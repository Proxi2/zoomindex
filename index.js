!function(){System.register(["./vendor.js"],function(e,t){"use strict";var a,n,i,s,r,l,o,d,c,u,m,p,h,f,g,y,v,_,b,M,x,C,j,N,w,I,T,E,S,k,A,R,L,O,D,P,F,B,U,H,z,V,G,q,$,K,J,W,Y,X,Q,Z,ee,et,ea,en,ei,es,er,el,eo,ed,ec,eu,em,ep,eh,ef,eg,ey,ev,e_,eb,eM,ex,eC,ej,eN,ew,eI,eT,eE,eS,ek,eA,eR,eL,eO,eD,eP,eF,eB,eU,eH,ez,eV,eG,eq,e$,eK,eJ,eW,eY,eX,eQ,eZ,e1,e0,e2,e5,e3,e6,e4,e8,e7,e9,te,tt,ta,tn,ti,ts,tr,tl,to,td,tc,tu,tm,tp,th,tf,tg,ty,tv,t_,tb,tM,tx,tC,tj,tN,tw,tI,tT,tE,tS,tk,tA,tR,tL,tO,tD,tP,tF,tB,tU,tH,tz,tV,tG,tq,t$,tK,tJ,tW,tY,tX,tQ,tZ,t1,t0,t2,t5,t3,t6,t4,t8,t7,t9,ae,at,aa,an,ai,as,ar,al,ao,ad,ac,au,am,ap,ah,af,ag,ay,av,a_,ab,aM,ax,aC,aj,aN,aw,aI,aT,aE,aS,ak,aA,aR,aL,aO,aD,aP,aF,aB,aU,aH,az,aV,aG,aq,a$,aK,aJ,aW,aY,aX,aQ,aZ,a1,a0,a2,a5,a3,a6,a4,a8,a7,a9,ne,nt,na,nn,ni,ns,nr,nl,no,nd,nc,nu,nm,np,nh,nf,ng,ny,nv,n_,nb,nM,nx,nC,nj,nN,nw,nI,nT,nE,nS,nk,nA,nR,nL,nO,nD,nP,nF,nB,nU,nH,nz,nV,nG,nq,n$,nK,nJ,nW,nY,nX,nQ,nZ,n1,n0,n2,n5,n3,n6,n4,n8,n7,n9,ie,it,ia,ii,is,ir,il,io,id,ic,iu,im,ip,ih,ig,iy,iv,i_,ib,iM,ix,iC,ij,iN,iw,iI,iT,iE,iS,ik,iA,iR,iL,iO,iD,iP,iF,iB,iU,iH,iz,iV,iG,iq,i$,iK,iJ,iW,iY;return{setters:[e=>{a=e.r,n=e.Z,i=e.m,s=e.M,r=e.c,l=e.i,o=e.a,d=e.b,c=e.d,u=e.u,m=e.e,p=e.f,h=e.o,f=e.g,g=e.j,y=e.h,v=e.k,_=e.l,b=e.n,M=e.p,x=e.t,C=e.q,j=e.s,N=e.v,w=e.w,I=e.O,T=e.x,E=e.y,S=e.z,k=e.A,A=e.B,R=e.C,L=e.D,O=e.E,D=e.F,P=e.G,F=e.H,B=e.S,U=e.I,H=e.J,z=e.K,V=e.L,G=e.N,q=e.P,$=e.Q,K=e.R,J=e.T,W=e.U,Y=e.V,X=e.W,Q=e.X,Z=e.Y,ee=e._,et=e.$,ea=e.a0,en=e.a1,ei=e.a2,es=e.a3,er=e.a4,el=e.a5,eo=e.a6,ed=e.a7,ec=e.a8,eu=e.a9,em=e.aa,ep=e.ab,eh=e.ac,ef=e.ad,eg=e.ae,ey=e.af,ev=e.ag,e_=e.ah,eb=e.ai,eM=e.aj,ex=e.ak,eC=e.al,ej=e.am,eN=e.an,ew=e.ao,eI=e.ap,eT=e.aq,eE=e.ar,eS=e.as,ek=e.at,eA=e.au,eR=e.av,eL=e.aw,eO=e.ax,eD=e.ay,eP=e.az,eF=e.aA,eB=e.aB,eU=e.aC,eH=e.aD,ez=e.aE,eV=e.aF,eG=e.aG,eq=e.aH,e$=e.aI,eK=e.aJ,eJ=e.aK,eW=e.aL,eY=e.aM,eX=e.aN,eQ=e.aO,eZ=e.aP,e1=e.aQ,e0=e.aR,e2=e.aS,e5=e.aT,e3=e.aU,e6=e.aV,e4=e.aW,e8=e.aX,e7=e.aY,e9=e.aZ,te=e.a_,tt=e.a$,ta=e.b0,tn=e.b1,ti=e.b2,ts=e.b3,tr=e.b4,tl=e.b5,to=e.b6,td=e.b7,tc=e.b8,tu=e.b9,tm=e.ba,tp=e.bb,th=e.bc,tf=e.bd,tg=e.be,ty=e.bf,tv=e.bg,t_=e.bh,tb=e.bi,tM=e.bj,tx=e.bk,tC=e.bl,tj=e.bm,tN=e.bn,tw=e.bo,tI=e.bp,tT=e.bq,tE=e.br,tS=e.bs,tk=e.bt,tA=e.bu,tR=e.bv,tL=e.bw,tO=e.bx,tD=e.by,tP=e.bz,tF=e.bA,tB=e.bB,tU=e.bC,tH=e.bD,tz=e.bE,tV=e.bF,tG=e.bG,tq=e.bH,t$=e.bI,tK=e.bJ,tJ=e.bK,tW=e.bL,tY=e.bM,tX=e.bN,tQ=e.bO,tZ=e.bP,t1=e.bQ,t0=e.bR,t2=e.bS,t5=e.bT,t3=e.bU,t6=e.bV,t4=e.bW,t8=e.bX,t7=e.bY,t9=e.bZ,ae=e.b_,at=e.b$,aa=e.c0,an=e.c1,ai=e.c2,as=e.c3,ar=e.c4,al=e.c5,ao=e.c6,ad=e.c7,ac=e.c8,au=e.c9,am=e.ca,ap=e.cb,ah=e.cc,af=e.cd,ag=e.ce,ay=e.cf,av=e.cg,a_=e.ch,ab=e.ci,aM=e.cj,ax=e.ck,aC=e.cl,aj=e.cm,aN=e.cn,aw=e.co,aI=e.cp,aT=e.cq,aE=e.cr,aS=e.cs,ak=e.ct,aA=e.cu,aR=e.cv,aL=e.cw,aO=e.cx,aD=e.cy,aP=e.cz,aF=e.cA,aB=e.cB,aU=e.cC,aH=e.cD,az=e.cE,aV=e.cF,aG=e.cG,aq=e.cH,a$=e.cI,aK=e.cJ,aJ=e.cK,aW=e.cL,aY=e.cM,aX=e.cN,aQ=e.cO,aZ=e.cP,a1=e.cQ,a0=e.cR,a2=e.cS,a5=e.cT,a3=e.cU,a6=e.cV,a4=e.cW,a8=e.cX,a7=e.cY,a9=e.cZ,ne=e.c_,nt=e.c$,na=e.d0,nn=e.d1,ni=e.d2,ns=e.d3,nr=e.d4,nl=e.d5,no=e.d6,nd=e.d7,nc=e.d8,nu=e.d9,nm=e.da,np=e.db,nh=e.dc,nf=e.dd,ng=e.de,ny=e.df,nv=e.dg,n_=e.dh,nb=e.di,nM=e.dj,nx=e.dk,nC=e.dl,nj=e.dm,nN=e.dn,nw=e.dp,nI=e.dq,nT=e.dr,nE=e.ds,nS=e.dt,nk=e.du,nA=e.dv,nR=e.dw,nL=e.dx,nO=e.dy,nD=e.dz,nP=e.dA,nF=e.dB,nB=e.dC,nU=e.dD,nH=e.dE,nz=e.dF,nV=e.dG,nG=e.dH,nq=e.dI,n$=e.dJ,nK=e.dK,nJ=e.dL,nW=e.dM,nY=e.dN,nX=e.dO,nQ=e.dP,nZ=e.dQ,n1=e.dR,n0=e.dS,n2=e.dT,n5=e.dU,n3=e.dV,n6=e.dW,n4=e.dX,n8=e.dY,n7=e.dZ,n9=e.d_,ie=e.d$,it=e.e0,ia=e.e1,ii=e.e2,is=e.e3,ir=e.e4,il=e.e5,io=e.e6,id=e.e7,ic=e.e8,iu=e.e9,im=e.ea,ip=e.eb,ih=e.ec,ig=e.ed,iy=e.ee,iv=e.ef,i_=e.eg,ib=e.eh,iM=e.ei,ix=e.ej,iC=e.ek,ij=e.el,iN=e.em,iw=e.en,iI=e.eo,iT=e.ep,iE=e.eq,iS=e.er,ik=e.es,iA=e.et,iR=e.eu,iL=e.ev,iO=e.ew,iD=e.ex,iP=e.ey,iF=e.ez,iB=e.eA,iU=e.eB,iH=e.eC,iz=e.eD,iV=e.eE,iG=e.eF,iq=e.eG,i$=e.eH,iK=e.eI,iJ=e.eJ,iW=e.eK,iY=e.eL}],execute:function(){let e;var iX=(e=>(e[e.SORTTYPE_UNKNOWN=0]="SORTTYPE_UNKNOWN",e[e.SORTTYPE_TIMESTAMP=1]="SORTTYPE_TIMESTAMP",e[e.SORTTYPE_SCORE=2]="SORTTYPE_SCORE",e[e.SORTTYPE_NAME_ASC=3]="SORTTYPE_NAME_ASC",e[e.SORTTYPE_NAME_DESC=4]="SORTTYPE_NAME_DESC",e[e.SORTTYPE_CREATE_TIME_ASC=5]="SORTTYPE_CREATE_TIME_ASC",e[e.SORTTYPE_CREATE_TIME_DESC=6]="SORTTYPE_CREATE_TIME_DESC",e[e.SORTTYPE_MODIFY_TIME_ASC=7]="SORTTYPE_MODIFY_TIME_ASC",e[e.SORTTYPE_MODIFY_TIME_DESC=8]="SORTTYPE_MODIFY_TIME_DESC",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(iX||{}),iQ=(e=>(e[e.FILETYPE_UNKNOWN=0]="FILETYPE_UNKNOWN",e[e.ALL=1]="ALL",e[e.IMAGES=2]="IMAGES",e[e.VIDEOS=3]="VIDEOS",e[e.DOCUMENTS=4]="DOCUMENTS",e[e.PRESENTATIONS=5]="PRESENTATIONS",e[e.SPREADSHEETS=6]="SPREADSHEETS",e[e.OTHER=7]="OTHER",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(iQ||{}),iZ=(e=>(e[e.WHITEBOARD=0]="WHITEBOARD",e[e.INTEGRATION=1]="INTEGRATION",e[e.SHAREPOINT=2]="SHAREPOINT",e[e.ZOOM_FILES=3]="ZOOM_FILES",e[e.BOX=4]="BOX",e[e.HUDDLE_VIEW=5]="HUDDLE_VIEW",e[e.NEW_WHITEBOARD=6]="NEW_WHITEBOARD",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(iZ||{}),i1=(e=>(e.CHAT="chat",e.CHANNEL="channel",e.MUC="muc",e.UNKNOWN="unknown",e.TOP_MENU="top_menu",e.BROADCAST="broadcast",e.HIDDEN="hidden",e.ROOM="room",e))(i1||{}),i0=(e=>(e.STARRED="STARRED",e.CHATS="CHATS",e.CHANNELS="CHANNELS",e.MEETING_CHATS="MEETING_CHATS",e.SPOT_CHANNELS="SPOT_CHANNELS",e.APPS="APPS",e.FOLDERS="FOLDERS",e.RECENTS="RECENTS",e.TOP_MENU="TOP_MENU",e))(i0||{}),i2=(e=>(e.PROFILE_INFO="profile-info",e.MEMBER_LIST="member-list",e.MORE_OPTIONS="more-options",e.BOOKMARK="bookmark",e.NOTIFICATIONS="notifications",e.PIN_HISTORY="pin-history",e.FILES="files",e.MENTION_GROUPS="mention-groups",e.WHITEBOARD="whiteboard",e))(i2||{}),i5=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.IM_GROUP=1]="IM_GROUP",e[e.CHANNEL=2]="CHANNEL",e[e.NEW_CHAT=3]="NEW_CHAT",e[e.PERSONAL_GROUP=4]="PERSONAL_GROUP",e[e.BROADCAST_CHANNEL=5]="BROADCAST_CHANNEL",e[e.EVENT_CHANNEL=6]="EVENT_CHANNEL",e[e.HIDDEN_CHANNEL=7]="HIDDEN_CHANNEL",e))(i5||{}),i3=(e=>(e.START_CHAT="startchat",e.GROUP_CHAT="groupchat",e.CHAT="chat",e.STAR="star",e.TOP_MENU="topmenu",e))(i3||{}),i6=(e=>(e[e.unsent=0]="unsent",e[e.sending=1]="sending",e[e.sended=2]="sended",e[e.sendError=3]="sendError",e[e.notDownload=4]="notDownload",e[e.downloading=5]="downloading",e[e.downloaded=6]="downloaded",e[e.downloadError=7]="downloadError",e[e.downloadErrorNotReady=8]="downloadErrorNotReady",e[e.paused=9]="paused",e))(i6||{}),i4=(e=>(e[e.OWNER=10]="OWNER",e[e.ADMIN=22]="ADMIN",e[e.ANNOUNCER=25]="ANNOUNCER",e[e.MODERATOR=27]="MODERATOR",e[e.MEMBER=30]="MEMBER",e[e.OUTCAST=40]="OUTCAST",e[e.ADDON=60]="ADDON",e[e.NOTAMEMBER=-1]="NOTAMEMBER",e))(i4||{}),i8=(e=>(e.PRIVATE="private",e.PUBLIC="public",e))(i8||{}),i7=(e=>(e.ALL="all",e.ADMIN="admin",e))(i7||{}),i9=(e=>(e.ALL="all",e.MEMBERS="members",e.ADMINS="admins",e))(i9||{}),se=(e=>(e.ALL="all",e.ADMINISTRATOR="administrator",e.DESIGNEES="designees",e))(se||{}),st=(e=>(e.ADD_MEMBER="AddDialog",e.ASSIGN_ADMIN="AssignDialog",e.CREATE_CHANNEL="CreateDialog",e.EDIT_CHANNEL="EditDialog",e.DELETE_CHANNEL="DeleteDialog",e.LEAVE_CHANNEL="LeaveDialog",e.VIEW_MEMBERS="MembersDialog",e.VIEW_PROFILE="ProfileDialog",e.REMOVE_MEMBER="RemoveDialog",e.MEETING="MeetingDialog",e.JOIN_CHANNEL="JoinDialog",e.PREVIEW_CHANNEL="PreviewDialog",e.ADD_MEMBER_P2P="AddDialogP2P",e.TRANSFER="TransferDialog",e.MESSAGE_BOX="MessageBoxDialog",e.CONTACT_INVITATION="ContactInvitationDialog",e.MESSAGE_PREFERENCES="MessagePreferencesDialog",e.CODE_SNIPPET="CodeSnippetDialog",e.ADD_MENTION_GROUP="AddMentionGroupDialog",e.EDIT_MENTION_GROUP="EditMentionGroupDialog",e.PREVIEW_MENTION_GROUP="PreviewMentionGroupDialog",e.ADD_APP="AddAppDialog",e))(st||{}),sa=(e=>(e.add="add",e.remove="remove",e))(sa||{}),sn=(e=>(e.MENTION="mention",e.CONTACT="contact",e.REMINDERS="reminders",e.BOOKMARKS="bookmarks",e.FILES="files",e.MORE="more",e))(sn||{}),si=(e=>(e.ALL="all",e.ANYONE="anyone",e.BOOKMARKS="bookmarks",e))(si||{});let ss=[{jid:"mention",type:"top_menu"},{jid:"contact",type:"top_menu"},{jid:"reminders",type:"top_menu"},{jid:"bookmarks",type:"top_menu"},{jid:"files",type:"top_menu"}];var sr=(e=>(e.LIGHT="LIGHT",e.DEFAULT="DEFAULT",e))(sr||{}),sl=(e=>(e.LIGHT="themeLIGHT",e))(sl||{}),so=(e=>(e.FIRST="FIRST",e.LAST="LAST",e))(so||{});let sd=["mention","contact","reminders","bookmarks","files"];var sc=(e=>(e.ASSIGN="add_admin",e.UNASSIGN="del_admin",e))(sc||{}),su=(e=>(e.Self_Restrict="MessageError_InSelfRestrictDomains",e.Peer_Restrict="MessageError_InPeerRestrictDomains",e.Blocked="MessageError_BlockedUser",e))(su||{}),sm=(e=>(e[e.REASON_UNKNOWN=0]="REASON_UNKNOWN",e[e.REASON_INFORMATION_BARRIER=1]="REASON_INFORMATION_BARRIER",e[e.REASON_SAME_ORG_ORG_MEMBER_ADD_EXT=2]="REASON_SAME_ORG_ORG_MEMBER_ADD_EXT",e[e.REASON_NON_CONTACT=3]="REASON_NON_CONTACT",e[e.REASON_SAME_ORG_EXT_MEMBER_ADD_EXT=4]="REASON_SAME_ORG_EXT_MEMBER_ADD_EXT",e[e.REASON_EXT_MEMBER_ADD_EXT=5]="REASON_EXT_MEMBER_ADD_EXT",e[e.REASON_REACH_MAX_MEMBER_NUM=6]="REASON_REACH_MAX_MEMBER_NUM",e[e.REASON_USER_INACTIVE=7]="REASON_USER_INACTIVE",e[e.REASON_TYPE_ZOOM_ROOM=8]="REASON_TYPE_ZOOM_ROOM",e[e.REASON_TYPE_NOT_CLIENT_INVITE_BOT=9]="REASON_TYPE_NOT_CLIENT_INVITE_BOT",e[e.REASON_CHAT_DISABLED=10]="REASON_CHAT_DISABLED",e[e.REASON_USER_NOT_FOUND=11]="REASON_USER_NOT_FOUND",e[e.REASON_TYPE_SHARED_OFFICE=12]="REASON_TYPE_SHARED_OFFICE",e[e.REASON_INVITE_DUPLICATE_USER=13]="REASON_INVITE_DUPLICATE_USER",e[e.REASON_INVITER_NOT_PERMISSION=14]="REASON_INVITER_NOT_PERMISSION",e[e.REASON_KICK_OPERATOR=15]="REASON_KICK_OPERATOR",e[e.REASON_NOT_EXIST_MEMBER=16]="REASON_NOT_EXIST_MEMBER",e[e.REASON_KICK_GROUPKEEP_OR_USERSKEEP=17]="REASON_KICK_GROUPKEEP_OR_USERSKEEP",e[e.REASON_EXTERNAL_INVITATION_WEB_RATE_LIMIT=18]="REASON_EXTERNAL_INVITATION_WEB_RATE_LIMIT",e[e.REASON_NOT_ADMIN_ADD_EXT=19]="REASON_NOT_ADMIN_ADD_EXT",e[e.REASON_BLOCK_NOT_PERMISSION=20]="REASON_BLOCK_NOT_PERMISSION",e[e.REASON_BLOCKED_NOT_PERMISSION=21]="REASON_BLOCKED_NOT_PERMISSION",e))(sm||{});let sp={0:"#2D8CFF",1:"#CF42C2",2:"#00A832",3:"#FF4242",4:"#FAAC2A",5:"#BABACC"};var sh=(e=>(e.MicrosoftOneDrive="onedrive",e.GoogleDrive="gdrive",e.Dropbox="dropbox",e.MicrosoftSharePoint="sharepoint",e.Box="box",e))(sh||{}),sf=(e=>(e.Whiteboard="whiteboard",e.NewWhiteboard="new_whiteboard",e))(sf||{}),sg=(e=>(e[e.None=0]="None",e[e.Dropbox=1]="Dropbox",e[e.MicrosoftOneDrive=2]="MicrosoftOneDrive",e[e.GoogleDrive=3]="GoogleDrive",e[e.Box=4]="Box",e[e.MicrosoftSharePoint=5]="MicrosoftSharePoint",e))(sg||{}),sy=(e=>(e[e.None=0]="None",e[e.Word=1]="Word",e[e.Excel=2]="Excel",e[e.PPT=3]="PPT",e[e.OneNote=4]="OneNote",e[e.BoxNode=5]="BoxNode",e[e.BoxNodeFromTemplate=6]="BoxNodeFromTemplate",e[e.GoogleDocs=7]="GoogleDocs",e[e.GoogleSlides=8]="GoogleSlides",e[e.GoogleSheet=9]="GoogleSheet",e))(sy||{}),sv=(e=>(e.MESSAGE="message",e.FIELDS="fields",e.SELECT="select",e.ACTIONS="actions",e.ATTACHMENTS="attachments",e.TIME_PICKER="timepicker",e.DATE_PICKER="datepicker",e.SECTION="section",e.RADIO_BUTTONS="radio_buttons",e.DIVIDER="divider",e.PROGRESS_BAR="progress_bar",e.FILE="file",e))(sv||{}),s_=(e=>(e.PRIMARY="Primary",e.DEFAULT="Default",e.DANGER="Danger",e.DISABLED="Disabled",e))(s_||{}),sb=(e=>(e.Action="action",e.Edit="edit",e.Select="select",e.FieldEdit="field_edit",e.Timepicker="timepicker",e.Datepicker="datepicker",e.RadioButtons="radio_buttons",e))(sb||{});class sM{static #e=(()=>{this.created={}})();static create(e){let t=sM.created[e];if(t)return t;{let t=new sM(e);return sM.created[e]=t,t}}static #t=(()=>{this.ACTIVE_ATTRIBUTE="data-active"})();static #a=(()=>{this.SCROLL_ATTRIBUTE="data-scroll-id"})();static #n=(()=>{this.MESSAGE_ATTRIBUTE="data-message-id"})();static #i=(()=>{this.REPLY_ATTRIBUTE="data-reply-id"})();static #s=(()=>{this.HIGHLIGHT_ATTRIBUTE="data-highlight"})();static activeAttrs(e){return e?{[sM.ACTIVE_ATTRIBUTE]:e}:{}}static scrollAttrs(e){return{[sM.SCROLL_ATTRIBUTE]:e}}static msgAttrs(e){return{[sM.MESSAGE_ATTRIBUTE]:e}}static replyAttrs(e){return{[sM.REPLY_ATTRIBUTE]:e}}static #r=(()=>{this.queryScroll=e=>document.querySelector(`[${sM.ACTIVE_ATTRIBUTE}] [${sM.SCROLL_ATTRIBUTE}="${e}"]`)})();static #l=(()=>{this.queryMessage=(e,t)=>sM.queryScroll(e)?.querySelector(`[${sM.MESSAGE_ATTRIBUTE}="${t}"]`)})();constructor(e){this.lastHighlightTimeMap=new Map,this.needToScrollEnd=!1,this.needRestore=null,this.channelJid=e}get scrollElement(){return sM.queryScroll(this.channelJid)}get isScrollBottom(){let e=this.scrollElement;return!e||Math.abs(e.scrollHeight-e.clientHeight-e.scrollTop)<1}scrollToMessage(e,t){let a=this.scrollElement;if(!a)return;let n=a.querySelector(`[${sM.MESSAGE_ATTRIBUTE}="${e}"]`);if(n){if("function"==typeof n.scrollIntoView)n.scrollIntoView({block:"center"});else{let e=a.scrollHeight,t=Math.min(Math.max(n.offsetTop+n.clientHeight/2-a.clientHeight/2,0),e);a.scrollTop=t}if(t){n.removeAttribute(sM.HIGHLIGHT_ATTRIBUTE);let t=Date.now();requestAnimationFrame(()=>{this.lastHighlightTimeMap.set(e,t),n.setAttribute(sM.HIGHLIGHT_ATTRIBUTE,"true"),setTimeout(()=>{this.lastHighlightTimeMap.get(e)===t&&n.removeAttribute(sM.HIGHLIGHT_ATTRIBUTE)},2e3)})}}}scrollToReplyInput(e){let t=this.scrollElement;if(!t)return;let a=t.querySelector(`[${sM.REPLY_ATTRIBUTE}="${e}"]`);if(!a||this.isInView(a))return;let n=t.scrollHeight;t.scrollTop=Math.min(Math.max(a.offsetTop+a.clientHeight-t.clientHeight+12,0),n)}isInView(e){let t=this.scrollElement;if(!t)return!1;let a=t.scrollTop,n=a+t.clientHeight,i=e.offsetTop+e.offsetHeight;return a<e.offsetTop+e.clientHeight&&n>i+e.clientHeight}scrollEnd(){let e=this.scrollElement;return e?(this.needToScrollEnd=!1,e.scrollTop=e.scrollHeight,!0):(this.needToScrollEnd=!0,!1)}tryScrollEnd(){return!!this.needToScrollEnd&&this.scrollEnd()}scrollTop(){let e=this.scrollElement;e&&(e.scrollTop=0)}adjustPosition(e){let t=this.scrollElement;if(!t||!e)return;let a=Math.min(Math.max(t.scrollTop+e,0),t.scrollHeight);t.scrollTop=a}restore(e){let{messageId:t,targetTop:a,offset:n}=e,i=this.scrollElement;if(!i)return this.needRestore={messageId:t,targetTop:a,offset:n},!1;let s=i.querySelector(`[${sM.MESSAGE_ATTRIBUTE}="${t}"]`);return s?(this.needRestore=null,i.scrollTop=s.offsetTop+i.getBoundingClientRect().top-a-n,!0):(this.needRestore=null,!1)}restorePosition(e,t){void 0===t&&(t=0);let a=this.scrollElement;if(!a)return{};let n=a.querySelector(`[${sM.MESSAGE_ATTRIBUTE}="${e}"]`);if(!n)return{};let{top:i}=n.getBoundingClientRect();return{record:()=>{let{top:e}=n.getBoundingClientRect();i=e},restore:()=>{this.restore({messageId:e,targetTop:i,offset:t})}}}tryRestorePosition(){return!!this.needRestore&&this.restore(this.needRestore)}}class sx{static #e=(()=>{this.MAIN_MSG_ATTR="data-main-msg-id"})();static #t=(()=>{this._created={}})();static create(e){let t=sx._created[e];if(t)return t;{let t=new sx(e);return sx._created[e]=t,t}}constructor(e){this._messages=[],this._channelJid=e;let t=e=>{let t=e.target.getAttribute(sx.MAIN_MSG_ATTR);if(!t)return;let a=e.isIntersecting,n=this._messages.findIndex(e=>e===t);if(a){if(-1!==n)return;this._messages.push(t)}else{if(-1===n)return;this._messages.splice(n,1)}};this._observer=new IntersectionObserver(e=>{e.forEach(t)},{root:sM.queryScroll(this._channelJid)})}observe(e){this._observer.observe(e)}unobserve(e){this._observer.unobserve(e)}get messages(){return this._messages}}let sC={Utils:{}};sC.Utils.focusFirstDescendant=function(e,t){for(let a of e.childNodes)if(a!==t&&(sC.Utils.attemptFocus(a)||sC.Utils.focusFirstDescendant(a,t)))return!0;return!1},sC.Utils.focusNext=function(e,t,a){let n=t||document.activeElement,i=n?.nextSibling;if(i&&i!==a)return!!sC.Utils.attemptFocus(i)||!!sC.Utils.focusFirstDescendant(i)||sC.Utils.focusNext(e,i,a);{let t=n?.parentNode;return t!==e&&sC.Utils.focusNext(e,t,a)}},sC.Utils.focusPrevious=function(e,t,a){let n=t||document.activeElement,i=n?.previousSibling;if(i&&i!==a)return!!sC.Utils.attemptFocus(i)||!!sC.Utils.focusLastDescendant(i)||sC.Utils.focusPrevious(e,i,a);{let t=n?.parentNode;return t!==e&&sC.Utils.focusPrevious(e,t,a)}},sC.Utils.focusLastDescendant=function(e,t){for(let a=e.childNodes.length-1;a>=0;a--){let n=e.childNodes[a];if(n!==t&&(sC.Utils.attemptFocus(n)||sC.Utils.focusLastDescendant(n,t)))return!0}return!1},sC.Utils.findLastFocusEl=function(e,t,a){void 0===a&&(a=!0);for(let n=e.childNodes.length-1;n>=0;n--){let i=e.childNodes[n];if(i!==t&&sC.Utils.isFocusable(i,a))return i;let s=sC.Utils.findLastFocusEl(i,t,a);if(s)return s}return null},sC.Utils.findFirstFocusEl=function(e,t,a){for(let n of(void 0===a&&(a=!0),e.childNodes)){if(n!==t&&sC.Utils.isFocusable(n,a))return n;let e=sC.Utils.findFirstFocusEl(n,t,a);if(e)return e}return null},sC.Utils.attemptFocus=function(e){if(!sC.Utils.isFocusable(e))return!1;try{e.focus()}catch(e){}return document.activeElement===e},sC.Utils.isFocusable=function(e,t){if(void 0===t&&(t=!0),!e.getAttribute||e.disabled||t&&e.tabIndex<0)return!1;if(e.tabIndex>=0||null!==e.getAttribute("tabindex"))return!0;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return"hidden"!==e.type&&"file"!==e.type;case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},sC.Utils.triggerEvent=function(e,t){let a;for(var n=arguments.length,i=Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];a=/^mouse|click/.test(t)?"MouseEvents":t.startsWith("key")?"KeyboardEvent":"HTMLEvents";let r=document.createEvent(a);return r.initEvent(t,...i),e.dispatchEvent?e.dispatchEvent(r):e.fireEvent?.("on"+t,r),e};let sj=sC.Utils,sN={tab:"Tab",enter:"Enter",space:" ",esc:"Escape",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",left:"ArrowLeft"},sw=[".exe",".app"],sI="aria-screen-reader",sT=e=>{let t=document.getElementById(sI);t&&(t.innerText=e)},sE="undefined"==typeof window,sS=!sE&&navigator.userAgent.toLowerCase();sS&&sS.indexOf("android");let sk=navigator.vendor.match(/apple/i)&&sS&&!sS.match(/crios/i)&&sS&&!sS.match(/fxios/i)&&sS&&!sS.match(/opera|opt\//);navigator?.mediaDevices?.getDisplayMedia;let sA=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{fill:"#747487",fillRule:"evenodd",d:"M4.5 6.80336V25.1966C4.5 28.1256 6.8744 30.5 9.80336 30.5H23.1966C26.1256 30.5 28.5 28.1256 28.5 25.1966V11.0007C28.5 10.2039 28.1867 9.439 27.6277 8.87116L21.2637 2.40607C20.6931 1.82642 19.9137 1.5 19.1003 1.5H9.80336C6.8744 1.5 4.5 3.8744 4.5 6.80336ZM3 25.1966V6.80336C3 3.04597 6.04597 0 9.80336 0H19.1003C20.3156 0 21.4801 0.487712 22.3326 1.35379L28.6967 7.81888C29.5319 8.66732 30 9.81013 30 11.0007V25.1966C30 28.954 26.954 32 23.1966 32H9.80336C6.04597 32 3 28.954 3 25.1966Z",clipRule:"evenodd"}),a.createElement("path",{stroke:"#747487",strokeLinecap:"round",strokeWidth:1.5,d:"M18.7852 4V9.25C18.7852 10.3546 19.6806 11.25 20.7852 11.25H26.0352"})))},sR=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},a.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"#fff",strokeWidth:2}),a.createElement("path",{fill:"#fff",d:"M9.5 12.2929V6.5C9.5 6.22388 9.72388 6 10 6C10.2761 6 10.5 6.22388 10.5 6.5V12.2929L12.6465 10.1464C12.8418 9.95117 13.1582 9.95117 13.3535 10.1464C13.5488 10.3417 13.5488 10.6583 13.3535 10.8536L10.3535 13.8536C10.1582 14.0488 9.8418 14.0488 9.64648 13.8536L6.64648 10.8536C6.45117 10.6583 6.45117 10.3417 6.64648 10.1464C6.8418 9.95117 7.1582 9.95117 7.35352 10.1464L9.5 12.2929Z"})))},sL=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},a.createElement("circle",{cx:10,cy:10,r:9,fill:"#DE2828",stroke:"#fff",strokeWidth:2}),a.createElement("path",{fill:"#fff",d:"M10 11C9.58582 11 9.25 10.6642 9.25 10.25V6.75C9.25 6.33582 9.58582 6 10 6C10.4142 6 10.75 6.33582 10.75 6.75V10.25C10.75 10.6642 10.4142 11 10 11Z"}),a.createElement("path",{fill:"#fff",d:"M10 13.75C9.58582 13.75 9.25 13.4142 9.25 13C9.25 12.5858 9.58582 12.25 10 12.25C10.4142 12.25 10.75 12.5858 10.75 13C10.75 13.4142 10.4142 13.75 10 13.75Z"})))},sO=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},a.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"#fff",strokeWidth:2}),a.createElement("path",{fill:"#fff",d:"M10.0005 14.5C9.724 14.5 9.50032 14.2763 9.50032 13.9998C9.50032 13.7243 9.724 13.4997 10.0005 13.4997C11.933 13.4997 13.4997 11.933 13.4997 10.0005C13.4997 8.06704 11.933 6.50032 10.0005 6.50032C8.06704 6.50032 6.50032 8.06704 6.50032 10.0005C6.50032 10.276 6.27568 10.4997 6.00016 10.4997C5.72368 10.4997 5.5 10.276 5.5 10.0005C5.5 7.51504 7.51504 5.5 10.0005 5.5C12.485 5.5 14.5 7.51504 14.5 10.0005C14.5 12.485 12.485 14.5 10.0005 14.5Z"})))},sD=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},a.createElement("circle",{cx:10,cy:10,r:9,fill:"#61C755",stroke:"#fff",strokeWidth:2}),a.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M14.0138 7.16552C14.2538 7.39405 14.263 7.77384 14.0345 8.01379L9.03449 13.2638C8.91978 13.3842 8.76022 13.4517 8.5939 13.45C8.42758 13.4483 8.26942 13.3776 8.15719 13.2549L6.15719 11.0674C5.93359 10.8228 5.95058 10.4433 6.19514 10.2197C6.4397 9.99608 6.81922 10.0131 7.04282 10.2576L8.60896 11.9706L13.1655 7.18621C13.3941 6.94625 13.7738 6.93699 14.0138 7.16552Z",clipRule:"evenodd"})))},sP=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("path",{stroke:"currentColor",d:"M12.6816 5.25779L13.7734 6.38592C14.0625 6.68462 14.0565 7.16057 13.7601 7.45193L8.3376 12.781C8.2277 12.889 8.08745 12.9609 7.93559 12.9871L5.89787 13.338C5.7544 13.3627 5.62923 13.2389 5.65241 13.0951L5.99591 10.9655C6.0216 10.8062 6.09751 10.6594 6.21257 10.5463L11.6074 5.24433C11.9071 4.94978 12.3894 4.95582 12.6816 5.25779Z"}),a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2.5 2C2.22386 2 2 2.22386 2 2.5C2 2.77614 2.22386 3 2.5 3H4.75V8.5C4.75 8.57767 4.84272 8.59508 4.8904 8.53377L5.59447 7.62853C5.69527 7.49893 5.75 7.33943 5.75 7.17525V3H8C8.27614 3 8.5 2.77614 8.5 2.5C8.5 2.22386 8.27614 2 8 2H5.25H2.5Z",clipRule:"evenodd"})))},sF=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 22 22",width:"1em",height:"1em"},a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16.7526 1.09981C16.7526 0.685754 17.0882 0.350098 17.5023 0.350098C17.9163 0.350098 18.252 0.685754 18.252 1.09981V3.1015H20.252C20.6659 3.1015 21.0015 3.43704 21.0015 3.85094C21.0015 4.26485 20.666 4.60039 20.252 4.60039H18.252V6.59807C18.252 7.01213 17.9163 7.34778 17.5023 7.34778C17.0882 7.34778 16.7526 7.01213 16.7526 6.59807V4.60039H14.7494C14.3355 4.60039 14 4.26485 14 3.85094C14 3.43704 14.3355 3.1015 14.7494 3.1015H16.7526V1.09981ZM1.5 13.0101V7.00012C1.5 5.61941 2.61929 4.50012 4 4.50012H10C10.4142 4.50012 10.75 4.16434 10.75 3.75012C10.75 3.33591 10.4142 3.00012 10 3.00012H4C1.79086 3.00012 0 4.79098 0 7.00012V13.0101C0 15.2137 1.7864 17.0001 3.99003 17.0001C3.99553 17.0001 4 17.0046 4 17.0101V20.5516C4 21.0861 4.64629 21.3538 5.02426 20.9759L8.56066 17.4395C8.84197 17.1582 9.2235 17.0001 9.62132 17.0001H16C18.2091 17.0001 20 15.2093 20 13.0001V11.0001C20 10.5859 19.6642 10.2501 19.25 10.2501C18.8358 10.2501 18.5 10.5859 18.5 11.0001V13.0001C18.5 14.3808 17.3807 15.5001 16 15.5001H9.62132C8.82567 15.5001 8.06261 15.8162 7.5 16.3788L5.5 18.3788V17.0101C5.5 16.1762 4.82403 15.5001 3.99003 15.5001C2.61482 15.5001 1.5 14.3853 1.5 13.0101Z",clipRule:"evenodd"})))},sB=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 15 15",width:"1em",height:"1em"},a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12.5 0C12.2239 0 12 0.223858 12 0.5V2H10.5C10.2239 2 10 2.22386 10 2.5C10 2.77614 10.2239 3 10.5 3H12V4.5C12 4.77614 12.2239 5 12.5 5C12.7761 5 13 4.77614 13 4.5V3H14.5C14.7761 3 15 2.77614 15 2.5C15 2.22386 14.7761 2 14.5 2H13V0.5C13 0.223858 12.7761 0 12.5 0ZM6 7C6 7.55228 5.55228 8 5 8C4.44772 8 4 7.55228 4 7C4 6.44772 4.44772 6 5 6C5.55228 6 6 6.44772 6 7ZM10 7C10 7.55228 9.55228 8 9 8C8.44772 8 8 7.55228 8 7C8 6.44772 8.44772 6 9 6C9.55228 6 10 6.44772 10 7ZM4.65664 9.25298C4.52022 9.01289 4.21499 8.92885 3.9749 9.06528C3.73481 9.20171 3.65078 9.50693 3.7872 9.74702C4.54047 11.0726 6.0159 11.5 6.99999 11.5C7.98408 11.5 9.45951 11.0726 10.2128 9.74702C10.3492 9.50693 10.2652 9.20171 10.0251 9.06528C9.78499 8.92885 9.47976 9.01289 9.34334 9.25298C8.83133 10.154 7.77467 10.5 6.99999 10.5C6.22531 10.5 5.16865 10.154 4.65664 9.25298ZM7 14C10.3137 14 13 11.3137 13 8V7.5C13 7.22386 13.2239 7 13.5 7C13.7761 7 14 7.22386 14 7.5V8C14 11.866 10.866 15 7 15C3.13401 15 0 11.866 0 8C0 4.13401 3.13401 1 7 1H7.5C7.77614 1 8 1.22386 8 1.5C8 1.77614 7.77614 2 7.5 2H7C3.68629 2 1 4.68629 1 8C1 11.3137 3.68629 14 7 14Z",clipRule:"evenodd"})))},sU=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 15 15",width:"1em",height:"1em"},a.createElement("path",{stroke:"currentColor",strokeLinecap:"round",d:"M1.76172 8.61078C1.76172 8.61078 2.03255 5.71743 4.09236 4.28671C6.15216 2.85598 8.51933 3.10544 8.51933 3.10544M7.07317 1.375L8.96144 3.19848L7.13796 5.08675M5.68719 12.75L7.04412 11.0538C7.23458 10.8158 7.60405 10.8406 7.76091 11.102L8.38215 12.1374C8.55028 12.4177 8.9551 12.4213 9.1283 12.1442L10.4937 9.9596C10.6809 9.66003 11.1277 9.69443 11.2668 10.0191L12.2497 12.3125M6.12469 13.625H11.3747C12.3412 13.625 13.1247 12.8415 13.1247 11.875V8.375C13.1247 7.4085 12.3412 6.625 11.3747 6.625H6.12469C5.15819 6.625 4.37469 7.4085 4.37469 8.375V11.875C4.37469 12.8415 5.15819 13.625 6.12469 13.625ZM6.99968 8.8125C6.99968 9.05412 6.80381 9.25 6.56219 9.25C6.32056 9.25 6.12469 9.05412 6.12469 8.8125C6.12469 8.57088 6.32056 8.375 6.56219 8.375C6.80381 8.375 6.99968 8.57088 6.99968 8.8125Z"})))},sH=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("circle",{cx:8,cy:8,r:7.5,stroke:"#BABACC"})))},sz=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("circle",{cx:8,cy:8,r:8,fill:"#0E72ED"}),a.createElement("g",{filter:"url(#filter0_dd_1354_6199)"},a.createElement("circle",{cx:8,cy:8,r:4,fill:"#fff"})),a.createElement("defs",null,a.createElement("filter",{id:"filter0_dd_1354_6199",width:12,height:12,x:2,y:3,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},a.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:1}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.2 0"}),a.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1354_6199"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:.5}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.4 0"}),a.createElement("feBlend",{in2:"effect1_dropShadow_1354_6199",result:"effect2_dropShadow_1354_6199"}),a.createElement("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1354_6199",result:"shape"})))))},sV=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("circle",{cx:8,cy:8,r:7.5,stroke:"#F1F4F6"})))},sG=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("circle",{cx:8,cy:8,r:8,fill:"#D0E3FB"}),a.createElement("g",{filter:"url(#filter0_dd_1354_6219)"},a.createElement("circle",{cx:8,cy:8,r:4,fill:"#fff"})),a.createElement("defs",null,a.createElement("filter",{id:"filter0_dd_1354_6219",width:12,height:12,x:2,y:3,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},a.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:1}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.2 0"}),a.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1354_6219"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:.5}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.4 0"}),a.createElement("feBlend",{in2:"effect1_dropShadow_1354_6219",result:"effect2_dropShadow_1354_6219"}),a.createElement("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1354_6219",result:"shape"})))))},sq=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("rect",{width:15,height:15,x:.5,y:.5,stroke:"#BABACC",rx:3.5})))},s$=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("rect",{width:16,height:16,fill:"#0E72ED",rx:4}),a.createElement("g",{filter:"url(#filter0_dd_11433_51822)"},a.createElement("path",{fill:"#fff",d:"M12.9102 3.89945C13.3062 4.22346 13.3646 4.80716 13.0406 5.20318L7.48175 11.9973C7.316 12.1999 7.07228 12.3229 6.81085 12.3359C6.54942 12.349 6.29468 12.2508 6.10959 12.0657L3.02136 8.97749C2.65955 8.61568 2.65955 8.02907 3.02136 7.66727C3.38317 7.30546 3.96977 7.30546 4.33158 7.66727L6.69592 10.0316L11.6065 4.02982C11.9305 3.63381 12.5142 3.57544 12.9102 3.89945Z"})),a.createElement("defs",null,a.createElement("filter",{id:"filter0_dd_11433_51822",width:14.5,height:12.647,x:.75,y:2.69,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},a.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:1}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.2 0"}),a.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_11433_51822"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:.5}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.4 0"}),a.createElement("feBlend",{in2:"effect1_dropShadow_11433_51822",result:"effect2_dropShadow_11433_51822"}),a.createElement("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_11433_51822",result:"shape"})))))},sK=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("rect",{width:15,height:15,x:.5,y:.5,stroke:"#F1F4F6",rx:3.5})))},sJ=e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("rect",{width:16,height:16,fill:"#D0E3FB",rx:4}),a.createElement("g",{filter:"url(#filter0_dd_11433_51887)"},a.createElement("path",{fill:"#fff",d:"M12.9102 3.89945C13.3062 4.22346 13.3646 4.80716 13.0406 5.20318L7.48175 11.9973C7.316 12.1999 7.07228 12.3229 6.81085 12.3359C6.54942 12.349 6.29468 12.2508 6.10959 12.0657L3.02136 8.97749C2.65955 8.61568 2.65955 8.02907 3.02136 7.66727C3.38317 7.30546 3.96977 7.30546 4.33158 7.66727L6.69592 10.0316L11.6065 4.02982C11.9305 3.63381 12.5142 3.57544 12.9102 3.89945Z"})),a.createElement("defs",null,a.createElement("filter",{id:"filter0_dd_11433_51887",width:14.5,height:12.647,x:.75,y:2.69,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},a.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:1}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.2 0"}),a.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_11433_51887"}),a.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:1}),a.createElement("feGaussianBlur",{stdDeviation:.5}),a.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),a.createElement("feColorMatrix",{values:"0 0 0 0 0.0745098 0 0 0 0 0.0862745 0 0 0 0 0.0980392 0 0 0 0.4 0"}),a.createElement("feBlend",{in2:"effect1_dropShadow_11433_51887",result:"effect2_dropShadow_11433_51887"}),a.createElement("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_11433_51887",result:"shape"})))))};function sW(){return n.uuid()}var sY=(e=>(e.image="imageEdit",e.file="fileEdit",e))(sY||{}),sX=(e=>(e.KeyWord="keyword",e.Type="sortType",e.GroupJid="groupJid",e.SendByJid="sendByJid",e.FileType="fileType",e.FileTime="fileTime",e.OnlyP2P="onlyP2P",e.UserJid="userJid",e.ChannelType="channelType",e))(sX||{}),sQ=(e=>(e.Any="any",e.Today="today",e.Yesterday="yesterday",e.Last7Days="last7days",e.Last30Days="last30days",e))(sQ||{}),sZ=(e=>(e[e.loadError=0]="loadError",e[e.loadErrorNotReady=1]="loadErrorNotReady",e[e.notLoad=2]="notLoad",e[e.loading=3]="loading",e[e.loaded=4]="loaded",e[e.loadingHQ=5]="loadingHQ",e[e.loadedHQ=6]="loadedHQ",e))(sZ||{});let s1=["png","jpg","jpeg","gif","svg"];function s0(e,t){return(void 0===t&&(t=2),e<1024)?e+"B":e<1048576?Math.round(e/1024)+" KB":e<1073741824?(e/1024/1024).toFixed(t)+" MB":e<1099511627776?(e/1024*1048576).toFixed(t)+" GB":""}function s2(e){return e?.substring(e.lastIndexOf(".")).toLowerCase()??""}function s5(e){return".gif"===s2(e)}function s3(e){return e.includes(".")?e.slice(0,e.lastIndexOf(".")):e}let s6={txt:["txt","odt","pages"],html:["html","htm"],video:["3gp","asf","avi","m4u","m4v","mov","mp4","mpe","mpeg","mpg","mpg4","wmv","rmvb","mp4a","3gpp","mjpeg","flv","mkv"],audio:["m3u","m4a","m4b","m4p","mp2","mp3","mpga","ogg","wav","wma","aiff"],pdf:["pdf"],doc:["doc","docx","rtf","wps"],xls:["xls","xlsx","csv"],ppt:["ppt","pptx","pps"],zip:["zip","rar","7z"],sketch:["sketch"],code:["js","xml","json","cpp","h","java","log","rc","sh","c","conf","prop"],oneNote:["one"],image:s1},s4={};Object.keys(s6).forEach(e=>{let t=s6[e]||[];Object.assign(s4,t.reduce((t,a)=>({...t,[`.${a}`]:e}),{}))});let s8={txt:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#747487",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("rect",{width:12,height:1.5,x:8,y:21,fill:"#747487",rx:.5}),a.createElement("rect",{width:17,height:1.5,x:8,y:17.5,fill:"#747487",rx:.5}),a.createElement("rect",{width:17,height:1.5,x:8,y:14,fill:"#747487",rx:.5})))},html:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#747487",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#747487",d:"M12.2949 17.3359C12.2949 17.3867 12.333 17.4297 12.3818 17.4375C13.2744 17.5547 13.7422 18.0391 13.7422 18.8555V20.3906C13.7422 21.2461 14.041 21.5781 14.8086 21.5781H14.8604C14.9707 21.5781 15.0605 21.668 15.0605 21.7812V22.5C15.0605 22.6094 14.9707 22.6992 14.8604 22.6992H14.668C13.0566 22.6992 12.3535 22.0391 12.3535 20.5469V19.2891C12.3535 18.5 12.0684 18.1562 11.2979 18.0898C11.1338 18.0742 11 17.9414 11 17.7773V16.8984C11 16.7344 11.1348 16.6016 11.2998 16.5898C12.0645 16.5234 12.3535 16.1797 12.3535 15.3906V14.1328C12.3535 12.6484 13.0566 12 14.668 12H14.8604C14.9707 12 15.0605 12.0898 15.0605 12.1992V12.918C15.0605 13.0312 14.9707 13.1172 14.8604 13.1172H14.8086C14.041 13.1172 13.7422 13.4531 13.7422 14.3086V15.8203C13.7422 16.6367 13.2744 17.1211 12.3818 17.2383C12.333 17.2461 12.2949 17.2891 12.2949 17.3359Z"}),a.createElement("path",{fill:"#747487",d:"M20.624 17.4375C20.6729 17.4297 20.7109 17.3867 20.7109 17.3359C20.7109 17.2891 20.6729 17.2461 20.624 17.2383C19.7314 17.1211 19.2695 16.6367 19.2695 15.8203V14.3086C19.2695 13.4531 18.9707 13.1172 18.1973 13.1172H18.1455C18.0352 13.1172 17.9453 13.0312 17.9453 12.918V12.1992C17.9453 12.0898 18.0352 12 18.1455 12H18.3379C19.9492 12 20.6523 12.6484 20.6523 14.1328V15.3906C20.6523 16.1797 20.9414 16.5234 21.7061 16.5898C21.8711 16.6016 22.0059 16.7344 22.0059 16.8984V17.7773C22.0059 17.9414 21.8721 18.0742 21.708 18.0898C20.9375 18.1562 20.6523 18.5 20.6523 19.2891V20.5469C20.6523 22.0391 19.9492 22.6992 18.3379 22.6992H18.1455C18.0352 22.6992 17.9453 22.6094 17.9453 22.5V21.7812C17.9453 21.668 18.0352 21.5781 18.1455 21.5781H18.1973C18.9648 21.5781 19.2695 21.2461 19.2695 20.3906V18.8555C19.2695 18.0391 19.7314 17.5547 20.624 17.4375Z"})))},video:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#094A99",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#094A99",d:"M12.75 13.6797V20.3243C12.75 21.1758 13.6777 21.711 14.416 21.2813L20.1094 17.9571C20.8428 17.5313 20.8428 16.4727 20.1094 16.043L14.416 12.7227C13.6777 12.293 12.75 12.8243 12.75 13.6797Z"})))},audio:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#747487",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("rect",{width:1.5,height:4,x:10.5,y:15.5,fill:"#747487",rx:.5}),a.createElement("rect",{width:1.5,height:4,x:20.5,y:15.5,fill:"#747487",rx:.5}),a.createElement("rect",{width:1.5,height:6,x:15.5,y:14.5,fill:"#747487",rx:.5}),a.createElement("rect",{width:1.5,height:14,x:13,y:10,fill:"#747487",rx:.5}),a.createElement("rect",{width:1.5,height:10,x:18,y:12.5,fill:"#747487",rx:.5})))},pdf:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#E44",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#E44",fillRule:"evenodd",d:"M9.74961 20.1853C9.76524 20.1705 9.78149 20.1563 9.79832 20.1429L9.81357 20.1307L9.83015 20.1204C10.2617 19.8521 10.8016 19.6599 11.3888 19.4917C11.7688 19.3829 12.186 19.2796 12.619 19.1725C12.813 19.1245 13.0101 19.0757 13.2085 19.0252C13.9433 17.9192 14.5858 16.597 15.1719 15.3278C14.9708 14.758 14.7782 14.1663 14.6461 13.5958C14.5048 12.9859 14.4271 12.3779 14.4939 11.8336C14.6127 10.866 15.5038 10.1698 16.4714 10.2886C17.439 10.4074 18.1352 11.2985 18.0164 12.2661C17.9548 12.7675 17.7651 13.3084 17.5354 13.8495C17.3747 14.2283 17.1867 14.624 17.0001 15.0168C16.941 15.1414 16.882 15.2656 16.824 15.389C17.1945 16.3149 17.7304 17.2127 18.3418 17.9763C19.3585 17.7812 20.631 17.6392 21.5221 17.7486C22.4897 17.8674 23.1859 18.7585 23.0671 19.7261C22.9483 20.6937 22.0572 21.3899 21.0896 21.2711C19.9438 21.1304 18.6462 20.4793 17.7543 19.6168C16.5439 19.7654 15.2711 20.0758 14.0293 20.3953C13.3742 21.3309 12.6271 22.3693 12.0168 22.9395L12.0001 22.9551L11.9814 22.9683C11.9715 22.9753 11.9613 22.9821 11.951 22.9886C11.5774 23.2794 11.1062 23.3924 10.649 23.3363C9.6814 23.2175 8.98522 22.3264 9.10403 21.3588C9.16158 20.8901 9.39683 20.4728 9.74961 20.1853ZM16.2866 13.6641C16.5651 13.0301 16.7861 12.4669 16.8286 12.1202C16.8681 11.7984 16.6474 11.5159 16.3256 11.4763C16.0037 11.4368 15.7212 11.6576 15.6817 11.9794C15.637 12.3435 15.7559 12.9558 15.9376 13.6375C15.9808 13.7997 16.0276 13.9659 16.0766 14.1335C16.1488 13.9743 16.2194 13.8171 16.2866 13.6641ZM15.9696 16.4125C15.9096 16.54 15.8493 16.6677 15.7884 16.7955C15.4955 17.4099 15.1896 18.0262 14.8513 18.6255C14.7764 18.7582 14.6998 18.8902 14.6215 19.0211C14.7698 18.9846 14.9184 18.9485 15.0673 18.9131C15.6587 18.7727 16.2547 18.6438 16.856 18.5435C16.9788 18.523 17.1017 18.5037 17.2249 18.4858C17.15 18.3872 17.0765 18.287 17.0044 18.1853C16.6925 17.7456 16.4072 17.278 16.156 16.7908C16.0916 16.6659 16.0294 16.5398 15.9696 16.4125ZM19.5072 19.0326C20.2278 18.9373 20.9383 18.8826 21.3763 18.9364C21.6981 18.9759 21.9189 19.2584 21.8793 19.5803C21.8398 19.9021 21.5573 20.1228 21.2355 20.0833C20.7129 20.0191 20.0356 19.7423 19.4338 19.3755C19.2916 19.2889 19.1536 19.1972 19.0229 19.1022C19.1829 19.0775 19.3453 19.054 19.5072 19.0326ZM12.5038 20.4528C12.3276 20.4994 12.1556 20.5457 11.9902 20.5916C11.3367 20.7731 10.787 20.9499 10.4931 21.1246C10.3932 21.2107 10.3104 21.3532 10.2918 21.5047C10.2523 21.8265 10.473 22.109 10.7948 22.1485C10.966 22.1695 11.1003 22.1289 11.2072 22.0491C11.4592 21.8114 11.8101 21.3783 12.1864 20.8798C12.2908 20.7416 12.3971 20.5984 12.5038 20.4528Z",clipRule:"evenodd"})))},doc:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#3066B5",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#3166B5",d:"M16.5254 16.7422H16.4688L14.7285 23H12.9199L10.4951 13.8398H12.4824L13.9229 20.4727H13.9736L15.6875 13.8398H17.3066L19.0195 20.4727H19.0703L20.5176 13.8398H22.5049L20.0742 23H18.2646L16.5254 16.7422Z"})))},xls:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#48C163",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("rect",{width:5,height:3,x:8,y:12.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:8,y:16.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:8,y:20.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:14,y:12.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:14,y:16.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:14,y:20.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:20,y:12.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:20,y:16.5,fill:"#48C163",rx:.3}),a.createElement("rect",{width:5,height:3,x:20,y:20.5,fill:"#48C163",rx:.3})))},ppt:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#FF742E",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#FF742E",d:"M21.6013 17.5C21.8222 17.5 22.0015 17.6797 21.9857 17.9C21.7808 20.7509 19.403 23 16.5 23C13.4624 23 11 20.5376 11 17.5C11 14.597 13.2491 12.2192 16.1 12.0143C16.3203 11.9985 16.5 12.1778 16.5 12.3987C16.5 13.3838 16.5 15.9372 16.5 17.1013C16.5 17.3222 16.6778 17.5 16.8987 17.5C18.0628 17.5 20.6162 17.5 21.6013 17.5Z"}),a.createElement("path",{fill:"#FF742E",d:"M22.8013 16.5C23.0222 16.5 23.2015 16.3203 23.1856 16.0999C22.9902 13.3813 20.8187 11.2098 18.1 11.0143C17.8797 10.9985 17.7 11.1778 17.7 11.3987C17.7 12.1664 17.7 13.9641 17.7 16.0995C17.7 16.3204 17.8778 16.4999 18.0987 16.4999C19.2628 16.4999 21.8161 16.5 22.8013 16.5Z"})))},zip:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#747487",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#747487",fillRule:"evenodd",d:"M10 1.5V3H13V4.5H10V6H13V7.5H10V9H13V10.5H10V17.8008C10 18.4609 10.5371 19 11.2002 19H14.7998C15.4629 19 16 18.4609 16 17.8008V12H13V10.5H16V9H13V7.5H16V6H13V4.5H16V3H13V1.5C13.1468 1.5 10 1.5 10 1.5ZM11.5 16V16.8984C11.5 17.2305 11.7686 17.5 12.0996 17.5H13.9004C14.2314 17.5 14.5 17.2305 14.5 16.8984V16H11.5Z",clipRule:"evenodd"})))},sketch:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#FD8E33",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#FD8E33",d:"M13.3682 13H19.6318C19.8682 13 20.0957 13.0898 20.2666 13.2539L22.7998 15.668C23.1807 16.0312 23.1807 16.6367 22.7998 17L17.1357 22.3945C16.7793 22.7344 16.2207 22.7344 15.8643 22.3945L10.2002 17C9.81934 16.6367 9.81934 16.0312 10.2002 15.668L12.7334 13.2539C12.9043 13.0898 13.1318 13 13.3682 13Z"})))},code:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#424242",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("rect",{width:1.3,height:6.4,fill:"#424242",rx:.65,transform:"matrix(-0.681998 -0.731354 -0.731354 0.681998 23.4 17.6001)"}),a.createElement("rect",{width:1.3,height:6.4,x:23.4,y:17.5,fill:"#424242",rx:.65,transform:"rotate(133 23.4 17.5)"}),a.createElement("rect",{width:1.3,height:6.4,x:9.533,y:17.6,fill:"#424242",rx:.65,transform:"rotate(-47 9.53271 17.6001)"}),a.createElement("rect",{width:1.3,height:6.4,fill:"#424242",rx:.65,transform:"matrix(0.681998 0.731354 0.731354 -0.681998 9.53271 17.5)"})))},oneNote:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},a.createElement("path",{fill:"#5C2872",fillRule:"evenodd",d:"M2.25 3.40168V12.5983C2.25 14.0628 3.4372 15.25 4.90168 15.25H11.5983C13.0628 15.25 14.25 14.0628 14.25 12.5983V5.50033C14.25 5.10193 14.0934 4.7195 13.8139 4.43558L10.6318 1.20303C10.3465 0.913208 9.95686 0.75 9.55017 0.75H4.90168C3.4372 0.75 2.25 1.9372 2.25 3.40168ZM1.5 12.5983V3.40168C1.5 1.52298 3.02298 0 4.90168 0H9.55017C10.1578 0 10.74 0.243856 11.1663 0.676895L14.3484 3.90944C14.7659 4.33366 15 4.90506 15 5.50033V12.5983C15 14.477 13.477 16 11.5983 16H4.90168C3.02298 16 1.5 14.477 1.5 12.5983Z",clipRule:"evenodd"}),a.createElement("path",{fill:"#5C2872",d:"M7.28202 11.4399V8.52313H7.33693L9.36864 11.4399H10.1313V6.87988H9.24967V9.784H9.19476L7.16915 6.87988H6.40039V11.4399H7.28202Z"})))},image:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 32 32",width:"1em",height:"1em"},a.createElement("path",{stroke:"#0E72ED",strokeWidth:1.5,d:"M3.75 7C3.75 3.54822 6.54822 0.75 10 0.75H18.9068C20.0451 0.75 21.1358 1.20662 21.9346 2.01756L28.0278 8.20345C28.811 8.99855 29.25 10.0698 29.25 11.1859V25C29.25 28.4518 26.4518 31.25 23 31.25H10C6.54822 31.25 3.75 28.4518 3.75 25V7Z"}),a.createElement("path",{fill:"#0E72ED",d:"M21.3993 14.5C21.3993 15.3281 20.7275 16 19.8993 16C19.0712 16 18.3993 15.3281 18.3993 14.5C18.3993 13.6719 19.0712 13 19.8993 13C20.7275 13 21.3993 13.6719 21.3993 14.5Z"}),a.createElement("path",{fill:"#0E72ED",d:"M15.1532 15.3281L19.3993 20L20.6181 18.4766C21.0185 17.9766 21.7802 17.9766 22.1806 18.4766L24.7499 21.6875C25.0116 22.0156 24.7782 22.5 24.3593 22.5H8.50089C8.07121 22.5 7.84171 21.9922 8.12492 21.6719L13.661 15.3438C14.0546 14.8945 14.7519 14.8867 15.1532 15.3281Z"})))},default:sA},s7={[i6.unsent]:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},a.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"#fff",strokeWidth:2}),a.createElement("path",{fill:"#fff",d:"M10.5 7.70709V13.5C10.5 13.7761 10.2761 14 10 14C9.72388 14 9.5 13.7761 9.5 13.5V7.70709L7.35352 9.85358C7.1582 10.0488 6.8418 10.0488 6.64648 9.85358C6.45117 9.65826 6.45117 9.34174 6.64648 9.14642L9.64648 6.14642C9.8418 5.95117 10.1582 5.95117 10.3535 6.14642L13.3535 9.14642C13.5488 9.34174 13.5488 9.65826 13.3535 9.85358C13.1582 10.0488 12.8418 10.0488 12.6465 9.85358L10.5 7.70709Z"})))},[i6.sending]:sO,[i6.sended]:sD,[i6.sendError]:sL,[i6.notDownload]:sR,[i6.downloading]:sO,[i6.downloaded]:sD,[i6.downloadError]:sL,[i6.downloadErrorNotReady]:sL,[i6.paused]:e=>{let{className:t,spin:n,style:i,size:s,color:r,tabIndex:l,onClick:o,...d}=e;return a.createElement("i",{className:(()=>{let e=["zmicon","zmicon-acc-no-outline"];return n&&e.push("zmicon-spin"),t&&e.push(t),e.join(" ")})(),style:(()=>{if(r||s||i)return{...i,color:r,fontSize:s}})(),tabIndex:l,role:"img",onClick:o,...d},a.createElement("svg",{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},a.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"#fff",strokeWidth:2}),a.createElement("rect",{width:1.2,height:7,x:7.1,y:6.5,fill:"#fff",rx:.6}),a.createElement("rect",{width:1.2,height:7,x:11.7,y:6.5,fill:"#fff",rx:.6})))}};function s9(e){return new Promise((t,a)=>{let n=document.createElement("canvas"),i=n.getContext("2d");if(!i)return;let s=new Image;s.crossOrigin="Anonymous",s.onload=function(){n.height=s.height,n.width=s.width,i.drawImage(s,0,0);let e=n.toDataURL("image/png");t(e)},s.onerror=function(){a(Error(`Load img failed, url: ${e}`))},s.src=e})}function re(e,t){if(void 0===t&&(t="file"),!e)return null;let a=e.split(","),n=a[0]?.match(/:(.*?);/)?.[1],i=n?.split("/")[1],s=atob(a[1]),r=s.length,l=new Uint8Array(r);for(;r--;)l[r]=s.charCodeAt(r);return new File([l],`${t}.${i}`,{type:n})}async function rt(e){let t=await s9(e);return re(t)}let ra=[i.image,i.screenshot,i.giphy];function rn(e){return e.filter(e=>[i.file,...ra].includes(e.type))}function ri(e){let t=rn(e);return t.map((e,t)=>({file:e.file,imgUrl:ra.includes(e.type)?e.imgUrl:void 0,giphy:e.type===i.giphy?e.giphy:void 0,index:t}))}function rs(e,t){return e.map((e,a)=>{let n=e.file??(e.fileUrl?re(e.fileUrl,s3(e.fileName)):t(e.fileId));return n?{file:n,imgUrl:e.fileUrl,giphy:e.giphy,index:a}:null}).filter(e=>e)}function rr(e){return e.map(e=>e.giphy?{...e.giphy,startpos:e.pos,endpos:e.pos}:{id:e.id,file:e.file,sendAsFile:!e.imgUrl,startpos:e.pos,endpos:e.pos})}function rl(e){return e.map(e=>({fileId:e.id,fileName:e.file.name,size:e.file.size,file:e.file,fileType:e.giphy?s.Giphy:e.imgUrl?s.JPG:s.OtherFile,fileUrl:e.imgUrl,type:0,startpos:e.pos,endpos:e.pos,giphy:e.giphy}))}function ro(e,t){let{getImageState:a,getFileState:n}=t;return a?.(e.fileId).message||n?.(e.fileId).file||(e.fileType===s.Giphy?e.fileUrl??null:null)}function rd(e,t){return e.map(e=>rp(e.fileType)?{type:sY.image,id:e.fileId,imgUrl:ro(e,{getImageState:t})??"",fileItem:e}:rf(e.fileType)?{type:sY.file,id:e.fileId,fileItem:e}:null).filter(e=>e)}function rc(e,t){return e.map(e=>ro(e,t)).filter(Boolean)}function ru(e,t){let a=e.map(e=>{let{index:a,...n}=e;return{id:sW(),pos:t+a,...n}}),n=rr(a),i=rl(a);return{mixSendFiles:n,mixShownFiles:i}}function rm(e,t){let a=t.length===e.length,n=!t.some(e=>[i.file,...ra].includes(e.type));return a&&n}function rp(e){return!!e&&[s.Screenshot,s.PNG,s.JPG,s.Giphy,s.GIF].some(t=>t.toLowerCase()===e.toLowerCase())}function rh(e){return!!e&&e.toLowerCase()===s.WhiteboardPreview.toLowerCase()}function rf(e){return!!e&&!rp(e)&&!rh(e)}function rg(e,t,a){let n=rn(t),s=e&&n.length||!e&&n.length>1,r=e&&!n.length,l=!e&&1===n.length;return a?i.file:s?i.mix:r?i.text:l?n[0].type:i.unknown}function ry(e,t){let a;return t&&window.pwaChatConfig.integrationDomain?a=window.pwaChatConfig.integrationDomain+t:window.pwaChatConfig.isVerify3rdFileUrlEnabled||(a=e),a}let rv=e=>e.slice(0,e.lastIndexOf("."));function r_(e){if(!e)return;let{previewLink:t,previewPath:a}=e,n=ry(t,a);n&&window.open(n,"_blank")}function rb(e){let t=new Blob([]);return new File([t],e)}let rM={[sh.Dropbox]:sg.Dropbox,[sh.GoogleDrive]:sg.GoogleDrive,[sh.MicrosoftOneDrive]:sg.MicrosoftOneDrive,[sh.Box]:sg.Box,[sh.MicrosoftSharePoint]:sg.MicrosoftSharePoint},rx={[sg.Dropbox]:i.dropbox,[sg.GoogleDrive]:i.googleDrive,[sg.MicrosoftOneDrive]:i.microsoftOneDrive,[sg.Box]:i.box,[sg.MicrosoftSharePoint]:i.microsoftSharePoint,[sg.None]:""},rC={[i.dropbox]:"Drop Box",[i.microsoftOneDrive]:"One Drive",[i.googleDrive]:"Google Drive",[i.box]:"Box",[i.microsoftSharePoint]:"Share Point"},rj=Object.freeze(Object.defineProperty({__proto__:null,FileStatusIconMap:s7,base64toFile:re,cloudTypeMap:rM,createFakeFile:rb,createFileToUpload:function(e,t,a){let n=s2(e.name);return{file:e,id:t,sizeStr:s0(e.size),extension:n,uploadProgress:0,downloadProgress:0,status:i6.notDownload,type:i.file,...a}},getExtension:s2,getFileIcon:function(e){return s8[s4[e]]||s8.default},getFileNameWithoutExtension:rv,getFileStatusIcon:function(e){return s7[e]||s7[i6.notDownload]},getMixCopyFiles:rc,getMixDefaultFiles:rd,getMixFiles:ru,getMixSendFiles:rr,getMixShownFiles:rl,getNaiveFileName:s3,getRetryUnifiedFiles:rs,getSafeLink:ry,getSendMsgType:rg,getToSendFiles:rn,getUnifiedFiles:ri,imageLikeTypes:ra,imageToFile:rt,imgToBase64:s9,integrationTypeMap:rx,isGif:s5,isImage:function(e){if(!e?.type)return!1;let[t,a]=e.type.split("/");return"image"===t&&s1.includes(a)},isImageFile:function(e){return"image"===s4[e]},isLargeFile:function(e){return!!e&&e.size>8388608},isMixFile:rf,isMixFilesEqual:rm,isMixImage:rp,isMixWhiteboard:rh,isSameFile:function(e,t){return e.name===t.name&&e.type===t.type&&e.size===t.size&&e.lastModified===t.lastModified},modifySize:s0,openThirdPartyLink:r_,thirdPartyNameMap:rC},Symbol.toStringTag,{value:"Module"})),rN={MostRelevant:{searchKey:sX.Type,optionValue:iX.SORTTYPE_SCORE},MostRecent:{searchKey:sX.Type,optionValue:iX.SORTTYPE_TIMESTAMP},AllFiles:{searchKey:sX.FileType,optionValue:iQ.ALL},Images:{searchKey:sX.FileType,optionValue:iQ.IMAGES},Videos:{searchKey:sX.FileType,optionValue:iQ.VIDEOS},Documents:{searchKey:sX.FileType,optionValue:iQ.DOCUMENTS},Presentations:{searchKey:sX.FileType,optionValue:iQ.PRESENTATIONS},Spreadsheets:{searchKey:sX.FileType,optionValue:iQ.SPREADSHEETS},OtherFileTypes:{searchKey:sX.FileType,optionValue:iQ.OTHER},AnyTime:{searchKey:sX.FileTime,optionValue:sQ.Any},Today:{searchKey:sX.FileTime,optionValue:sQ.Today},Yesterday:{searchKey:sX.FileTime,optionValue:sQ.Yesterday},Last7Days:{searchKey:sX.FileTime,optionValue:sQ.Last7Days},Last30Days:{searchKey:sX.FileTime,optionValue:sQ.Last30Days}},rw=new class{getFile(e){return this.fileMap.get(e)}persistFile(e,t){this.removeFile(t),this.fileMap.set(e,t)}removeFile(e){[...this.fileMap.entries()].forEach(t=>{let[a,n]=t;e===n&&this.fileMap.delete(a)})}removeFileById(e){this.fileMap.delete(e)}constructor(){this.fileMap=new Map}};function rI(e,t){if(!e||e.jid===t.jid)return!1;let a=r(e.orgUnit?.split(";")),n=r(t.orgUnit?.split(";"));return l(o(a,n))}function rT(e){return d(e,"@conference")}function rE(e){return e?.indexOf("robot")===0}function rS(e){return e?.includes("@")?e===window.pwaChatConfig.jid:e?.toLowerCase()===window.pwaChatConfig.jid?.split("@")[0]?.toLowerCase()}function rk(e){return e===i4.OWNER}function rA(e){return e===i4.ADMIN}function rR(e){return rk(e)||rA(e)}function rL(e){return e===i4.ADDON}function rO(e){if("string"!=typeof e)return!1;let t=e.indexOf("@");return t>0&&t<e.length-1}function rD(e){return!!(+e&c.kMUCFlag_Normal)}function rP(e){return!!(+e&c.kMUCFlag_Room)}function rF(e){return e===sn.MENTION}function rB(e){return e===sn.BOOKMARKS}function rU(e){return e===sn.CONTACT}function rH(e){return e===sn.REMINDERS}function rz(e){return e===sn.FILES}function rV(){let e=u();return{$t:e.formatMessage}}let rG="en-US",rq=["de-DE","en-US","es-ES","fr-FR","id-ID","it-IT","ja-JP","ko-KR","nl-NL","pl-PL","pt-PT","ru-RU","tr-TR","vi-VN","zh-CN","zh-TW"],r$={"ja-JP":["jp-JP"],"ko-KR":["ko-KO"]};function rK(){let e;let t=window?.document.cookie||"",a=`${t};`.match(/_zm_lang=(.*?);/);if(a&&a.length>1)e=a[1];else{let t=new URLSearchParams(location.search);e=t.get("lang")}let n=rq.find(t=>t===e||r$[t]?.includes(e||""));return n??rG}function rJ(e,t){let a;try{a=JSON.parse(e)}catch(e){a=t}return a}class rW{static #e=(()=>{this.RICH_TEXT_FORMAT="text/html"})();static #t=(()=>{this.IMAGE_FORMAT="zoom/image"})();static #a=(()=>{this.FILE_FORMAT="zoom/file"})();static #n=(()=>{this.FILE_PLACEHOLDER="__zoom_file__"})();static #i=(()=>{this.MIX_FORMAT="zoom/mix"})();static #s=(()=>{this.MIX_PLACEHOLDER="__zoom_mix__"})();async copyText(e){if(e){if(navigator.clipboard)return navigator.clipboard.writeText(e);{let t=document.createElement("textarea");t.style.position="fixed",t.style.clip="rect(0 0 0 0)",t.style.top="10px",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy",!0),document.body.removeChild(t);return}}}copyRichText(e){let t=document.getSelection(),a=document.createRange();a.selectNodeContents(e),t?.removeAllRanges(),t?.addRange(a),document.execCommand("copy")}async copyImage(e){if(!e)return;let t=rY(e);if(navigator.clipboard&&window?.ClipboardItem){let e=function(e,t){void 0===t&&(t=512);let[a,n]=e.split(";base64,"),i=atob(n),s=[];for(let e=0;e<i.length;e+=t){let a=i.slice(e,e+t),n=Array(a.length);for(let e=0;e<a.length;e++)n[e]=a.charCodeAt(e);let r=new Uint8Array(n);s.push(r)}let r=new Blob(s,{type:a.split(":")[1]});return r}(t);return navigator.clipboard.write([new ClipboardItem({[e.type]:sk?new Promise(t=>t(e)):e})]).catch(e=>{this.copyBase64(t)})}this.copyBase64(t)}copyGif(e){e&&this.copyBase64(e)}copyBase64(e){this.triggerCopy(rW.IMAGE_FORMAT,e)}handlePasteBase64(e){return e.clipboardData?.getData(rW.IMAGE_FORMAT)}copyFile(e){this.copiedFile=e,this.triggerCopy(rW.FILE_FORMAT,rW.FILE_PLACEHOLDER)}copyMix(e){let{element:t,files:a}=e,n=a.map(e=>m(e)?re(rY(e)):e);if(!t&&!n.length)return;this.copiedMix=n;let i=e=>{e.preventDefault(),t&&e.clipboardData?.setData(rW.RICH_TEXT_FORMAT,t.outerHTML),e.clipboardData?.setData(rW.MIX_FORMAT,rW.MIX_PLACEHOLDER),document.removeEventListener("copy",i)};document.addEventListener("copy",i),document.execCommand("copy")}handlePasteFile(e){let t=e.clipboardData?.getData(rW.FILE_FORMAT);return t===rW.FILE_PLACEHOLDER?this.copiedFile:null}handlePasteMix(e){let t=e.clipboardData?.getData(rW.MIX_FORMAT);return t===rW.MIX_PLACEHOLDER?this.copiedMix:null}triggerCopy(e,t){let a=n=>{n.preventDefault(),n.clipboardData?.setData(e,t),document.removeEventListener("copy",a)};document.addEventListener("copy",a),document.execCommand("copy")}constructor(){this.copiedMix=null,this.copiedFile=null}}function rY(e){return e.includes("text/plain")?e.replace("text/plain","image/png"):e}let rX=new rW,rQ={hiddenPinTimestampKey:"PWA_CHAT_HIDDEN_PINS",frequentlyEmojiList:"PWA_CHAT_FRQ_EMOJIS",searchedKeywords:"PWA_CHAT_SEARCHED_KEYWORDS",lastChat:"PWA_CHAT_LAST_CHAT",deviceId:"PWA_CHAT_DEVICE_ID",settings:"PWA_CHAT_SETTINGS",showPMCTips:"PWA_CHAT_PMC_TIPS",siderWidth:"PWA_CHAT_SIDEBAR_WIDTH",language:"PWA_CHAT_LANGUAGE",messages:"PWA_CHAT_MESSAGES",recentChat:"PWA_CHAT_RECENT_CHAT",folder:"PWA_CHAT_FOLDER",key:"PWA_CHAT_KEY",channelInfo:"PWA_CHAT_CHANNEL_INFO",profileInfo:"PWA_CHAT_PROFILE_INFO",chatHistory:"PWA_CHAT_HISTORY",appsInfo:"PWA_CHAT_APPS_INFO"},rZ={[rQ.hiddenPinTimestampKey]:"0.0.1",[rQ.frequentlyEmojiList]:"0.0.1",[rQ.searchedKeywords]:"0.0.1",[rQ.lastChat]:"0.0.1",[rQ.deviceId]:"0.0.1",[rQ.settings]:"0.0.1",[rQ.showPMCTips]:"0.0.1",[rQ.siderWidth]:"0.0.1",[rQ.language]:"0.0.1",[rQ.messages]:"0.0.1",[rQ.recentChat]:"0.0.1",[rQ.folder]:"0.0.1",[rQ.key]:"0.0.1",[rQ.channelInfo]:"0.0.1",[rQ.profileInfo]:"0.0.1",[rQ.chatHistory]:"0.0.1",[rQ.appsInfo]:"0.0.1"};function r1(e){return`${window.pwaChatConfig.jid}$$${rZ[e]}`}function r0(e,t,a){if(!p(t))return a;let n=r1(e);return t[n]??a}function r2(e,t,a){let n=p(a)?a:{},i=r1(e);return null===t?h(n,i):{...n,[i]:t}}function r5(e){let t=localStorage.getItem(e);return t?rJ(t,{}):{}}let r3={get(e){let t=r5(e);return r0(e,t,null)},set(e,t){let a=this.get(e),n="function"==typeof t?t(a):t,i=r5(e),s=r2(e,n,i);localStorage.setItem(e,JSON.stringify(s))},delete(e){let t=r5(e),a=r2(e,null,t);localStorage.setItem(e,JSON.stringify(a))}},r6=window.React.forwardRef;function r4(e,t){if(function(e){return e.$$typeof===y.ForwardRef}(e)){let a=r6((a,n)=>{let i={...t,...a,className:f(t.className,a.className)};return g.jsx(e,{...i,ref:n})});return a.displayName=e.displayName,a}{let a=a=>{let n={...t,...a,className:f(t.className,a.className)};return g.jsx(e,{...n})};return a.displayName=e.displayName,a}}let r8="[a-zA-Z0-9$-_.+!*'(),{}|\\\\^~[\\]`<>#%\";/?:@&=]",r7=RegExp(`(?:(?:(?:https?):)?\\/\\/)(?:${r8}+(?::${r8}*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9][a-z0-9_-]{0,62})?[a-z0-9]\\.?)+(?:[a-z]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]${r8}*)?`,"ig"),r9=/[.;,']/,le=e=>[...e.matchAll(r7)].map(t=>{let a=t[0]||"",n=t.index||0,i=n,s=n;for(;s<=n+a.length-1;)i=s++;for(;n<i&&e[i]?.match(r9);)i--;return{link:a=e.slice(n,i+1),start:n,end:i}}),lt=/^[A-Za-z0-9!#$%&'â€™*+/=?^_`{|}~-]+(\.[A-Za-z0-9!#$%&'â€™*+/=?^_`{|}~-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9-]+)*(\.[A-Za-z]{2,})$/,la=e=>lt.test(e),ln=e=>{if(!e?.match(r7))return null;let{host:t,pathname:a,searchParams:n}=new URL(e),i=t.match(/zoom(dev)?\.us$/),s=a.match(/^\/[j|s]\/[0-9]{9,11}$/)||a.match(/^\/wc\/[0-9]{9,11}\/start|join$/)||a.match(/^\/wc\/join\/[0-9]{9,11}$/)||a.match(/^\/my\/[a-z0-9.]{5,40}$/),r=a.match(/[^/(j|s|join)/][0-9]{9,11}$/)?.[0]||a.match(/^\/wc\/([0-9]{9,11})\/(join|start)$/)?.[1]||a.match(/^\/my\/([a-z0-9.]{5,40})$/)?.[1];if(!i||!s||!r)return null;let l=[...n].reduce((e,t)=>({...e,[t[0]]:t[1]}),{});return{meetingNumber:r,meetingParams:l}},li=()=>{let e=window.location.origin;switch(!0){case e.includes("zoom.us"):return"https://zoom.us";case!1:case e.includes("zoomdev.us"):return"https://zoomdev.us";default:return e}},ls=e=>e.getElementsByTagName("button"),lr=e=>{let{direction:t="row",querySelector:a=ls,includeTarget:n=!1}=void 0===e?{}:e,i={column:{prev:sN.up,next:sN.down},row:{prev:sN.left,next:sN.right}};return e=>{let s=e.target,r=Array.from(a?.(e.currentTarget));n&&r.unshift(e.currentTarget);let l=r.findIndex(e=>e===s);if(l>=0){switch(e.key){case i[t].next:l=(l+1)%r.length;break;case i[t].prev:l=0===l?r.length-1:l-1;break;default:return}e.preventDefault(),r[l]?.focus()}}},ll=(e,t,a)=>n=>{if(e.find(e=>e===n.key)){if(a){let e=n.currentTarget,t=n.target;if(!e.contains(t))return}n.stopPropagation(),t(n)}},lo=e=>t=>{t.stopPropagation(),e?.()},ld=(e,t,a)=>{if(!e)return{};let n={tabIndex:0,onKeyDown:ll([sN.enter,sN.space],e),onClick:t?lo(e):e};return a?n:{...n,role:"button"}},lc=e=>{let{isActive:t,isFolder:a,isExpanded:n,groupName:i,label:s}=e,r=a?{"aria-expanded":`${!!n}`}:{},l=a?{}:{"aria-selected":`${!!t}`};return{...t?{"aria-current":"page"}:{},...a?{role:"treeitem","data-node-type":"parent","aria-level":"1"}:{role:"treeitem","data-node-type":"child","aria-level":"2"},...r,...l,...i?{"aria-owns":i}:{},...s?{"aria-label":s}:{}}},lu=e=>e.filter(e=>e).join(",");var lm=(e=>(e.MEMBER="@",e.CHANNEL="#",e))(lm||{});let lp=new class{constructor(){this.map=new Map}hasMeetingNo(e){return this.map.has(e)}getChannelJidByMeetingNo(e){return this.map.get(e)||null}setMeetingChannelMap(e,t){this.map.set(e,t)}};function lh(e){return e.images.bigPicInfo.objectUrl??""}var lf=(e=>(e.object="object",e.array="array",e.map="map",e.set="set",e))(lf||{});function lg(e){switch(!0){case b(e):return"array";case _(e):return"map";case v(e):return"set";case p(e):return"object";default:return null}}function ly(e){return"object"===lg(e)?Object.keys(e):[...e.keys()]}function lv(e,t){return"map"===lg(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function l_(e,t){return"map"===lg(e)?e.get(t):e[t]}function lb(e,t,a){let n=lg(e);switch(!0){case M(e):j(e,t,a);return;case"set"===n:e.add(t);return;case"map"===n:e.set(t,a);return;case"array"===n:case"object"===n:e[t]=a;return;default:return}}function lM(e){return M(e)?x(e):C(e)}let lx={add:lb,remove:function(e,t){let a=lg(e);switch(!0){case M(e):N(e,t);return;case"set"===a:case"map"===a:e.delete(t);return;case"array"===a:e.splice(t,1);return;case"object"===a:delete e[t];return;default:return}},replace:lb};function lC(e,t,a){void 0===a&&(a=!0);let n=[],i=[];return function e(t,a,n,i,s,r){if(void 0===r&&(r=!0),t===a)return;let[l,o]=[t,a].map(lg);if(null===l||null===o||l!==o){i.push({op:"replace",path:[...n],value:r?lM(a):a}),s.push({op:"replace",path:[...n],value:r?lM(t):t});return}switch(l){case lf.map:case lf.object:return function(t,a,n,i,s,r){void 0===r&&(r=!0);let l=ly(t),o=ly(a);for(let o of l){let l=[...n,o],d=l_(t,o);if(!lv(a,o)){i.push({op:"remove",path:l}),s.push({op:"add",path:l,value:r?lM(d):d});continue}let c=l_(a,o);e(d,c,l,i,s,r)}for(let e of o){let l=[...n,e];if(!lv(t,e)){let t=l_(a,e);i.push({op:"add",path:l,value:r?lM(t):t}),s.push({op:"remove",path:l})}}}(t,a,n,i,s,r);case lf.array:return function(t,a,n,i,s,r){void 0===r&&(r=!0),a.length<t.length&&([a,t]=[t,a],[s,i]=[i,s]);for(let l=0;l<t.length;l++){let o=[...n,l];e(t[l],a[l],o,i,s,r)}for(let e=t.length;e<a.length;e++){let t=[...n,e],s=a[e];i.push({op:"add",path:t,value:r?lM(s):s})}t.length<a.length&&s.push({op:"replace",path:[...n,"length"],value:t.length})}(t,a,n,i,s,r);case lf.set:return function(e,t,a,n,i){let s=void 0;e.forEach(e=>{if(!t.has(e)){let t=[...a,s];n.push({op:"remove",path:t,value:e}),i.unshift({op:"add",path:t,value:e})}}),t.forEach(t=>{if(!e.has(t)){let e=[...a,s];n.push({op:"add",path:e,value:t}),i.unshift({op:"remove",path:e,value:t})}})}(t,a,n,i,s)}}(e,t,[],n,i,a),{patches:n,inversePatches:i}}function lj(e,t,a){for(let n of(void 0===a&&(a=!0),t)){let{op:t,path:i,value:s}=n;if(!i.length){"remove"===t?console.error("[applyPatches] Remove on root is not allowed."):e=s;continue}let r=e;for(let e=0;e<i.length-1;e++){let t=i[e];r=l_(r,t)}let l=lg(r);if(!l)continue;if(l===lf.set){lx[t](r,s);continue}let o=i[i.length-1];if("__proto__"===o&&[lf.object,lf.array].includes(l))throw Error('[applyPatches] Mutate object or array "__proto__" is not allowed.');if(l===lf.array&&"length"===o&&M(r)){let e=r.length;if(e<=s)continue;r.splice(s,e-s);continue}lx[t](r,o,a?lM(s):s)}return e}let lN=w;function lw(e,t){void 0===t&&(t=!0);let a=function(e,t){return void 0===t&&(t=!1),new I(a=>{let n=T(e);return E(n,e=>{let{newValue:t}=e;return a.next(t)},t)})}(e,!0);return t?a.pipe(S(k),lI()):a.pipe(lI())}function lI(){return e=>new I(t=>{let a=e.subscribe({next(e){lN(e=>t.next(e))(e)},error(e){t.error(e)},complete(){t.complete()}});return()=>{a.unsubscribe()}})}function lT(e){let{nickname:t,firstname:a,lastname:n,email:i,name:s}=e;return t||(a||n?`${a??""} ${n??""}`:i||s||"")}function lE(e){let{message:t,failureBody:a}=e;return!t||1===a}let lS=window.React;function lk(e,t){if(!e||!m(e))return e;let{link:a=!0,lineBreak:n=!0}=t||{},i=[{text:e,type:"text"}];return a&&(i=function(e){let t=le(e);if(!t.length)return[{text:e,type:"text"}];let a=[],n=0;return t.forEach(t=>{let{link:i,start:s,end:r}=t;s>n&&a.push({type:"text",text:e.substring(n,s)}),a.push({text:i,type:"link"}),n=r+1}),n<e.length&&a.push({type:"text",text:e.substring(n,e.length)}),a}(e)),n&&(i=function(e){return F(e.map(e=>"text"===e.type?e.text?function(e){let t=e.split("\n");return t.reduce((e,t)=>{let a={text:t,type:"text"};return e.length?[...e,{text:"",type:"line"},a]:[a]},[])}(e.text):[]:e))}(i)),function(e){return lS.createElement("span",null,e.map((e,t)=>{let{type:a,text:n}=e;switch(a){case"line":return lS.createElement("br",{key:`br-${t}`});case"link":return lS.createElement("a",{key:`link-${t}`,href:n,target:"_blank",rel:"noopener noreferrer"},n);default:return n}}))}(i)}function lA(){let e=new B;return[e.asObservable(),t=>t.pipe(U(t=>e.next(t)),H())]}function lR(e,t){if(!e)return;let a=document.createElement("a");a.download=t,a.style.display="none",a.href=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}function lL(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}let lO=["27ae60","16a085","2980b9","8e44ad","34495e","f39c12","d35400","c0392b"];function lD(e,t){return e.length?[...Array(2*e.length-1)].map((a,n)=>n%2?t:e[n/2]):[]}var lP=(e=>(e.external="external",e))(lP||{});let lF=e=>{let t=[],a=[],n=[];return e.forEach(e=>{e.jid&&e.type&&[i1.CHANNEL,i1.MUC].includes(e.type)?n.push(e.jid):e.jid?t.push({jid:e.jid,displayName:e.displayName}):a.push(e.value)}),{memberList:t,emailList:a,channelList:n}},lB=e=>{let{disableExternal:t=!1,disableFromEmail:a=!1,disableSelf:n=!1}=e;return(e,i)=>{if(void 0===i&&(i=""),e?.some(e=>!!e.isMUC))return{result:e.filter(e=>!!e.jid)};let s=(e||[]).filter(e=>!(n&&rS(e.jid))&&(!t||!e.isExternal));return s.length?{result:s}:!a&&i.indexOf("@")>0?{result:[{name:i,label:i,value:i,optionDataType:"external",isDisabled:!la(i)}],hideGroupName:!0}:{result:[]}}};function lU(e,t){return rT(e)||rS(t)?e:t??e}function lH(e,t){return(e.name||"").toLowerCase()>(t.name||"").toLowerCase()?1:-1}function lz(e){if(!e?.length)return[];let t=e.find(e=>e.role===i4.OWNER),a=e.filter(e=>e.role===i4.ADMIN).sort(lH),n=e.filter(e=>e.role===i4.ANNOUNCER).sort(lH);return r([t,...a,...n])}function lV(e){if(!e?.length)return[];let t=e.filter(e=>!e.role||![i4.OWNER,i4.ADMIN,i4.ANNOUNCER].includes(e.role)).sort(lH);return t}function lG(e){return r([...lz(e),...lV(e)])}function lq(e){return{important:lz(e),common:lV(e)}}function l$(e,t,a){return(void 0===a&&(a=!1),a)?z(V(z(e),t)):V(e,t)}let lK=/^https?:\/\/[a-zA-Z0-9.-:]*\/launch\/chat\/v2\/([0-9a-zA-Z=]*)$/;function lJ(e){return e.match(lK)?.[1]??""}function lW(e){let t=lJ(e);if(!t)return null;try{let e=atob(t),a=rJ(e,null);if(!a?.sid)return null;let{sid:n,mid:i,time:s}=a;return{sid:n,mid:i,time:s}}catch(e){return null}}function lY(e){let{sid:t,mid:a,time:n}=e,i=JSON.stringify({sid:t,mid:a,time:n}),s=btoa(i);return`${li()}/launch/chat/v2/${s}`}function lX(e,t){if(!e.length)return G;let a=q(...t),n=[],i=[];return t=>$(K.pipe(U({complete(){n=e.map(e=>x(e))}})),a.pipe(U({complete(){i=n.map((t,a)=>{let n=e[a];return lC(t,n).inversePatches}),n=[]}})),t).pipe(J(t=>{let a=w(()=>{i.forEach((t,a)=>{if(t.length){let n=e[a];lj(n,t)}})});try{a()}catch(e){console.error(e)}throw i=[],t}),U({complete(){i=[]}}))}function lQ(e){let{count:t=5,delayDuration:a=e=>1e3*e}=e??{};return W({count:t,delay:(e,t)=>Y(a(t)),resetOnSuccess:!0})}let lZ=window.React.useCallback;function l1(e,t){let[a={},n]=X(e,{}),i=Q(a),s=r0(e,a,t),r=lZ(()=>s,[s]),l=lZ(t=>{n(r2(e,t,i.current))},[i,e,n]),o=lZ(()=>{n(r2(e,null,i.current))},[i,e,n]);return{getStorageValue:r,setStorageValue:l,removeStorageValue:o}}let l0=window.React,l2=l0.useEffect,l5=window.React,l3=l5.useMemo,l6=window.React,l4=l6.useLayoutEffect,l8=window.React.useEffect,l7=window.React.useReducer,l9=()=>({}),oe=(e,t)=>{if(!t)return l8(e);let[a,n]=l7(l9,{});return l8(()=>{let t=new Z("useEffect",n);return t.track(e),()=>t.dispose()},[a,...t])};window.React.useLayoutEffect,window.React.useReducer;let ot=window.React.useMemo,oa=(e,t)=>ot(()=>T(e,void 0),t).get(),on=()=>{let e=window.navigator.userAgent,t=window.navigator.platform,a="unknown";return["Macintosh","MacIntel","MacPPC","Mac68K"].includes(t)?a="MacOS":["iPhone","iPad","iPod"].includes(t)?a="iOS":["Win32","Win64","Windows","WinCE"].includes(t)?a="Windows":/Android/.test(e)?a="Android":!a&&/Linux/.test(t)&&(a="Linux"),a},oi=()=>{let e=l3(()=>on(),[]);return{os:e,isAppleOS:"MacOS"===e||"iOS"===e}};function os(e,t,a){let n=Q(t),i=Q(a);l2(()=>{let t=e.action$.subscribe(e=>{if("function"==typeof n.current)n.current(e);else{if(e.name!==n.current)return;i.current?.(e.payload)}});return()=>{t.unsubscribe()}},[n,i,e.action$])}let or=window.React.useCallback,ol=window.React.useRef;function oo(e){let{onIntersect:t,getBoundary:a,getTarget:n,threshold:i}=e,s=ol();return l4(()=>{let e=n();if(e)return s.current=new IntersectionObserver(e=>{e[0].isIntersecting&&t()},{root:a(),threshold:i}),s.current.observe(e),()=>{s.current?.disconnect()}},[t,a,n,i]),or(()=>{s.current?.disconnect()},[])}let od=window.React.useRef,oc=window.React.useState,ou=window.React.useCallback;function om(e){let[t,a]=oc(e),n=ou(()=>{a(!0)},[]),i=ou(()=>{a(!1)},[]),s=ou(()=>{a(e=>!e)},[]);return[t,n,i,s]}window.React.useRef;let op=ee(()=>new ResizeObserver(e=>{e.forEach(e=>{e.target.handleResizeChange&&e.target.handleResizeChange(e.contentRect)})})),oh=(e,t)=>{l2(()=>{let a=null;return e.current&&(e.current.handleResizeChange=t,op().observe(e.current),a=e.current),()=>{a&&op().unobserve(a)}},[e,t])};window.React.useState;let of=window.React.useState,og=window.React.useCallback,oy=window.React.useMemo,ov=window.React.useRef;function o_(e){let[t,a]=of(new Set(e)),n=ov(new Set(e)),i=og(e=>{a(t=>new Set([...t,e])),n.current.add(e)},[a]),s=og(e=>{a(t=>new Set([...t].filter(t=>t!==e))),n.current.delete(e)},[a]),r=og(e=>n.current.has(e),[]),l=oy(()=>({addItem:i,removeItem:s,hasItem:r}),[i,s,r]);return[t,l]}function ob(e){return e}function oM(e,t){return t?[e,"disabled"]:e}function ox(e,t){return t?[e,"active"]:e}function oC(e){return e}function oj(e){return e}window.React.useMemo;let oN=Object.freeze(Object.defineProperty({__proto__:null,AssignOwner:{searchInput:"assign_owner_search_input"},Bookmarks:{bookmarksPanel:"bookmarks_panel",jumpBtn:{base:"bookmark_jump_btn",variant:oC},removeBtn:{base:"bookmark_remove_btn",variant:oC}},Channel:{advancedPermHeader:"advanced_perm_header",advancedPermContent:"advanced_perm_content"},ContactRequests:{inviteSuccessUserName:"contact_invite_success_name",contactRequestsItem:{base:"contact_requests_item",variant:e=>e},contactRequestsItemType:{base:"contact_requests_item_type",variant:e=>e},contactRequestsItemAcceptBtn:"contact_requests_item_accept_btn",contactRequestsItemRejectBtn:"contact_requests_item_reject_btn",contactRequestsItemDeleteBtn:"contact_requests_item_delete_btn",contactRequestsItemChatBtn:"contact_requests_item_chat_btn"},Dropdown:{blockContact:"block_contact_dropdown_option",phoneCall:"phone_call_dropdown_option",unBlockContact:"unblock_contact_dropdown_option",dropdownContent:"dropdown_content",messageDropdown:"message_dropdown",createChannel:"create_channel_dropdown_option",joinChannel:"join_channel_dropdown_option",createFolder:"create_folder_dropdown_option",settings:"setting_dropdown_option",inviteToMeeting:"invite_to_meeting_dropdown_option",meetWithVideo:"meet_with_video_dropdown_option",meetWithoutVideo:"meet_without_video_dropdown_option",markAsUnread:"mark_as_unread_dropdown_option",markAsRead:"mark_as_read_dropdown_option",addMembers:"add_members_dropdown_option",aboutChannel:"about_channel_dropdown_option",notificationsAllMessages:"notifications_all_messages_dropdown_option",notificationsMentions:"notifications_mentions_dropdown_option",notificationsOff:"notifications_off_dropdown_option",muteChannel:"mute_channel_dropdown_option",unmuteChannel:"unmute_channel_dropdown_option",editChannel:"edit_channel_dropdown_option",deleteChannel:"delete_channel_dropdown_option",copyDeepLinkChannel:"copyDeepLink_channel_dropdown_option",muteChat:"mute_chat_dropdown_option",unmuteChat:"unmute_chat_dropdown_option",editChat:"edit_chat_dropdown_option",deleteChat:"delete_chat_dropdown_option",star:"star_dropdown_option",unStar:"unstar_dropdown_option",copyDeepLink:"copyDeepLink",deleteContact:"delete_contact_dropdown_option",actionMenuContainer:"dropdown_action_menu_container",jumpToMessage:"jump_to_message_dropdown_option",removeBookmark:"remove_bookmark_dropdown_option",moveToFolder:"move_to_folder_dropdown_option",removeFolder:"remove_folder_dropdown_option",moveToFolderItem:"move_to_folder_item_dropdown_option",sizeSmall:"size_small_dropdown_option",sizeMedium:"size_medium_dropdown_option",sizeLarge:"size_large_dropdown_option",editorHead1:"editor_head_1_dropdown_option",editorHead2:"editor_head_2_dropdown_option",editorHead3:"editor_head_3_dropdown_option",editorHeadP:"editor_head_p_dropdown_option",viewProfile:"view_member_dropdown_option",assignAdmin:"assign_member_dropdown_option",unassignAdmin:"unassign_member_dropdown_option",removeMember:"remove_member_dropdown_option",deleteMemberContact:"delete_contact_member_dropdown_option",removeFromPinHistory:"remove_from_pin_history",pin:"pin",unpin:"unpin",fileFromYourComputer:"file_from_your_computer",fileFromMicrosoftSharePoint:"file_from_microsoft_share_point",fileFromBox:"file_from_box",fileFromGoogleDrive:"file_from_google_drive",fileFromOneDrive:"file_from_one_drive",viewAndEditMentionGroup:"view_and_edit_mention_group",viewMentionGroup:"view_mention_group",joinMentionGroup:"join_mention_group",leaveMentionGroup:"leave_mention_group",deleteMentionGroup:"delete_mention_group",chooseFromAllMembers:"choose_from_all_members",chooseFromAddedMembers:"choose_from_added_members",addApps:"add_apps_dropdown_option"},Editor:{editorBtn:{base:"editor_btn",variant:(e,t)=>t?[e,"active"]:e},color:{base:"color",variant:(e,t)=>[e,t]},colorClearBtn:"colorClearBtn",link:{base:"editor_link",variant:e=>e},linkInput:"editor_link_input",linkConfirmBtn:"editor_link_confirm_btn",linkEditBtn:"editor_link_edit_btn",linkOpenBtn:"editor_link_open_btn"},Emoji:{emojiInputButton:{base:"emoji_input_button",variant:e=>e},emojiImgContent:"emoji_img_content",gifPickerBtn:"gif_btn",gifInputButton:{base:"gif_input_button",variant:e=>e},gifPanel:"gif_panel_content",gifImgLoading:"gif_img_loading",gifImgContents:{base:"gif_img_content",variant:e=>e}},File:{fileItem:{base:"file_item",variant:e=>e},fileLoadingProgress:"file_loading_progress",fileThirdStorageTag:"file_third_storage_tag",file:{base:"file",variant:e=>e},fileItemDeleteBtn:"file_item_delete_btn",fileIcon:"file_icon",fileName:"file_name",fileDetail:"file_detail",fileSize:"file_size",fileCancelBtn:"file_cancel_btn",fileStatus:{base:"file_status",variant:e=>e}},Form:{formField:{base:"form_field",variant:e=>e},selectOption:{base:"select_option",variant:e=>e},formButton:{base:"form_button",variant:e=>e}},Icon:{icon:{base:"icon",variant:e=>e}},JoinChannel:{searchInput:"join_channel_search_input",joinChannelItem:{base:"join_channel_item",variant:e=>e},joinBtn:"join_channel_join_btn",previewBtn:"join_channel_preview_btn"},Main:{sendBtn:"send_btn",replySendBtn:"reply_send_btn",editSendBtn:"edit_send_btn",loading:"loading",chatBox:"chat_box",replyChatBox:"reply_chat_box",editChatBox:"edit_chat_box",message:{base:"message",variant:e=>e},closeImageBtn:"close_img-btn",imgRotateBtn:"img_rotate-btn",imgDownloadBtn:"img_download-btn",imgBookmarkBtn:"img_bookmark-btn",imgRemoveBookmarkBtn:"img_remove_bookmark-btn",imgMoreBtn:"img_more-btn",imgPreviousBtn:"img_previous-btn",imgNextBtn:"img_next-btn",imgZoomMax:"img_zoom_max",imgZoomMin:"img_zoom_min",imgSliderItem:"img_slider_item",imgPreviewContainer:"img_preview_container",imgContainer:"img_container",messageLoaded:"message_loaded",messageUnreadTip:"message_unread_tip",link:"link",linkPreviewDetail:"link_preview",deepLinkType:"deep_link_type",deepLinkTitle:"deep_link_title",deepLinkDetail:"deep_link_detail",foldLinkPreview:"fold_link_preview",unfoldLinkPreview:"unfold_link_preview",msgReplyBtn:"msg_reply_btn",msgEmojiBtn:"msg_emoji_btn",msgMoreBtn:"msg_more_btn",moreActionsMenuBtn:"more_actions_menu_btn",memberListIcon:"member_list_icon",pinTag:"pinTag",unreadNewMsgBtn:"unreadNewMsgBtn",formatBtn:{base:"format_btn",variant:ob},activePanel:"active_panel",msgMoreMenuItem:{base:"msg_more",variant:oM},msgContextMenuItem:{base:"msg_context_menu",variant:oM},fileBtn:{base:"file_btn",variant:ob},screenshotBtn:{base:"screenshot_btn",variant:ob},userItem:{base:"user_item",variant:ob},userItemMoreBtn:"user_item_more_btn",toggleReplyBtn:"toggle_reply_btn",headingFolderBtn:"heading_folder_btn",panelHeader:"panel_header",editableTextBlock:"editable_text_block",editableTextContent:"editable_text_content",editableTextEditBtn:"editable_text_edit_btn",editableTextSaveBtn:"editable_text_save_btn",disablePostChatBox:"disable_post_chat_box",msgJumpBtn:"msg_jump_btn"},Mention:{mentionMsg:"mention_msg",list:"suggestion_list",channelMemberSelector:"channel_member_selector",mentionGroupItemMoreBtn:"mention_group_item_more_btn",item:{base:"suggestion_item",variant:e=>e},text:{base:"mention_text",variant:e=>e}},Modal:{modalContainer:{base:"modal_container",variant:e=>e},modalTile:"modal_title",modalConfirmBtn:"modal_confirm_btn",modalCancelBtn:"modal_cancel_btn",modalCloseBtn:"modal_close_btn",modalExtraDeleteBtn:"modal_extra_delete_btn",modalMemberSearchInput:"modal_member_search_input",modalMemberSearchList:"modal_member_search_list",modalMessageRecentList:"modal_message_recent_list",modalBlockedUserList:"modal_blocked_user_list"},MoreActions:{panel:"more_actions_panel",closeBtn:"more_actions_close_btn",addMembersBtn:"add_members_btn",desc:"channel_desc",editDescBtn:"edit_desc_btn",profileHeader:"profile_header",profileContent:"profile_content",memberListHeader:"member_list_header",memberListContent:"member_list_content",addMembersIcon:"add_members_icon",viewAllMembersBtn:"view_all_members_btn",optionsHeader:"channel_options_header",optionsContent:"channel_options_content",sendContactRequestBtn:"send_contact_request_btn",filesHeader:"files_header",filesContent:"files_content",mentionGroupsHeader:"mention_groups_header",mentionGroupsContent:"mention_groups_content",mentionGroupItem:{base:"mention_groups_item",variant:e=>e},addMentionGroupBtn:"add_mention_group_btn",pinHistoryHeader:"pin_history_header",pinHistoryListContent:"pin_history_list_content",optionBtn:{base:"channel_option",variant:e=>e},userItemMoreBtn:"user_item_more_btn",descContent:"desc_content",sideMessage:"side_message"},Navigation:{panel:"navigation_panel",back:"navigation_back_btn",forward:"navigation_forward_btn",history:"navigation_history_btn",historyList:"navigation_history_list"},NewChat:{content:"new_chat_content",close:"new_chat_close"},Reminders:{remindersList:"reminders_list",reminderMsg:"reminder_msg",reminderOperate:"reminder_operate",filterBtn:{base:"reminder_filter_btn",variant:e=>e},reminderOperateBtn:{base:"reminder_operate_btn",variant:e=>e},customReminderNote:"custom_reminder_note"},Screenshot:{screenshotCropImage:"screenshot_crop_image",screenshotCropBtn:"screenshot_crop_btn",screenshotCancelBtn:"screenshot_cancel_btn"},Search:{openSearch:"search_open",searchType:{base:"search_type_item",variant:oj},searchContainer:{base:"search_container",variant:oj},closeBtn:"search_close",clearBtn:"search_clear",searchItem:"search_item",highlightItem:"highlight_item",searchItemDownloadProcess:"search_item_download_process",searchOperateChat:"search_operate_chat",searchOperateAddContact:"search_operate_add_contact",searchOperateMeeting:"search_operate_meeting",searchOperateJump:"search_operate_jump",searchOperateDownload:"search_operate_download",searchOperateMoreOptions:"search_operate_more_options",searchEmpty:"search_empty"},Sidebar:{teamChatMoreBtn:"team_chat_more_btn",newChatBtn:"new_chat_btn",sidebar:"sidebar",chatMenuMoreOptions:"chat_menu_more_options",topMenuBtn:{base:"top_menu_btn",variant:ox},topMenuMoreItem:{base:"top_menu_more_item",variant:e=>e},chatItem:{base:"chat_item",variant:ox},chatItemMoreAction:{base:"chat_item_more_action",variant:ox},chatMenu:{base:"chat_menu",variant:e=>e},chatMenuItemBody:{base:"chat_menu_item_body",variant:e=>e},sidebarAvatar:{base:"sidebar_avatar",variant:e=>e},chatFolders:{base:"chat_folder",variant:e=>e},unreadInfo:"chat_unread_info"}},Symbol.toStringTag,{value:"Module"})),ow="data-testid",oI=function(e){return Object.entries(e).reduce((e,t)=>{let[a,n]=t;return{...e,[a]:{...function(e){return Object.entries(e).reduce((e,t)=>{let[a,n]=t;if("string"==typeof n)return{...e,[a]:{[ow]:n}};{let{base:t,variant:i}=n;return{...e,[a]:function(){for(var e=arguments.length,a=Array(e),n=0;n<e;n++)a[n]=arguments[n];let s=i(...a),l=r(Array.isArray(s)?[t,...s]:[t,s]);return{[ow]:l.join("_")}}}}},{})}(n)}}},{})}(oN),oT={accountId:window.pwaChatConfig?.accountId,matchType:et.ALL,matchRange:ea.JOINED,channelType:en.ALL_NORMAL,page:1,size:100},oE={...oT,channelType:en.ALL_MUC},oS={"de-DE":()=>ei(()=>t.import("./de-DE.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"es-ES":()=>ei(()=>t.import("./es-ES.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"fr-FR":()=>ei(()=>t.import("./fr-FR.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"id-ID":()=>ei(()=>t.import("./id-ID.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"it-IT":()=>ei(()=>t.import("./it-IT.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"ja-JP":()=>ei(()=>t.import("./ja-JP.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"ko-KR":()=>ei(()=>t.import("./ko-KR.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"nl-NL":()=>ei(()=>t.import("./nl-NL.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"pl-PL":()=>ei(()=>t.import("./pl-PL.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"pt-PT":()=>ei(()=>t.import("./pt-PT.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"ru-RU":()=>ei(()=>t.import("./ru-RU.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"tr-TR":()=>ei(()=>t.import("./tr-TR.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"vi-VN":()=>ei(()=>t.import("./vi-VN.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"zh-CN":()=>ei(()=>t.import("./zh-CN.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url),"zh-TW":()=>ei(()=>t.import("./zh-TW.js"),false?"__VITE_PRELOAD__":void 0,t.meta.url)},ok={"de-DE":"de","en-US":"en","es-ES":"es","fr-FR":"fr","id-ID":"id","it-IT":"it","ja-JP":"ja","ko-KR":"ko","nl-NL":"nl","pl-PL":"pl","pt-PT":"pt","ru-RU":"ru","tr-TR":"tr","vi-VN":"vi","zh-CN":"zh-cn","zh-TW":"zh-tw"};function oA(){let e=u();return{$t:e.formatMessage}}es.extend(er),es.extend(el);let oR=new class{fetchLang(e){return"en-US"===e?Promise.resolve({}):oS[e]().then(e=>e.default).catch(()=>null)}fetchInitialLang(){return this._initialLangResource?Promise.resolve(this._initialLangResource):this.fetchLang(this.initialLang).then(e=>(this._initialLangResource=e,e))}initDayjsLocale(){es.locale(ok[this.initialLang])}init(){this.fetchInitialLang(),this.initDayjsLocale()}get initialLangResource(){return this._initialLangResource}constructor(){this.initialLang=rK(),this._initialLangResource="en-US"===this.initialLang?{}:null}};oR.init();let oL=new class{init(){oR.fetchInitialLang().then(e=>{this.intl=ed({messages:e??{},locale:oR.initialLang,defaultLocale:"en-US",onError:ec},this.intlCache)})}get $t(){return this.intl.formatMessage}constructor(){this.intlCache=eo(),this.intl=ed({locale:"en-US",onError:ec},this.intlCache)}};oL.init();let oO=window.React.useState,oD=e=>{let{children:t}=e,[a,n]=oO(oR.initialLangResource),i=!!a;return l2(()=>{i||oR.fetchInitialLang().then(e=>n(e))},[i]),g.jsx(eu,{messages:a??{},locale:oR.initialLang,defaultLocale:rG,onError:ec,children:t})},oP=[{key:"MostRelevant",value:iX.SORTTYPE_SCORE,text:oL.$t({id:"jlFlXc",defaultMessage:[{type:0,value:"Most Relevant"}]})},{key:"MostRecent",value:iX.SORTTYPE_TIMESTAMP,text:oL.$t({id:"RTkF4y",defaultMessage:[{type:0,value:"Most Recent"}]})}],oF=[{key:"AllFiles",value:iQ.ALL,text:oL.$t({id:"5IiYyq",defaultMessage:[{type:0,value:"All Files"}]})},{key:"Images",value:iQ.IMAGES,text:oL.$t({id:"Fip4H8",defaultMessage:[{type:0,value:"Images"}]})},{key:"Videos",value:iQ.VIDEOS,text:oL.$t({id:"4XfMux",defaultMessage:[{type:0,value:"Videos"}]})},{key:"Documents",value:iQ.DOCUMENTS,text:oL.$t({id:"vBlT6y",defaultMessage:[{type:0,value:"Documents"}]})},{key:"Presentations",value:iQ.PRESENTATIONS,text:oL.$t({id:"kXo2i+",defaultMessage:[{type:0,value:"Presentations"}]})},{key:"Spreadsheets",value:iQ.SPREADSHEETS,text:oL.$t({id:"fd/DO3",defaultMessage:[{type:0,value:"Spreadsheets"}]})},{key:"OtherFileTypes",value:iQ.OTHER,text:oL.$t({id:"8N/ba1",defaultMessage:[{type:0,value:"Other File Types"}]})}],oB=[{key:"AnyTime",value:sQ.Any,text:oL.$t({id:"HXZ5wy",defaultMessage:[{type:0,value:"Any Time"}]})},{key:"Today",value:sQ.Today,text:oL.$t({id:"zWgbGg",defaultMessage:[{type:0,value:"Today"}]})},{key:"Yesterday",value:sQ.Yesterday,text:oL.$t({id:"6dIxDP",defaultMessage:[{type:0,value:"Yesterday"}]})},{key:"Last7Days",value:sQ.Last7Days,text:oL.$t({id:"ZtU8Lq",defaultMessage:[{type:0,value:"Last "},{type:1,value:"count"},{type:0,value:" Days"}]},{count:7})},{key:"Last30Days",value:sQ.Last30Days,text:oL.$t({id:"ZtU8Lq",defaultMessage:[{type:0,value:"Last "},{type:1,value:"count"},{type:0,value:" Days"}]},{count:30})}];function oU(e){return e?ep(eh(e).filter(e=>{let[,{count:t}]=e;return t>0}).map(e=>{let[t,{count:a,haveIEmojied:n,firstEmojiTime:i}]=e;return{emoji:t,count:a,firstEmojiTime:i,haveIEmojied:n}}),["firstEmojiTime"],["asc"]):[]}var oH=(e=>(e.startChatMessage="startChatMessage",e.appendInfoMessage="appendInfoMessage",e.updateLatestMessage="updateLatestMessage",e.pendingMessage="pendingMessage",e.starFromFolders="starFromFolders",e.chatRemoved="chatRemoved",e.channelJoined="channelJoined",e.channelChanged="channelChanged",e.jumpToMessage="jumpToMessage",e.removeInvitation="removeInvitation",e.addContactRequest="addContactRequest",e.muteGroupChats="muteGroupChats",e.revokeFiles="revokeFiles",e.recentChats="recentChats",e.appChats="appChats",e))(oH||{});let oz=new class{get startChatMessage$(){return this._startChatMessage$.asObservable()}get appendInfoMessage$(){return this._appendInfoMessage$.asObservable()}get updateLatestMessage$(){return this._updateLatestMessage$.asObservable()}get pendingMessage$(){return this._pendingMessage$.asObservable()}get starFromFolders$(){return this._starFromFolders$.asObservable()}get chatRemoved$(){return this._chatRemoved$.asObservable()}get channelJoined$(){return this._channelJoined$.asObservable()}get channelChanged$(){return this._channelChanged$.asObservable()}get jumpToMessage$(){return this._jumpToMessage$}get removeInvitation$(){return this._removeInvitation$.asObservable()}get addContactRequest$(){return this._addContactRequest$.asObservable()}get muteGroupChats$(){return this._muteGroupChats$.asObservable()}get revokeFiles$(){return this._revokeFiles$.asObservable()}get recentChats$(){return this._recentChats$.asObservable()}get appChats$(){return this._appChats$.asObservable()}dispatch(e,t){let a=this[`_${e}$`];a&&lN(()=>a.next(t))()}constructor(){this._startChatMessage$=new B,this._appendInfoMessage$=new B,this._updateLatestMessage$=new B,this._pendingMessage$=new B,this._starFromFolders$=new B,this._chatRemoved$=new B,this._channelJoined$=new B,this._channelChanged$=new B,this._removeInvitation$=new B,this._addContactRequest$=new B,this._jumpToMessage$=new ef(null).pipe(eg(e=>!!e)),this._muteGroupChats$=new B,this._revokeFiles$=new B,this._recentChats$=new B,this._appChats$=new B}},oV=e=>e.slice().sort((e,t)=>Number(e?.index??0)-Number(t?.index??0)),oG=e=>{let t=oV(e);return t[t.length-1]},oq=ee(()=>{let e=document.createElement("canvas");return e.getContext("2d")});function o$(e,t,a){return a?(a.font=t,a.measureText(e).width):0}function oK(e,t){let a=es(e);return t?a.format(t):a.isToday()?a.format("h:mm A"):a.isYesterday()?oL.$t({id:"6dIxDP",defaultMessage:[{type:0,value:"Yesterday"}]})+`, ${a.format("h:mm A")}`:a.isBefore(es(),"year")?a.format("MMM D, YYYY, h:mm A"):a.format("MMM D, h:mm A")}function oJ(e){let t=es(e);return t.format("h:mm A")}function oW(e){let t=es(e);return t.format("ddd, MMM D")}function oY(e){let t=es(e);return t.format("MMM D, YYYY, H:mm")}function oX(e,t){return Math.abs(es(e).diff(t,"minute"))}function oQ(e){if(!e)return null;let{begin:t,end:a,wording:n}=e;if(!n)return null;let i=es(new Date().getTime());return t&&i.isBefore(1e3*t)||a&&i.isAfter(1e3*a)?null:n}let oZ=window.PWAToast.ICON_TYPE,o1=window.PWAToast.toast;function o0(e,t){let{title:a,desc:n,options:i}=e;o1({type:t,title:a,desc:n},i)}let o2={info:(e,t,a)=>{o0({title:e,desc:t,options:a},oZ.INFO)},success:(e,t,a)=>{o0({title:e,desc:t,options:a},oZ.SUCCESS)},error:(e,t,a)=>{o0({title:e,desc:t,options:a},oZ.FAILURE)},warning:(e,t,a)=>{o0({title:e,desc:t,options:a},oZ.WARN)}};var o5=(e=>(e.changeChannel="changeChannel",e))(o5||{});function o3(){return window.__MICRO_APP_ENVIRONMENT__}function o6(e){o3()&&window.microApp.dispatch(e)}var o4=(e=>(e.chat="chat",e.emoji="emoji",e.file="file",e.giphy="giphy",e))(o4||{}),o8=(e=>(e.emoji="emoji",e.giphy="giphy",e.file="file",e))(o8||{}),o7=(e=>(e.fileExceed="fileExceed",e.fileRepeat="fileRepeat",e.textOverflow="textOverflow",e.offline="offline",e.screenshot="screenshot",e.fileOverSize="fileOverSize",e.fileNotSupport="fileNotSupport",e))(o7||{});let o9=ey(),de=new class{setDefaultEditor(e){this.defaultEditor=e}setLastActiveEditor(e){this.lastActiveEditor=e}setReplyEditor(e,t){this.replyEditorMap.set(e,t)}getReplyEditor(e){return this.replyEditorMap.get(e)}getDefaultEditor(){return this.defaultEditor}getLastActiveEditor(){return this.lastActiveEditor}addQuoteMessage(e){if(e.current){let t=this.lastActiveEditor||this.defaultEditor,a=e.current.outerText?e.current.outerText:e.current.innerText;t&&a.length&&t?.current?.addQuoteMsg(a)}}constructor(){this.defaultEditor=null,this.lastActiveEditor=null,this.replyEditorMap=new Map}},dt=new Map,da="team_chat_emoji",dn=e_().schema(()=>({emojiSkinTone:eb.nativeEnum(eM)})).mutations(e=>({setEmojiSkinTone(t){e.emojiSkinTone=t}})).create({emojiSkinTone:eM.Default}),di=window.React.createContext,ds=window.React.useContext;var dr=(e=>(e.emoji="emoji",e.giphy="giphy",e.file="file",e))(dr||{});let dl=di([]),dd=dl.Provider;function dc(e){let t=ds(dl);return!t.includes(e)}function du(e,t){return a=>{let n=dc(t);return n?g.jsx(e,{...a}):null}}let dm=window.React.createContext,dp=dm(()=>{}),dh=dp.Provider,df={editor:"_editor_1gnzh_1",imEditor:"_imEditor_1gnzh_6",spritesHidden:"_spritesHidden_1gnzh_14",innerEditor:"_innerEditor_1gnzh_20",menuBar:"_menuBar_1gnzh_33",content:"_content_1gnzh_39",formatting:"_formatting_1gnzh_49",buttons:"_buttons_1gnzh_53",popperContainer:"_popperContainer_1gnzh_64"},dg=window.React.useState,dy=window.React.useRef,dv=window.React.forwardRef,d_=window.React.useImperativeHandle,db=ex(dv(function(e,t){let{textContent:a,defaultFiles:n,disabled:s=!1,placeholder:l,className:o,menuBarClassName:d,children:c,getPreventBlurElements:u,onSend:m,onBlur:p,onFocus:h,onWarning:y,onMentionSearch:v,onSlashSearch:_,mentionSuggestionRender:b,slashSuggestionRender:M,contentCheck:x,giphyConfig:C,...j}=e,[N,w]=dg(null),I=Q(N),T=eC(),[E,S]=dg(!a),k=dy(null),A=dy(null),R=dc(dr.file)&&!s,[L,O]=dg(!1),D=Q(L),{$t:P}=rV(),{emojiSkinTone:F,setEmojiSkinTone:B}=dn,{files:U,processFiles:H,remove:z,clear:V,setFiles:G}=ej({disabled:!R,onError(e,t){switch(e){case eR.exceed:return y?.("fileExceed");case eR.noAccept:return y?.("fileNotSupport",{fileName:t?.[0].name});case eR.overSize:return y?.("fileOverSize");case eR.repeat:return y?.("fileRepeat");default:return}},maxCount:10,maxSize:536870912,noAccept:sw,onChosen:()=>{N?.isEditable&&N?.cmd.focus()}}),q=E&&!U.length,$=Q(q),K=()=>{N?.cmd.clearContent(),V()},J=Q(()=>{if(!navigator.onLine){y?.("offline");return}if(N&&N.getText().length>4096){y?.("textOverflow");return}if(q)return;let e=N?.helper.getContent();if(!e)return;let t={textContent:e,files:U},a=()=>{m(t),K()};x?x(t).then(e=>{e&&a()}):a()}),W=(e,t)=>{let a=t.key===sN.enter&&!t.shiftKey;switch(!0){case a&&!D.current&&!I.current?.helper.isSuggestionActivated([eI.mention,eI.emojiNode,eI.slash]):return t.preventDefault(),J.current(),!0;case t.key===sN.tab&&t.shiftKey:return sj.focusPrevious(document.body),!0;default:return!1}},Y=(e,t)=>{let a=t.clipboardData?.items?[...t.clipboardData.items]:[],n=rX.handlePasteBase64(t),i=rX.handlePasteFile(t),s=rX.handlePasteMix(t);return H(r(a.map(e=>e.getAsFile()).concat(n?re(n):null).concat(i).concat(s))),!1},X=()=>{p?.($.current)},Z=()=>{N?.setEditable(!1)},ee=()=>{N?.setEditable(!0)},et=()=>A.current||document.body;return l2(()=>{s||!T?(K(),Z()):ee()},[s]),l2(()=>{eN(eA,"anonymous")},[]),l2(()=>(n?.length&&G(()=>[...n]),w(ew({editable:!s,autofocus:"end",content:a,placeholder:l,limit:4096,onLimitReached(){y?.("textOverflow")},popoverContainer:et,deepLinkTransText:{messageText:P({id:"mCaAWr",defaultMessage:[{type:0,value:"Link to Team Chat Message"}]}),channelText:P({id:"DFlw+O",defaultMessage:[{type:0,value:"Link to Team Chat Channel"}]})},emoji:{skinTone:F,suggestion:!0,crossOrigin:"anonymous",popoverContainer:et},mention:{onSearch:v,customSuggestionList:b},slash:{onSearch:_,customSuggestionList:M},bubbleMenu:{enable:!0,onClickMore(e){O(!0),e.cmd.setBubbleMenuVisible(!1)}},bubbleLink:{popoverContainer:et,enable:!0},onKeyDown:W,onPaste:Y,onFocus:h,onEmptyChange:S,editorElement:k.current,getPreventBlurElements:()=>r(u?.()),onBlur:X})),()=>{N?.destroy()}),[]),l2(()=>{N?.cmd.focus(a?"end":"start",{scrollIntoView:!1})},[N]),l2(()=>{N?.cmd.setPlaceholder(l,df.innerEditor)},[N,l]),d_(t,()=>({focus:()=>{I.current?.cmd.focus("end",{scrollIntoView:!1})},getTextContent:()=>I.current?.helper.getContent().text??"",setTextContent:e=>I.current?.chain().focus().setContent({type:eI.paragraph,content:[{type:eI.text,text:e}]}).run(),appendTextContent:e=>{I.current?.chain().focus("end").insertContent({type:eI.paragraph,content:[{type:eI.text,text:e}]}).run()},insertContent:e=>I.current?.cmd.insertContent(e),addQuoteMsg:e=>{I.current?.cmd.insertBlockQuote(e,E)}}),[I,E]),g.jsx(dh,{value:O,children:g.jsx(eT,{className:df.editor,onFiles:H,disabled:!R,children:g.jsxs("div",{...j,ref:k,onKeyDown:e=>{e.key===sN.esc&&N?.cmd.blur()},className:f(df.imEditor,o),children:[L&&N&&g.jsx(eE,{popoverContainer:et(),className:f(d,df.menuBar),lang:rK(),editor:N}),g.jsx(eS,{lang:rK(),editor:N,className:f(df.content,{[df.formatting]:L})}),g.jsx("div",{className:df.popperContainer,ref:A}),g.jsx(ek,{fileList:U,onRemove:z}),g.jsx("div",{tabIndex:-1,className:df.buttons,children:c({isEmpty:q,formatting:L,handleFormatting:()=>{O(!L),N?.cmd.setBubbleMenuVisible(L),N?.isEditable&&N?.cmd.focus()},handleEnter:J.current,processFiles:H,handleEmojiSelect:e=>{N?.cmd.insertEmoji(e)},handleGiphySelect:function(e){let t=re(lh(e),e.id);t&&H([t],{type:i.giphy,giphy:e})},giphyConfig:C,handleSkinToneChange:e=>{B(e),N?.cmd.setEmojiSkinTone(e)},emojiSkinTone:F,handleScreenshotError:()=>{y?.("screenshot")}})}),g.jsx("div",{className:f("joypixels-24-people",df.spritesHidden)})]})})})})),dM={btn:"_btn_gz2l2_1","btn-icon-only":"_btn-icon-only_gz2l2_19","btn-round":"_btn-round_gz2l2_22","btn-lg":"_btn-lg_gz2l2_42","btn-sm":"_btn-sm_gz2l2_54","btn-text":"_btn-text_gz2l2_66","btn-link":"_btn-link_gz2l2_113","btn-default":"_btn-default_gz2l2_155","btn-primary":"_btn-primary_gz2l2_197","btn-dangerous":"_btn-dangerous_gz2l2_238","btn-disabled":"_btn-disabled_gz2l2_280","btn-loading":"_btn-loading_gz2l2_283","btn-need-space-left":"_btn-need-space-left_gz2l2_287","btn-need-space-right":"_btn-need-space-right_gz2l2_290","btn-circle":"_btn-circle_gz2l2_293"},dx=window.React,dC={large:"lg",small:"sm",middle:void 0},dj=dx.forwardRef((e,t)=>{let{loading:a=!1,type:n="default",danger:i,shape:s="default",size:r,disabled:l,className:o,children:d,icon:c,iconPlacement:u="left",ghost:m=!1,block:p=!1,htmlType:h="button",...y}=e,v=a?"loading":c,_=dC[r||"middle"]||null,b=d||0===d,M=f("_btn_gz2l2_1",{[dM[`btn-${s}`]]:"default"!==s&&s,[dM[`btn-${n}`]]:!!n,[dM[`btn-${_}`]]:!!_,[dM["btn-icon-only"]]:!b&&!!v,[dM["btn-background-ghost"]]:m&&!function(e){return"text"===e||"link"===e}(n),[dM["btn-loading"]]:a,[dM["btn-block"]]:p,[dM["btn-dangerous"]]:!!i,[dM[`btn-need-space-${u}`]]:b&&!!v,[dM["btn-disabled"]]:l},o),x=a?g.jsx(eL,{...oI.Icon.icon("loading")}):c,C=g.jsxs("button",{...y,type:h,className:M,onClick:t=>{let{onClick:n}=e;if(a||l){t.preventDefault();return}n?.(t)},disabled:l,ref:t,children:["left"===u&&x,d,"right"===u&&x]});return C}),dN=window.React.useState,dw=window.React.useCallback,dI=window.React.useEffect,dT=window.React.Fragment;function dE(e){let{dataList:t,dataRender:a,keyedBy:n,...i}=e,[s,r]=dN(0),l=dw(e=>{r(t=>{let a;return a=t<=0?0:t-1,e[a]?.focus(),a})},[r]),o=dw(e=>{let a=t.length-1;r(t=>{let n;return n=t>=a?a:t+1,e[n]?.focus(),n})},[r,t]),d=dw(e=>{let a=e.target,i=e.currentTarget,s=t.map((e,t)=>i.querySelector(`[role="listitem"][data-key="${n(e,t)}"]`)).filter(e=>e);if(s.includes(a)){switch(e.key){case sN.down:case sN.right:o(s);break;case sN.up:case sN.left:l(s);break;default:return}e.preventDefault()}},[t,l,o,n]),c=dw(e=>{let a=e.target,i=e.currentTarget,s=10,l=t.map((e,t)=>i.querySelector(`[role="listitem"][data-key="${n(e,t)}"]`)).filter(e=>e),o=a;for(;s-- >0;){if(o===i||!o?.parentElement)return;if(l.includes(o)){let e=l.findIndex(e=>e===o);r(e),o===a&&a.focus();return}o=o.parentElement}},[t,r,n]);return dI(()=>{r(e=>t.length?t[s]?e:t.length-1:0)},[s,r,t]),g.jsx("div",{...i,role:"list",tabIndex:-1,onKeyDown:d,onClick:c,children:t.map((e,t)=>g.jsx(dT,{children:a(e,{tabIndex:t===s?0:-1,role:"listitem","data-key":n(e,t)},t)},n(e,t)))})}function dS(e){let{style:t,tagStyle:a,tagsData:n,className:i,tagClassName:s,gap:r=12,value:l,onChange:o}=e,d=u(),c=[{id:"TopResults",text:d.formatMessage({id:"0clvxC",defaultMessage:[{type:0,value:"Top results"}]}),icon:g.jsx(eO,{}),iconChecked:g.jsx(eD,{})},{id:"Contacts",text:d.formatMessage({id:"4S241U",defaultMessage:[{type:0,value:"Contacts"}]}),icon:g.jsx(eP,{}),iconChecked:g.jsx(eF,{})},{id:"Channels",text:d.formatMessage({id:"LUrJwE",defaultMessage:[{type:0,value:"Channels"}]}),icon:g.jsx(eB,{}),iconChecked:g.jsx(eU,{})},{id:"Messages",text:d.formatMessage({id:"hMzcSq",defaultMessage:[{type:0,value:"Messages"}]}),icon:g.jsx(eH,{}),iconChecked:g.jsx(ez,{})},{id:"Files",text:d.formatMessage({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]}),icon:g.jsx(eV,{}),iconChecked:g.jsx(eG,{})}],m=n||c;return g.jsx(dE,{style:t,className:f(i,"_searchTags_afjgz_1"),dataList:m,keyedBy:e=>e.id,dataRender:(e,t,n)=>g.jsxs("button",{...oI.Search.searchType(e.id),style:{marginRight:n===m.length-1?0:r,...a},"aria-label":e.text,"aria-checked":e.id===l,className:f(s,"_checkableTag_afjgz_5",{_isChecked_afjgz_41:e.id===l}),onClick:()=>(function(e){o?.(e)})(e.id),...t,children:[e.id===l?e.iconChecked:e.icon,g.jsx("span",{children:e.text})]})})}let dk={content:"_content_1g3yu_1",arrow:"_arrow_1g3yu_8"};function dA(e){let{children:t,content:a,arrowVisible:n=!1,className:i,arrowClassName:s,open:r,defaultOpen:l,onOpenChange:o,side:d,align:c,sideOffset:u,alignOffset:m}=e;return g.jsx(eq,{children:g.jsxs(e$,{delayDuration:300,open:r,defaultOpen:l,onOpenChange:o,children:[g.jsx(eK,{asChild:!0,children:t}),g.jsxs(eJ,{side:d,align:c,sideOffset:u,alignOffset:m,className:f(dk.content,i),children:[a,n&&g.jsx(eW,{className:f(dk.arrow,s)})]})]})})}let dR={badge:"_badge_2rjzy_1",avatarContainer:"_avatarContainer_2rjzy_5",sm:"_sm_2rjzy_5","avatar-zoommeeting":"_avatar-zoommeeting_2rjzy_9","avatar-presenting":"_avatar-presenting_2rjzy_9","avatar-mobile":"_avatar-mobile_2rjzy_13","avatar-calendar":"_avatar-calendar_2rjzy_17","avatar-pbx":"_avatar-pbx_2rjzy_21",md:"_md_2rjzy_25",lg:"_lg_2rjzy_45",badgeStatus:"_badgeStatus_2rjzy_49",mobile:"_mobile_2rjzy_65",calendar:"_calendar_2rjzy_68",pbx:"_pbx_2rjzy_71",meeting:"_meeting_2rjzy_74"},dL={dnd:g.jsx(eY,{}),presenting:g.jsx(eX,{className:dR.meeting}),zoommeeting:g.jsx(eX,{className:dR.meeting}),pbx:g.jsx(eQ,{className:dR.pbx}),calendar:g.jsx(eZ,{className:dR.calendar}),available:g.jsx(e1,{className:dR.available}),away:g.jsx(e0,{className:dR.away}),offline:g.jsx(e2,{className:dR.offline}),mobile:g.jsx(e5,{className:dR.mobile}),busy:g.jsx(e3,{className:dR.busy}),blocked:g.jsx(e6,{className:dR.blocked})};function dO(e){let{status:t,size:a="sm",statusClassName:n,className:i,children:s,hidden:r}=e;return r?s:g.jsxs("div",{className:f(dR.badge,i),"aria-hidden":"true",children:[g.jsx("div",{className:f(dR.avatarContainer,{[dR[`avatar-${t}`]]:!!t,[dR[a]]:!!t}),children:s}),t&&g.jsx("span",{className:f(dR.badgeStatus,t,a,n),children:dL[t]})]})}let dD={dialog:"_dialog_1v17y_1",noSpacing:"_noSpacing_1v17y_10",loadingMask:"_loadingMask_1v17y_13",loadingInner:"_loadingInner_1v17y_24",dialogTitle:"_dialogTitle_1v17y_31",dialogClose:"_dialogClose_1v17y_49",dialogFooter:"_dialogFooter_1v17y_53",okButton:"_okButton_1v17y_57",footerButton:"_footerButton_1v17y_60"},dP="modalLabel",dF="modalDescribe";function dB(e){let{style:t={},className:a,closable:n=!1,width:i=720,noSpacing:s=!1,loading:r=!1,title:l,header:o,footer:d,children:c,onOk:m,onCancel:p,hideOk:h=!1,hideCancel:y=!1,okDisable:v,cancelDisable:_,testKey:b,camelTitle:M,cancelText:x,okDanger:C,okText:j}=e,N=u();return g.jsxs("div",{...oI.Modal.modalContainer(b),style:{width:i,...t},className:f(a,dD.dialog,{[dD.noSpacing]:s}),children:[r&&g.jsx(e4,{className:dD.loadingMask,loading:r,children:g.jsx("div",{className:dD.loadingInner})}),void 0===o?(()=>g.jsx("div",{className:dD.dialogHeader,children:l&&g.jsxs("h1",{...oI.Modal.modalTile,className:f(dD.dialogTitle,{camelText:!!M}),children:[g.jsx("span",{id:dP,children:l}),n&&g.jsx(dj,{...oI.Modal.modalCloseBtn,size:"small",type:"text",className:dD.dialogClose,icon:g.jsx(e8,{}),onClick:p})]})}))():o,c,void 0===d?(()=>y&&h?null:g.jsxs("div",{className:dD.dialogFooter,children:[!y&&g.jsx(dj,{...oI.Modal.modalCancelBtn,onClick:p,className:dD.footerButton,disabled:_,children:x||N.formatMessage({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})}),!h&&g.jsx(dj,{...oI.Modal.modalConfirmBtn,type:"primary",danger:C,onClick:m,disabled:v,className:f(dD.okButton,dD.footerButton),children:j||N.formatMessage({id:"N2IrpM",defaultMessage:[{type:0,value:"Confirm"}]})})]}))():d]})}let dU={searchInput:"_searchInput_150u0_1",searchInputBorder:"_searchInputBorder_150u0_9",searchInputGroup:"_searchInputGroup_150u0_18",inputWrapper:"_inputWrapper_150u0_26",input:"_input_150u0_26",searchInputSuffix:"_searchInputSuffix_150u0_50",clearButton:"_clearButton_150u0_55",searchInputGroupAddon:"_searchInputGroupAddon_150u0_61",closable:"_closable_150u0_72",bordered:"_bordered_150u0_76"},dH=window.React.forwardRef,dz=window.React.useEffect,dV=window.React.useImperativeHandle,dG=window.React.useRef,dq=window.React.useState,d$=dH(function(e,t){let{className:a,inputClassName:n,inputWrapperClassName:i,style:s,placeholder:r,autoFocus:l=!1,maxLength:o,allowClear:d=!0,closable:c=!1,bordered:m=!1,showSearch:p=!0,stopPropagation:h=!1,onSearch:y,onChange:v,onKeyDown:_,onFocus:b,onBlur:M,onClear:x,onClose:C,onCompositionStart:j,onCompositionEnd:N,taKey:w=""}=e,I=dG(null),T=dG(!1),[E,S]=dq(),k=u(),A=e=>{e.persist?.(),!T.current&&(S(e?.target?.value),e&&e.target&&"click"===e.type&&y&&y(e?.target?.value,e),v&&v(e))},R=e=>{y&&y(I.current?.value||"",e)},L=e=>{T.current||R(e)},O=()=>{I.current?.focus()};return dV(t,()=>({setValue:e=>{I.current&&(I.current.value=e,S(e),v?.({target:I.current}))},getValue:()=>I.current?.value,focus:()=>{I.current?.focus()}})),dz(()=>{let e;return l&&(e=setTimeout(O,50)),()=>{e&&clearTimeout(e)}},[l]),g.jsxs("span",{...oI.Search.searchContainer(w),style:s,className:f(a,dU.searchInput),children:[g.jsxs("span",{className:f(dU.searchInputGroup,{[dU.searchInputBorder]:m}),tabIndex:-1,children:[p&&g.jsx("span",{className:f(dU.searchInputGroupAddon),children:g.jsx(eO,{onClick:O})}),g.jsxs("span",{className:f(i,dU.inputWrapper),children:[g.jsx("input",{ref:I,className:f(n,dU.input),type:"text",placeholder:r||k.formatMessage({id:"xmcVZ0",defaultMessage:[{type:0,value:"Search"}]}),maxLength:o,onChange:A,onKeyDown:e=>{h&&e.stopPropagation(),L&&"Enter"===e.key&&L(e),_?.(e)},onBlur:e=>{M?.(e)},onFocus:e=>{b?.(e)},onCompositionStart:e=>{T.current=!0,j?.(e)},onCompositionEnd:e=>{T.current=!1,N?.(e),A(e)}}),d&&E&&g.jsx("span",{className:dU.searchInputSuffix,children:g.jsx(dj,{...oI.Search.clearBtn,className:dU.clearButton,type:"text",size:"small",onClick:()=>{x?.(),I.current?.value&&(I.current.value="",S(""))},children:g.jsx("span",{children:k.formatMessage({id:"/GCoTA",defaultMessage:[{type:0,value:"Clear"}]})})})})]})]}),c&&g.jsx(dj,{...oI.Search.closeBtn,className:f(dU.searchInputGroupAddon,dU.closable,{[dU.bordered]:!m}),icon:g.jsx(e8,{}),onClick:()=>{C?.()}})]})});function dK(e){let{...t}=e;return g.jsx(e7,{...t})}let dJ=e=>{let{className:t,eventKey:a,onClick:n,children:i,isActive:s,...r}=e;return g.jsx("div",{...ld(()=>{n(a)}),className:t,...r,children:i})};dK.Item=e7.Item,dK.Header=function(e){let{className:t,...a}=e;return g.jsx(e7.Header,{iconRenderer:e=>g.jsx(e9,{className:f("_icon_ahpo7_22",{_active_ahpo7_30:e}),"aria-hidden":"true"}),...a,className:f("_header_ahpo7_1",t),CustomHeader:dJ})},dK.Body=function(e){let{className:t,...a}=e;return g.jsx(e7.Body,{...a,className:f(t)})};let dW={isMoving:"_isMoving_1m6x2_1",tree:"_tree_1m6x2_5",endAnchor:"_endAnchor_1m6x2_15",nodeBody:"_nodeBody_1m6x2_19",parentAppend:"_parentAppend_1m6x2_25",appendAfter:"_appendAfter_1m6x2_57",appendBefore:"_appendBefore_1m6x2_86"},dY=window.React.createContext,dX=window.React.useContext,dQ=window.React.memo,dZ=window.React.useState,d1=window.React.useMemo;var d0=(e=>(e.node="node",e.parent="parent",e))(d0||{});let d2=dY({currentHover:null,currentDrag:null,dragPosition:null,getAllowDrop:()=>!0,handleDrop:ec,setHover:ec,setPosition:ec,setDrag:ec}),d5=d2.Provider,d3=dQ(function(e){let{handleDrop:t,allowDrop:a}=e,[n,i]=dZ(null),[s,r]=dZ(null),[l,o]=dZ(null),d=d1(()=>{let e=()=>!!n&&!!s&&(!a||a({dropItem:n,dragPosition:l||"down",dragItem:s}));return{getAllowDrop:e,currentHover:n,currentDrag:s,dragPosition:l,setHover:i,setPosition:o,setDrag:r,handleDrop:()=>{let a=l||"down";return e()?n?.type==="node"&&s?.type==="parent"?void 0:void(n&&s&&t({dropItem:n,dragPosition:a,dragItem:s})):void 0}}},[n,s,l,a,t,i,o,r]);return g.jsx(d5,{...e,value:d})});function d6(){return dX(d2)}let d4=window.React.useRef,d8=window.React.useCallback,d7=e=>{let{id:t,index:a,type:n,detail:i}=e,s=d6(),r=d4(null),l=d8((e,l)=>{if(!r.current)return;if(s.setDrag(e),e.id===t){s?.setHover(null),s?.setPosition(null);return}let o=r.current?.getBoundingClientRect(),d=(o.bottom-o.top)/2,c=l.getClientOffset(),u=c.y-o.top;s?.setHover({id:t,index:a,type:n,detail:i}),s?.setPosition(u>d?"down":"up")},[t,i,a,s,n]),[{handlerId:o},d]=te({accept:d0.node,collect:e=>({handlerId:e.getHandlerId()}),drop(){s?.setHover(null),s?.setPosition(null),s?.handleDrop()},hover:l}),[{isDragging:c},u]=tt({type:d0.node,item:()=>({id:t,index:a,type:n,detail:i}),end(){s?.setHover(null),s?.setPosition(null)},collect:e=>({isDragging:e.isDragging()})});return u(d(r)),{isDragging:c,ref:r,handlerId:o}},d9=e=>[...e.querySelectorAll('[role="treeitem"]')],ce=()=>{let e=e=>{let t=e.querySelector('[role="treeitem"][aria-current="page"][data-node-type="child"]');if(t)return t;let a=e.querySelector('[role="treeitem"][aria-current="page"][data-node-type="parent"]');if(a)return a;let n=d9(e),i=n[0];return i??e},t=e=>Array.from((e??document).querySelectorAll('button, [type="button"], [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')),a=()=>{let e=document.querySelector('[data-testid="active_panel"]'),a=document.querySelector('[data-testid="search_open"]'),n=t(e);n.length?n[0].focus():a?.focus()},n=e=>{let a=t(),n=Array.from(a).findIndex(t=>t===e);n>0&&n<=a.length-1&&a[n-1].focus()},i=e=>"parent"===e.getAttribute("data-node-type"),s=e=>"child"===e.getAttribute("data-node-type");return{menuAccessibilityHandler:{onKeyDownCapture(e){let t=e.currentTarget;if(e.key===sN.tab){let r=e.target,l=i(r)||s(r),o="button"===r.getAttribute("type")&&"menu"===r.getAttribute("aria-haspopup"),d=r.querySelector('[type="button"][aria-haspopup="menu"]');if(e.shiftKey){l&&(e.preventDefault(),n(t));return}(o||l&&!d)&&(e.preventDefault(),a());return}if(e.key===sN.right){let t=e.target;if("true"===t.getAttribute("aria-expanded")){let a=d9(e.currentTarget),n=Array.from(a).findIndex(e=>e===t),i=a[n+1];i&&s(i)&&i.focus()}else"false"===t.getAttribute("aria-expanded")&&t.click();return}if(e.key===sN.left){let t=e.target;if("true"===t.getAttribute("aria-expanded"))t.click();else if(s(t)){let a=d9(e.currentTarget),n=Array.from(a).findIndex(e=>e===t);for(;--n>=0;)if(i(a[n])){a[n].focus(),a[n].click();break}}return}let r=e.target,l=d9(e.currentTarget),o=Array.from(l).findIndex(e=>e===r);if(o>=0)switch(e.key){case sN.down:o=o===l.length-1?o:o+1,e.preventDefault(),l[o]?.focus();break;case sN.up:o=0===o?o:o-1,e.preventDefault(),l[o]?.focus();break;default:return}},onFocusCapture(t){t.target===t.currentTarget&&e(t.target)?.focus()}},getActiveElementByTarget:e}};function ct(e){let{handleDrop:t,allowDrop:a,...n}=e,{getActiveElementByTarget:i,menuAccessibilityHandler:s}=ce();return g.jsx(d3,{handleDrop:t,allowDrop:a,children:g.jsx(ta,{backend:tn,children:g.jsxs("ul",{className:dW.tree,tabIndex:0,role:"tree",...s,children:[g.jsx(dK,{...n}),g.jsx("span",{className:dW.endAnchor,tabIndex:0,onFocus:e=>{e.target===e.currentTarget&&i(e.target.parentElement)?.focus()}})]})})})}ct.Item=function(e){let{droppableId:t,...a}=e,{currentHover:n,currentDrag:i,dragPosition:s,getAllowDrop:r}=d6(),l=n?.id===t&&r(),o=i?.type===d0.parent&&"up"===s;return g.jsxs(g.Fragment,{children:[l&&o&&g.jsx("div",{className:dW.parentAppend}),g.jsx(dK.Item,{...a}),l&&!o&&g.jsx("div",{className:dW.parentAppend})]})},ct.Header=function(e){let{draggableId:t,detail:a,...n}=e,{isDragging:i,ref:s,handlerId:r}=d7({id:t,index:0,type:d0.parent,detail:a});return g.jsx("div",{role:"none",ref:s,className:f({[dW.isMoving]:i}),"data-handler-id":r,children:g.jsx(dK.Header,{...n})})},ct.Body=function(e){let{groupIdName:t,groupName:a,children:n,...i}=e;return g.jsx(dK.Body,{...i,children:g.jsx("ul",{role:"group",id:t,"aria-label":a,className:dW.nodeBody,children:n})})},ct.Node=function(e){let{index:t,draggableId:a,detail:n,...i}=e,{isDragging:s,ref:r,handlerId:l}=d7({id:a,index:t,type:d0.node,detail:n}),{currentHover:o,dragPosition:d,currentDrag:c,getAllowDrop:u}=d6(),m=o?.id===a&&c?.type!==d0.parent&&u();return g.jsx("li",{ref:r,role:"none",className:f({[dW.isMoving]:s,[dW.appendBefore]:m&&"up"===d,[dW.appendAfter]:m&&"down"===d}),"data-handler-id":l,children:i.children})};function ca(e){return g.jsx(ti,{...e,className:"_baseRadioGroup_1n6zz_1"})}function cn(e){return g.jsx(ts,{...e})}let ci=window.React.useCallback,cs=window.React.useMemo,cr={content:"_content_1uded_1",anchor:"_anchor_1uded_9"},cl=window.React.useCallback,co=window.React.useMemo,cd=window.ReactDOM.createPortal;function cc(e){let{children:t,content:a,trigger:n="click",className:i,defaultOpen:s,open:r,onOpenChange:l,modal:o,portalContainer:d=document.body,arrow:c,arrowClassName:u,anchorDomNode:m,...p}=e,h=cl(e=>{e!==r&&l?.(e)},[r,l]),{onMouseEnter:y,onMouseLeave:v}=function(e){let{delay:t,onHoverChange:a}=e,n=cs(()=>tr(a,t),[a,t]),i=ci(()=>{n(!0)},[n]),s=ci(()=>{n(!1)},[n]);return{onMouseEnter:i,onMouseLeave:s}}({delay:200,onHoverChange:h}),_=cl(e=>{e.preventDefault()},[]),b=cl(e=>{[sN.enter,sN.space].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),l?.(!0))},[l]),M="click"===n,x=co(()=>m?cd(g.jsx(tl,{className:cr.anchor}),m):null,[m]);return g.jsxs(to,{defaultOpen:s,open:r,modal:o,onOpenChange:l,children:[g.jsx(td,{asChild:!0,onMouseEnter:M?void 0:y,onMouseLeave:M?void 0:v,onClick:M?void 0:_,onKeyDown:M?void 0:b,children:t}),x,g.jsx(tc,{container:d,children:g.jsxs(tu,{onClick:e=>e.stopPropagation(),...p,onMouseEnter:M?void 0:y,onMouseLeave:M?void 0:v,className:f(cr.content,i),children:[a,c&&g.jsx(tm,{className:u})]})})]})}let cu={tagSelect:"_tagSelect_1b8lf_1",active:"_active_1b8lf_33",hidden:"_hidden_1b8lf_37",placeholder:"_placeholder_1b8lf_44",icon:"_icon_1b8lf_50"},cm=window.React.forwardRef,cp=window.React.useState,ch=cm(function(e,t){let{hidden:a,checked:n,onChange:i,children:s}=e,[r,l]=cp(n);return g.jsx("button",{ref:t,className:f(cu.tagSelect,{[cu.hidden]:a,[cu.active]:r}),onClick:()=>{let e=!r;l(e),i?.(e)},children:g.jsx("span",{className:cu.placeholder,children:s})})}),cf={content:"_content_1ippg_1",subContent:"_subContent_1ippg_2",item:"_item_1ippg_15",separator:"_separator_1ippg_29"},cg=t_,cy=tb,cv=r4(tv,{asChild:!0}),c_=r4(tp,{className:cf.content}),cb=r4(th,{className:cf.item}),cM=r4(tf,{className:cf.separator}),cx=tM,cC=r4(tg,{className:cf.item}),cj=r4(ty,{className:cf.subContent}),cN={content:"_content_1jdqt_1",search:"_search_1jdqt_8",searchInputWrapper:"_searchInputWrapper_1jdqt_11",options:"_options_1jdqt_14",option:"_option_1jdqt_14",optionIndicator:"_optionIndicator_1jdqt_43"},cw=window.React.useEffect,cI=window.React.useMemo,cT=window.React.useState;function cE(e){let{value:t,defaultValue:a,loading:n=!1,showSearch:i=!1,placeholder:s,options:r=[],children:l,portalContainer:o=document.body,dropDownWidth:d,searchFixedOptions:c=[],onChange:u,onSearch:m,onDropDownOpenChange:p}=e,[h,y]=cT(!1),[v,_]=cT(a),[b,M]=cT(r),x=cI(()=>b.find(e=>e.value===v),[v,b]);cw(()=>{r&&M(r)},[r]),cw(()=>{t&&t!==v&&_(t)},[t]);let C=e=>()=>{u?.(e.value,e),_(e.value),y(!1),p?.(!1)},j=cI(()=>tr(e=>{m?.(e.target.value)},500),[m]);return g.jsxs(cg,{open:h,onOpenChange:e=>{if(e&&i){let e=[],t=[...r,...c];t.forEach(t=>{let a=e.some(e=>e.value===t.value);a||e.push(t)}),M(e)}y(e),p?.(e)},children:[g.jsx(cv,{children:(()=>l||g.jsxs("button",{className:f(cu.tagSelect,{[cu.active]:!!(x?.value&&!x?.alias)}),children:[g.jsx("span",{className:cu.placeholder,children:x?.alias??x?.label??s}),g.jsx(tC,{className:cu.icon})]}))()}),g.jsx(cy,{container:o,children:g.jsxs(c_,{className:cN.content,style:{width:d},sideOffset:5,align:"start",children:[i&&g.jsx(d$,{className:cN.search,autoFocus:!0,showSearch:!1,allowClear:!1,bordered:!0,inputWrapperClassName:cN.searchInputWrapper,onChange:j}),g.jsx(e4,{loading:n,children:g.jsx("div",{className:cN.options,children:b.map(e=>g.jsxs(cb,{className:cN.option,onClick:C(e),children:[g.jsx("span",{children:e.label}),x?.value===e.value&&g.jsx(tx,{className:cN.optionIndicator})]},e.value))})})]})})]})}cE.TagSelect=ch;let cS=tS,ck=tk,cA=r4(tE,{asChild:!0}),cR=r4(tj,{className:cf.content}),cL=r4(tN,{className:cf.item}),cO=r4(tw,{className:cf.separator}),cD=tA,cP=r4(tI,{className:cf.item}),cF=r4(tT,{className:cf.content});function cB(e){let{className:t,...a}=e;return g.jsx(tR,{...a,className:f(t,"_datePicker_x7hac_1")})}function cU(e){let{className:t,...a}=e;return g.jsx(tL,{...a,className:f(t,"_timePicker_3q98v_1")})}let cH=window.React.useCallback;function cz(e){let{checked:t,disabled:a,onChange:n,ariaLabel:i,...s}=e,r=cH((e,t)=>e?t?g.jsx(sJ,{}):g.jsx(s$,{}):t?g.jsx(sK,{}):g.jsx(sq,{}),[]);return g.jsx(tO,{className:"_checkbox_i3kjl_1",...s,checked:t,disabled:a,onCheckedChange:n,"aria-label":i,children:g.jsx(tD,{className:"_indicator_i3kjl_31",forceMount:!0,children:r(!!t,!!a)})})}let cV={radioGroupRoot:"_radioGroupRoot_rhb8i_1",radioGroupLabel:"_radioGroupLabel_rhb8i_5",radioGroup:"_radioGroup_rhb8i_1",radio:"_radio_rhb8i_1",radioText:"_radioText_rhb8i_47",radioGroupSubLabel:"_radioGroupSubLabel_rhb8i_53"},cG=window.React.useCallback;function cq(e){let{options:t=[],value:a,onChange:n,disabled:i,className:s,labelClassName:r,textClassName:l,ariaLabel:o,showLabel:d=!0,...c}=e,u=cG((e,t)=>e?t?g.jsx(sG,{}):g.jsx(sz,{}):t?g.jsx(sV,{}):g.jsx(sH,{}),[]),m=cG((e,t,a)=>t&&a?`${a}, ${e}, ${t}`:t&&!a?`${e}, ${t}`:!t&&a?`${a}, ${e}`:e,[]);return g.jsx(tP,{className:f(cV.radioGroupRoot,s),value:a,onValueChange:n,...c,children:t.map(e=>g.jsxs("label",{className:f(cV.radioGroupLabel,r),children:[g.jsxs("span",{className:cV.radioGroup,children:[g.jsx(tF,{value:e.value,className:cV.radio,disabled:i,"aria-label":m(e.label,e.subLabel,o),...e.name?oI.Form.formField(e.name):{},children:g.jsx(tB,{forceMount:!0,children:u(a===e.value,!!i)})}),d&&g.jsx("span",{className:f(cV.radioText,l),children:e.label})]}),e.subLabel&&g.jsx("p",{className:f(cV.radioGroupSubLabel,l),children:e.subLabel})]},e.value))})}let c$={switchButtonWrapper:"_switchButtonWrapper_1jliv_1",switchButton:"_switchButton_1jliv_1",active:"_active_1jliv_33",switcher:"_switcher_1jliv_38"};function cK(e){let{options:t,activeKey:a,onChange:n}=e,{$t:i}=rV(),s=e=>e===a?i({id:"LtTjKV",defaultMessage:[{type:0,value:"selected"}]}):i({id:"fboXJN",defaultMessage:[{type:0,value:"unselected"}]}),r=e=>{e!==a&&n(e)};return g.jsxs("div",{className:c$.switchButtonWrapper,children:[t.map((e,n)=>g.jsx("button",{"aria-label":i({id:"rIADF9",defaultMessage:[{type:1,value:"optionText"},{type:0,value:", "},{type:1,value:"selectedState"},{type:0,value:", "},{type:1,value:"position"}]},{optionText:e.text,selectedState:s(e.key),position:`${n} of ${t.length}`}),className:f(c$.switchButton,{[c$.active]:a===e.key}),onClick:()=>{r(e.key)},children:e.text},e.key)),g.jsx("div",{className:f(c$.switcher,c$.switchButton),style:{width:`calc(100% / ${t.length})`,transform:`translateX(calc(100% * ${t.findIndex(e=>e.key===a)}))`}})]})}let cJ={dropdownMenuItem:"_dropdownMenuItem_zu6ht_1",menuItemLabel:"_menuItemLabel_zu6ht_7",menuItemLabelSubText:"_menuItemLabelSubText_zu6ht_7",checkedIndicator:"_checkedIndicator_zu6ht_13",danger:"_danger_zu6ht_17",primary:"_primary_zu6ht_20",subIndicator:"_subIndicator_zu6ht_27",dropdownMenuSubTrigger:"_dropdownMenuSubTrigger_zu6ht_32",menuGroupTitle:"_menuGroupTitle_zu6ht_60"},cW=window.React.Fragment,cY=e=>{let{groupTitle:t}=e;return t?g.jsx("p",{className:cJ.menuGroupTitle,children:t}):null},cX=e=>{let{text:t,subText:a}=e;return g.jsxs("div",{className:cJ.menuItemLabel,children:[g.jsx("span",{className:cJ.menuItemLabelText,children:t}),a&&g.jsx("span",{className:cJ.menuItemLabelSubText,children:a})]})},cQ=e=>{let{className:t,open:a,onOpenChange:n,portalContainer:i=document.body,side:s,sideOffset:r,align:l,children:o,options:d=[],disabled:c,onInteractOutside:u}=e,m=e=>()=>{e.operate?.(e)},p=e=>Array.isArray(e.children)&&e.children.length>0?g.jsxs(cW,{children:[g.jsxs(cx,{children:[g.jsxs(cC,{...e.testKey?oI.Dropdown[e.testKey]:{},className:cJ.dropdownMenuSubTrigger,disabled:e.disabled||e.checked,children:[g.jsx(cX,{text:e.text,subText:e.subText}),g.jsx(tU,{className:cJ.subIndicator})]}),g.jsx(cy,{container:i,children:g.jsx(cj,{className:f(t),children:e.children.map(e=>p(e))})})]}),e.separator&&g.jsx(cM,{})]},e.key):g.jsxs(cW,{children:[g.jsx(cY,{groupTitle:e.groupTitle}),g.jsxs(cb,{...e.testKey?oI.Dropdown[e.testKey]:{},className:f(cJ.dropdownMenuItem,{[cJ.danger]:e.danger,[cJ.primary]:e.primary}),disabled:e.disabled||e.checked,onClick:m(e),children:[g.jsx(cX,{text:e.text,subText:e.subText}),e.checked&&g.jsx(tH,{className:cJ.checkedIndicator})]}),e.separator&&g.jsx(cM,{})]},e.key),h=e=>e.filter(e=>!e.invisible).map((e,t,a)=>{let n=t===a.length-1?{...e,separator:!1}:e;return Array.isArray(n.children)?{...n,children:h(n.children)}:n}),y=h(d);return g.jsxs(cg,{open:a,onOpenChange:n,children:[g.jsx(cv,{className:cJ.trigger,disabled:c,children:o}),g.jsx(cy,{container:i,children:g.jsx(c_,{className:t,onClick:e=>e.stopPropagation(),side:s,sideOffset:r,align:l,onKeyDown:e=>{e.stopPropagation()},onInteractOutside:u,children:g.jsx(g.Fragment,{children:y.map(e=>p(e))})})})]})},cZ={sliderContainer:"_sliderContainer_8p17x_1",iconItem:"_iconItem_8p17x_11",icon:"_icon_8p17x_11",sliderItem:"_sliderItem_8p17x_26",sliderRoot:"_sliderRoot_8p17x_31",sliderTrack:"_sliderTrack_8p17x_39",sliderRange:"_sliderRange_8p17x_52",sliderThumb:"_sliderThumb_8p17x_58",tooltip:"_tooltip_8p17x_71",arrow:"_arrow_8p17x_76"};function c1(e){let{min:t,max:a,step:n,value:i,onChange:s,onStartClick:r,onEndClick:l}=e,{$t:o}=rV();return g.jsxs("div",{className:cZ.sliderContainer,children:[g.jsx("button",{...oI.Main.imgZoomMin,className:cZ.iconItem,"aria-label":o({id:"/UnJ3S",defaultMessage:[{type:0,value:"Zoom out"}]}),onClick:r,children:g.jsx(dA,{className:cZ.tooltip,content:o({id:"/UnJ3S",defaultMessage:[{type:0,value:"Zoom out"}]}),arrowVisible:!0,arrowClassName:cZ.arrow,side:"top",children:g.jsx(tz,{className:cZ.icon})})}),g.jsx("div",{...oI.Main.imgSliderItem,className:cZ.sliderItem,children:g.jsxs(tV,{className:cZ.sliderRoot,min:t,max:a,step:n,value:[i],"aria-label":o({id:"34imV/",defaultMessage:[{type:0,value:"Zoom Value"}]}),onValueChange:e=>{let[t]=e;s(t)},children:[g.jsx(tG,{className:cZ.sliderTrack,children:g.jsx(tq,{className:cZ.sliderRange})}),g.jsx(dA,{className:cZ.tooltip,content:`${i}%`,arrowVisible:!0,arrowClassName:cZ.arrow,side:"top",children:g.jsx(t$,{className:cZ.sliderThumb})})]})}),g.jsx("button",{...oI.Main.imgZoomMax,className:cZ.iconItem,"aria-label":o({id:"xbi38c",defaultMessage:[{type:0,value:"Zoom in"}]}),onClick:l,children:g.jsx(dA,{className:cZ.tooltip,content:o({id:"xbi38c",defaultMessage:[{type:0,value:"Zoom in"}]}),arrowVisible:!0,arrowClassName:cZ.arrow,side:"top",children:g.jsx(tK,{className:cZ.icon})})})]})}let c0=window.React.useRef;function c2(e){let t=tJ(e),a=c0(null),{gridProps:n}=tW(e,t,a);return g.jsx("ul",{className:e.className,...n,ref:a,children:[...t.collection].map(a=>g.jsx(c5,{className:e.itemClassName,item:a,state:t},a.key))})}function c5(e){let{item:t,state:a,className:n}=e,i=c0(null),{rowProps:s,gridCellProps:r}=tY({node:t},a,i),{focusProps:l}=tX();return g.jsx("li",{className:n,...tQ(s,l),ref:i,children:g.jsx("div",{...r,children:t.rendered})})}let c3={editorSend:"_editorSend_13533_1",editorTool:"_editorTool_13533_5"},c6=r4(dj,{className:c3.editorSend}),c4=r4(dj,{className:c3.editorTool}),c8=e=>{let{active:t,handleFormatting:a,children:n,...i}=e,{$t:s}=rV();return g.jsx(c4,{className:f("_formatButton_aesc3_1",{_active_aesc3_10:t}),type:"text",size:"small",icon:g.jsx(sP,{className:"_icon_aesc3_6","aria-label":s({id:"zQLEfz",defaultMessage:[{type:0,value:"Format"}]})}),onClick:a,"aria-expanded":!!t,...i,children:n})},c7=du(tZ,dr.emoji),c9=du(t1,dr.giphy),ue=du(t0,dr.file),ut=du(t2,dr.file),ua=t5([t3,t6,t4,t8,t7]),un=window.React.memo,ui=un(function(e){let{appButtons:t,disabledFeatures:a=[],innerRef:n,theme:i,handleCloud:s,...r}=e,{$t:l}=rV(),o=g.jsx(db,{...oI.Main.chatBox,ref:n,...r,className:"_chatInputBox_42uxp_1",children:e=>{let{isEmpty:a,formatting:n,handleFormatting:r,handleEnter:o,processFiles:d,handleEmojiSelect:c,handleGiphySelect:u,giphyConfig:m,handleSkinToneChange:p,emojiSkinTone:h,handleScreenshotError:f}=e;return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"_buttons_42uxp_4",children:[g.jsx(c8,{...oI.Main.formatBtn("chat"),active:n,handleFormatting:r}),g.jsx(c7,{theme:i,frqUniqId:da,skinToneLabel:l({id:"KnFtPn",defaultMessage:[{type:0,value:"Change Skin Tone"}]}),skinTone:h,onSkinToneChange:p,onPick:c,taKey:"chat",crossOrigin:"anonymous"}),g.jsx(c9,{theme:i,onPick:u,config:m,taKey:"chat",lang:rK()}),g.jsx(ue,{taKey:"chat",onFiles:d,handleCloud:s,lang:rK()}),g.jsx(ut,{lang:rK(),taKey:"chat",onError:f,onScreenshot:e=>d([e])}),t]}),g.jsx(c6,{...oI.Main.sendBtn,size:"small",className:"_placeEnd_42uxp_11",disabled:a,type:"primary",icon:g.jsx(t9,{}),onClick:o})]})}});return g.jsx(dd,{value:a,children:g.jsx(ua,{value:oI,children:o})})}),us=window.React.memo,ur=us(function(e){let{appButtons:t,disabledFeatures:a=[],baseEditorRef:n,onReply:i,handleCloud:s,...r}=e,{$t:l}=rV(),o=g.jsx(db,{...oI.Main.replyChatBox,ref:n,...r,className:"_replyInputBox_1xevw_1",menuBarClassName:"_menuBar_1xevw_15",onSend:i,children:e=>{let{isEmpty:a,formatting:n,handleFormatting:i,handleEnter:r,processFiles:o,handleEmojiSelect:d,handleGiphySelect:c,giphyConfig:u,handleSkinToneChange:m,emojiSkinTone:p,handleScreenshotError:h}=e;return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"_buttons_1xevw_9",children:[g.jsx(c8,{...oI.Main.formatBtn("reply"),active:n,handleFormatting:i}),g.jsx(c7,{frqUniqId:da,skinTone:p,skinToneLabel:l({id:"KnFtPn",defaultMessage:[{type:0,value:"Change Skin Tone"}]}),onSkinToneChange:m,onPick:d,taKey:"reply",crossOrigin:"anonymous"}),g.jsx(c9,{onPick:c,config:u,lang:rK(),taKey:"reply"}),g.jsx(ue,{onFiles:o,handleCloud:s,taKey:"reply",lang:rK()}),g.jsx(ut,{taKey:"reply",lang:rK(),onError:h,onScreenshot:e=>o([e])}),t]}),g.jsx(c6,{...oI.Main.replySendBtn,size:"small",className:"_placeEnd_1xevw_23",disabled:a,type:"primary",icon:g.jsx(t9,{}),onClick:r})]})}});return g.jsx(dd,{value:a,children:g.jsx(ua,{value:oI,children:o})})}),ul=window.React.memo,uo=window.React.useCallback,ud=ul(function(e){let{disabledFeatures:t=[],onClose:a,onEdit:n,handleCloud:i,...s}=e,{$t:r}=rV(),l=uo(e=>{n(e)},[n]),o=g.jsx(db,{...oI.Main.editChatBox,...s,className:"_editInputBox_1dyir_1",menuBarClassName:"_menuBar_1dyir_16",onSend:l,children:e=>{let{isEmpty:t,formatting:n,handleFormatting:s,handleEnter:l,processFiles:o,handleEmojiSelect:d,handleGiphySelect:c,giphyConfig:u,handleSkinToneChange:m,emojiSkinTone:p,handleScreenshotError:h}=e;return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"_buttons_1dyir_10",children:[g.jsx(c8,{...oI.Main.formatBtn("edit"),active:n,handleFormatting:s}),g.jsx(c7,{frqUniqId:da,skinToneLabel:r({id:"KnFtPn",defaultMessage:[{type:0,value:"Change Skin Tone"}]}),skinTone:p,onSkinToneChange:m,onPick:d,crossOrigin:"anonymous",taKey:"edit"}),g.jsx(c9,{onPick:c,config:u,lang:rK(),taKey:"edit"}),g.jsx(ue,{onFiles:o,handleCloud:i,taKey:"edit",lang:rK()}),g.jsx(ut,{lang:rK(),taKey:"edit",onError:h,onScreenshot:e=>o([e])})]}),g.jsxs("div",{className:"_actions_1dyir_20",children:[g.jsx(c6,{...oI.Main.editSendBtn,size:"small",disabled:t,type:"primary",icon:g.jsx(tx,{"aria-label":r({id:"jvo0vs",defaultMessage:[{type:0,value:"Save"}]})}),onClick:l}),g.jsx(c6,{size:"small",icon:g.jsx(ae,{}),onClick:a})]})]})}});return g.jsx(dd,{value:t,children:g.jsx(ua,{value:oI,children:o})})});function uc(e){return e===o4.chat?!!window.pwaChatConfig.isChatEnabled:!!window.pwaChatConfig[e]}function uu(){return l3(()=>r([!uc(o4.emoji)&&o8.emoji,!uc(o4.giphy)&&o8.giphy,!uc(o4.file)&&o8.file]),[])}let um=e_().schema(()=>({canStartPhoneCall:eb.boolean(),isNoMeetingsLicenseTypeUser:eb.boolean()})).views(()=>({get isMioLicensedUser(){return!!window.pwaChatConfig?.isMioLicensedUser}})).mutations(e=>({setCanStartPhoneCall(t){e.canStartPhoneCall=t}})),up=um.create({canStartPhoneCall:!1,isNoMeetingsLicenseTypeUser:!o3()||!!window.rawWindow?.PwaConfig.isNoMeetingsLicenseTypeUser}),uh=null;var uf=(e=>(e.EXPIRED="WEB_SESSION_EXPIRED",e.CONFLICT="XMPP_SESSION_CONFLICT",e.REVOKE_TOKEN="XMPP_SESSION_REVOKE_TOKEN",e.ROUTE_TO_CHAT="ROUTE_TO_CHAT",e.START_MEETING="START_MEETING",e.START_PHONE_CALL="START_PHONE_CALL",e.CHAT_APP_READY="CHAT_APP_READY",e.CHANNEL_MEETING_REQ="CHANNEL_MEETING_REQ",e.UNREAD_COUNT="UNREAD_COUNT",e.JOIN_MEETING="JOIN_MEETING",e.OPEN_SETTING="OPEN_SETTING",e.PMC_TIPS_CLOSE="PMC_TIPS_CLOSE",e))(uf||{});let ug="No SDK connection available.",uy=(e,t)=>{let a=e=>{let t=Object.values(window.pwaChatConfig?.appAllowMap??{});return t.some(t=>{if(t.indexOf("*")>-1){let a=t.replace("*",".*"),n=new RegExp(a);return n.test(e)}return t===e})},n=r(e);return n.filter(e=>!rE(e[t])||a(e[t]))},uv=new class{destroy(){return this.checkAlive(this.connection?.destroy)().then(()=>{this.connection=null})}logPerformance(e,t){var a=this;return function(){for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];let r=fS.now();return t?.call(a.connection,...i).then(t=>(fS.logMeasure(e,{start:r,tags:[fk.HTTP]}),t))}}checkAlive(e){var t=this;return function(){for(var a=arguments.length,n=Array(a),i=0;i<a;i++)n[i]=arguments[i];return t.connection&&e?e.call(t.connection,...n).catch(e=>{throw e instanceof ar?fS.error(e.errorCode+" : "+e.errorInfo):e instanceof Error&&fS.error(e.message),e}):(fS.error(ug),Promise.reject(Error(ug)))}}on(e,t){this.connection?this.connection.on(e,(e,a)=>{e?console.error(e):t(a)}):console.error(ug)}off(e,t){this.connection?this.connection.off(e,t):console.error(ug)}constructor(){this.connection=function(){{if(!uc(o4.chat))return null;let{jid:e,testChannelId:t,giphyKey:a,giphyImageSize:i,giphyPreload:s,xmppWsDomain:r,webDomain:o,fileServerDomain:d,fileImageServerDomain:c,mpApiUrl:u,microServiceDomain:m,asyncDomain:p,imMultipleResourceEnable:h,currentStorageType:f,storageDomain:g,integrationDomain:y,marketplaceDomains:v,accountId:_,nwsDomain:b,appAllowMap:M}=window.pwaChatConfig||{},x="box"===f?an.chatBoxStorage:f;return n.init({ws:`wss://${r}:443/xmpp-websocket`,jid:e,giphyKey:a,giphyImageSize:i||ai.pc,giphyPreload:s,channelJid:t,fetchAllTokenInfo:function(){let e=null;return()=>{let t=aa({tokenType:"all",deviceId:r3.get(rQ.deviceId),cachedResourceId:e},l);return at.post("/chat/token",t).then(t=>{let{data:a}=t;if(a?.errorCode===201)return o6({type:uf.EXPIRED}),o3()||window.location.reload(),a.result;let{deviceId:n,resourceId:i}=a.result||{};return n&&r3.set(rQ.deviceId,n),i&&(e=i),a.result}).catch(e=>{throw console.error(e),e})}}(),webServerDomain:o,xmsServerDomain:m,fileServerDomain:d,imageServerDomain:c,marketPlaceServerDomain:u.replace(/\/$/,""),asyncServerDomain:p,pwaServerDomain:window.location.origin,multiDeviceEnable:h,browserMode:as.regular,nativeClientData:{deviceName:function(){switch(!0){case P():return"Edge";case D():return"Firefox";case sk:return"Safari";case O():return"Opera";case L():return"Chrome";case R():return"Chromebook";default:return""}}()},currentStorageType:x,storageDomain:g,integrationDomain:y,marketPlaceDomain:v?.marketplaceUrl??"",orgUnit:_,nwsServerDomain:b,appAllowMap:M})}}(),this.query={fetchHistoryMsgs:this.checkAlive(this.connection?.fetchHistoryMsgs),fetchMsgByTimes:this.checkAlive(this.connection?.fetchMsgByTimes),fetchHistoryComments:this.checkAlive(this.connection?.fetchHistoryComments),jumpFetchHistoryMsgs:this.checkAlive(this.connection?.jumpFetchHistoryMsgs),fetchEmojiVoteList:this.checkAlive(this.connection?.fetchEmojiVoteList),fetchGiphyList:this.checkAlive(this.connection?.fetchGiphyList),searchGiphyList:this.checkAlive(e=>{let{queryString:t,limit:a}=e;return this.connection.searchGiphyList(t,a,window.pwaChatConfig.giphyRating||"G")}),fetchVCard:this.checkAlive(e=>this.connection.fetchVcard(...e)),fetchRecentChats:this.checkAlive(async()=>{let e=await this.connection.fetchRecentChats();return e.filter(e=>!rE(e.jid))}),fetchHistoryLastMsg:this.checkAlive(this.connection?.fetchHistoryLastMsg),fetchHistoryLatestMainMsg:this.checkAlive(this.connection?.fetchLatestMainMsgs),fetchChannelRecentInfo:this.checkAlive(this.connection?.fetchChannelRecentInfo),fetchChatRecentInfo:this.checkAlive(this.connection?.fetchChatRecentInfo),fetchChannelPreviewInfo:this.checkAlive(this.connection?.fetchChannelPreviewInfo),fetchChannelList:this.checkAlive(this.connection?.fetchChannelList),getStarred:this.checkAlive(async e=>{let t=await this.connection.getStarred(e);return uy(t,"jid")}),fetchUserRoles:this.checkAlive(this.connection?.fetchUserRoles),searchChannelMembers:this.checkAlive(this.connection?.searchChannelMembers),fetchAppCmdInfo:this.checkAlive(this.connection?.fetchAppCmdInfo),getChannel:this.checkAlive(this.connection?.fetchChannelInfo),fetchSearch:this.checkAlive(this.connection?.fetchSearch),queryPresences:this.checkAlive(e=>Promise.resolve(this.connection.queryPresences(e))),subscribePresences:this.checkAlive(e=>Promise.resolve(this.connection.subscribe(e))),fetchSearchAll:this.checkAlive(e=>this.connection.fetchSearch(al.ALL,e)),fetchSearchContacts:this.checkAlive(async e=>{let t=await this.connection.fetchSearch(al.CONTACT,e);return t.data.data=uy(t.data.data,"jid"),t}),fetchSearchChannels:this.checkAlive(e=>this.connection.fetchSearch(al.CHANNEL,e)),fetchSearchMessages:this.checkAlive(e=>this.connection.fetchSearch(al.MESSAGE,e)),fetchSearchFiles:this.checkAlive(e=>this.connection.fetchSearch(al.FILE,e)),getFolderList:this.checkAlive(async()=>{let e=await this.connection.getFolderList();return e.map(e=>(e.members=uy(e.members,"objid"),e))}),getFolderMembers:this.checkAlive(e=>{let{folderID:t,memberList:a}=e;return this.connection.getFolderMembers(t,a)}),getImageThumbnailUrl:this.checkAlive(this.connection?.getImageThumbnailUrl),fetchMembers:this.checkAlive(this.connection?.fetchMembers),fetchPendingExtMembers:this.checkAlive(this.connection?.fetchPendingExtMembers),fetchSpecialMembers:this.checkAlive(this.connection?.fetchSpecialMembers),fetchBookmark:this.checkAlive(this.connection?.fetchBookmark),fetchMessageByBookmark:this.checkAlive(this.connection?.fetchMessageByBookmark),getAllReminderMessages:this.checkAlive(this.connection?.getAllReminderMessages),fetchContactRequestList:this.checkAlive(this.connection?.fetchContactRequestList),fetchClassificationList:this.checkAlive(this.connection?.fetchClassificationList),fetchPinMsgList:this.checkAlive(e=>this.connection.fetchPinMsgList(e)),fetchBlockList:this.checkAlive(this.connection?.fetchBlockList),getUserNotify:this.checkAlive(this.connection?.getUserNotify),getChannelNotify:this.checkAlive(this.connection?.getChannelNotify),getMuteChannel:this.checkAlive(this.connection?.getMuteChannel),fetchMUCByIds:this.checkAlive(this.connection?.searchMucByJids),fetchImageMsgFile:this.checkAlive(this.connection?.fetchMsgFile.fetchImageMsgFile),fetchCodeSnippetMsgFile:this.checkAlive(this.connection?.fetchMsgFile.fetchCodeSnippetMsgFile),fetchGiphyMsgFile:this.checkAlive(this.connection?.fetchMsgFile.fetchGiphyMsgFile),checkMsgPolicy:this.checkAlive(e=>Promise.resolve(this.connection.checkEtiquettePolicy(e))),searchChannelAndUser:this.checkAlive(this.connection?.searchChannelAndUser),fetchTopPin:this.checkAlive(e=>this.connection.fetchTopPin(e)),fetchMentionGroups:this.checkAlive(this.connection?.fetchMentionGroups),fetchMentionGroupMembers:this.checkAlive(this.connection?.fetchMentionGroupMembers),fetchExternalResource:this.checkAlive(async()=>{let e=await this.connection.fetchExternalResource();return e.appList=e.appList.map(e=>(e.apps=uy(e.apps,"jid"),e)),e}),fetchMioAppList:this.checkAlive(this.connection?.fetchMioAppList),fetchInstalledChatAppInfo:this.checkAlive(this.connection?.fetchInstalledChatAppInfo),fetchAppDoc:this.checkAlive(this.connection?.fetchAppDoc)},this.mutation={changeChannel:this.checkAlive(e=>this.connection.changeChannel(e)),changeSelfPresenceType:this.checkAlive(e=>{let{presenceType:t,options:a}=e;return this.connection.changeSelfPresenceType(t,a),Promise.resolve()}),batchSyncRecentChat:this.checkAlive(this.connection.batchSyncRecentChat),sendMessage:this.logPerformance("sendMessage",this.checkAlive(async e=>this.connection.sendMessage(e))),sendCloudFile:this.logPerformance("sendCloudFile",this.checkAlive(e=>{let{thirdPartyInfo:t,...a}=e;return this.connection.sendMessage(a,t)})),editMessage:this.checkAlive(this.connection?.editMessage),sendImage:this.logPerformance("sendImage",this.checkAlive(this.connection?.sendImage)),sendScreenshot:this.logPerformance("sendScreenshot",this.checkAlive(this.connection?.sendScreenshot)),sendGiphy:this.logPerformance("sendGiphy",this.checkAlive(this.connection?.sendGiphy)),sendFile:this.logPerformance("sendFile",this.checkAlive(this.connection?.sendFile)),sendMixMsg:this.logPerformance("sendMixMessage",this.checkAlive(async e=>this.connection.sendMessage(e))),sendAppMessage:this.logPerformance("sendAppMessage",this.checkAlive(async e=>this.connection.sendMessage(e))),downloadFile:this.checkAlive(this.connection?.downloadFile),revokeMessage:this.checkAlive(this.connection?.revokeMessage),markMsgRead:this.checkAlive(this.connection?.markMsgRead),setEmojiVote:this.checkAlive(this.connection?.setEmojiVote),pinMsg:this.checkAlive(this.connection?.pinMsg),unpinMsg:this.checkAlive(this.connection?.unpinMsg),removePinMsg:this.checkAlive(this.connection?.removePinMsg),transferOwner:this.checkAlive(this.connection?.assignAdmin),assignAdmin:this.checkAlive(this.connection?.changeChannelAdmin),createChannel:this.logPerformance("createChannel",this.checkAlive(this.connection?.createChannel)),updateChannel:this.checkAlive(this.connection?.updateChannel),deleteChannel:this.checkAlive(this.connection?.deleteChannel),leaveChannel:this.checkAlive(this.connection?.leaveChannel),joinChannel:this.checkAlive(this.connection?.joinChannel),createChat:this.logPerformance("createChat",this.checkAlive(this.connection?.createChat)),createMUC:this.logPerformance("createMUC",this.checkAlive(this.connection?.createMUC)),updateMUC:this.checkAlive(this.connection?.updateMUC),deleteMUC:this.checkAlive(this.connection?.deleteMUC),leaveChat:this.checkAlive(this.connection?.leaveChat),leaveAndAssignChannel:this.checkAlive(this.connection?.leaveAndAssignChannel),leaveAndAssignChat:this.checkAlive(this.connection?.leaveAndAssignChat),addMember:this.checkAlive(this.connection?.addMember),removeMember:this.checkAlive(this.connection?.kickMember),removeInvitation:this.checkAlive(this.connection?.removeInvitation),updateChannelDesc:this.checkAlive(this.connection?.changeDesc),downloadSearchFile:this.checkAlive(this.connection?.downloadSearchFile),createFolder:this.checkAlive(this.connection?.createFolder),deleteFolder:this.checkAlive(this.connection?.deleteFolder),updateFolder:this.checkAlive(this.connection?.updateFolder),addMemberToFolder:this.checkAlive(this.connection?.addMemberToFolder),deleteMemberFromFolder:this.checkAlive(this.connection?.deleteMemberFromFolder),updateFolderMembers:this.checkAlive(this.connection?.updateFolderMembers),star:this.checkAlive(this.connection?.star),unStar:this.checkAlive(this.connection?.unStar),markMsgAsUnread:this.checkAlive(e=>this.connection.markUnread(ao.MESSAGE,e)),markChatAsUnread:this.checkAlive(e=>this.connection.markUnread(ao.CHAT,e)),bookmark:this.checkAlive(e=>{let{id:t,timeframe:a}=e;return this.connection.bookmark(t,a)}),removeBookmark:this.checkAlive(e=>{let{id:t,timeframe:a}=e;return this.connection.unmark(t,a)}),linkToBase64:this.checkAlive(this.connection?.linkToBase64),setReminder:this.checkAlive(this.connection?.setReminder),closeReminder:this.checkAlive(this.connection?.closeReminder),readReminder:this.checkAlive(this.connection?.readReminder),addBuddyByEmail:this.checkAlive(this.connection?.addBuddyByEmailToXmpp),addBuddyByJID:this.checkAlive(this.connection?.addBuddyByJID),removeBuddy:this.checkAlive(this.connection?.removeBuddy),unSubscribedByJid:this.checkAlive(e=>{let{jid:t,name:a}=e;return this.connection.unSubscribedByJid(t,a)}),subscribeByJid:this.checkAlive(this.connection?.subscribeByJid),syncAllSubScribeReqAsReaded:this.checkAlive(this.connection?.syncAllSubScribeReqAsReaded),addDataToStorage:this.checkAlive(this.connection?.addDataToStorage),deleteContactReq:this.checkAlive(this.connection?.deleteContactReq),block:this.checkAlive(this.connection?.block),unblock:this.checkAlive(this.connection?.unblock),setUserNotify:this.checkAlive(this.connection?.setUserNotify),setChannelNotify:this.checkAlive(e=>{let{notifyChannels:t,action:a}=e;return this.connection.setChannelNotify(t,a)}),setMuteChannel:this.checkAlive(this.connection?.setChannelMute),setChannelUnMute:this.checkAlive(this.connection?.setChannelUnMute),createMentionGroup:this.checkAlive(this.connection?.createMentionGroup),deleteMentionGroup:this.checkAlive(this.connection?.deleteMentionGroup),updateMentionGroup:this.checkAlive(this.connection?.updateMentionGroup),joinMentionGroup:this.checkAlive(this.connection?.joinMentionGroup),leaveMentionGroup:this.checkAlive(this.connection?.leaveMentionGroup),addMioAppToChannel:this.checkAlive(this.connection?.addMioAppToChannel),removeMioAppFromChannel:this.checkAlive(this.connection?.removeMioAppFromChannel)}}};function u_(e){return new Promise(t=>{e.length<3&&t([]),uv.query.fetchSearch(al.CONTACT,{sourceType:4,keyword:e,contactType:"0"}).then(e=>t(e?.data?.data||[])).catch(()=>{t([])})})}function ub(e,t){if(!("Notification"in window)){t?.(Error("this browser does not support desktop notification"));return}if("granted"===Notification.permission){e("granted");return}if(sk){Notification.requestPermission(()=>{setTimeout(()=>{e(Notification.permission)},350)});return}Notification.requestPermission().then(e).catch(t)}let uM=`${window.pwaChatConfig.chatCdnCommonLibPath}/favicon.ico`;class ux{constructor(){this._defaultOptions={icon:uM,badge:uM},this._notification=window.Notification,this._instance=null}create(e,t,a){this._instance=new this._notification(e,t),this.addListeners(a)}addListeners(e){e?.onClick&&this._instance?.addEventListener("click",e.onClick),e?.onShow&&this._instance?.addEventListener("show",e.onShow),e?.onClose&&this._instance?.addEventListener("close",e.onClose),e?.onError&&this._instance?.addEventListener("error",e.onError)}notify(e){let{title:t,options:a,listeners:n}=e,i={...this._defaultOptions,...a};ub(e=>{"granted"===e&&this.create(t,i,n)})}close(){this._instance?.close()}}var uC=/\s/,uj=/^\s+/;function uN(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var uw="object"==typeof global&&global&&global.Object===Object&&global,uI="object"==typeof self&&self&&self.Object===Object&&self,uT=(uw||uI||Function("return this")()).Symbol,uE=Object.prototype,uS=uE.hasOwnProperty,uk=uE.toString,uA=uT?uT.toStringTag:void 0,uR=Object.prototype.toString,uL=uT?uT.toStringTag:void 0,uO=0/0,uD=/^[-+]0x[0-9a-f]+$/i,uP=/^0b[01]+$/i,uF=/^0o[0-7]+$/i,uB=parseInt,uU=1/0;let uH=class{constructor(e,t,a){this.id=0,this.register=function(e){return function(e,t){var a;if("function"!=typeof t)throw TypeError("Expected a function");return e=function(e){var t=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":uL&&uL in Object(e)?function(e){var t=uS.call(e,uA),a=e[uA];try{e[uA]=void 0;var n=!0}catch{}var i=uk.call(e);return n&&(t?e[uA]=a:delete e[uA]),i}(e):function(e){return uR.call(e)}(e)}(e)}(e))return uO;if(uN(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=uN(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=function(e){return e&&e.slice(0,function(e){for(var t=e.length;t--&&uC.test(e.charAt(t)););return t}(e)+1).replace(uj,"")}(e);var a=uP.test(e);return a||uF.test(e)?uB(e.slice(2),a?2:8):uD.test(e)?uO:+e}(e))===uU||e===-uU?(e<0?-1:1)*17976931348623157e292:e===e?e:0:0===e?e:0}(e),a=t%1;return t===t?a?t-a:t:0}(e),function(){return--e>0&&(a=t.apply(this,arguments)),e<=1&&(t=void 0),a}}(2,e)}(async()=>{if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.register(`${this.path}/service-worker.js`);this.serviceWorker=e.installing||e.waiting||e.active,this.openDB()}catch(e){console.error(`PWA Chat Service Worker registration failed with ${e}`)}}),this.serverKey=e,this.userJid=t,this.path=a,this.register()}postMessageToWorker(e,t){var a;null==(a=this.serviceWorker)||a.postMessage({type:e,payload:t})}openDB(){this.postMessageToWorker("openDB",{serverKey:this.serverKey,userJid:this.userJid})}increaseId(){this.id++}async set(e,t){await this.register(),this.postMessageToWorker("set",{key:e,value:t})}async get(e){await this.register();let t=this.id;return this.postMessageToWorker("get",{key:e,id:t}),this.increaseId(),new Promise(e=>{let a=n=>{if(!n.data)return;let{type:i,payload:s}=n.data;"get"===i&&s&&t===s.id&&(e(s.data),navigator.serviceWorker.removeEventListener("message",a))};navigator.serviceWorker.addEventListener("message",a)})}async delete(e){await this.register(),this.postMessageToWorker("delete",{key:e})}},uz=ad(rJ(window.pwaChatConfig.encryptedKeys??"",[]).filter(e=>{let{isCurrent:t}=e;return t}))?.value,uV=uz?new uH(uz,window.pwaChatConfig.jid,function(){return o3()?"/wc/team-chat":window.location.pathname.includes("/team-chat")?"/team-chat":"/chat"}()):{},uG=ac(document,"visibilitychange").pipe(eg(()=>"hidden"===document.visibilityState));function uq(e,t){let{storageKey:a,persist:n,recover:i,persistTrigger$:s=()=>uG,recoverTrigger$:r=()=>q(void 0)}=t,l=`_recover_${a}`;return e.mutations((e,t)=>{let{encryptedStorage:n}=t;return{[l](t){try{let a=i(t);j(e,a)}catch{n.delete?.(a)}}}}).effects((e,t)=>{let{encryptedStorage:i}=t;return{[`_onRecover_${a}`]:()=>r(e).pipe(au(()=>{let t=i.get?.(a);return t instanceof Promise?ap(t).pipe(J(()=>K),eg(e=>!!e),ah(t=>e[l](t))):K})),[`_onPersist_${a}`]:()=>s(e).pipe(am(()=>{let t=i.set?.(a,n(e));return t instanceof Promise?ap(t).pipe(J(()=>K),H()):K}))}})}function u$(e,t){let{storageKey:a,persist:n,recover:i,persistTrigger$:s=()=>uG,recoverTrigger$:r=()=>q(void 0)}=t,l=`_recover_${a}`;return e.mutations((e,t)=>{let{storage:n}=t;return{[l](t){try{let a=i(t);j(e,a)}catch{n.delete(a)}}}}).effects((e,t)=>{let{storage:i}=t;return{[`_onRecover_${a}`]:()=>r(e).pipe(au(()=>{let t=i.get(a);return t?q(e[l](t)):K})),[`_onPersist_${a}`]:()=>s(e).pipe(U(()=>{i.set(a,n(e))}),H())}})}let uK=["fetchGiphyList","searchGiphyList","getImageThumbnailUrl","fetchImageMsgFile","fetchCodeSnippetMsgFile","fetchClassificationList","fetchGiphyMsgFile","checkMsgPolicy","downloadFile","linkToBase64"];var uJ=(e=>(e.cacheFirst="cacheFirst",e.cacheOnly="cacheOnly",e.cacheAndNetwork="cacheAndNetwork",e.networkOnly="networkOnly",e.noCache="noCache",e.standby="standby",e))(uJ||{});let uW=new class{destroy(){this.sdk.destroy(),this.subscriptions.forEach(e=>{e.unsubscribe()})}createEventObservable(e){return function(e,t){return new I(a=>{let n=lN(e=>a.next(e));return e(n),()=>t(n)})}(t=>{this.sdk.on(e,t)},t=>{this.sdk.off(e,t)})}constructor(){this.sdk=uv,this.subscriptions=[],this.connected$=this.createEventObservable(af.connected),this.connectedBefore$=this.connected$.pipe(ag(1),ay({bufferSize:1,refCount:!0})),this.message$=this.createEventObservable(af.message).pipe(U(e=>{e.forEach(e=>{if(e.messageType!==i.call)return;let t=e.callInfo?.raw.meetingNo;t&&(e.callInfo?.action==="invite"&&lp.setMeetingChannelMap(t,e.channelJid),e.callInfo?.action==="accept"&&(e.channelJid=lp.getChannelJidByMeetingNo(t)||e.channelJid))})}),av()),this.user$=this.createEventObservable(af.updateUserInfo),this.error$=this.createEventObservable(af.error),this.restrictedError$=this.createEventObservable(af.restrictedError),this.emojiVote$=this.createEventObservable(af.emojiVote),this.revokeMessage$=this.createEventObservable(af.revokeMessage),this.editMessage$=this.createEventObservable(af.editMessage),this.giphyLoaded$=this.createEventObservable(af.giphyLoaded),this.fileLoaded$=this.createEventObservable(af.fileLoaded),this.fileUploadProgress$=this.createEventObservable(af.fileUploadProgress),this.fileDownloadProgress$=this.createEventObservable(af.fileDownloadProgress),this.searchFileDownloadProgress$=this.createEventObservable(af.searchFileDownloadProgress),this.linkPreview$=this.createEventObservable(af.linkPreview),this.updateChannelInfo$=this.createEventObservable(af.updateChannelInfo),this.channelList$=this.createEventObservable(af.channelList),this.channelChange$=this.createEventObservable(af.channelChange),this.bufferedChannelChange$=this.channelChange$.pipe(ay({bufferSize:1,refCount:!0})),this.channelInfo$=this.createEventObservable(af.channelInfo),this.starChange$=this.createEventObservable(af.starChange),this.unreadChannelMap$=this.createEventObservable(af.unreadChannelMap).pipe(ay({bufferSize:1,refCount:!0})),this.unreadChannel$=this.unreadChannelMap$.pipe(ah(e=>aM(e))),this.channelAction$=this.createEventObservable(af.channelAction),this.userStatusNotify$=this.createEventObservable(af.userStatusNotify),this.checkRepeatSubPresence$=this.createEventObservable(af.checkRepeatSubPresence),this.connectionConflict$=this.createEventObservable(af.connectionConflict),this.revokeToken$=this.createEventObservable(af.revokeToken),this.mentioned$=this.createEventObservable(af.mention),this.mentionMeMessage$=this.createEventObservable(af.mentionMeMessage),this.folderSync$=this.createEventObservable(af.folderSync),this.folderMemberList$=this.createEventObservable(af.folderMemberList),this.bookmark$=this.createEventObservable(af.bookmark),this.reminderSync$=this.createEventObservable(af.reminderSync),this.readReminderTime$=this.createEventObservable(af.readReminderTime),this.onSubscription$=this.createEventObservable(af.onSubscription),this.onExternalSubsync$=this.createEventObservable(af.onExternalSubsync),this.onSubScribeSync$=this.createEventObservable(af.onSubScribeSync),this.onInvitation$=this.createEventObservable(af.onInvitation),this.contactBlocked$=this.createEventObservable(af.contactBlocked),this.notification$=this.createEventObservable(af.notification),this.userNotification$=this.createEventObservable(af.userNotification),this.mentionGroupAction$=this.createEventObservable(af.mentionGroupAction),this.mentionGroupList$=this.createEventObservable(af.mentionGroupList),this.updateCurrentUserInfo$=this.createEventObservable(af.updateCurrentUserInfo),this.appAction$=this.createEventObservable(af.appAction),this.query=ab(this.sdk.query,(e,t)=>this.createRxQuery(e,t)),this.mutation=ab(this.sdk.mutation,(e,t)=>this.createRxMutation(e,t)),this.subscriptions.push(this.connectedBefore$.subscribe())}createRxQuery(e,t){let a=new Map;return(i,s)=>this.wrapWithConnection(new I(t=>{let r=n.CancelToken.source(),{fetchPolicy:l,cachedBy:o}=s??{},d=lN(e=>t.next(e));if(l&&o){let e=o(i),n=a.get(e);switch(l){case"cacheFirst":n?(d(n),t.complete()):c(t=>{a.set(e,t)});break;case"cacheAndNetwork":n&&d(n),c(t=>{a.set(e,t)});break;case"networkOnly":c(t=>{a.set(e,t)});break;default:c()}}else c();function c(a){e(i,{cancelSource:r}).then(e=>{a?.(e),d(e),t.complete()}).catch(e=>{t.error(e),t.complete()})}return function(){r.cancel()}}),t)}createRxMutation(e,t){return a=>this.wrapWithConnection(new I(t=>{let i=n.CancelToken.source(),s=lN(e=>t.next(e));return e(a,{cancelSource:i}).then(e=>{s(e),t.complete()}).catch(e=>{t.error(e),t.complete()}),function(){i.cancel()}}),t)}wrapWithConnection(e,t){return uK.includes(t)?e:this.connectedBefore$.pipe(a_(()=>e))}},uY={fetchGiphy:async e=>{try{if(e){let{data:t}=await ax(uW.query.searchGiphyList({queryString:e,limit:8},{fetchPolicy:uJ.cacheFirst,cachedBy:e=>e.queryString}));return t}{let{data:e}=await ax(uW.query.fetchGiphyList(void 0,{fetchPolicy:uJ.cacheFirst,cachedBy:()=>""}));return e}}catch(e){return console.error("Load Giphy List Error",e),[]}},loadGiphy:async e=>{try{let{data:t}=await ax(uW.query.fetchGiphyMsgFile({url:e},{fetchPolicy:uJ.cacheFirst,cachedBy:e=>e.url||""}));return{objectUrl:t}}catch(e){return console.error("Load Giphy Error",e),{objectUrl:""}}}},uX=new class{get canBlur(){return this._canBlur}disableBlur(){this._canBlur=!1}enableBlur(){this._canBlur=!0}constructor(){this._canBlur=!0}},uQ=window.React.useCallback;function uZ(e,t){let a;try{a=JSON.parse(e)}catch{a=t}return a}let u1=uZ((null==(hJ=window.pwaChatConfig)?void 0:hJ.logConfig)||"",{enable:!1,gatewayEndPoint:"",errorReportRatio:0}),u0=u1.enable;!function(e){e[e.PLAIN=0]="PLAIN",e[e.RSA=1]="RSA",e[e.AESGCM256=2]="AESGCM256"}(hW||(hW={})),function(e){e[e.info=0]="info",e[e.debug=1]="debug",e[e.log=2]="log",e[e.warn=3]="warn",e[e.error=4]="error"}(hY||(hY={})),function(e){e[e.PROTECT_LOCAL_KEY=0]="PROTECT_LOCAL_KEY"}(hX||(hX={})),function(e){e.beforeInit="beforeInit",e.afterInit="afterInit",e.beforeLog="beforeLog",e.hitSizeLimit="hitSizeLimit",e.afterLog="afterLog",e.beforeReport="beforeReport",e.afterReport="afterReport"}(hQ||(hQ={}));class u2{constructor(){}}var u5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u3={exports:{}},u6={exports:{}};let u4=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})),u8=function(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var a=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};a.prototype=t.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(a,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),a}(u4);function u7(){return hZ||(hZ=1,function(e,t){(function(t,a){e.exports=a()})(0,function(){var e=e||function(e,t){if(typeof window<"u"&&window.crypto&&(a=window.crypto),typeof self<"u"&&self.crypto&&(a=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(a=globalThis.crypto),!a&&typeof window<"u"&&window.msCrypto&&(a=window.msCrypto),!a&&typeof u5<"u"&&u5.crypto&&(a=u5.crypto),!a)try{a=u8}catch{}var a,n=function(){if(a){if("function"==typeof a.getRandomValues)try{return a.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof a.randomBytes)try{return a.randomBytes(4).readInt32LE()}catch{}}throw Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var a;return e.prototype=t,a=new e,e.prototype=null,a}}(),s={},r=s.lib={},l=r.Base=function(){return{extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=l.extend({init:function(e,a){e=this.words=e||[],a!=t?this.sigBytes=a:this.sigBytes=4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,a=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var s=0;s<i;s++){var r=a[s>>>2]>>>24-s%4*8&255;t[n+s>>>2]|=r<<24-(n+s)%4*8}else for(var l=0;l<i;l+=4)t[n+l>>>2]=a[l>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,a=this.sigBytes;t[a>>>2]&=4294967295<<32-a%4*8,t.length=e.ceil(a/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],a=0;a<e;a+=4)t.push(n());return new o.init(t,e)}}),d=s.enc={},c=d.Hex={stringify:function(e){for(var t=e.words,a=e.sigBytes,n=[],i=0;i<a;i++){var s=t[i>>>2]>>>24-i%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n+=2)a[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new o.init(a,t/2)}},u=d.Latin1={stringify:function(e){for(var t=e.words,a=e.sigBytes,n=[],i=0;i<a;i++){var s=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n++)a[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new o.init(a,t)}},m=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=m.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var a,n=this._data,i=n.words,s=n.sigBytes,r=this.blockSize,l=s/(4*r),d=(l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0))*r,c=e.min(4*d,s);if(d){for(var u=0;u<d;u+=r)this._doProcessBlock(i,u);a=i.splice(0,d),n.sigBytes-=c}return new o.init(a,c)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,a){return new e.init(a).finalize(t)}},_createHmacHelper:function(e){return function(t,a){return new h.HMAC.init(e,a).finalize(t)}}});var h=s.algo={};return s}(Math);return e})}(u6)),u6.exports}!function(e,t){!function(t,a){e.exports=a(u7())}(0,function(e){return e.enc.Utf8})}(u3);var u9=u3.exports,me={exports:{}};!function(e,t){!function(t,a){e.exports=a(u7())}(0,function(e){return function(){var t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,a=e.sigBytes,n=this._map;e.clamp();for(var i=[],s=0;s<a;s+=3)for(var r=t[s>>>2]>>>24-s%4*8&255,l=t[s+1>>>2]>>>24-(s+1)%4*8&255,o=t[s+2>>>2]>>>24-(s+2)%4*8&255,d=r<<16|l<<8|o,c=0;c<4&&s+.75*c<a;c++)i.push(n.charAt(d>>>6*(3-c)&63));var u=n.charAt(64);if(u)for(;i.length%4;)i.push(u);return i.join("")},parse:function(e){var a=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<n.length;s++)i[n.charCodeAt(s)]=s}var r=n.charAt(64);if(r){var l=e.indexOf(r);-1!==l&&(a=l)}return function(e,a,n){for(var i=[],s=0,r=0;r<a;r++)if(r%4){var l=n[e.charCodeAt(r-1)]<<r%4*2|n[e.charCodeAt(r)]>>>6-r%4*2;i[s>>>2]|=l<<24-s%4*8,s++}return t.create(i,s)}(e,a,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64})}(me);var mt=me.exports,ma=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let mn=e=>{let t=u9.parse(e);return mt.stringify(t)},mi=e=>{let t=mt.parse(e);return u9.stringify(t)},ms=e=>{for(var t=e.length,a=e.length-1;a>=0;a--){var n=e.charCodeAt(a);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&a--}return t};function mr(e){let t=new ArrayBuffer(e.length),a=new Uint8Array(t);for(let t=0,n=e.length;t<n;t++)a[t]=e.charCodeAt(t);return t}function ml(e){for(var t="",a=new Uint8Array(e),n=a.byteLength,i=0;i<n;i++)t+=String.fromCharCode(a[i]);return self.btoa(t)}let mo=()=>ma(void 0,void 0,void 0,function*(){return yield self.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}),md=()=>self.crypto.getRandomValues(new Uint8Array(16)),mc=(e,t,a)=>ma(void 0,void 0,void 0,function*(){try{return yield self.crypto.subtle.encrypt({name:"AES-GCM",iv:a},t,e)}catch(e){throw e}}),mu=(e,t,a)=>ma(void 0,void 0,void 0,function*(){try{return yield self.crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,e)}catch(e){throw e}}),mm=(e,t)=>ma(void 0,void 0,void 0,function*(){try{return yield self.crypto.subtle.decrypt({name:"RSA-OAEP"},t,e)}catch(e){throw e}}),mp=(e,t,a)=>ma(void 0,void 0,void 0,function*(){return new Promise((n,i)=>{requestAnimationFrame(()=>ma(void 0,void 0,void 0,function*(){var s;try{let i;let r=null===(s=null==t?void 0:t.algorithm)||void 0===s?void 0:s.name;if("RSA-OAEP"===r?i=mm:"AES-GCM"===r&&(i=mu),!i)throw Error("Unsupported encrypt key type");if("string"==typeof e){let s=new TextEncoder,r=yield i(s.encode(e),t,a);n(r)}else{let s=yield i(e,t,a);n(s)}}catch(e){i(e)}}))})}),mh=e=>ma(void 0,void 0,void 0,function*(){let t=e.replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----",""),a=self.atob(t),n=mr(a);return yield self.crypto.subtle.importKey("spki",n,{name:"RSA-OAEP",hash:"SHA-1"},!0,["encrypt"])}),mf=e=>ma(void 0,void 0,void 0,function*(){return yield self.crypto.subtle.exportKey("raw",e)}),mg=(e,t)=>{let a="string"==typeof e?mr(e):e;return self.crypto.subtle.encrypt({name:"RSA-OAEP"},t,a)},my=(e,t,a)=>ma(void 0,void 0,void 0,function*(){return new Promise((n,i)=>{requestAnimationFrame(()=>ma(void 0,void 0,void 0,function*(){var i;let s;let r=null===(i=null==t?void 0:t.algorithm)||void 0===i?void 0:i.name;if("RSA-OAEP"===r?s=mg:"AES-GCM"===r&&(s=mc),!s)throw Error("Unsupported encrypt key type");if("string"==typeof e){let i=new TextEncoder,r=yield s(i.encode(e),t,a);n(r)}else{let i=yield s(e,t,a);n(i)}}))})}),mv={},m_=(e,t)=>{mv[t]=e};var mb=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let mM=(e,t,a,n)=>mb(void 0,void 0,void 0,function*(){try{if(!e||!t||!a)return null;let n=yield self.crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,e);return String.fromCharCode.apply(null,new Uint8Array(n))}catch(e){throw e}}),mx={decryptAESGCM256:mM,bulkDecryptAESGCM256:e=>mb(void 0,void 0,void 0,function*(){return yield Promise.all(e.map(e=>mM(...e)))})};var mC=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let mj=e=>{let t;return t=0+ms(e.message),e.tags.forEach(e=>{t+=ms(e)}),t},mN={success:!1,codecWorker:null},mw=[],mI=()=>mC(void 0,void 0,void 0,function*(){return mN.success||(yield new Promise((e,t)=>{mw.push(()=>{e(null)})})),mN.codecWorker}),mT=()=>{mw.forEach(e=>{e()}),mN.success=!0},mE=e=>(mN.codecWorker=mx,mT(),mN);class mS{constructor(e){this.uuid=self.crypto.randomUUID();let{databaseName:t,maxSize:a,publicKey:n,reportUrl:i,plugins:s,idbManager:r,logManager:l,currentSize:o,externalKeys:d,codecWorkerFilePath:c}=e;mE(),this.databaseName=t,this.maxSize=a,this.publicKey=n??"",this.reportUrl=i??"",this.plugins=s??[],this.idbManager=r,this.logManager=l,this.currentSize=o??0,this.getCodecWorker=mI,this.externalKeys=d,this.commonMethods=Object.assign({},mv)}getLocalAESGCM256Key(){var e;return mC(this,void 0,void 0,function*(){if(this.localAESGCM256Key)return this.localAESGCM256Key;this.localAESGCM256Key=yield mo();let t=this.externalKeys?null===(e=this.externalKeys.filter(e=>e.usage===hX.PROTECT_LOCAL_KEY)[0])||void 0===e?void 0:e.key:void 0;return yield this.idbManager.saveAESGCM256Key(this.uuid,this.localAESGCM256Key,t),this.localAESGCM256Key})}updateCurrentSize(e){var t;let a=null!==(t=this.currentSize)&&void 0!==t?t:0;if(e instanceof Map)for(let[t,n]of e)a+=mj(n);else a+=mj(e);return this.currentSize=a,a>=this.maxSize}}let mk=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let n={},i=[];for(let e of t)e.forEach(e=>{n[e.id]||(n[e.id]=!0,i.push(e))});let s=new Map;return i.sort((e,t)=>(null==e?void 0:e.id)-(null==t?void 0:t.id)).forEach(e=>{s.set(e.id,e)}),s},mA=(e,t)=>{let a=new Map;return t.forEach(t=>{e(t)&&a.set(t.id,t)}),a},mR=(e,t)=>{if(!t)return e.byTime;if("string"==typeof t)return e.byTag[t]||new Map;if(Array.isArray(t)){if(t.every(e=>"string"==typeof e))return mk(...t.map(t=>e.byTag[t]).filter(e=>!!e))}else{if("function"==typeof t)return mA(t,e.byTime);if("object"==typeof t){if(t.tags&&t.filter){if("string"==typeof t.tags)return mA(t.filter,e.byTag[t.tags]);if(Array.isArray(t.tags)&&t.tags.every(e=>"string"==typeof e))return mk(...t.tags.map(a=>{let n=e.byTag[a];return n?mA(t.filter,n):new Map}))}else{if(t.filter)return mA(t.filter,e.byTime);if(t.tags){if("string"==typeof t)return e.byTag[t]||new Map;if(Array.isArray(t)&&t.every(e=>"string"==typeof e))return mk(...t.map(t=>e.byTag[t]))}}}else console.error("Wrong filter type")}return new Map};var mL=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};class mO{constructor(){this.getStore=()=>({byTag:Object.assign({},this.store.byTag),byTime:new Map(this.store.byTime)}),this.pushByTime=e=>{for(let t of e)this.store.byTime.set(t.id,t)},this.pushByTag=e=>{e.forEach(e=>{let t=e.tags;Array.isArray(t)&&t.forEach(t=>{this.store.byTag[t]||(this.store.byTag[t]=new Map),this.store.byTag[t].set(e.id,e)})})},this.addLog=e=>{let t=e;Array.isArray(e)||(t=[e]),this.pushByTime(t),this.pushByTag(t)},this.syncFromIDB=e=>mL(this,void 0,void 0,function*(){let t=yield e.getAllLogs();this.addLog(t)}),this.reset=()=>{this.store={byTag:{},byTime:new Map}},this.deleteLogs=e=>{for(let t of e){let e=this.store.byTime.get(t);if(!e)continue;let{tags:a}=e;for(let e of a)this.store.byTag[e].delete(t);this.store.byTime.delete(t)}},this.filterStore=e=>{let t=mR(this.store,e),a=new Map;for(let[e,n]of t){let t=n.encryptMode!==hW.AESGCM256,i=Object.assign(Object.assign({},n),{message:t?mi(n.message):n.message});try{i.message=JSON.parse(i.message)}catch{}a.set(e,i)}return a},this.store={byTag:{},byTime:new Map}}}function mD(e,t,a){let n=e.plugins;if(!Array.isArray(n))return a;let i=a;return n.forEach(a=>{let n=a[t];if("function"==typeof n){let t=n(e,i);t&&(i=t)}}),i}var mP=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let mF=(e,t,a,n,i,s)=>{let r=Array.isArray(t)?t:[t],l=Date.now();return Object.assign({message:e,logLevel:a,tags:r,encryptMode:n,timestamp:l,laplaceSessionId:i},s)},mB=(e,t,a,n,i,s)=>(void 0===s&&(s={}),mP(void 0,void 0,void 0,function*(){let{noCache:r,extraProperties:l={}}=s,o=`${t}`,d=mF(o,a,n,i,e.uuid,l),c=mD(e,hQ.beforeLog,d);if(r)mD(e,hQ.afterLog,d);else{let{idbManager:t,logManager:a}=e,n=yield t.makeNextId();if(i===hW.AESGCM256){let t=yield e.getLocalAESGCM256Key(),a=yield my(c.message,t,new Uint8Array(16));c.message=ml(a)}else c.message=mn(c.message);let s=Object.assign(Object.assign({},c),{id:n});e.updateCurrentSize(s)&&mD(e,hQ.hitSizeLimit,s),a.addLog(s),t.addLog(s),mD(e,hQ.afterLog,s)}}));m_(mB,"commonLog");var mU={},mH=function(e,t,a,n,i){var s=new Worker(mU[t]||(mU[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(e){var t=e.data,a=t.$e$;if(a){var n=Error(a[0]);n.code=a[1],n.stack=a[2],i(n,null)}else i(null,t)},s.postMessage(a,n),s},mz=Uint8Array,mV=Uint16Array,mG=Uint32Array,mq=new mz([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),m$=new mz([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mK=new mz([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mJ=function(e,t){for(var a=new mV(31),n=0;n<31;++n)a[n]=t+=1<<e[n-1];for(var i=new mG(a[30]),n=1;n<30;++n)for(var s=a[n];s<a[n+1];++s)i[s]=s-a[n]<<5|n;return[a,i]},mW=mJ(mq,2),mY=mW[0],mX=mW[1];mY[28]=258,mX[258]=28;for(var mQ=mJ(m$,0)[1],mZ=new mV(32768),m1=0;m1<32768;++m1){var m0=(43690&m1)>>>1|(21845&m1)<<1;m0=(61680&(m0=(52428&m0)>>>2|(13107&m0)<<2))>>>4|(3855&m0)<<4,mZ[m1]=((65280&m0)>>>8|(255&m0)<<8)>>>1}for(var m2=function(e,t,a){for(var n,i=e.length,s=0,r=new mV(t);s<i;++s)e[s]&&++r[e[s]-1];var l=new mV(t);for(s=0;s<t;++s)l[s]=l[s-1]+r[s-1]<<1;if(a){n=new mV(1<<t);var o=15-t;for(s=0;s<i;++s)if(e[s])for(var d=s<<4|e[s],c=t-e[s],u=l[e[s]-1]++<<c,m=u|(1<<c)-1;u<=m;++u)n[mZ[u]>>>o]=d}else for(n=new mV(i),s=0;s<i;++s)e[s]&&(n[s]=mZ[l[e[s]-1]++]>>>15-e[s]);return n},m5=new mz(288),m1=0;m1<144;++m1)m5[m1]=8;for(var m1=144;m1<256;++m1)m5[m1]=9;for(var m1=256;m1<280;++m1)m5[m1]=7;for(var m1=280;m1<288;++m1)m5[m1]=8;for(var m3=new mz(32),m1=0;m1<32;++m1)m3[m1]=5;var m6=m2(m5,9,0),m4=m2(m3,5,0),m8=function(e){return(e+7)/8|0},m7=function(e,t,a){(null==t||t<0)&&(t=0),(null==a||a>e.length)&&(a=e.length);var n=new(2==e.BYTES_PER_ELEMENT?mV:4==e.BYTES_PER_ELEMENT?mG:mz)(a-t);return n.set(e.subarray(t,a)),n},m9=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],pe=function(e,t,a){var n=Error(t||m9[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,pe),!a)throw n;return n},pt=function(e,t,a){a<<=7&t;var n=t/8|0;e[n]|=a,e[n+1]|=a>>>8},pa=function(e,t,a){a<<=7&t;var n=t/8|0;e[n]|=a,e[n+1]|=a>>>8,e[n+2]|=a>>>16},pn=function(e,t){for(var a=[],n=0;n<e.length;++n)e[n]&&a.push({s:n,f:e[n]});var i=a.length,s=a.slice();if(!i)return[pc,0];if(1==i){var r=new mz(a[0].s+1);return r[a[0].s]=1,[r,1]}a.sort(function(e,t){return e.f-t.f}),a.push({s:-1,f:25001});var l=a[0],o=a[1],d=0,c=1,u=2;for(a[0]={s:-1,f:l.f+o.f,l:l,r:o};c!=i-1;)l=a[a[d].f<a[u].f?d++:u++],o=a[d!=c&&a[d].f<a[u].f?d++:u++],a[c++]={s:-1,f:l.f+o.f,l:l,r:o};for(var m=s[0].s,n=1;n<i;++n)s[n].s>m&&(m=s[n].s);var p=new mV(m+1),h=pi(a[c-1],p,0);if(h>t){var n=0,f=0,g=h-t,y=1<<g;for(s.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});n<i;++n){var v=s[n].s;if(p[v]>t)f+=y-(1<<h-p[v]),p[v]=t;else break}for(f>>>=g;f>0;){var _=s[n].s;p[_]<t?f-=1<<t-p[_]++-1:++n}for(;n>=0&&f;--n){var b=s[n].s;p[b]==t&&(--p[b],++f)}h=t}return[new mz(p),h]},pi=function(e,t,a){return -1==e.s?Math.max(pi(e.l,t,a+1),pi(e.r,t,a+1)):t[e.s]=a},ps=function(e){for(var t=e.length;t&&!e[--t];);for(var a=new mV(++t),n=0,i=e[0],s=1,r=function(e){a[n++]=e},l=1;l<=t;++l)if(e[l]==i&&l!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)r(32754);s>2&&(r(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(r(i),--s;s>6;s-=6)r(8304);s>2&&(r(s-3<<5|8208),s=0)}for(;s--;)r(i);s=1,i=e[l]}return[a.subarray(0,n),t]},pr=function(e,t){for(var a=0,n=0;n<t.length;++n)a+=e[n]*t[n];return a},pl=function(e,t,a){var n=a.length,i=m8(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<n;++s)e[i+s+4]=a[s];return(i+4+n)*8},po=function(e,t,a,n,i,s,r,l,o,d,c){pt(t,c++,a),++i[256];for(var u,m,p,h,f=pn(i,15),g=f[0],y=f[1],v=pn(s,15),_=v[0],b=v[1],M=ps(g),x=M[0],C=M[1],j=ps(_),N=j[0],w=j[1],I=new mV(19),T=0;T<x.length;++T)I[31&x[T]]++;for(var T=0;T<N.length;++T)I[31&N[T]]++;for(var E=pn(I,7),S=E[0],k=E[1],A=19;A>4&&!S[mK[A-1]];--A);var R=d+5<<3,L=pr(i,m5)+pr(s,m3)+r,O=pr(i,g)+pr(s,_)+r+14+3*A+pr(I,S)+(2*I[16]+3*I[17]+7*I[18]);if(R<=L&&R<=O)return pl(t,c,e.subarray(o,o+d));if(pt(t,c,1+(O<L)),c+=2,O<L){u=m2(g,y,0),m=g,p=m2(_,b,0),h=_;var D=m2(S,k,0);pt(t,c,C-257),pt(t,c+5,w-1),pt(t,c+10,A-4),c+=14;for(var T=0;T<A;++T)pt(t,c+3*T,S[mK[T]]);c+=3*A;for(var P=[x,N],F=0;F<2;++F)for(var B=P[F],T=0;T<B.length;++T){var U=31&B[T];pt(t,c,D[U]),c+=S[U],U>15&&(pt(t,c,B[T]>>>5&127),c+=B[T]>>>12)}}else u=m6,m=m5,p=m4,h=m3;for(var T=0;T<l;++T)if(n[T]>255){var U=n[T]>>>18&31;pa(t,c,u[U+257]),c+=m[U+257],U>7&&(pt(t,c,n[T]>>>23&31),c+=mq[U]);var H=31&n[T];pa(t,c,p[H]),c+=h[H],H>3&&(pa(t,c,n[T]>>>5&8191),c+=m$[H])}else pa(t,c,u[n[T]]),c+=m[n[T]];return pa(t,c,u[256]),c+m[256]},pd=new mG([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),pc=new mz(0),pu=function(e,t,a,n,i,s){var r=e.length,l=new mz(n+r+5*(1+Math.ceil(r/7e3))+i),o=l.subarray(n,l.length-i),d=0;if(!t||r<8)for(var c=0;c<=r;c+=65535){var u=c+65535;u>=r&&(o[d>>3]=s),d=pl(o,d+1,e.subarray(c,u))}else{for(var m=pd[t-1],p=m>>>13,h=8191&m,f=(1<<a)-1,g=new mV(32768),y=new mV(f+1),v=Math.ceil(a/3),_=2*v,b=function(t){return(e[t]^e[t+1]<<v^e[t+2]<<_)&f},M=new mG(25e3),x=new mV(288),C=new mV(32),j=0,N=0,c=0,w=0,I=0,T=0;c<r;++c){var E=b(c),S=32767&c,k=y[E];if(g[S]=k,y[E]=S,I<=c){var A=r-c;if((j>7e3||w>24576)&&A>423){d=po(e,o,0,M,x,C,N,w,T,c-T,d),w=j=N=0,T=c;for(var R=0;R<286;++R)x[R]=0;for(var R=0;R<30;++R)C[R]=0}var L=2,O=0,D=h,P=S-k&32767;if(A>2&&E==b(c-P))for(var F=Math.min(p,A)-1,B=Math.min(32767,c),U=Math.min(258,A);P<=B&&--D&&S!=k;){if(e[c+L]==e[c+L-P]){for(var H=0;H<U&&e[c+H]==e[c+H-P];++H);if(H>L){if(L=H,O=P,H>F)break;for(var z=Math.min(P,H-2),V=0,R=0;R<z;++R){var G=c-P+R+32768&32767,q=g[G],$=G-q+32768&32767;$>V&&(V=$,k=G)}}}k=g[S=k],P+=S-k+32768&32767}if(O){M[w++]=268435456|mX[L]<<18|mQ[O];var K=31&mX[L],J=31&mQ[O];N+=mq[K]+m$[J],++x[257+K],++C[J],I=c+L,++j}else M[w++]=e[c],++x[e[c]]}}d=po(e,o,s,M,x,C,N,w,T,c-T,d),!s&&7&d&&(d=pl(o,d+1,pc))}return m7(l,0,n+m8(d)+i)},pm=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var a=t,n=9;--n;)a=(1&a&&-306674912)^a>>>1;e[t]=a}return e}(),pp=function(){var e=-1;return{p:function(t){for(var a=e,n=0;n<t.length;++n)a=pm[255&a^t[n]]^a>>>8;e=a},d:function(){return~e}}},ph=function(e,t,a,n,i){return pu(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,a,n,!i)},pf=function(e,t){var a={};for(var n in e)a[n]=e[n];for(var n in t)a[n]=t[n];return a},pg=function(e,t,a){for(var n=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),r=0;r<n.length;++r){var l=n[r],o=s[r];if("function"==typeof l){t+=";"+o+"=";var d=l.toString();if(l.prototype){if(-1!=d.indexOf("[native code]")){var c=d.indexOf(" ",8)+1;t+=d.slice(c,d.indexOf("(",c))}else for(var u in t+=d,l.prototype)t+=";"+o+".prototype."+u+"="+l.prototype[u].toString()}else t+=d}else a[o]=l}return[t,a]},py=[],pv=function(e){var t=[];for(var a in e)e[a].buffer&&t.push((e[a]=new e[a].constructor(e[a])).buffer);return t},p_=function(e,t,a,n){if(!py[a]){for(var i,s="",r={},l=e.length-1,o=0;o<l;++o)s=(i=pg(e[o],s,r))[0],r=i[1];py[a]=pg(e[l],s,r)}var d=pf({},py[a][1]);return mH(py[a][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",a,d,pv(d),n)},pb=function(){return[mz,mV,mG,mq,m$,mK,mX,mQ,m6,m5,m4,m3,mZ,pd,pc,m2,pt,pa,pn,pi,ps,pr,pl,po,m8,m7,pu,ph,pI,px]},pM=function(){return[pN,pw,pj,pp,pm]},px=function(e){return postMessage(e,[e.buffer])},pC=function(e,t,a,n,i,s){var r=p_(a,n,i,function(e,t){r.terminate(),s(e,t)});return r.postMessage([e,t],t.consume?[e.buffer]:[]),function(){r.terminate()}},pj=function(e,t,a){for(;a;++t)e[t]=a,a>>>=8},pN=function(e,t){var a=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&pj(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),a){e[3]=8;for(var n=0;n<=a.length;++n)e[n+10]=a.charCodeAt(n)}},pw=function(e){return 10+(e.filename&&e.filename.length+1||0)};function pI(e,t){return ph(e,t||{},0,0)}function pT(e,t){t||(t={});var a=pp(),n=e.length;a.p(e);var i=ph(e,t,pw(t),8),s=i.length;return pN(i,t),pj(i,s-8,a.d()),pj(i,s-4,n),i}var pE=typeof TextEncoder<"u"&&new TextEncoder,pS=typeof TextDecoder<"u"&&new TextDecoder;try{pS.decode(pc,{stream:!0})}catch{}let pk=e=>{let t=new XMLHttpRequest;if(t.open(e.type||"GET",e.url,!0),t.withCredentials=e.withCredentials,t.onreadystatechange=function(){if(4===t.readyState){let a=t.status;a>=200&&a<300?e.success&&e.success(t.responseText,e.data,e.meta):e.fail&&e.fail(`Request failed, status: ${a}, responseText: ${t.responseText}`,e.data,e.meta)}},"POST"===e.type){if(e.headers)for(let a in e.headers)t.setRequestHeader(a,e.headers[a]);try{t.send(e.data)}catch(t){e.fail&&e.fail(t,e.data,e.meta)}}return t};var pA=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})},pR=globalThis&&globalThis.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]]);return a};let pL=e=>t=>pA(void 0,void 0,void 0,function*(){let a=md(),n=yield mo(),i=yield mh(e),s=yield mf(n),r=yield mg(s,i),l=yield my(t.report.messages,n,a),o=Object.assign(Object.assign({},t.report),{messages:ml(l),meta:{key:ml(r),iv:ml(a),version:"000001"}});return Object.assign(Object.assign({},t),{report:o})}),pO=e=>pA(void 0,void 0,void 0,function*(){let t=e.report.meta;t?(t.version="000001",t.flag="0"):t={version:"000001",flag:"0"};let a=Object.assign(Object.assign({},e.report),{meta:t});return Object.assign(Object.assign({},e),{report:a})}),pD=e=>new Promise((t,a)=>{let n=function(e,t){if(t){for(var a=new mz(e.length),n=0;n<e.length;++n)a[n]=e.charCodeAt(n);return a}if(pE)return pE.encode(e);for(var i=e.length,s=new mz(e.length+(e.length>>1)),r=0,l=function(e){s[r++]=e},n=0;n<i;++n){if(r+5>s.length){var o=new mz(r+8+(i-n<<1));o.set(s),s=o}var d=e.charCodeAt(n);d<128||t?l(d):(d<2048?l(192|d>>6):(d>55295&&d<57344?(l(240|(d=65536+(1047552&d)|1023&e.charCodeAt(++n))>>18),l(128|d>>12&63)):l(224|d>>12),l(128|d>>6&63)),l(128|63&d))}return m7(s,0,r)}(e);!function(e,t,a){a||(a=t,t={}),"function"!=typeof a&&pe(7),pC(e,t,[pb,pM,function(){return[pT]}],function(e){return px(pT(e.data[0],e.data[1]))},2,a)}(n,{consume:!0},(e,n)=>{e&&a(e),t(n)})}),pP=e=>t=>pA(void 0,void 0,void 0,function*(){let a=yield pD(t.report.messages);e&&(a=ml(a));let n=Object.assign(Object.assign({},t.report),{messages:a});return Object.assign(Object.assign({},t),{report:n})}),pF=(e,t,a,n)=>{e.map(e=>Object.assign(Object.assign({url:t||"",type:"POST",withCredentials:!1,headers:{},data:JSON.stringify(e.report),meta:{reportItems:e.reportItems,nextReportItems:e.nextReportItems}},a),n)).forEach(e=>{pk(e)})},pB=(e,t)=>{void 0===t&&(t=2);let a=`${e}`;for(;a.length<t;)a=`0${a}`;return a},pU=e=>{let t=new Date(e),a=t.getUTCFullYear(),n=pB(t.getUTCMonth()+1),i=pB(t.getUTCDate()),s=pB(t.getUTCHours()),r=pB(t.getUTCMinutes()),l=pB(t.getUTCSeconds()),o=pB(t.getUTCMilliseconds(),3);return`${a}-${n}-${i} ${s}:${r}:${l}.${o}`},pH=(e,t)=>{let{message:a,logLevel:n,tags:i,timestamp:s,encryptMode:r,id:l}=e,o=pR(e,["message","logLevel","tags","timestamp","encryptMode","id"]),d=Object.assign(Object.assign({time:pU(s),logLevel:hY[n],message:a,tags:i},t),o);return JSON.stringify(d)},pz=(e,t,a)=>{let n="",i=0,s=new Map,r=new Map,l=t.gzip?92160:30720;for(let[t,o]of e){let e=pH(o,a),t=ms(e);i+t<l?(i+=t,n+=e+`
`,s.set(o.id,o)):r.set(o.id,o)}return{reportItems:s,nextReportItems:r,report:{messages:n}}},pV=(e,t,a,n)=>{let i;let s=[];do{let r=t(i||e,a,n),{nextReportItems:l}=r;s.push(r),i=l}while(i&&null!=i&&i.size);return s},pG=(e,t)=>pA(void 0,void 0,void 0,function*(){try{let{idbManager:a,getCodecWorker:n,externalKeys:i}=t,s=i?i.filter(e=>e.usage===hX.PROTECT_LOCAL_KEY).map(e=>e.key):void 0,r=new Map,l=Array.from(e.values()),o=yield Promise.all(l.map(e=>pA(void 0,void 0,void 0,function*(){return e.encryptMode===hW.AESGCM256?[function(e){for(var t=self.atob(e),a=t.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=t.charCodeAt(i);return n.buffer}(e.message),(yield a.loadAESGCM256Key(e.laplaceSessionId,s)),new Uint8Array(16)]:[]})).map(e=>!1===e[1]?[]:e)),d=yield(yield n()).bulkDecryptAESGCM256(o);return l.forEach((e,t)=>{let a=d[t];a?r.set(e.id,Object.assign(Object.assign({},e),{message:a})):r.set(e.id,e)}),r}catch{return e}}),pq=(e,t,a)=>(void 0===a&&(a={}),pA(void 0,void 0,void 0,function*(){let n=e.logManager.filterStore(t),i=e.publicKey,{xhrOptions:s={},reportMaker:r,additionalContext:l,gzip:o,encrypt:d,publicKey:c}=a;if(c&&(i=c),d&&!i)throw Error("Cannot encrypt report without key");let u=mD(e,hQ.beforeReport,n),m=yield pG(u,e);for(let[e,t]of m)try{t.message=JSON.parse(t.message)}catch{}let p=pV(m,r??pz,a,l);if(o){let e=pP(!d);p=yield Promise.all(p.map(e))}pF(p=d?yield Promise.all(p.map(pL(i))):yield Promise.all(p.map(pO)),e.reportUrl,{success:(t,a,n)=>{mD(e,hQ.afterReport,{report:a,reportItems:n.reportItems,nextReportItems:n.nextReportItems})},fail:(t,a,n)=>{mD(e,hQ.afterReport,{report:a,reportItems:n.reportItems,nextReportItems:n.nextReportItems,error:t})}},s)}));m_(pq,"commonReport");var p$=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let pK=(e,t,a)=>p$(void 0,void 0,void 0,function*(){let{idbManager:n,logManager:i}=e;if(Array.isArray(a)&&(yield n.deleteLogs(a),i.deleteLogs(a),!t))return;let s=e.logManager.filterStore(t),r=[];for(let[e,t]of s)r.push(t.id);let l=r;Array.isArray(r)||(l=[r]),yield n.deleteLogs(l),i.deleteLogs(l)}),pJ=e=>p$(void 0,void 0,void 0,function*(){let{idbManager:t,logManager:a}=e;yield t.reset(),a.reset()});function pW(e){return new Promise((t,a)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>a(e.error)})}function pY(e,t){let a=indexedDB.open(e);a.onupgradeneeded=()=>a.result.createObjectStore(t);let n=pW(a);return(e,a)=>n.then(n=>a(n.transaction(t,e).objectStore(t)))}function pX(){return e||(e=pY("keyval-store","keyval")),e}function pQ(e,t){return void 0===t&&(t=pX()),t("readonly",t=>pW(t.get(e)))}function pZ(e,t,a){return void 0===a&&(a=pX()),a("readwrite",a=>(a.put(t,e),pW(a.transaction)))}function p1(e,t){return void 0===t&&(t=pX()),t("readwrite",t=>(e.forEach(e=>t.delete(e)),pW(t.transaction)))}m_(pK,"commonDelete"),m_(pJ,"commonReset");var p0=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let p2={default:{queue:[],isRunning:!1,listeners:[]}},p5=e=>{let t=p2[e];return t||(t={queue:[],isRunning:!1,listeners:[]},p2[e]=t),t};function p3(e,t){void 0===t&&(t="default");let a=p5(t);return new Promise((n,i)=>{a.queue.push({task:e,resolution:n,rejection:i}),function e(t){return p0(this,void 0,void 0,function*(){let a=p5(t),{queue:n,listeners:i}=a;for(;n.length>0&&!a.isRunning;){let i=n.shift();a.isRunning=!0;try{let e=yield i.task();i.resolution(e)}catch(e){i.rejection(e)}a.isRunning=!1,e(t)}i.length&&i.forEach(e=>{e()})})}(t)})}let p6=(e,t)=>{p5(e).listeners.push(t)};var p4=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let p8="change_meta",p7="change_log",p9=()=>Promise.resolve();class he{constructor(e){this.waitingForReset=!1,this.isReseting=!1,this.isChangingMeta=!1,this.isChangingLog=!1,this.get=e=>p4(this,void 0,void 0,function*(){return yield pQ(e,this.store)}),this.getSecret=e=>p4(this,void 0,void 0,function*(){return yield pQ(e,this.keyStore)}),this.set=(e,t)=>p4(this,void 0,void 0,function*(){try{return yield pZ(e,t,this.store)}catch(a){a instanceof DOMException&&a&&"QuotaExceededError"===a.name&&(yield this.deleteOldLogsForSetNewOne(),yield this.set(e,t)),console.error(a)}}),this.setSecret=(e,t)=>p4(this,void 0,void 0,function*(){try{return yield pZ(e,t,this.keyStore)}catch(a){a instanceof DOMException&&a&&"QuotaExceededError"===a.name&&(yield this.deleteOldLogsForSetNewOne(),yield this.set(e,t)),console.error(a)}}),this.deleteOldLogsForSetNewOne=()=>p4(this,void 0,void 0,function*(){var e;let t=yield this.getAllLogs(),a=[];for(let n=0;n<13;n++){let i=null===(e=t[n])||void 0===e?void 0:e.id;(i||0===i)&&a.push(`${i}`)}p1(a,this.store)}),this.adjustMaxId=()=>p4(this,void 0,void 0,function*(){return this.isReseting?p9():(this.isChangingMeta=!0,yield p3(()=>p4(this,void 0,void 0,function*(){var e;let t=yield this.getAllLogs(),a=t[t.length-1],n=null!==(e=null==a?void 0:a.id)&&void 0!==e?e:0;return yield this.set("maxId",n),n}),p8))}),this.makeNextId=()=>p4(this,void 0,void 0,function*(){return this.isReseting?p9():(this.isChangingMeta=!0,yield p3(()=>p4(this,void 0,void 0,function*(){let e=yield this.get("maxId");if(!e&&0!==e)return yield this.set("maxId",0),0;let t=e+1;return yield this.set("maxId",t),t}),p8))}),this.addLog=e=>p4(this,void 0,void 0,function*(){if(this.isReseting)return p9();this.isChangingLog=!0,yield p3(()=>p4(this,void 0,void 0,function*(){let{id:t}=e;this.set(`${t}`,e)}),p7)}),this.getAllLogs=()=>p4(this,void 0,void 0,function*(){return(yield function(e){return void 0===e&&(e=pX()),e("readonly",t=>{if(t.getAll&&t.getAllKeys)return Promise.all([pW(t.getAllKeys()),pW(t.getAll())]).then(e=>{let[t,a]=e;return t.map((e,t)=>[e,a[t]])});let a=[];return e("readonly",e=>(function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},pW(e.transaction)})(e,e=>a.push([e.key,e.value])).then(()=>a))})}(this.store)).filter(e=>{let[t,a]=e;return"maxId"!==t}).sort((e,t)=>{var a,n;return(null===(a=e[1])||void 0===a?void 0:a.id)-(null===(n=t[1])||void 0===n?void 0:n.id)}).map(e=>{let[t,a]=e;return a})}),this.deleteLogs=e=>p4(this,void 0,void 0,function*(){if(this.isReseting)return p9();this.isChangingLog=!0,yield p3(()=>p4(this,void 0,void 0,function*(){p1(e.map(e=>`${e}`),this.store)}),p7),yield this.adjustMaxId()}),this.saveAESGCM256Key=(e,t,a)=>p4(this,void 0,void 0,function*(){if(a){let n=yield self.crypto.subtle.exportKey("raw",t),i=yield my(n,a,new Uint8Array(16));yield this.setSecret(`aes-gcm-256-${e}`,i)}else yield this.setSecret(`aes-gcm-256-${e}`,t)}),this.loadAESGCM256Key=(e,t)=>p4(this,void 0,void 0,function*(){let a=yield this.getSecret(`aes-gcm-256-${e}`);if(!t)return!1;for(let e=0;e<t.length;e++)try{let n=t[e],i=yield mp(a,n,new Uint8Array(16));return yield self.crypto.subtle.importKey("raw",i,"AES-GCM",!0,["decrypt"])}catch{continue}return!1}),this.reset=()=>p4(this,void 0,void 0,function*(){if(this.isReseting||(this.waitingForReset=!0,this.isChangingLog||this.isChangingMeta))return p9();this.isReseting=!0,yield function(e){return void 0===e&&(e=pX()),e("readwrite",e=>(e.clear(),pW(e.transaction)))}(this.store),this.isReseting=!1,this.waitingForReset=!1}),this.store=pY(e,e+"-store"),this.keyStore=pY(e+"-sec",e+"-store"),p6(p8,()=>{this.isChangingMeta=!1,this.waitingForReset&&this.reset()}),p6(p7,()=>{this.isChangingLog=!1,this.waitingForReset&&this.reset()})}}var ht=globalThis&&globalThis.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,s){function r(e){try{o(n.next(e))}catch(e){s(e)}}function l(e){try{o(n.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):(function(e){return e instanceof a?e:new a(function(t){t(e)})})(e.value).then(r,l)}o((n=n.apply(e,t||[])).next())})};let ha={databaseName:"laplace-default-db",maxSize:49283072};class hn{constructor(e){this.commonLogWithContext=(e,t,a,n,i)=>ht(this,void 0,void 0,function*(){yield mB(this.runtimeMetaManager,e,t,a,n,i)}),this.commonReportWithContext=(e,t)=>ht(this,void 0,void 0,function*(){yield pq(this.runtimeMetaManager,e,t)}),this.commonDeleteWithContext=e=>ht(this,void 0,void 0,function*(){yield pK(this.runtimeMetaManager,e)}),this.resetWithContext=()=>ht(this,void 0,void 0,function*(){yield pJ(this.runtimeMetaManager)}),this.initLocalAESGCM256Key=()=>ht(this,void 0,void 0,function*(){return yield mo()}),this.doNotUseDirtyGetStore=()=>this.runtimeMetaManager.logManager.getStore(),this.log=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.log,hW.PLAIN,{extraProperties:a})}),this.info=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.info,hW.PLAIN,{extraProperties:a})}),this.warn=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.warn,hW.PLAIN,{extraProperties:a})}),this.debug=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.debug,hW.PLAIN,{extraProperties:a})}),this.error=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.error,hW.PLAIN,{extraProperties:a})}),this.logWithEncryption=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.log,hW.AESGCM256,{extraProperties:a})}),this.infoWithEncryption=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.info,hW.AESGCM256,{extraProperties:a})}),this.debugWithEncryption=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.debug,hW.AESGCM256,{extraProperties:a})}),this.warnWithEncryption=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.warn,hW.AESGCM256,{extraProperties:a})}),this.errorWithEncryption=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.error,hW.AESGCM256,{extraProperties:a})}),this.logWithoutCache=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.log,hW.PLAIN,{extraProperties:a,noCache:!0})}),this.infoWithoutCache=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.info,hW.PLAIN,{extraProperties:a,noCache:!0})}),this.warnWithoutCache=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.warn,hW.PLAIN,{extraProperties:a,noCache:!0})}),this.debugWithoutCache=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.debug,hW.PLAIN,{extraProperties:a,noCache:!0})}),this.errorWithoutCache=(e,t,a)=>ht(this,void 0,void 0,function*(){yield this.commonLogWithContext(e,t,hY.error,hW.PLAIN,{extraProperties:a,noCache:!0})}),this.getLogs=e=>{let t=this.runtimeMetaManager.logManager;return t?t.filterStore(e):new Map},this.reportByHttps=(e,t)=>ht(this,void 0,void 0,function*(){yield this.commonReportWithContext(e,t)}),this.deleteLog=e=>ht(this,void 0,void 0,function*(){yield this.commonDeleteWithContext(e)}),this.deleteAll=()=>ht(this,void 0,void 0,function*(){yield this.resetWithContext()});let{runtimeMetaManager:t}=e;this.runtimeMetaManager=t}}hn.init=e=>ht(void 0,void 0,void 0,function*(){let{databaseName:t="laplace-default-db"}=e,a=new he(t),n=new mO,i=new mS(Object.assign(Object.assign(Object.assign({},ha),e),{idbManager:a,logManager:n}));mD(i,hQ.beforeInit),yield n.syncFromIDB(i.idbManager);let s=new hn({runtimeMetaManager:i});return mD(i,hQ.afterInit),s});let hi=e=>{let t=[];for(let[a,n]of e)t.push(n);return t};class hs extends u2{constructor(e){super(),this.config={debug:!1},this.debugLog=e=>{let{debug:t}=this.config},this.afterInit=e=>{let{expireBefore:t}=this.config;if(!t){this.debugLog("early return on beforeInit because expireBefore is falsy");return}let{logManager:a,commonMethods:{commonDelete:n}}=e,i=a.getStore().byTime,s=("function"==typeof t?hi(i).filter(t):hi(i).filter(e=>e.timestamp<t)).map(e=>e.id);n(e,void 0,s),this.debugLog(`afterInit, clean log id: ${s}`)},this.afterReport=(e,t)=>{let{reportItems:a,report:n,nextReportItems:i,error:s}=t;if(s){this.debugLog("error"),console.error(s);return}let{cleanAfterReport:r}=this.config;if(!r){this.debugLog("early return on afterReport because cleanAfterReport is falsy");return}let{commonMethods:{commonDelete:l}}=e,o=("function"==typeof r?hi(a).filter(r):hi(a)).map(e=>e.id);l(e,void 0,o),this.debugLog(`afterReport, clean log id: ${o}`)},e&&(this.config=e)}}var hr="object"==typeof global&&global&&global.Object===Object&&global,hl="object"==typeof self&&self&&self.Object===Object&&self,ho=hr||hl||Function("return this")(),hd=ho.Symbol,hc=Object.prototype,hu=hc.hasOwnProperty,hm=hc.toString,hp=hd?hd.toStringTag:void 0,hh=Object.prototype.toString,hf=hd?hd.toStringTag:void 0;function hg(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var hy=ho["__core-js_shared__"],hv=function(){var e=/[^.]+$/.exec(hy&&hy.keys&&hy.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),h_=Function.prototype.toString,hb=/^\[object .+?Constructor\]$/,hM=Object.prototype,hx=Function.prototype.toString,hC=hM.hasOwnProperty,hj=RegExp("^"+hx.call(hC).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function hN(e,t){var a=function(e,t){return null==e?void 0:e[t]}(e,t);return!function(e){return!(!hg(e)||function(e){return!!hv&&hv in e}(e))&&(!function(e){if(!hg(e))return!1;var t=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":hf&&hf in Object(e)?function(e){var t=hu.call(e,hp),a=e[hp];try{e[hp]=void 0;var n=!0}catch{}var i=hm.call(e);return n&&(t?e[hp]=a:delete e[hp]),i}(e):function(e){return hh.call(e)}(e)}(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)?hb:hj).test(function(e){if(null!=e){try{return h_.call(e)}catch{}try{return e+""}catch{}}return""}(e))}(a)?void 0:a}var hw=hN(Object,"create"),hI=Object.prototype.hasOwnProperty,hT=Object.prototype.hasOwnProperty;function hE(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}function hS(e,t){for(var a=e.length;a--;)if(function(e,t){return e===t||e!==e&&t!==t}(e[a][0],t))return a;return -1}hE.prototype.clear=function(){this.__data__=hw?hw(null):{},this.size=0},hE.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},hE.prototype.get=function(e){var t=this.__data__;if(hw){var a=t[e];return"__lodash_hash_undefined__"===a?void 0:a}return hI.call(t,e)?t[e]:void 0},hE.prototype.has=function(e){var t=this.__data__;return hw?void 0!==t[e]:hT.call(t,e)},hE.prototype.set=function(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=hw&&void 0===t?"__lodash_hash_undefined__":t,this};var hk=Array.prototype.splice;function hA(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}hA.prototype.clear=function(){this.__data__=[],this.size=0},hA.prototype.delete=function(e){var t=this.__data__,a=hS(t,e);return!(a<0)&&(a==t.length-1?t.pop():hk.call(t,a,1),--this.size,!0)},hA.prototype.get=function(e){var t=this.__data__,a=hS(t,e);return a<0?void 0:t[a][1]},hA.prototype.has=function(e){return hS(this.__data__,e)>-1},hA.prototype.set=function(e,t){var a=this.__data__,n=hS(a,e);return n<0?(++this.size,a.push([e,t])):a[n][1]=t,this};var hR=hN(ho,"Map");function hL(e,t){var a=e.__data__;return!function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?a.map:a["string"==typeof t?"string":"hash"]}function hO(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}function hD(e){var t=-1,a=null==e?0:e.length;for(this.__data__=new hO;++t<a;)this.add(e[t])}function hP(e){return e!==e}function hF(e,t){return!!(null==e?0:e.length)&&function(e,t,a){return t===t?function(e,t,a){for(var n=a-1,i=e.length;++n<i;)if(e[n]===t)return n;return -1}(e,t,a):function(e,t,a,n){for(var i=e.length,s=a+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return -1}(e,hP,a)}(e,t,0)>-1}function hB(e,t,a){for(var n=-1,i=null==e?0:e.length;++n<i;)if(a(t,e[n]))return!0;return!1}function hU(e,t){return e.has(t)}hO.prototype.clear=function(){this.size=0,this.__data__={hash:new hE,map:new(hR||hA),string:new hE}},hO.prototype.delete=function(e){var t=hL(this,e).delete(e);return this.size-=t?1:0,t},hO.prototype.get=function(e){return hL(this,e).get(e)},hO.prototype.has=function(e){return hL(this,e).has(e)},hO.prototype.set=function(e,t){var a=hL(this,e),n=a.size;return a.set(e,t),this.size+=a.size==n?0:1,this},hD.prototype.add=hD.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},hD.prototype.has=function(e){return this.__data__.has(e)};var hH=hN(ho,"Set");function hz(e){var t=-1,a=Array(e.size);return e.forEach(function(e){a[++t]=e}),a}var hV=hH&&1/hz(new hH([,-0]))[1]==1/0?function(e){return new hH(e)}:function(){};let hG=new class{constructor(){this.timer=null,this.micro=Promise.resolve()}send(e){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{this.micro.then(e),this.timer=null},1e3)}},hq="JS_ERROR";class h$ extends u2{constructor(e){super(),this.config={debug:!1,publicTags:[]},this.transport=hG,this.errorCount=0,this.addPublicTags=e=>{let{publicTags:t}=this.config;return t?[...e,...t]:e},this.debugLog=e=>{let{debug:t}=this.config},this.ignore=e=>{var t,a,n,i,s;return(null==(t=this.config)?void 0:t.maxErrorCount)!==void 0&&this.errorCount>=(null==(a=this.config)?void 0:a.maxErrorCount)||null!=(n=this.config)&&!!n.ignoredErrorMsgKeywords&&e&&(null==(s=null==(i=this.config)?void 0:i.ignoredErrorMsgKeywords)?void 0:s.some(t=>null==e?void 0:e.includes(t)))},this.afterInit=e=>{if(!self.addEventListener)return;let{commonMethods:{commonLog:t,commonReport:a}}=e,{autoReport:n}=this.config,i=()=>{n&&this.transport.send(()=>{a(e,void 0,n).catch(()=>{t(e,"auto log error plugin report failed",this.addPublicTags([hq]),hY.error,hW.PLAIN)}),this.debugLog(`report with option: ${JSON.stringify(n)}`)})};try{self.addEventListener("error",async a=>{var n,s,r,l,o,d;if(!this.ignore(null==a?void 0:a.message)){if(null!=a&&a.target&&(null!=(n=null==a?void 0:a.target)&&n.src||null!=(s=null==a?void 0:a.target)&&s.href)){let n=`Load Resource Error in ${null==(r=null==a?void 0:a.target)?void 0:r.tagName} element: ${(null==(l=null==a?void 0:a.target)?void 0:l.src)||(null==(o=null==a?void 0:a.target)?void 0:o.href)}`;await t(e,n,this.addPublicTags(["RESOURCE_ERROR"]),hY.error,hW.PLAIN),this.errorCount+=1,i(),this.debugLog(n)}else{let n=`Javascript Runtime Error in ${null==a?void 0:a.filename} (${null==a?void 0:a.lineno}:${null==a?void 0:a.colno}): ${null==a?void 0:a.message}
Stack: ${(null==(d=null==a?void 0:a.error)?void 0:d.stack)??(null==a?void 0:a.stack)}`;await t(e,n,this.addPublicTags([hq]),hY.error,hW.PLAIN),this.errorCount+=1,i(),this.debugLog(a)}}}),self.addEventListener("unhandledrejection",async a=>{var n;if(this.ignore(null==(n=null==a?void 0:a.reason)?void 0:n.message))return;let s="",{reason:r}=a;s="string"==typeof r?`Promise Error: ${r}`:"object"==typeof r?`Promise Error with reason: ${JSON.stringify(r)}`:`Promise Error with unrecognized reason: ${r}`,await t(e,s,this.addPublicTags(["UNHANDLED_PROMISE_REJECTION"]),hY.error,hW.PLAIN),this.errorCount+=1,i(),this.debugLog(a)})}catch(e){console.error(e)}this.debugLog("afterInit, add listener")},e&&(this.config=e),null!=e&&e.publicTags&&!Array.isArray(null==e?void 0:e.publicTags)&&(this.config.publicTags=[null==e?void 0:e.publicTags])}}class hK extends u2{constructor(e){super(),this.config={debug:!1,publicTags:[]},this.transport=hG,this.addPublicTags=e=>{let{publicTags:t}=this.config;return t?[...e,...t]:e},this.debugLog=e=>{let{debug:t}=this.config},this.afterInit=e=>{let{autoReport:t}=this.config,{commonMethods:{commonLog:a,commonReport:n}}=e,i=()=>{t&&this.transport.send(()=>{n(e,void 0,t).catch(t=>{a(e,`memory auto report failed: ${t}`,this.addPublicTags(["JS_ERROR"]),hY.error,hW.PLAIN)})})},s=e=>{this.debugLog(e)},r=async t=>{s(`Memory usage: ${t.bytes}`);let n=JSON.stringify({...t}),r=this.addPublicTags(["CHAT_MEASURE_MEMORY"]);await a(e,n,r,hY.info,hW.PLAIN),i()},l=()=>-(3e5*Math.log(Math.random()));async function o(){let e;try{e=await performance.measureUserAgentSpecificMemory()}catch(e){if(e instanceof DOMException&&"SecurityError"===e.name){s("The context is not secure.");return}throw e}r(e),d()}function d(){if(!window.crossOriginIsolated||!performance.measureUserAgentSpecificMemory){s("performance.measureUserAgentSpecificMemory() is not available");return}let e=l();s(`Running next memory measurement in ${Math.round(e/1e3)} seconds`),setTimeout(o,e)}d()},e&&(this.config=e),null!=e&&e.publicTags&&!Array.isArray(null==e?void 0:e.publicTags)&&(this.config.publicTags=[null==e?void 0:e.publicTags])}}var hJ,hW,hY,hX,hQ,hZ,h1,h0,h2,h5,h3=-1,h6=function(e){addEventListener("pageshow",function(t){t.persisted&&(h3=t.timeStamp,e(t))},!0)},h4=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},h8=function(){var e=h4();return e&&e.activationStart||0},h7=function(e,t){var a=h4(),n="navigate";return h3>=0?n="back-forward-cache":a&&(document.prerendering||h8()>0?n="prerender":document.wasDiscarded?n="restore":a.type&&(n=a.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},h9=function(e,t,a){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver(function(e){Promise.resolve().then(function(){t(e.getEntries())})});return n.observe(Object.assign({type:e,buffered:!0},a||{})),n}}catch{}},fe=function(e,t,a,n){var i,s;return function(r){t.value>=0&&(r||n)&&((s=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=s,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,a),e(t))}},ft=function(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})},fa=function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},fn=function(e){var t=!1;return function(a){t||(e(a),t=!0)}},fi=-1,fs=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},fr=function(e){"hidden"===document.visibilityState&&fi>-1&&(fi="visibilitychange"===e.type?e.timeStamp:0,fo())},fl=function(){addEventListener("visibilitychange",fr,!0),addEventListener("prerenderingchange",fr,!0)},fo=function(){removeEventListener("visibilitychange",fr,!0),removeEventListener("prerenderingchange",fr,!0)},fd=function(){return fi<0&&(fi=fs(),fl(),h6(function(){setTimeout(function(){fi=fs(),fl()},0)})),{get firstHiddenTime(){return fi}}},fc=function(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()},fu=[1800,3e3],fm=function(e,t){t=t||{},fc(function(){var a,n=fd(),i=h7("FCP"),s=h9("paint",function(e){e.forEach(function(e){"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<n.firstHiddenTime&&(i.value=Math.max(e.startTime-h8(),0),i.entries.push(e),a(!0)))})});s&&(a=fe(e,i,fu,t.reportAllChanges),h6(function(n){a=fe(e,i=h7("FCP"),fu,t.reportAllChanges),ft(function(){i.value=performance.now()-n.timeStamp,a(!0)})}))})},fp=[.1,.25],fh=function(e,t){t=t||{},fm(fn(function(){var a,n=h7("CLS",0),i=0,s=[],r=function(e){e.forEach(function(e){if(!e.hadRecentInput){var t=s[0],a=s[s.length-1];i&&e.startTime-a.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,s.push(e)):(i=e.value,s=[e])}}),i>n.value&&(n.value=i,n.entries=s,a())},l=h9("layout-shift",r);l&&(a=fe(e,n,fp,t.reportAllChanges),fa(function(){r(l.takeRecords()),a(!0)}),h6(function(){i=0,a=fe(e,n=h7("CLS",0),fp,t.reportAllChanges),ft(function(){return a()})}),setTimeout(a,0))}))},ff={passive:!0,capture:!0},fg=new Date,fy=function(e,t){h1||(h1=t,h0=e,h2=new Date,fb(removeEventListener),fv())},fv=function(){if(h0>=0&&h0<h2-fg){var e={entryType:"first-input",name:h1.type,target:h1.target,cancelable:h1.cancelable,startTime:h1.timeStamp,processingStart:h1.timeStamp+h0};h5.forEach(function(t){t(e)}),h5=[]}},f_=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var a=function(){fy(e,t),i()},n=function(){i()},i=function(){removeEventListener("pointerup",a,ff),removeEventListener("pointercancel",n,ff)};addEventListener("pointerup",a,ff),addEventListener("pointercancel",n,ff)}(t,e):fy(t,e)}},fb=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,f_,ff)})},fM=[100,300],fx=function(e,t){t=t||{},fc(function(){var a,n=fd(),i=h7("FID"),s=function(e){e.startTime<n.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),a(!0))},r=function(e){e.forEach(s)},l=h9("first-input",r);a=fe(e,i,fM,t.reportAllChanges),l&&fa(fn(function(){r(l.takeRecords()),l.disconnect()})),l&&h6(function(){a=fe(e,i=h7("FID"),fM,t.reportAllChanges),h5=[],h0=-1,h1=null,fb(addEventListener),h5.push(s),fv()})})},fC=[2500,4e3],fj={},fN=function(e,t){t=t||{},fc(function(){var a,n=fd(),i=h7("LCP"),s=function(e){var t=e[e.length-1];t&&t.startTime<n.firstHiddenTime&&(i.value=Math.max(t.startTime-h8(),0),i.entries=[t],a())},r=h9("largest-contentful-paint",s);if(r){a=fe(e,i,fC,t.reportAllChanges);var l=fn(function(){fj[i.id]||(s(r.takeRecords()),r.disconnect(),fj[i.id]=!0,a(!0))});["keydown","click"].forEach(function(e){addEventListener(e,l,!0)}),fa(l),h6(function(n){a=fe(e,i=h7("LCP"),fC,t.reportAllChanges),ft(function(){i.value=performance.now()-n.timeStamp,fj[i.id]=!0,a(!0)})})}})},fw=[800,1800],fI=function e(t){document.prerendering?fc(function(){return e(t)}):"complete"!==document.readyState?addEventListener("load",function(){return e(t)},!0):setTimeout(t,0)},fT=function(e,t){t=t||{};var a=h7("TTFB"),n=fe(e,a,fw,t.reportAllChanges);fI(function(){var i=h4();if(i){var s=i.responseStart;if(s<=0||s>performance.now())return;a.value=Math.max(s-h8(),0),a.entries=[i],n(!0),h6(function(){(n=fe(e,a=h7("TTFB",0),fw,t.reportAllChanges))(!0)})}})};class fE extends u2{constructor(e){super(),this.config={debug:!1,publicTags:[]},this.transport=hG,this.addPublicTags=e=>{let{publicTags:t}=this.config;return t?[...e,...t]:e},this.debugLog=e=>{let{debug:t}=this.config},this.afterInit=e=>{let{autoReport:t}=this.config,{commonMethods:{commonLog:a,commonReport:n}}=e,i=()=>{t&&this.transport.send(()=>{n(e,void 0,t).catch(()=>{a(e,"web vitals auto report failed",["JS_ERROR"],hY.error,hW.PLAIN)})})},s=t=>async n=>{let s=JSON.stringify({...n,duration:parseInt(n.value.toString())}),r=this.addPublicTags([t,"CHAT_WEB_VITALS"]);this.debugLog(s),await a(e,s,r,hY.info,hW.PLAIN),i()};fh(s("CLS")),fx(s("FID")),fN(s("LCP")),fT(s("TTFB")),fm(s("FCP"))},e&&(this.config=e),null!=e&&e.publicTags&&(this.config.publicTags=[null==e?void 0:e.publicTags].flatMap(e=>e).map(e=>"function"==typeof e?e():e).filter(e=>e))}}let fS=new class{constructor(){this.DATABASE="laplace-team-chat-database",this.MAXIMUM_SIZE=49283072,this.LOG_GATEWAY_API_ROUTE="/pwa/webclient",this.trackingId=function(){let e=new Date().getTime(),t=(null==performance?void 0:performance.now)&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{let n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===a?n:3&n|8).toString(16)})}(),this.tags=[this.trackingId,"ZOOM TEAM CHAT"],this.reportUrl=u1.gatewayEndPoint?u1.gatewayEndPoint+this.LOG_GATEWAY_API_ROUTE:"",this.laplace=null,this.debug=!1,this.transport=hG,this.debug=!1,u0&&this.initLaplace()}get plugins(){return[new h$({autoReport:{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}},publicTags:this.tags}),new hs({debug:!1,cleanAfterReport:!0}),new hK({autoReport:{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}},publicTags:this.tags}),new fE({autoReport:{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}},publicTags:this.tags})]}get laplaceConfig(){return{databaseName:this.DATABASE,maxSize:this.MAXIMUM_SIZE,publicKey:"",reportUrl:this.reportUrl,plugins:this.plugins}}concatTags(e){return null!=e&&e.length?function(e){return e&&e.length?function(e,t,a){var n=-1,i=hF,s=e.length,r=!0,l=[],o=l;if(a)r=!1,i=hB;else if(s>=200){var d=t?null:hV(e);if(d)return hz(d);r=!1,i=hU,o=new hD}else o=t?[]:l;e:for(;++n<s;){var c=e[n],u=t?t(c):c;if(c=a||0!==c?c:0,r&&u===u){for(var m=o.length;m--;)if(o[m]===u)continue e;t&&o.push(u),l.push(c)}else i(o,u,a)||(o!==l&&o.push(u),l.push(c))}return l}(e):[]}(function(e){for(var t=-1,a=null==e?0:e.length,n=0,i=[];++t<a;){var s=e[t];s&&(i[n++]=s)}return i}("string"==typeof e?[...this.tags,e]:[...this.tags,...e])):this.tags}reportToGlobalTracing(){this.transport.send(()=>{var e;null==(e=this.laplace)||e.reportByHttps(void 0,{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}}).catch(e=>{console.error(e)})})}debugLog(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];this.debug}log(e,t){var a;null==(a=this.laplace)||a.logWithEncryption(e,this.concatTags(t)).then(()=>{this.reportToGlobalTracing()}).catch(e=>{console.error(e)}),this.debugLog("log",e)}warn(e,t){var a;null==(a=this.laplace)||a.warnWithEncryption(e,this.concatTags(t)).then(()=>{this.reportToGlobalTracing()}).catch(e=>{console.error(e)}),this.debugLog("warn",e)}info(e,t){var a;null==(a=this.laplace)||a.infoWithEncryption(e,this.concatTags(t)).then(()=>{this.reportToGlobalTracing()}).catch(e=>{console.error(e)}),this.debugLog("info",e)}error(e,t){var a;null==(a=this.laplace)||a.errorWithEncryption(e,this.concatTags(t)).then(()=>{this.reportToGlobalTracing()}).catch(e=>{console.error(e)}),this.debugLog("error",e)}now(){return"function"==typeof performance.now?parseInt(performance.now().toString()):Date.now()-performance.timing.navigationStart}logMeasure(e,t){let a=this.now(),n=0,i=a,s,r;if(t){if("string"==typeof t)s=[t];else if(Array.isArray(t))s=[...t];else{if(!(void 0===t.duration||void 0===t.start||void 0===t.end)){console.error("Failed to execute 'measure', it must not have all of its 'start', 'duration', and 'end' properties defined");return}if(void 0!==t.duration)i=t.duration;else{let{start:e=0,end:n=a}=t;i=n-e}if(void 0!==t.start)n=t.start;else{let{duration:e=a,end:i=a}=t;n=i-e}r=t.detail,s=t.tags}}let l={name:e,duration:i,detail:r,startTime:n};this.log(JSON.stringify(l),s)}getExternalKeys(e){let t=(e??[]).sort((e,t)=>Number(t.version)-Number(e.version));return Promise.all(t.map(e=>(function(e){let t=e.slice(0,32),a=new TextEncoder;return window.crypto.subtle.importKey("raw",a.encode(t),"AES-GCM",!1,["encrypt","decrypt"])})(e.value))).then(e=>e.map(e=>({usage:hX.PROTECT_LOCAL_KEY,key:e}))).catch(e=>{console.error(e)})}initLaplace(){let e=uZ(window.pwaChatConfig.encryptedKeys??"",[]);e.length&&this.getExternalKeys(e).then(e=>{hn.init({...this.laplaceConfig,externalKeys:e}).then(e=>{this.laplace=e}).catch(e=>{console.error(e)})})}};var fk=(e=>(e.PLATFORM_CHAT="PLATFORM_CHAT",e.PLATFORM_WC="PLATFORM_WC",e.BY_LOCAL="BY_LOCAL",e.BY_ONLINE="BY_ONLINE",e.LOAD_MESSAGES="LOAD_MESSAGES",e.LOAD_BOOKMARKS="LOAD_BOOKMARKS",e.LOAD_MENTIONS="LOAD_MENTIONS",e.LOAD_REMINDERS="LOAD_REMINDERS",e.LOAD_FILES="LOAD_FILES",e.LOAD_CONTACT_REQUESTS="LOAD_CONTACT_REQUESTS",e.LOAD_SIDEBAR_CHATS="LOAD_SIDEBAR_CHATS",e.LOAD_NOTES="LOAD_NOTES",e.LOAD_CHAT_MSGS="LOAD_CHAT_MSGS",e.LOAD_MORE_MSGS="LOAD_MORE_MSGS",e.XMPP_CONNECTED="XMPP_CONNECTED",e.GET_UNREAD="GET_UNREAD",e.HTTP="HTTP",e))(fk||{});window.React.useRef;let fA={},fR={optimisticRevoked:eb.boolean(),isEditorOpen:eb.boolean(),isEditing:eb.boolean(),isSending:eb.boolean().optional(),isPartial:eb.boolean(),isRealTime:eb.boolean().optional()},fL={width:eb.number(),height:eb.number(),size:eb.number(),url:eb.string(),objectUrl:eb.string().optional(),mp4:eb.string().optional(),webp:eb.string().optional()},fO={id:eb.string(),url:eb.string(),rating:eb.string(),title:eb.string(),type:eb.literal("gif"),tags:eb.string().optional(),images:eb.object({bigPicInfo:eb.object(fL),pcPicInfo:eb.object(fL),mobilePicInfo:eb.object(fL)})},fD={...fR,id:eb.string(),channelJid:eb.string(),message:eb.string(),messageXmlStr:eb.string(),time:eb.number(),lastCommentTimestamp:eb.number().optional(),operType:eb.nativeEnum(em),senderName:eb.string().nullable(),senderJid:eb.string().nullable(),senderAvatar:eb.string().nullable().optional(),error:eb.any(),emojiVotes:eb.record(eb.object({count:eb.number(),firstEmojiTime:eb.number(),haveIEmojied:eb.boolean()})),commentTotal:eb.number().optional(),replyId:eb.string().nullable().optional(),replyOwnerJid:eb.string().nullable().optional(),replyThreadTime:eb.number().nullable().optional(),isUnreadMsg:eb.boolean(),channelName:eb.string().optional(),receiverJid:eb.string().optional(),meetChat:eb.object({from:eb.string(),isGuset:eb.number(),ct:eb.number(),meetid:eb.string(),showGuestLabel:eb.boolean(),isSupportPMCSync:eb.boolean()}).optional()},fP={jid:eb.string(),name:eb.string(),nickname:eb.string().optional(),firstname:eb.string().optional(),lastname:eb.string().optional(),email:eb.string(),pronoun:eb.string().nullable().optional(),avatar:eb.string().nullable().optional(),orgUnit:eb.string().nullable(),accountStatus:eb.nativeEnum(aC).nullable().optional(),signature:eb.object({begin:eb.number(),end:eb.number(),duration:eb.number(),option:eb.number(),wording:eb.string().nullable().optional()}).optional(),jobInfo:eb.object({company:eb.string().nullable(),job:eb.string().nullable(),address:eb.string().nullable(),department:eb.string().nullable()}).optional(),contactInfo:eb.object({phones:eb.array(eb.object({label:eb.nativeEnum(aj),value:eb.string()}).or(eb.void())),extension:eb.string(),dn:eb.array(eb.string()),cn:eb.string()}).optional(),isCache:eb.boolean().optional()},fF={channelJid:eb.string().optional(),msgId:eb.string(),msgTimestamp:eb.number(),mainMsgId:eb.string(),mainMsgTimestamp:eb.number(),pinner:eb.object(fP).partial().optional(),pinTimestamp:eb.number(),type:eb.nativeEnum(aN)},fB={...fF,msgType:eb.literal(i.text),msg:eb.string()},fU={fileId:eb.string(),fileName:eb.string(),size:eb.number(),file:eb.instanceof(Blob).optional(),fileUrl:eb.string().optional(),url:eb.string().optional(),fileError:eb.any().optional()},fH={...fU,defaultImage:eb.string().optional(),fileType:eb.string().optional(),type:eb.number(),startpos:eb.number(),endpos:eb.number(),imageSize:eb.object({cx:eb.number().optional(),cy:eb.number().optional()}).optional()},fz={meetingNo:eb.string().optional()},fV={raw:eb.object(fz),action:eb.string(),subtype:eb.number().optional()},fG={...fF,msgType:eb.literal(i.file),file:eb.object(fU).optional()},fq={...fG,msgType:eb.literal(i.image)},f$={...fF,msgType:eb.literal(i.unknown)},fK={...fF,msgType:eb.literal(i.e2e)},fJ={...fF,msgType:eb.literal(i.mix)},fW={...fF,msgType:eb.literal(i.screenshot)},fY={...fF,msgType:eb.literal(i.call)},fX={...fF,msgType:eb.literal(i.codeSnippet)},fQ={...fF,msgType:eb.literal(i.bot)},fZ=[i.dropbox,i.microsoftOneDrive,i.googleDrive,i.box,i.microsoftSharePoint],f1=[eb.literal(i.dropbox),eb.literal(i.microsoftOneDrive),eb.literal(i.googleDrive),eb.literal(i.box),eb.literal(i.microsoftSharePoint)],f0={...fF,msgType:eb.union(f1),file:eb.object(fU).optional()},f2={...fD,fontStyle:eb.array(eb.object({type:eb.number(),endpos:eb.number(),startpos:eb.number(),reserve1:eb.string().optional()})),mention:eb.array(eb.object({jid:eb.string(),start:eb.number(),end:eb.number(),type:eb.nativeEnum(aw)}))},f5={...fD,messageType:eb.literal("forbidden")},f3={...fD,messageType:eb.literal(i.text),...f2},f6={...fD,messageType:eb.literal(i.info),actionInfo:eb.object({type:eb.nativeEnum(aI).or(eb.unknown()),operator:eb.object({name:eb.string().nullable(),jid:eb.string().nullable()}),buddyList:eb.array(eb.object({name:eb.string().nullable(),jid:eb.string().nullable()})).optional(),emailList:eb.array(eb.string()).optional(),notAllowedList:eb.array(eb.object({name:eb.string().nullable(),jid:eb.string().nullable(),reason:eb.number()})).optional(),errorType:eb.string().optional(),pins:eb.object({option:eb.number().optional(),pinList:eb.array(eb.union([eb.object(fG).partial(),eb.object(fB).partial(),eb.object(fq).partial(),eb.object(f$).partial(),eb.object(fJ).partial(),eb.object(fY).partial(),eb.object(fW).partial(),eb.object(fK).partial(),eb.object(fX).partial(),eb.object(fQ).partial(),eb.object(f0).partial()]))}).optional(),room:eb.object({name:eb.string(),desc:eb.string().optional(),descAction:eb.string().optional(),option:eb.number().or(eb.string()),mentionGroupData:eb.object({version:eb.number().optional(),jid:eb.string(),channelJid:eb.string(),name:eb.string().optional(),description:eb.string().optional(),members:eb.array(eb.string()).optional(),owner:eb.string().optional(),action:eb.nativeEnum(aT),addList:eb.array(eb.string()).optional(),removeList:eb.array(eb.string()).optional()}).optional()})}).optional()},f4={...fD,messageType:eb.literal(i.pmc),pmcMsgInfo:eb.object({id:eb.string(),hostId:eb.string(),accountId:eb.string(),number:eb.number(),topic:eb.string(),status:eb.number(),type:eb.number(),startTime:eb.number(),endTime:eb.number(),duration:eb.number(),timezone:eb.string(),modifyTime:eb.number(),options:eb.number(),createTime:eb.number(),originalMtgNumber:eb.number(),password:eb.string(),originalFrom:eb.number(),meetingType:eb.number(),joinUrl:eb.string(),attendeeCount:eb.number(),scheduleWithPMI:eb.boolean(),recurringType:eb.number(),occurrencesCount:eb.number(),realStartTime:eb.number(),realEndTime:eb.number()}).optional()},f8={...fD,messageType:eb.literal(i.giphy),giphyInfo:eb.object(fO).optional()},f7={id:eb.string(),fileName:eb.string(),fileSize:eb.number(),extFile:eb.string().optional(),previewLink:eb.string(),previewPath:eb.string(),integrationType:eb.string().optional(),thirdPartyFileType:eb.string().optional()},f9={...fD,messageType:eb.literal(i.file),file:eb.object(fU),thirdPartyType:eb.union(f1).optional(),thirdStorageInfo:eb.object(f7).optional()},ge={...fD,messageType:eb.literal(i.image),file:eb.object(fU)},gt={description:eb.string(),html:eb.string(),type:eb.string(),total_lines:eb.number(),code:eb.string()},ga={...fD,messageType:eb.literal(i.codeSnippet),file:eb.object({fileId:eb.string(),fileName:eb.string(),size:eb.number(),codeSnippet:eb.object(gt).optional()})},gn={...fD,messageType:eb.literal(i.screenshot),file:eb.object(fU)};eb.literal(i.composing),eb.literal(i.inactive),eb.literal(i.gone),eb.literal(i.active);let gi={...fD,messageType:eb.literal(i.e2e)},gs={...fD,messageType:eb.literal(i.unknown)},gr={...fD,...f2,messageType:eb.literal(i.mix),allFiles:eb.array(eb.object(fH)),failureBody:eb.number()},gl={...fD,callInfo:eb.object(fV).optional(),messageType:eb.literal(i.call)},go=eb.object({text:eb.string(),value:eb.string()}),gd=eb.object({color:eb.string(),bold:eb.boolean(),italic:eb.boolean()}).partial(),gc=eb.array(eb.object({text:eb.string(),hyperlink:eb.string(),sip:eb.string(),mailto:eb.string(),mention:eb.string(),linkto:eb.string(),img:eb.string(),imgAlt:eb.string(),dateFormat:eb.string(),profile:eb.string(),italic:eb.boolean(),bold:eb.boolean(),strikethrough:eb.boolean(),monospace:eb.boolean(),quotes:eb.number(),mentionAll:eb.boolean(),concat:eb.boolean(),timestamp:eb.number()}).partial()),gu=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.MESSAGE),text:eb.string(),editable:eb.boolean().optional(),link:eb.string().optional(),style:gd.optional(),isMarkdownSupport:eb.boolean().optional(),extractedMessages:gc.optional()}),gm=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.FIELDS),items:eb.array(eb.object({key:eb.string(),value:eb.string(),link:eb.string(),editable:eb.boolean().optional(),short:eb.boolean().optional(),style:gd.optional(),isMarkdownSupport:eb.boolean().optional(),extractedMessages:gc.optional()}))}),gp=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.SELECT),text:eb.string(),selectedItems:eb.array(go),groupItems:eb.array(eb.object({group:eb.string(),items:eb.array(go)})),staticSource:eb.string().optional()}),gh=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.ACTIONS),items:eb.array(eb.object({text:eb.string(),value:eb.string(),style:eb.nativeEnum(s_),action:eb.string().optional(),dialog:eb.object({link:eb.string(),width:eb.number(),height:eb.number(),size:eb.string(),title:eb.object({text:eb.string()}),hideTitle:eb.boolean(),hideApp:eb.boolean()}).optional()})),limit:eb.number().optional()}),gf=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.ATTACHMENTS),resourceUrl:eb.string(),imgUrl:eb.string(),information:eb.object({title:eb.object({text:eb.string()}),description:eb.object({text:eb.string()}).optional()}),ext:eb.string().optional(),size:eb.number().optional()}),gg=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.TIME_PICKER),actionId:eb.string(),initialTime:eb.string()}),gy=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.DATE_PICKER),initialDate:eb.string(),actionId:eb.string()}),gv=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.RADIO_BUTTONS),actionId:eb.string(),initialOption:go,options:eb.array(go)}),g_=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.DIVIDER),style:eb.object({color:eb.string(),bold:eb.boolean(),dotted:eb.boolean()})}),gb=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.PROGRESS_BAR),value:eb.number()}),gM=eb.object({eventId:eb.string(),version:eb.number(),type:eb.literal(sv.FILE),iconUrl:eb.string(),title:eb.object({text:eb.string(),fileUrl:eb.string()}),description:eb.object({text:eb.string()})}),gx=eb.object({version:eb.number(),type:eb.literal(sv.SECTION),sections:eb.array(eb.union([gu,gm,gp,gh,gf,gg,gy,gv,g_,gb,gM])),sidebarColor:eb.string(),footer:eb.string().optional(),footerIcon:eb.string().optional(),ts:eb.number().optional()}),gC=eb.object({head:eb.object({text:eb.string(),style:gd.optional(),isMarkdownSupport:eb.boolean().optional(),extractedMessages:gc.optional(),subHead:eb.object({text:eb.string(),style:gd.optional(),isMarkdownSupport:eb.boolean().optional(),extractedMessages:gc.optional()}).optional()}),body:eb.array(eb.union([gu,gm,gp,gh,gf,gx,gg,gy,gv,g_,gb,gM])),settings:eb.object({isSplitSidebar:eb.boolean(),defaultSidebarColor:eb.string()})}).partial(),gj=eb.object({messageData:gC,from:eb.string(),messageType:eb.number(),name:eb.string(),asyncid:eb.string().optional(),allowedDomains:eb.string().optional(),appFeatures:eb.number().optional(),mentionAll:eb.boolean().optional(),mentionSet:eb.string().optional(),templateVersion:eb.string().optional(),onlyyou:eb.number().optional()}),gN={...fD,messageType:eb.literal(i.bot),botTemplate:gj},gw={jid:eb.string(),name:eb.string(),role:eb.number(),joinTime:eb.number().nullable()},gI={jid:eb.string(),name:eb.string()};eb.string(),eb.string(),eb.number();let gT={jid:eb.string(),name:eb.string(),nickname:eb.string().optional(),firstname:eb.string().optional(),lastname:eb.string().optional(),email:eb.string().optional(),type:eb.nativeEnum(i5),sType:eb.string().optional(),avatar:eb.string().optional(),isPublic:eb.boolean().optional(),role:eb.number().optional(),latestTimestamp:eb.number().optional(),option:eb.string().nullable().optional(),isMeetChat:eb.boolean().optional(),isNoTopic:eb.boolean().optional(),isSpotChannel:eb.boolean().optional(),info:eb.object({PMC:eb.object({meetingNumber:eb.number(),option:eb.number()}).optional()}).optional(),sessionType:eb.nativeEnum(i1).optional()},gE={account:eb.string(),modifiedTime:eb.string(),version:eb.number().or(eb.string()).nullable(),createTime:eb.string().optional(),...gT};({accountID:eb.string(),...gT});let gS={channelJid:eb.string(),msgId:eb.string(),msgTimestamp:eb.number(),msgType:eb.union([eb.literal(i.file),eb.literal(i.text),eb.literal(i.image),eb.literal(i.unknown),eb.literal(i.mix),eb.literal(i.screenshot),eb.literal(i.e2e),eb.literal(i.codeSnippet),eb.literal(i.bot),eb.literal(i.call),eb.literal(i.bot),...f1]),mainMsgId:eb.string(),mainMsgTimestamp:eb.number(),type:eb.nativeEnum(aN),pinner:eb.object(fP).partial(),pinTimestamp:eb.number(),msg:eb.string().optional(),file:eb.object(fU).optional(),failureBody:eb.number().optional(),allFiles:eb.array(eb.object(fH)).optional(),thirdStorageInfo:eb.object(f7).optional()},gk={name:eb.string().or(eb.number()),jid:eb.string(),type:eb.nativeEnum(aE).nullable(),option:eb.number(),topPin:eb.object(gS).optional(),sType:eb.string().optional(),classification:eb.string().optional()},gA={...gk,latestVersion:eb.number(),version:eb.number(),modifiedTime:eb.number(),memberList:eb.array(eb.object(gw)),total:eb.number().optional(),isPublic:eb.boolean().optional(),canExternalAdd:eb.boolean().optional(),isYourOrg:eb.boolean().optional(),adminOnly:eb.boolean().optional(),adminAndSpecial:eb.boolean().optional(),historyMessagesVisible:eb.boolean().optional()},gR={threadTime:eb.number(),lastReadTime:eb.number(),unreadCount:eb.number()},gL={sessionId:eb.string(),unreadCount:eb.number(),lastReadTime:eb.number(),threadMap:eb.record(eb.string(),eb.object(gR)),markAsUnreadSet:eb.set(eb.number()).optional()};eb.string().optional(),eb.string().optional(),eb.string().optional(),eb.nativeEnum(aS).optional(),eb.nativeEnum(i1).optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.boolean().optional(),eb.number().or(eb.string()).optional(),eb.number().optional(),eb.boolean().optional(),eb.string().optional();let gO={jid:eb.string(),name:eb.string(),sessionType:eb.nativeEnum(i1),adminAndSpecial:eb.boolean(),adminOnly:eb.boolean(),canExternalAdd:eb.boolean(),fromChannel:eb.boolean(),fromMUC:eb.boolean(),historyMessagesVisible:eb.boolean(),isAdminAddMemberOnly:eb.boolean(),isAdminAddOutsideOnly:eb.boolean(),isE2EChannel:eb.boolean(),isExistRealMessage:eb.boolean(),isLargeChannel:eb.boolean(),isMeetChat:eb.boolean(),isNoTopic:eb.boolean(),isPublic:eb.boolean(),isSpotChannel:eb.boolean(),isYourOrg:eb.boolean(),isSharePoint:eb.boolean().optional(),isBox:eb.boolean().optional(),isUniversalChannel:eb.boolean().optional(),mcpType:eb.number().optional(),option:eb.number(),info:eb.object({PMC:eb.object({meetingNumber:eb.number(),option:eb.number()}).optional(),spotId:eb.string().optional()}).optional(),classification:eb.string().optional(),isCache:eb.boolean().optional()},gD={folderID:eb.string(),index:eb.string(),name:eb.string(),version:eb.number().optional(),members:eb.array(eb.object({folderID:eb.string(),index:eb.string(),objid:eb.string()}))};eb.string(),eb.string(),eb.number(),eb.number().nullable();let gP={groupId:eb.string(),role:eb.number()},gF=eb.object({bookmarks:eb.boolean(),contactRequests:eb.boolean(),reminders:eb.boolean(),files:eb.boolean(),oneSectionAllowed:eb.boolean(),separateChatAndChannel:eb.boolean(),showAvatarForDirectChat:eb.boolean(),sidebarTheme:eb.nativeEnum(sr),unreadMessagesOnTop:eb.boolean(),channelShowUnreadMessageCount:eb.boolean(),newRepliesAtBottomOfChat:eb.boolean(),showLinkPreview:eb.boolean(),statusToAwait:eb.boolean(),idleTime:eb.string(),channelUnreadStart:eb.nativeEnum(so)}),gB={id:eb.string(),accountId:eb.string(),name:eb.string(),description:eb.string(),color:eb.number(),type:eb.number(),createTime:eb.number(),modifyTime:eb.number()},gU=eb.object({cmd:eb.string(),extension:eb.object({appFeatures:eb.number(),capability:eb.number(),cmdModifyTime:eb.number(),notShow:eb.number(),shortcutsModifyTime:eb.number()}).partial(),firstName:eb.string(),lastName:eb.string(),introduction:eb.string(),jid:eb.string(),picRelateiveUrl:eb.string(),picUrl:eb.string(),signature:eb.string(),type:eb.number()});var gH=(e=>(e[e.none=0]="none",e[e.me=1]="me",e[e.all=2]="all",e))(gH||{});let gz=eb.object({time:eb.number(),type:eb.nativeEnum(gH),threadId:eb.string().optional().nullable(),threadTime:eb.number().optional().nullable()}),gV=eb.union([eb.literal("read"),eb.literal("marked"),eb.literal("markedPending")]),gG=function(e){return(t,a)=>{let n=e[t];if(!n)return t;let{on:i}=n,s=i[a];return void 0===s?t:s}}({read:{on:{MARK_UNREAD:"markedPending"}},marked:{on:{MARK_READ:"read"}},markedPending:{on:{CHANNEL_ACTIVE:"marked",MARK_READ:"read"}}}),gq=e_().schema(()=>({unreadMap:eb.record(eb.string(),eb.object(gL).optional()),mentionMap:eb.map(eb.string(),eb.map(eb.string(),gz)),markedState:eb.map(eb.string(),eb.map(eb.number(),gV))})).views(e=>{function t(t){return e.unreadMap[t]?.markAsUnreadSet?.size||0}function a(t){return e.unreadMap[t]?.unreadCount??0}function n(t,a){return e.markedState.get(t)?.get(a)??"read"}return{markCount:t,unreadCount:a,totalUnreadCount:e=>t(e)+a(e),lastReadReplyTime(t,a){let n=e.unreadMap[t];return n?.threadMap[a]?.lastReadTime},unreadThreads(t){let a=e.unreadMap[t];return a?ep(ak(a.threadMap),e=>{let{threadTime:t}=e;return t},"asc"):[]},mentioned(t){let a=Array.from(e.mentionMap.get(t)?.values()??[]);return a.length?a.some(e=>2===e.type)?2:1:0},marked:t=>e.unreadMap[t]?.markAsUnreadSet??new Set,markedMsgState:n,isMarked(e,t){let a=n(e,t);return"marked"===a||"markedPending"===a},get unreadSessionIds(){return Object.entries(e.unreadMap).reduce((e,t)=>{let[a,n]=t;return n?.unreadCount||n?.markAsUnreadSet?.size?[...e,a]:e},[])},get unreadSessionIdsWithMark(){return Object.entries(e.unreadMap).reduce((e,t)=>{let[a,n]=t;return n?.markAsUnreadSet?.size?[...e,a]:e},[])}}}).mutations(e=>{function t(t){let{sessionId:a,timestamp:n,event:i}=t,s=e.markedMsgState(a,n),r=gG(s,i),l=e.markedState.get(a);l?l.set(n,r):e.markedState.set(a,new Map([[n,r]]))}return{changeMarkedState:t,setUnreadMap(t){!function(e,t){let{patches:a}=lC(e,t,!1);try{lj(e,a,!1)}catch(e){console.error(e)}}(e.unreadMap,t.reduce((e,t)=>({...e,[t.sessionId]:t}),{}))},updateMarkedState(a){a.forEach(a=>{let{sessionId:n}=a,i=e.unreadMap[n]?.markAsUnreadSet??new Set,s=a.markAsUnreadSet??new Set,{patches:r}=lC(i,s);r.forEach(e=>{switch(e.op){case"add":return t({sessionId:n,timestamp:e.value,event:"MARK_UNREAD"});case"remove":return t({sessionId:n,timestamp:e.value,event:"MARK_READ"});default:return}})})},removeMentionsIfNeeded(t){let a=[...e.mentionMap.entries()];t.forEach(e=>{let t=a.find(t=>{let[a]=t;return a.includes(e.sessionId)})?.[1];t?.size&&(e.unreadCount?t.forEach((a,n)=>{let{time:i,threadTime:s}=a,r=!!s&&e.threadMap[s]&&i<=e.threadMap[s].lastReadTime,l=i<=e.lastReadTime;(r||l)&&t.delete(n)}):t.clear())})},setMentions(t){let{channelJid:a,msgId:n,type:i,time:s,threadId:r}=t,l=e.mentionMap.get(a);l?l.set(n,{time:s,type:i,threadId:r}):e.mentionMap.set(a,new Map([[n,{time:s,type:i,threadId:r}]]))}}}).effects((e,t)=>{let{sdk:a}=t;return{onChangeChannel:()=>a.channelChange$.pipe(a_(t=>{let{jid:a}=t,n=e.markedState.get(a);return n?ap([...n.keys()].map(t=>e.changeMarkedState({sessionId:a,timestamp:t,event:"CHANNEL_ACTIVE"}))):K})),onUnread:()=>a.unreadChannel$.pipe(aA(300,void 0,{leading:!1,trailing:!0}),a_(t=>q(e.updateMarkedState(t),e.setUnreadMap(t),e.removeMentionsIfNeeded(t)))),onMentioned:()=>a.mentioned$.pipe(a_(t=>{let a=t.mention?.some(e=>e.type===aw.all)?2:1;return q(e.setMentions({channelJid:t.channelJid,msgId:t.id,type:a,time:t.time,threadId:t.replyId,threadTime:t.replyThreadTime}))})),markAllRead:e=>e.pipe(au(()=>a.mutation.markMsgRead(void 0).pipe(J(()=>K),a_(()=>K)))),markAsUnread:e=>e.pipe(am(e=>a.mutation.markMsgAsUnread(e).pipe(J(()=>K),H()))),markChatAsUnread:e=>e.pipe(am(e=>a.mutation.markChatAsUnread(e).pipe(J(()=>K),H())))}}).create({unreadMap:{},mentionMap:new Map,markedState:new Map},{sdk:uW}),g$=e_().schema(()=>({chatId:eb.string().nullable()})).mutations((e,t)=>{let{eventEmitter:a}=t;return{setChatId(t){e.chatId=t},dispatchEvent(e){let{chatId:t,message:n}=e;a.dispatch(oH.startChatMessage,{chatId:t,message:n})}}}).effects((e,t)=>{let{sdk:a}=t;return{startMUCWithMessage:t=>t.pipe(am(t=>{let{info:n,message:i}=t;return a.mutation.createMUC(n).pipe(J(()=>K),a_(t=>q(e.setChatId(null),e.dispatchEvent({chatId:t,message:i}))))})),startP2PWithMessage:t=>t.pipe(am(t=>{let{jid:n,message:i}=t;return a.mutation.createChat(n).pipe(J(()=>K),a_(()=>q(e.setChatId(null),e.dispatchEvent({chatId:n,message:i}))))})),startP2P:e=>e.pipe(am(e=>{let{jid:t}=e;return a.mutation.createChat(t).pipe(J(()=>K),H())})),startMUC:e=>e.pipe(am(e=>{let{info:t}=e;return a.mutation.createMUC(t).pipe(J(()=>K),H())}))}}),gK=g$.create({chatId:null},{sdk:uW,eventEmitter:oz}),gJ=eb.object(gO);function gW(e,t){let{jid:a,name:n,option:i,info:s,classification:r,subject:l}=e,o={};for(let[e,d]of(Object.assign(o,{jid:a,name:String(n||l),option:i,info:s,classification:r,isCache:t}),aR)){let t=["canExternalAdd","historyMessagesVisible"].includes(e)?!(d&+i):!!(d&+i);Object.assign(o,{[e]:t})}return Object.assign(o,{sessionType:o.fromChannel?i1.CHANNEL:i1.MUC}),o.isSpotChannel=function(){return!!window.pwaChatConfig.isSpotEnabled}()&&o.isSpotChannel,o}let gY=e_().schema(()=>({fetched:eb.boolean(),channelMap:eb.map(eb.string(),gJ),checkPublicMap:eb.map(eb.string(),eb.boolean())})).views(e=>({groupChannels(t){let a=Array.from(e.channelMap.values());return t?a.filter(e=>e.sessionType===t):a},channelInfo:t=>e.channelMap.get(t),isJoined:t=>!!t&&e.channelMap.has(t),isChecked:t=>!!t&&(e.channelMap.has(t)||e.checkPublicMap.has(t)),isPublic:t=>!!t&&(e.channelMap.has(t)?e.channelMap.get(t).isPublic:!!e.checkPublicMap.get(t)),isPMC:t=>!!t&&!!e.channelMap.get(t)?.isMeetChat,isPMCCurring:t=>!!t&&!!e.channelMap.get(t)?.info?.PMC?.option,isSpotChannel:t=>!!t&&!!e.channelMap.get(t)?.isSpotChannel})).mutations(e=>{function t(t){let{data:a,type:n,isBySelf:i}=t;switch(n){case"add":e.channelMap.has(a.jid)||j(e.channelMap,a.jid,gW(a));break;case"remove":if(e.channelMap.has(a.jid)){if(!i){let{name:t,sessionType:n}=e.channelMap.get(a.jid);!function(e,t){let a=t?oL.$t({id:"KZ9BQ1",defaultMessage:[{type:0,value:'The channel "'},{type:1,value:"chatName"},{type:0,value:'" was deleted by the owner'}]},{chatName:e}):oL.$t({id:"ntASNL",defaultMessage:[{type:0,value:'The chat "'},{type:1,value:"chatName"},{type:0,value:'" was deleted by the owner'}]},{chatName:e});o2.warning(a)}(t,n===i1.CHANNEL)}e.channelMap.delete(a.jid)}break;case"edit":e.channelMap.has(a.jid)&&j(e.channelMap,a.jid,{...e.channelMap.get(a.jid),...gW(a)})}}return{setChannelMap(t){let a=t.reduce((e,t)=>({...e,[t.jid]:gW(t)}),{});j(e.channelMap,a),e.fetched=!0},updateChannelMapByRecentChats(t){let a=t.reduce((e,t)=>({...e,[t.jid]:gW({jid:t.jid,name:t.name,option:Number(t.option||0),info:t.info})}),{});j(e.channelMap,a)},setCheckPublic(t){let{channelId:a,isPublic:n}=t;j(e.checkPublicMap,a,n)},updateOnChannelAction(e){let{type:a,buddyList:n=[],data:i,operator:s,room:r}=e;switch(a){case aI.create:i?.option&&t({data:i,type:"add"});break;case aI.invite:{let e=n.some(e=>rS(e.jid));e&&t({data:i,type:"add"});break}case aI.subject:case aI.edit:t({data:{...i,classification:r.classification},type:"edit"});break;case aI.delete:t({data:{jid:r.jid},type:"remove",isBySelf:rS(s.jid)});break;case aI.kick:case aI.quit:{let e=n.some(e=>rS(e.jid));e&&t({data:{jid:r.jid},type:"remove",isBySelf:!0})}}}}}).effects((e,t)=>{let{sdk:a}=t;return{onChannelListChange:()=>a.channelList$.pipe(ah(t=>e.setChannelMap(t))),onRecentChatsChange:()=>oz.recentChats$.pipe(aL(a.channelList$),ah(t=>e.updateChannelMapByRecentChats(t.filter(e=>e.sType===i3.GROUP_CHAT)))),onChannelAction:()=>a.channelAction$.pipe(ah(t=>e.updateOnChannelAction(t))),checkPublic:t=>t.pipe(a_(t=>e.isChecked(t)?K:a.query.fetchChannelPreviewInfo({channelId:t,count:0}).pipe(J(()=>K),ah(a=>e.setCheckPublic({channelId:t,isPublic:!!a?.isPublic}))))),checkPublicBatch:t=>t.pipe(a_(t=>ap(t.map(t=>e.checkPublic(t)))))}}),gX=uq(gY,{storageKey:rQ.channelInfo,persist(e){let{channelMap:t}=e;return{channels:Array.from(t.values()).map(e=>({jid:e.jid,name:e.name,option:e.option}))}},recover(e){let t=eb.object({channels:eb.array(eb.object({jid:eb.string(),name:eb.string().or(eb.number()),option:eb.number()}))});t.parse(e);let{channels:a}=e,n=new Map(a.map(e=>[e.jid,gW(e,!0)]));return{channelMap:n}}}),gQ=gX.create({fetched:!1,channelMap:new Map,checkPublicMap:new Map},{sdk:uW,encryptedStorage:uV}),gZ=window.pwaChatConfig.jid,g1=e_().schema(()=>({data:eb.map(eb.string(),eb.object(fP))})).views(e=>({get currentUser(){return e.data.get(gZ)??{jid:gZ}},userInfo:t=>t?e.data.get(t):null,batchData:t=>t.reduce((t,a)=>({...t,[a]:e.data.get(a)}),{}),isUserEmpty:t=>!e.data.has(t)||!!e.data.get(t)?.isCache})).mutations(e=>({setData(t){t?.length&&j(e.data,aO(t,e=>{let{jid:t}=e;return t}))}})).effects((e,t)=>{let{sdk:a}=t;return{onUserUpdate:()=>a.user$.pipe(ah(t=>{let a=t.filter(t=>{let{jid:a}=t;return e.isUserEmpty(a)});return e.setData(a)})),fetchProfile:t=>t.pipe(eg(t=>e.isUserEmpty(t)),am(e=>a.query.fetchVCard([e]).pipe(J(()=>K),H()))),fetchProfileLazy(t){let n=[],i=t.pipe(eg(t=>e.isUserEmpty(t)&&!n.includes(t)));return i.pipe(aD(i.pipe(aA(100,void 0,{leading:!1,trailing:!0}))),ah(e=>aP(e)),eg(e=>!!e.length),U(e=>n=aP([...n,...e])),a_(e=>a.query.fetchVCard(e).pipe(J(()=>K),H(),U({complete(){n=n.filter(t=>!e.includes(t))}}))))},batchFetchProfileLazy:t=>t.pipe(a_(t=>ap(t.map(t=>e.fetchProfileLazy(t)))))}}),g0=uq(g1,{storageKey:rQ.profileInfo,persist(e){let{data:t}=e,a=[...t.values()].map(e=>({jid:e.jid,name:lT(e),orgUnit:e.orgUnit}));return{data:a}},recover(e){let t=eb.object({data:eb.array(eb.object({jid:fP.jid,name:fP.name,orgUnit:fP.orgUnit}))});t.parse(e);let{data:a}=e,n=a.map(e=>[e.jid,{...e,isCache:!0,email:""}]);return{data:new Map(n)}}}),g2=g0.create({data:new Map},{sdk:uW,encryptedStorage:uV}),g5={bookmarks:!1,contactRequests:!1,reminders:!1,files:!1,oneSectionAllowed:!0,separateChatAndChannel:!1,showAvatarForDirectChat:!0,sidebarTheme:sr.DEFAULT,unreadMessagesOnTop:!0,channelShowUnreadMessageCount:!1,newRepliesAtBottomOfChat:!0,showLinkPreview:!0,statusToAwait:!1,idleTime:"2",channelUnreadStart:so.FIRST},g3=e_().schema(()=>({modalVisible:eb.boolean(),settings:gF})).mutations(e=>({openModal(){e.modalVisible=!0},closeModal(){e.modalVisible=!1},setSettings(t){j(e.settings,t)}})),g6=u$(g3,{storageKey:rQ.settings,persist(e){let{settings:t}=e;return{settings:t}},recover(e){let t=eb.object({settings:gF});return t.parse(e),e}}),g4=g6.create({modalVisible:!1,settings:g5},{sdk:uW,storage:r3}),g8="start_chat_jid",g7=[i1.BROADCAST,i1.HIDDEN,i1.ROOM];eb.record(eb.nativeEnum(i0),eb.array(eb.string()));let g9=eb.object({jid:eb.string(),type:eb.nativeEnum(i1),timestamp:eb.number(),isCache:eb.boolean().optional()});eb.object({cmd:eb.string(),extension:eb.object({appFeatures:eb.number().optional(),capability:eb.number().optional(),cmdModifyTime:eb.number().optional(),notShow:eb.number().optional(),shortcutsModifyTime:eb.number().optional()}),firstName:eb.string(),lastName:eb.string(),introduction:eb.string(),jid:eb.string(),picRelateiveUrl:eb.string(),picUrl:eb.string(),signature:eb.string(),type:eb.number()});let ye=window.pwaChatConfig.jid;function yt(e){return e===i1.CHAT}function ya(e){return e===i1.MUC}function yn(e){return e===i1.CHANNEL}function yi(e){return e===i1.UNKNOWN}function ys(e,t){return[...t.keys()].filter(a=>e.includes(t.get(a).type))}function yr(e,t){return ep(e,e=>(t.get(e)?.name||"").toLowerCase())}function yl(e,t,a){return e.type===i1.CHAT?lT(a.get(e.jid)??{}):t.get(e.jid)?.name??""}function yo(e,t,a,n,i){if(void 0===i&&(i=[]),!e.length)return[];let s=e.filter(e=>!n.includes(e)),r=s.filter(e=>i.includes(e)),l=s.filter(e=>!i.includes(e)),o=yr(r,a),d=function(e,t){return ep(e,e=>t.get(e)?.timestamp||0,"desc")}(l,t);return[...d,...o]}function yd(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];if(!e)return a.find(e=>!!e.length)?.[0];let i=a.find(t=>t.includes(e));if(!i)return null;let s=i.indexOf(e);return i[s+(0===s?1:-1)]}let yc={loading:eb.boolean(),chatId:eb.string().nullable(),firstChatId:eb.string().nullable(),chatMap:eb.map(eb.string(),g9),starredChatIds:eb.array(eb.string()),activatedChatsQueue:eb.array(eb.string()),activatedChatsList:eb.array(eb.string()),mutedGroupChatIds:eb.array(eb.string()),recentChatsFetched:eb.boolean(),starredChatsFetched:eb.boolean(),folderChatsFetched:eb.boolean(),appsListFetched:eb.boolean()},yu=e_().schema(()=>yc).views((e,t)=>{let{groupChannelStore:a,profileStore:n}=t;return{get chats(){return Array.from(e.chatMap.values())},get starredIds(){return function(e,t,a,n,i){if(void 0===i&&(i=[]),!e.length)return[];let s=e.filter(e=>i.includes(e)),r=e.filter(e=>!i.includes(e)&&!rS(e)),l=yr(s,a),o=r.filter(e=>t.has(e)&&t.get(e).type!==i1.CHANNEL).sort((e,i)=>{let s=yl(t.get(e)??{},a,n),r=yl(t.get(i)??{},a,n);return s.localeCompare(r)}),d=yr(r.filter(e=>t.get(e)?.type===i1.CHANNEL),a);return[ye,...o,...d,...l]}(e.starredChatIds,e.chatMap,a.channelMap,n.data,e.mutedGroupChatIds)},get activateChatIds(){return e.activatedChatsList.filter(t=>e.activatedChatsQueue.includes(t))},get recentIds(){let t=ys([i1.CHANNEL,i1.MUC,i1.CHAT],e.chatMap),n=yo(t,e.chatMap,a.channelMap,e.starredChatIds,e.mutedGroupChatIds);if(e.chatMap.has(g8))return[g8,...n];return n},get chatIds(){let t=ys([i1.MUC,i1.CHAT],e.chatMap),n=yo(t,e.chatMap,a.channelMap,e.starredChatIds,e.mutedGroupChatIds);if(e.chatMap.has(g8))return[g8,...n];return n},get channelIds(){let t=ys([i1.CHANNEL],e.chatMap);return yo(t,e.chatMap,a.channelMap,e.starredChatIds,e.mutedGroupChatIds)},get meetingChatIds(){return function(e,t,a,n){void 0===n&&(n=[]);let i=ys([i1.MUC],e).filter(e=>!!t.get(e)?.isMeetChat);return yo(i,e,t,a,n)}(e.chatMap,a.channelMap,e.starredChatIds,e.mutedGroupChatIds)},get spotChannelIds(){return function(e,t,a,n){void 0===n&&(n=[]);let i=ys([i1.CHANNEL],e).filter(e=>!!t.get(e)?.isSpotChannel);return yo(i,e,t,a,n)}(e.chatMap,a.channelMap,e.starredChatIds,e.mutedGroupChatIds)},isChatStarred:t=>e.starredChatIds.includes(t)}}).mutations((e,t)=>{let{groupChannelStore:a,settingsStore:n,eventEmitter:i}=t;function s(e,t){e&&i.dispatch(oH.channelChanged,{jid:e,fromHistory:t})}function r(e){i.dispatch(oH.recentChats,e)}function l(t,a,n){if(!t||a&&!e.activatedChatsQueue.includes(t))return;let i=e.activatedChatsQueue.filter(e=>e!==t);a||(i.length>=10&&i.shift(),i.push(t)),n?e.activatedChatsQueue=i.filter(e=>e!==g8):e.activatedChatsQueue=i,a||(e.activatedChatsList=aP([...e.activatedChatsList,t]))}function o(t){return t.reduce((t,a)=>{let n=function(e){return e.sType===i3.CHAT?e.type===i5.CHANNEL?i1.ROOM:i1.CHAT:e.sType===i3.GROUP_CHAT&&e.type===i5.NEW_CHAT?i1.MUC:e.type===i5.BROADCAST_CHANNEL?i1.BROADCAST:e.type===i5.HIDDEN_CHANNEL?i1.HIDDEN:i1.CHANNEL}(a);if(g7.includes(n))return t;let{jid:i}=a;return rO(i)?e.chatMap.has(i)?{...t,[i]:{...e.chatMap.get(i),isCache:!1}}:{...t,[i]:{jid:i,type:n,timestamp:0}}:t},{})}function d(t){return t.reduce((t,a)=>e.chatMap.has(a)?{...t,[a]:{...e.chatMap.get(a),isCache:!1}}:{...t,[a]:{jid:a,type:i1.CHAT,timestamp:0}},{})}function c(t){let{jid:n,timestamp:i}=t;if(!rO(n)||rT(n)&&!a.isJoined(n))return;let s=rT(n)?a.channelInfo(n).sessionType:i1.CHAT;j(e.chatMap,n,{jid:n,type:s,timestamp:i})}function u(t){let{jid:a,timestamp:n}=t,i=e.chatMap.get(a);i?i.timestamp=n:c({jid:a,timestamp:n})}function m(t,a){if(e.chatId===t)return;let n=t&&e.chatMap.has(t)?t:null;e.chatId=n,s(n,a),l(n)}function p(t){if(e.chatMap.has(t)){if(e.chatId===t){let{separateChatAndChannel:a}=n.settings,i=null;(i=a?yd(t,e.starredIds,e.meetingChatIds,e.spotChannelIds,e.chatIds,e.channelIds):yd(t,e.starredIds,e.recentIds))&&m(i)}N(e.chatMap,t),l(t,!0)}}return{setLoading(t){e.loading=t},markRecentChatsFetched(){e.recentChatsFetched=!0},markStarredChatsFetched(){e.starredChatsFetched=!0},markFolderChatsFetched(){e.folderChatsFetched=!0},markAppsListFetched(){e.appsListFetched=!0},setChatMap(t){r(t);let a=o(t),n=ss.reduce((e,t)=>({...e,[t.jid]:{...t,timestamp:0}}),{});j(e.chatMap,{...a,...n})},updateChatMapById(e){c({jid:e,timestamp:0})},setChatTimestamp(t){let a=t.reduce((t,a)=>{let{jid:n,timestamp:i}=a;return e.chatMap.has(n)?{...t,[n]:{...e.chatMap.get(n),timestamp:i}}:t},{});j(e.chatMap,a)},updateChatTimestamp(e){u(e)},batchUpdateChatTimestamp(e){e.forEach(e=>u(e))},setChatId(e){m(e)},setChatIdByHistory(e){m(e,!0)},setDefaultChatId(){e.chatId||function(){let{separateChatAndChannel:t}=n.settings,a=null;(a=t?yd("",e.starredIds,aH(e.chatIds,...e.meetingChatIds),aH(e.channelIds,...e.spotChannelIds),e.meetingChatIds,e.spotChannelIds):yd("",e.starredIds,e.recentIds))&&m(a)}()},cleanChatId(){e.chatId=null},setStarredChats(t){r(t),e.starredChatIds=t.map(e=>e.jid);let a=o(t);j(e.chatMap,a)},setChatApps(t){let a=d(t);j(e.chatMap,a)},updateStarredChat(t){let{jid:a,action:n}=t;a&&n&&(n===sa.add?e.starredChatIds=aP([...e.starredChatIds,a]):e.starredChatIds=e.starredChatIds.filter(e=>e!==a))},setMutedGroupChats(t){e.mutedGroupChatIds=t},setFolderChats(t){let a=t.flatMap(e=>{let{memberList:t}=e;return t});r(a);let n=o(a);j(e.chatMap,n)},startChat(){let t=function(){return{jid:g8,type:i1.UNKNOWN,timestamp:new Date().getTime()}}();e.chatMap.has(g8)||j(e.chatMap,g8,t),e.chatId=g8,s(g8),l(g8)},removeChat(e){p(e)},updateOnChannelAction(t){let{type:a,buddyList:n=[],room:i,data:r,operator:o}=t;switch(a){case aI.create:{let t={jid:r.jid,type:rT(r.jid)?rD(r.option)?i1.MUC:i1.CHANNEL:i1.CHAT,timestamp:Number(r?.createTime)??Number(r?.modifiedTime)};j(e.chatMap,t.jid,t),rS(o.jid)&&function(t){N(e.chatMap,g8),e.chatId=t.jid,s(t.jid),l(t.jid,!1,!0)}(t);break}case aI.invite:{let t=n.some(e=>rS(e.jid));t&&j(e.chatMap,r.jid,{jid:r.jid,type:rD(r.option)?i1.MUC:i1.CHANNEL,timestamp:r?.isMeetChat&&!r.isExistRealMessage?0:Date.now()});break}case aI.delete:p(i.jid);break;case aI.kick:case aI.quit:{let e=n.some(e=>rS(e.jid));e&&p(i.jid)}}},updateOnAppAction(t){let{action:a,appInfo:n}=t;switch(a){case"add_member":{let t=d([n.jid]);j(e.chatMap,t);break}case"del_member":N(e.chatMap,n.jid),n.jid===e.chatId&&(e.chatId=null)}},dispatchStarFromFolderEvent(e){let{jid:t}=e;i.dispatch(oH.starFromFolders,{jid:t})},dispatchChannelChangedEvent(e){let{jid:t,fromHistory:a}=e;s(t,a)}}}).effects((e,t)=>{let{sdk:a,eventEmitter:n}=t;return{onConnected:()=>a.connected$.pipe(a_(()=>ap(r([e.fetchRecentChats(),e.getStarred(),e.chatId&&e.dispatchChannelChangedEvent({jid:e.chatId,fromHistory:!1})])))),onSyncRecentFromUnread:()=>a.unreadChannel$.pipe(ag(1),a_(t=>lw(()=>e.recentChatsFetched&&e.starredChatsFetched&&e.folderChatsFetched).pipe(eg(Boolean),a_(()=>{let a=t.map(e=>e.sessionId),n=a.filter(t=>rO(t)&&!e.chatMap.has(t));return ap(r([e.updateOfflineChats(n.map(e=>({jid:e,timestamp:0}))),!!n.length&&e.fetchHistoryLastMsg(n.map(e=>({jid:e,sType:rT(e)?az.groupchat:az.chat})))]))})))),onChatDisappear:()=>lw(()=>!l(e.chatMap)&&!!e.chatId&&!e.chatMap.has(e.chatId)).pipe(eg(Boolean),ah(()=>e.cleanChatId())),onUpdateFolderMembers:()=>a.folderMemberList$.pipe(a_(t=>q(e.setFolderChats(t),e.markFolderChatsFetched()))),onChannelAction:()=>a.channelAction$.pipe(ah(t=>e.updateOnChannelAction(t))),onUpdateLatestMessage:()=>aB(a.message$,n.updateLatestMessage$).pipe(a_(t=>{let a=function(e){let t=aF(e.filter(e=>{let{messageType:t}=e;return t!==i.info}),e=>e.time);return t?t.time:0}(t),n=t[0].channelJid;return e.chatMap.has(n)?a?q(e.updateChatTimestamp({jid:n,timestamp:a})):K:q(e.updateOfflineChats([{jid:n,timestamp:a}]))})),onStarChange:()=>a.starChange$.pipe(eg(e=>!!e.jid),a_(t=>{let{jid:a,action:n}=t;return e.chatMap.has(a)?q(e.updateStarredChat({jid:a,action:n})):n!==sa.add?K:q(e.updateChatMapById(a))})),onMuteGroupChats:()=>n.muteGroupChats$.pipe(ah(t=>e.setMutedGroupChats(t))),onAppChats:()=>n.appChats$.pipe(a_(t=>q(e.setChatApps(t),e.markAppsListFetched()))),onAppAction:()=>a.appAction$.pipe(a_(t=>q(e.updateOnAppAction(t)))),fetchRecentChats:t=>t.pipe(au(()=>a.query.fetchRecentChats().pipe(J(()=>K),a_(t=>ap(r([e.setChatMap(t),e.markRecentChatsFetched(),e.fetchHistoryLastMsg(t)]))),aV(e.setLoading(!0)),aG(e.setLoading(!1))))),getStarred:t=>t.pipe(au(()=>a.query.getStarred({isCanChat:!0}).pipe(J(()=>K),ah(e=>r(e)),a_(t=>q(e.setStarredChats(t),e.markStarredChatsFetched()))))),fetchHistoryLastMsg:t=>t.pipe(ah(e=>(function(e){return{limit:"1",sessions:e.map(e=>({jid:e.jid,timeframe:`0:${Date.now()}`,type:e.sType,visible_filter:!0}))}})(e)),au(t=>a.query.fetchHistoryLastMsg(t).pipe(J(()=>K),a_(t=>{let a=t.data.filter(e=>!!e.messages.length).map(e=>({jid:e.session,timestamp:e.messages[0].time}));return q(e.setChatTimestamp(a),e.setDefaultChatId())})))),star:t=>t.pipe(aU(e=>e.jid),a_(t=>t.pipe(am(t=>a.mutation.star(t.jid).pipe(J(()=>K),a_(()=>{let a=t.jid;return e.chatMap.has(a)?q(e.dispatchStarFromFolderEvent({jid:a})):K})))))),unStar:e=>e.pipe(aU(e=>e.jid),a_(e=>e.pipe(am(e=>a.mutation.unStar(e.jid).pipe(J(()=>K),H()))))),unStarChats:t=>t.pipe(au(t=>ap(t.filter(t=>e.starredChatIds.includes(t)).map(t=>e.unStar({jid:t}))))),batchRemoveChats:e=>e.pipe(a_(e=>e.length?a.mutation.batchSyncRecentChat(e.map(e=>({channelId:e,action:"remove"}))).pipe(J(()=>K),H()):K)),batchAddChats:e=>e.pipe(au(e=>e.length?a.mutation.batchSyncRecentChat(e.map(e=>({channelId:e,action:"add"}))).pipe(J(()=>K),H()):K)),updateOfflineChats:t=>t.pipe(a_(t=>q(e.batchUpdateChatTimestamp(t),e.batchAddChats(t.map(e=>e.jid)))))}}),ym=u$(yu,{storageKey:rQ.lastChat,persist(e){let{chatId:t}=e;return{chatId:t}},recover(e){let t=eb.object({chatId:yc.chatId});t.parse(e);let{chatId:a}=e;return{chatId:a,firstChatId:a,activatedChatsQueue:r([a]),activatedChatsList:r([a])}}}),yp=uq(ym.mutations(e=>({clearCacheChats(){[...e.chatMap.entries()].forEach(t=>{let[a,{isCache:n}]=t;n&&N(e.chatMap,a)})}})).effects(e=>({onChatsFetched:()=>lw(()=>e.recentChatsFetched&&e.starredChatsFetched&&e.folderChatsFetched).pipe(eg(Boolean),ah(()=>e.clearCacheChats()))})),{storageKey:rQ.recentChat,persist(e){let{mutedGroupChatIds:t,starredChatIds:a,chatMap:n}=e;return{mutedGroupChatIds:x(t),starredChatIds:x(a),chatMap:[...x(n).entries()]}},recover(e){let t=eb.object({mutedGroupChatIds:yc.mutedGroupChatIds,starredChatIds:yc.starredChatIds,chatMap:eb.array(eb.tuple([eb.string(),g9]))});t.parse(e);let{chatMap:a,...n}=e,i=new Map(a.filter(e=>{let[t]=e;return t!==g8}).map(e=>{let[t,a]=e;return[t,{...a,isCache:!0}]}));return{...n,chatMap:i}}}),yh=yp.create({loading:!1,chatId:null,firstChatId:null,chatMap:new Map,starredChatIds:[],activatedChatsQueue:[],activatedChatsList:[],mutedGroupChatIds:[],recentChatsFetched:!1,starredChatsFetched:!1,folderChatsFetched:!1,appsListFetched:!1},{sdk:uW,groupChannelStore:gQ,profileStore:g2,settingsStore:g4,eventEmitter:oz,storage:r3,encryptedStorage:uV});function yf(e){let{jid:t,type:a}=e;if(!rO(t)&&!sd.includes(t)&&t!==g8)return;let n=yh.chatMap.has(t);if(n){yh.setChatId(t);return}let i=a??(rT(t)?i1.MUC:i1.CHAT);switch(i){case i1.CHAT:gK.startP2P({jid:t});break;case i1.CHANNEL:case i1.MUC:yh.updateChatMapById(t),yh.setChatId(t)}}let yg=e_().schema(()=>({connectedChannelJid:eb.string().nullable()})).mutations(e=>({setConnectedJid(t){e.connectedChannelJid=t}})).effects((e,t)=>{let{sdk:a,eventEmitter:n}=t;return{onSDKChannelChange:()=>a.channelChange$.pipe(ah(t=>{let{jid:a}=t;return e.setConnectedJid(a)})),onUIChannelChanged:()=>n.channelChanged$.pipe(eg(e=>{let{jid:t}=e;return rO(t)}),ah(t=>{let{jid:a}=t;return e.changeChannel(a)})),changeChannel:t=>t.pipe(aq(()=>a.connectedBefore$),au(t=>t===e.connectedChannelJid?K:a.mutation.changeChannel(t).pipe(J(e=>(console.error(e),o2.error(e?.errorCode,e?.errorInfo,{toastId:o5.changeChannel}),K)),H())))}}),yy=yg.create({connectedChannelJid:null},{sdk:uW,eventEmitter:oz});var yv=(e=>(e.image="image",e.codeSnippet="codeSnippet",e.giphy="giphy",e))(yv||{});let y_={progress:0,status:i6.notDownload,file:void 0,fileUrl:void 0},yb={loadingStatus:sZ.notLoad,isSending:!1,message:"",fileName:"",isHQ:!1,isGiphy:!1},yM={codeSnippet:null,fileName:""},yx=eb.object({status:eb.nativeEnum(i6),progress:eb.number(),file:eb.instanceof(Blob).optional(),fileUrl:eb.string().optional()}),yC=eb.object({loadingStatus:eb.nativeEnum(sZ),isSending:eb.boolean(),message:eb.string(),fileName:eb.string(),isHQ:eb.boolean(),isGiphy:eb.boolean().optional()}),yj=eb.object({codeSnippet:eb.object(gt).nullable(),fileName:eb.string()}),yN=e_().schema(()=>({fileStateMap:eb.map(eb.string(),yx),imageStateMap:eb.map(eb.string(),yC),codeSnippetStateMap:eb.map(eb.string(),yj)})).views(e=>({getFileState:t=>e.fileStateMap.get(t)||y_,getImageState:t=>e.imageStateMap.get(t)||yb,getIsImageLoaded(t){let{fileId:a,isHQ:n}=t,i=e.imageStateMap.get(a)||yb;return n?i.loadingStatus===sZ.loadedHQ:!!i.message},getCodeSnippetState:t=>e.codeSnippetStateMap.get(t)||yM})).mutations((e,t)=>{let{download:a}=t;function n(t,a){if(!t)return;let n=e.fileStateMap.get(t)||y_;e.fileStateMap.set(t,{...n,...a})}function i(t,a){if(!t)return;let n=e.imageStateMap.get(t)||yb;e.imageStateMap.set(t,{...n,...a,message:a?.message||n.message})}return{setFileState(e){let{fileId:t,state:a}=e;n(t,a)},setSendingImageState(e){let{fileId:t,message:a,fileName:n,isGiphy:s,isSent:r}=e;i(t,{isSending:!r,isHQ:!0,message:a,fileName:n,isGiphy:s,loadingStatus:sZ.loadedHQ})},setImageSended(e){let{fileId:t}=e;i(t,{isSending:!1})},setImageState(e){let{fileId:t,...a}=e;i(t,a)},setCodeSnippetState(t){let{fileId:a,state:n}=t;!function(t,a){if(!t)return;let n=e.codeSnippetStateMap.get(t)||yM;e.codeSnippetStateMap.set(t,{...n,...a})}(a,n)},setFileProgress(e){let{id:t,progress:a,status:i}=e;t&&n(t,{progress:a,...i?{status:i}:{}})},deleteFromMap(t){t&&(e.fileStateMap.delete(t),e.imageStateMap.delete(t))},downloadFile(e){let{fileUrl:t,fileName:n}=e;t&&a(t,n)},updateImageId(t){let{prevId:a,newId:n}=t;if(!a||!n)return;let i=e.imageStateMap.get(a);i&&(e.imageStateMap.set(n,i),e.imageStateMap.delete(a))}}}).effects((e,t)=>{let{sdk:a}=t,[n,i]=lA();return{disposeFile:i,downloadFilesFile:t=>t.pipe(a_(t=>a.mutation.downloadSearchFile(t).pipe(a_(t=>q(e.downloadFile(t),e.setFileState({fileId:t.fileId,state:{status:i6.downloaded,progress:100,file:t.file,fileUrl:t.fileUrl}}))),aV(e.setFileState({fileId:t.fileId,state:{status:i6.downloading}})),J(a=>{console.error(a);let n=a instanceof ar&&a.errorCode===a$.FileUnreadyError;return q(e.setFileState({fileId:t.fileId,state:{status:n?i6.downloadErrorNotReady:i6.downloadError}}))}),aL(n.pipe(eg(e=>e===t.fileId)))))),fetchMsgFile(t){let a=t.pipe(eg(t=>{let{fileId:a,forceFetch:n,type:i}=t;if(n)return!0;switch(i){case"image":case"giphy":{let n=e.getImageState(a).loadingStatus;switch(!0){case t.isHQ&&n>=sZ.loadingHQ:case!t.isHQ&&n>=sZ.loading:return!1;default:return!0}}case"codeSnippet":{let t=e.codeSnippetStateMap.get(a)?.codeSnippet;return!t}default:return!1}}));return a.pipe(a_(t=>{switch(t.type){case"image":if(t.isHQ||s5(t.fileName??""))return q(e.fetchImageMsgFile({fileId:t.fileId,fileName:t.fileName}));return q(e.fetchImageThumbnailUrl({fileId:t.fileId,fileName:t.fileName}));case"codeSnippet":return q(e.fetchCodeSnippetMsgFile({fileId:t.fileId,fileName:t.fileName}));case"giphy":return q(e.fetchGiphyMsgFile({fileId:t.fileId,fileUrl:t.fileUrl,messageXmlStr:t.messageXmlStr}));default:return K}}))},fetchImageMsgFile:t=>t.pipe(a_(t=>{let{fileId:n,fileName:i}=t;return a.query.fetchImageMsgFile(n).pipe(lQ({count:2,delayDuration:()=>2e3}),a_(t=>{let{data:a}=t;return q(e.setImageState({fileId:n,message:a,fileName:i,isHQ:!0,loadingStatus:sZ.loadedHQ}))}),aV(e.setImageState({fileId:n,loadingStatus:sZ.loadingHQ})),J(t=>{let a=t instanceof ar&&t.errorCode===a$.FileUnreadyError;return q(e.setImageState({fileId:n,loadingStatus:a?sZ.loadErrorNotReady:sZ.loadError}))}))})),fetchImageThumbnailUrl:t=>t.pipe(a_(t=>{let{fileId:n,fileName:i}=t;return a.query.getImageThumbnailUrl(n).pipe(lQ(),J(e=>(console.error(e),K)),a_(t=>{let a=e.getImageState(n);return a.isHQ?K:q(e.setImageState({fileId:n,message:t,fileName:i,isHQ:!1,loadingStatus:sZ.loaded}))}),aV(e.setImageState({fileId:n,loadingStatus:sZ.loading})),J(()=>q(e.setImageState({fileId:n,loadingStatus:sZ.loadError}))))})),fetchCodeSnippetMsgFile:t=>t.pipe(a_(t=>{let{fileId:n,fileName:i}=t;return a.query.fetchCodeSnippetMsgFile(n).pipe(lQ(),J(e=>(console.error(e),K)),a_(t=>{let{data:a}=t;return q(e.setCodeSnippetState({fileId:n,state:{fileName:i,codeSnippet:a}}))}))})),fetchGiphyMsgFile:t=>t.pipe(a_(t=>{let{fileId:n,fileUrl:i,messageXmlStr:s}=t;return i||s?a.query.fetchGiphyMsgFile({url:i,messageXmlStr:s}).pipe(lQ(),J(e=>(console.error(e),K)),a_(t=>{let{data:a}=t;return q(e.setImageState({fileId:n,message:a,fileName:`${n}.gif`,isHQ:!0,isGiphy:!0,loadingStatus:sZ.loadedHQ}))}),aV(e.setImageState({fileId:n,loadingStatus:sZ.loadingHQ}))):K})),onFileUploadProgress:()=>a.fileUploadProgress$.pipe(ah(t=>e.setFileProgress({id:t.msgId,progress:t.progress,status:100===t.progress?i6.sended:null}))),onFileDownloadProgress:()=>a.searchFileDownloadProgress$.pipe(ah(t=>e.setFileProgress({id:t.fileId,progress:t.progress})))}}),yw=yN.create({fileStateMap:new Map,imageStateMap:new Map,codeSnippetStateMap:new Map},{sdk:uW,download:lR}),yI=eb.object({version:eb.number().optional(),jid:eb.string(),channelJid:eb.string(),name:eb.string().optional(),description:eb.string().optional(),members:eb.array(eb.string()).optional(),owner:eb.string().optional()}),yT=e_().schema(()=>({isInitialLoaded:eb.boolean(),fetchedChannel:eb.set(eb.string()),mentionGroupMap:eb.map(eb.string(),yI),removedMentionGroupNameMap:eb.map(eb.string(),eb.string()),membersMap:eb.map(eb.string(),eb.object({isLoading:eb.boolean().optional(),members:eb.array(eb.string()),haveMore:eb.boolean().optional(),lastValue:eb.string().optional()}))})).views(e=>({mentionList:t=>[...e.mentionGroupMap.values()].filter(e=>e.channelJid===t),mentionGroupDetail:t=>e.mentionGroupMap.get(t),mentionMembers:t=>e.membersMap.get(t)?.members||[],mentionMemberDetail:t=>e.membersMap.get(t),removedMentionGroupName:t=>e.removedMentionGroupNameMap.get(t)||e.mentionGroupMap.get(t)?.name||"",fillMentionByMentionGroup(t){if(!t)return;let a=t.filter(e=>e.type===aw.mentionGroup).map(t=>e.membersMap.get(t.jid)?.members||[]).flat(),n=aP(a).filter(e=>!t.find(t=>t.jid===e)).map(e=>({jid:e,start:0,end:0,type:aw.user}));return[...n,...t]}})).mutations(e=>{function t(t){let{jid:a,members:n}=t,i=e.membersMap.get(a);if(!i)return;let s=i?.members||[];i.members=s.filter(e=>!n.includes(e))}return{setInitialLoaded(){e.isInitialLoaded=!0},setChannelFetched(t){e.fetchedChannel.add(t)},setMentionGroupList(t){t.forEach(t=>{let a=t.jid,n=e.mentionGroupMap.get(a)||{};e.mentionGroupMap.set(a,{...n,...aa(t,aJ)})})},removeMentionGroup(t){let a=e.mentionGroupMap.get(t);a?.name&&e.removedMentionGroupNameMap.set(a.jid,a.name),e.mentionGroupMap.delete(t)},addMembersMap(t){let{jid:a,members:n}=t,i=e.membersMap.get(a),s=i?.members||[];e.membersMap.set(a,{...i,members:aP([...s,...n])})},deleteMembersMap(e){let{jid:a,members:n}=e;t({jid:a,members:n})},deleteMemberFromChannel(a){let{channelJid:n,members:i}=a,s=[...e.mentionGroupMap.values()].filter(e=>e.channelJid===n);s.forEach(e=>t({jid:e.jid,members:i}))},setMembersDetailMap(t){let{jid:a,mapDetail:n}=t,i=e.membersMap.get(a);e.membersMap.set(a,{...n,members:i?.members||[]})},removeMembersDetail(t){e.membersMap.delete(t)}}}).effects((e,t)=>{let{sdk:a}=t;return{onConnected:()=>a.bufferedChannelChange$.pipe(aK(()=>lw(()=>e.isInitialLoaded).pipe(eg(Boolean))),a_(t=>t?q(e.fetchMentionGroups(t.jid)):K)),onMentionGroupList:()=>a.mentionGroupList$.pipe(a_(t=>{let a=aP(t.map(e=>{let{channelJid:t}=e;return t}));return q(e.setMentionGroupList(t),...a.map(t=>e.setChannelFetched(t)),e.setInitialLoaded())})),onChannelAction:()=>a.channelAction$.pipe(eg(t=>{let{room:{jid:a}}=t;return e.fetchedChannel.has(a)}),a_(t=>{let{type:a,buddyList:n=[],room:i}=t;return a===aI.kick&&n?.every(e=>{let{jid:t}=e;return!rS(t)})?q(e.deleteMemberFromChannel({channelJid:i.jid,members:n.map(e=>{let{jid:t}=e;return t}).filter(e=>e)})):K})),onMentionGroupAction:()=>a.mentionGroupAction$.pipe(eg(t=>{let{channelJid:a}=t;return e.fetchedChannel.has(a)}),a_(t=>{let{action:a,jid:n,channelJid:i,name:s,description:r,members:l=[],addList:o,removeList:d}=t;switch(a){case aT.create:return q(e.setMentionGroupList([{jid:n,channelJid:i,name:s,description:r}]),e.setMembersDetailMap({jid:n,mapDetail:{haveMore:!1,isLoading:!1}}),e.addMembersMap({jid:n,members:l}));case aT.delete:return q(e.removeMentionGroup(n),e.removeMembersDetail(n));case aT.add:case aT.remove:case aT.update:return q(e.setMentionGroupList([{jid:n,channelJid:i,name:s,description:r}]),e.addMembersMap({jid:n,members:o||[]}),e.deleteMembersMap({jid:n,members:d||[]}));default:return K}})),fetchMentionGroups:t=>t.pipe(au(t=>e.fetchedChannel.has(t)?K:a.query.fetchMentionGroups(t).pipe(J(()=>K),a_(a=>q(e.setChannelFetched(t),e.setMentionGroupList(a)))))),fetchMentionGroupMembers:t=>t.pipe(a_(t=>{let n=e.mentionGroupMap.get(t),i=e.membersMap.get(t);return!n||i?.haveMore===!1||i?.isLoading?K:a.query.fetchMentionGroupMembers({jid:t,channelJid:n.channelJid,lastValue:i?.lastValue}).pipe(a_(a=>a?q(e.setMembersDetailMap({jid:t,mapDetail:{...a,isLoading:!1}}),e.addMembersMap({jid:t,members:a.members.map(e=>{let{jid:t}=e;return t})}),...a.haveMore?[e.fetchMentionGroupMembers(t)]:[]):K),J(()=>q(e.removeMembersDetail(t))),aV(e.setMembersDetailMap({jid:t,mapDetail:{isLoading:!0}})))})),createMentionGroup:e=>e.pipe(au(e=>{let{channelJid:t,name:n,description:i,memberList:s,onAction:r}=e;return a.mutation.createMentionGroup({channelJid:t,name:n,description:i,memberList:s}).pipe(a_(()=>(r(!0),K)),J(e=>(console.error(e),r(!1),K)))})),updateMentionGroup:t=>t.pipe(au(t=>{let{jid:n,name:i,description:s,addList:r=[],removeList:l=[],onAction:o}=t,d=e.mentionGroupMap.get(n);return d?a.mutation.updateMentionGroup({jid:n,channelJid:d.channelJid,name:i,description:s,action:aT.update,addList:r,removeList:l}).pipe(a_(()=>(o(!0),K)),J(e=>(console.error(e),o(!1),K))):K})),deleteMentionGroup:t=>t.pipe(au(t=>{let{jid:n,onAction:i}=t,s=e.mentionGroupMap.get(n);return s?a.mutation.deleteMentionGroup({jid:n,channelJid:s.channelJid}).pipe(J(()=>(i(),K)),U(()=>i()),a_(()=>q(e.removeMentionGroup(n),e.removeMembersDetail(n)))):K})),joinToMentionGroup:t=>t.pipe(au(t=>{let n=window.pwaChatConfig.jid,i=e.mentionGroupMap.get(t);return i?a.mutation.joinMentionGroup({jid:t,channelJid:i.channelJid,action:aT.add,owner:i?.owner||""}).pipe(J(()=>K),ah(()=>e.addMembersMap({jid:t,members:[n]}))):K})),leaveMentionGroup:t=>t.pipe(au(t=>{let n=window.pwaChatConfig.jid,i=e.mentionGroupMap.get(t);return i?a.mutation.leaveMentionGroup({jid:t,channelJid:i.channelJid,action:aT.remove,owner:i?.owner||""}).pipe(J(()=>K),ah(()=>e.deleteMembersMap({jid:t,members:[n]}))):K}))}}),yE=yT.create({mentionGroupMap:new Map,membersMap:new Map,fetchedChannel:new Set,isInitialLoaded:!1,removedMentionGroupNameMap:new Map},{sdk:uW}),yS=eb.discriminatedUnion("messageType",[eb.object(f3),eb.object(f8),eb.object(f9),eb.object(ge),eb.object(gn),eb.object(f6),eb.object(f4),eb.object(gs),eb.object(gr),eb.object(gl),eb.object(f5),eb.object(gi),eb.object(ga),eb.object(gN)]);eb.object(fU);let yk=yS.and(eb.object({replyId:eb.string(),replyThreadTime:eb.number()}));function yA(e){return!!e.replyId}function yR(e,t){return{...e,isSending:t}}function yL(e,t){let a=t.filter(e=>e.type===aW.insertLink),n=le(e||"").filter(e=>{let{start:t,end:n}=e;return!a.find(e=>{let{startpos:a,endpos:i}=e;return t===a&&i===n})}),i=aP([...n.map(e=>{let{link:t}=e;return t}),...a.map(e=>{let{reserve1:t}=e;return t})]);return i.length?{links:i.filter(Boolean)}:{}}function yO(e){let{messageType:t}=e,a={senderAvatar:"",commentTotal:0,emojiVotes:{},isUnreadMsg:!1,optimisticRevoked:!1,isEditorOpen:!1,isEditing:!1,isPartial:!1};switch(t){case i.text:{let{fontStyte:n,mention:i,...s}=e;return{...a,...s,fontStyle:n??[],mention:i??[],messageType:t}}case i.file:{let{file:n,...i}=e;if(!n)return null;return{...a,...i,messageType:t,file:n}}case i.dropbox:case i.box:case i.microsoftSharePoint:case i.googleDrive:case i.microsoftOneDrive:{let{thirdStorageInfo:n,...s}=e;if(!n)return null;let r={size:n.fileSize,fileId:n.id,fileName:n.fileName};return{...a,...s,messageType:i.file,file:r,thirdPartyType:t,thirdStorageInfo:n}}case i.image:case i.screenshot:{let{file:n,...i}=e;if(!n)return null;return{...a,...i,file:n,messageType:t}}case i.codeSnippet:{let{file:n,...i}=e;if(!n)return null;return{...a,...i,file:n,messageType:t}}case i.mix:{let{fontStyte:n,mention:i,allFiles:s,failureBody:r,...l}=e;return{isSending:!1,...a,...l,messageType:t,fontStyle:n??[],mention:i??[],allFiles:s??[],failureBody:r??0}}case i.bot:{let{botTemplate:n,...i}=e;if(!n)return null;return{...a,...i,messageType:t,botTemplate:n}}case i.info:case i.giphy:case i.pmc:case i.e2e:case i.call:case i.unknown:return{...a,...e,messageType:t};default:return null}}function yD(e){let t=yO(e);if(!t)return null;let{replyId:a,replyThreadTime:n,...i}=t;return a&&"number"==typeof n?{...i,replyId:a,replyThreadTime:n}:null}function yP(e){return r(e.map(e=>yO(e)))}function yF(e){return r(e.map(e=>yD(e)))}let yB=e_().schema(()=>({mainMessageMap:eb.map(eb.string(),yS),replyMap:eb.map(eb.string(),yk),unsentMessageMap:eb.map(eb.string(),yS.or(yk))})).views(e=>{function t(t){return e.mainMessageMap.get(t)}function a(t){return e.replyMap.get(t)}function n(n){return t(n)??a(n)??function(t){return e.unsentMessageMap.get(t)}(n)}return{mainMessage:t,reply:a,message:n,mainMessages:e=>r(e.map(t)),replies:e=>r(e.map(a)),messages:e=>r(e.map(n)),get meetingMap(){return[...e.mainMessageMap.values()].filter(e=>e.messageType===i.call&&e.callInfo?.action!=="invite").reduce((e,t)=>{let a=t.callInfo?.raw.meetingNo;return a&&(e.has(a)||e.set(a,t),t.callInfo?.subtype===1&&e.set(a,t)),e},new Map)}}}).mutations(e=>{function t(t){t.forEach(t=>{let a=e.message(t.id);a?j(a,t):t.replyId?e.replyMap.set(t.id,t):e.mainMessageMap.set(t.id,t)})}return{setMessages(e){t(e)},setPartialMessages(a){let n=a.filter(t=>{let{id:a}=t;return!e.message(a)}).map(e=>({...e,isPartial:!0}));t(n)},updateMessage(t){let a=e.message(t.id);a&&j(a,t)},deleteMessage(t){e.mainMessageMap.delete(t)||e.replyMap.delete(t)},addUnsentMessage(t){e.unsentMessageMap.set(t.id,t)},deleteUnsentMessage(t){e.unsentMessageMap.delete(t)},setEmojiVote(t){let{msgId:a,emoji:n,action:i,senderJid:s}=t,r=e.message(a);if(!r)return;let l=r.emojiVotes,o=rS(s);if("add"===i){if(l[n]){if(l[n].count+=1,!o)return;l[n].haveIEmojied=!0}else j(l,{[n]:{count:1,haveIEmojied:o,firstEmojiTime:Date.now()}})}else if(l[n].count>1){if(l[n].count-=1,!o)return;l[n].haveIEmojied=!1}else N(r.emojiVotes,n)},correctEmojiVoteCount(t){let{msgId:a,emoji:n,count:i}=t,s=e.message(a);if(!s?.emojiVotes?.[n])return;let r=Math.abs(i-s.emojiVotes[n].count);r>1&&(s.emojiVotes[n].count=i)},updateCommentTotal(t){let{mainMsgId:a,diff:n}=t,i=e.mainMessage(a);i&&(i.commentTotal=Math.max((i.commentTotal??0)+n,0))},setIsEditing(t){let{id:a,isEditing:n}=t,i=e.message(a);i&&(i.isEditing=n)},setIsEditorOpen(t){let{mainMsgId:a,isOpen:n}=t,i=e.mainMessage(a);i&&(i.isEditorOpen=n)},markChatRead(t){let a=[...e.mainMessageMap.values(),...e.replyMap.values()];a.forEach(e=>{e.channelJid===t&&e.isUnreadMsg&&(e.isUnreadMsg=!1)})},markRealTimeMsgRead(t){let a=[...e.mainMessageMap.values(),...e.replyMap.values()],n=ab(aO(t,e=>{let{sessionId:t}=e;return t}),e=>{let{threadMap:t,unreadMsgTimestamps:a}=e;return Object.values(t).reduce((e,t)=>{let{unreadMsgTimestamps:a}=t;return a.forEach(t=>e.add(t)),e},a)});a.forEach(e=>{e.isUnreadMsg&&e.isRealTime&&!n[e.channelJid]?.has(e.time)&&(e.isUnreadMsg=!1)})}}}).effects((e,t)=>{let{sdk:a,fileMap:n}=t;return{onEditMessage:()=>a.editMessage$.pipe(a_(t=>{let a={...aY(t,["id","time","operType","message","messageXmlStr","mention","allFiles"]),fontStyle:t.fontStyte||[],failureBody:t.failureBody||void 0};return t.messageType===i.codeSnippet&&t.file?q(n.fetchMsgFile({type:yv.codeSnippet,fileId:t.file.fileId,fileName:t.file.fileName,forceFetch:!0}),e.updateMessage(a)):q(e.updateMessage(a))})),onUnreadChannelMap:()=>a.unreadChannel$.pipe(aA(300,void 0,{leading:!1,trailing:!0}),ah(t=>e.markRealTimeMsgRead(t))),onUpdateEmojiVote:()=>a.emojiVote$.pipe(ah(t=>e.setEmojiVote(t))),editMixMessage:t=>t.pipe(a_(t=>{let{files:s,...l}=t,{fileToSend:o,fileToShow:d,newFiles:c}=function(e){let{allFiles:t=[],startIndex:a=0}=e,n=[],s=[],r=[];return t.forEach((e,t)=>{let l=a+t;switch(e.type){case sY.file:case sY.image:{let t={...e.fileItem,type:e.fileItem?.type||0,startpos:l,endpos:l};n.push(t),s.push(t);return}case i.giphy:case i.screenshot:case i.image:case i.file:{let t={id:sW(),file:e.file,imgUrl:e.imgUrl,giphy:e.giphy,pos:l},[a]=rr([t]),[i]=rl([t]);n.push(a),s.push(i),r.push(i)}}}),{fileToSend:n,fileToShow:s,newFiles:r}}({allFiles:s,startIndex:t.message.length}),u={id:t.id,message:t.message,fontStyle:t.fontStyte,mention:t.mention,failureBody:t.message.length?0:1,allFiles:d,operType:em.edit,isSending:!0};return a.mutation.editMessage({...l,msgType:i.mix,allFiles:o,...yL(t.message,t.fontStyte||[])}).pipe(a_(a=>{let i=a.allFiles||[],s={id:t.id,time:a.msgTimestamp,message:a.message,mention:a.mention,fontStyle:a.fontStyte,allFiles:i,messageXmlStr:a.originMsgXmlStr,isSending:!1};return ap(r([e.updateMessage(s),...i.filter(e=>{let{id:t,fileUrl:a}=e;return!!t||!!a}).map(e=>{let{fileId:t,fileName:a,id:i,sendAsFile:s,file:r,fileUrl:l}=e;if(s)return n.setFileState({fileId:t,state:{status:i6.sended,progress:100,file:r}});{let e=i?n.getImageState(i).message:"";return n.setSendingImageState({fileId:t,message:e||l||"",fileName:a,isSent:!0,isGiphy:!!l})}}),...c.map(e=>n.deleteFromMap(e.fileId))]))}),lX(r([e.message(t.id),n]),[e.updateMessage(u),...c.map(e=>e.fileUrl?n.setSendingImageState({fileId:e.fileId,message:e.fileUrl,fileName:e.fileName,isSent:!0,isGiphy:"giphy"===e.fileType}):n.setFileState({fileId:e.fileId,state:{status:i6.sending}}))]),J(()=>K))})),fetchMsgByTimes:t=>t.pipe(a_(t=>{let{params:n,onAction:i,forceUpdate:s}=t;return a.query.fetchMsgByTimes(n).pipe(J(e=>(console.error(e),i?.([]),K)),ah(t=>{let a=r(t.map(e=>e.replyId?yD(e):yO(e)));return i?.(a),s?e.setMessages(a):e.setPartialMessages(a)}))})),editTextMessage:t=>t.pipe(a_(t=>{let n={id:t.id,message:t.message,fontStyle:t.fontStyte,mention:t.mention,operType:em.edit};return a.mutation.editMessage({...t,msgType:i.text,...yL(t.message,t.fontStyte||[])}).pipe(ah(a=>{let n={id:t.id,message:a.message,mention:a.mention,time:a.msgTimestamp,fontStyle:a.fontStyte,messageXmlStr:a.originMsgXmlStr};return e.updateMessage(n)}),lX(r([e.message(t.id)]),[e.updateMessage(n)]),J(()=>K))}))}}),yU=yB.create({mainMessageMap:new Map,replyMap:new Map,unsentMessageMap:new Map},{sdk:uW,fileMap:yw});function yH(e,t,a){if(!e)return null;let n=yU.mainMessages(t),i=n.find(t=>{let{time:a}=t;return a===e});if(i)return i;let s=yU.replies(a),r=s.find(t=>{let{time:a}=t;return a===e});return r?.replyId?n.find(e=>{let{id:t}=e;return t===r.replyId}):null}let yz=eb.object({sessionId:eb.string(),timestamp:eb.number(),username:eb.string(),reminderT:eb.number(),msgId:eb.string(),thread:eb.string().optional(),threadT:eb.number().optional(),msgSender:eb.string(),content:eb.string(),note:eb.string(),displayT:eb.number(),expireT:eb.number(),notificationT:eb.number().optional()}),yV=e_().schema(()=>({customModalVisible:eb.boolean(),reminderList:eb.array(yz),loading:eb.boolean(),fetched:eb.boolean(),currentEditingMessage:yS.or(yk).nullable(),nowTime:eb.number(),isSubmitting:eb.boolean(),ifHideSuccessToast:eb.boolean().optional(),lastReadTime:eb.number()})).views(e=>{function t(e){let{expireT:t,displayT:a}=e,n=Date.now();return t<n?t:a}return{getReminderByMsgId:t=>e.reminderList.find(e=>{let{msgId:a}=e;return t===a})||null,getIsReminded:t=>!!e.reminderList.find(e=>e.msgId===t),getIsExpired(t){let{expireT:a}=t;return a<e.nowTime},get sortedReminderList(){return e.reminderList.slice().sort((e,a)=>t(e)-t(a))},get unreadNum(){return e.reminderList.filter(t=>{let{expireT:a}=t;return a<Date.now()&&a>e.lastReadTime}).length}}}).mutations((e,t)=>{let{scroller:a,messageStore:n}=t;function i(e){return{...e,expireT:Date.now()+1e3*e.reminderT}}return{scrollEnd(){requestAnimationFrame(()=>a.scrollEnd())},setLoading(t){e.loading=t},markFetched(){e.fetched=!0},setIsSubmitting(t){e.isSubmitting=t},openCustomReminder(t){let{message:a,ifHideToast:n}=t;e.customModalVisible=!0,e.ifHideSuccessToast=n,e.currentEditingMessage=a},closeCustomReminder(){e.customModalVisible=!1,e.currentEditingMessage=null},setReminderList(t){e.reminderList=t.map(i)},setMessageMap(e){let t=yP(e);n.setPartialMessages(t)},setNowTime(){e.nowTime=Date.now()},fixToExpired(t){let a=e.reminderList.findIndex(e=>{let{msgId:a}=e;return t===a});!(a<0)&&(e.reminderList[a].expireT<Date.now()||(e.reminderList[a].expireT=Date.now()-1))},deleteLocalReminder(t){let{session:a,svrTime:n}=t,i=e.reminderList.findIndex(e=>{let{sessionId:t,timestamp:i}=e;return n===i&&t===a});i<0||e.reminderList.splice(i,1)},addLocalReminder(t){let a=e.reminderList.findIndex(e=>{let{msgId:a}=e;return a===t.msgId});a<0&&e.reminderList.push(i(t)),e.reminderList.splice(a,1,i(t))},showCancelToast:()=>o2.success(oL.$t({id:"9PNVbd",defaultMessage:[{type:0,value:"Reminder Canceled"}]})),showRemindSuccessToast:()=>o2.success(oL.$t({id:"C+dYb4",defaultMessage:[{type:0,value:"Reminder saved.View and manage it in reminders on your left sidebar"}]})),setLastReadTime(t){e.lastReadTime=t||Date.now()},updateUnreadNum(){e.lastReadTime++}}}).effects((e,t)=>{let{sdk:a,recentChatStore:n}=t;return{onConnected:()=>a.connected$.pipe(ah(()=>e.fetchReminders())),readReminderTime:()=>a.readReminderTime$.pipe(ah(t=>{let{time:a}=t;return e.setLastReadTime(a)})),onBookmark:()=>a.reminderSync$.pipe(a_(t=>{switch(t.action){case aX.close:return q(e.deleteLocalReminder(t.data));case aX.set:{let a=t.data,n={sessionId:a.session,timestamp:a.svrTime,username:"",reminderT:a.timeout,msgId:a.msgId,msgSender:a.msgSender,content:a.content,note:a.note,displayT:Number(a.displayTime),expireT:Date.now()+1e3*a.timeout};return q(e.addLocalReminder(n),e.fetchMessageByBookmark({params:[{id:n.sessionId,t:String(n.timestamp)}]}))}case aX.remind:if(n.chatId===sn.REMINDERS)return q(e.fixToExpired(t.data.msgId),e.readReminder());return q(e.fixToExpired(t.data.msgId),e.updateUnreadNum());case aX.reset:return q(e.setLastReadTime(t.data.time));default:return K}})),fetchReminders:t=>t.pipe(au(()=>a.query.getAllReminderMessages().pipe(J(()=>K),ah(t=>e.setReminderList(t.items))))),fetchMessageByBookmark:t=>t.pipe(au(t=>{let{params:n,isScrollEnd:i,isShowLoading:s}=t,l=n.reduce((e,t)=>{let{id:a,t:n}=t;return e[a]?(e[a].push({t:n}),e):{...e,[a]:[{t:n}]}},{}),o=Object.keys(l).map(e=>({[e]:l[e]}));return a.query.fetchMessageByBookmark(o).pipe(J(()=>K),a_(t=>ap([e.setMessageMap(t.data.map(e=>e.messages).flat()),...i?[e.scrollEnd()]:[]])),aV(...r([s?e.setLoading(!0):null])),aG(...r([s?e.setLoading(!1):null]),e.markFetched()))})),fetchAllMessageByBookmark:t=>t.pipe(ah(()=>e.fetchMessageByBookmark({isScrollEnd:!0,isShowLoading:!0,params:e.reminderList.map(e=>({id:e.sessionId,t:String(e.timestamp)}))}))),setReminder:t=>t.pipe(am(t=>{let n,{msg:s,time:l,note:o,ifHideToast:d}=t,c=Math.floor((l-Date.now())/1e3),u=e.getReminderByMsgId(s.id);return n=u?e.getIsExpired(u)?u.expireT:u.displayT:Date.now(),a.mutation.setReminder({msg:function(e){let t=e.message;switch(e.messageType){case i.image:case i.giphy:case i.screenshot:t="Image";break;case i.file:t=e.file?.fileName||"File"}return{...e,message:t}}(s),note:o,timeout:c,displayT:n}).pipe(a_(()=>ap(r([e.addLocalReminder({sessionId:s.channelJid,timestamp:s.time,username:"",reminderT:c,msgId:s.id,msgSender:s.senderJid||"",content:s.message,note:o,displayT:n,expireT:l}),e.closeCustomReminder(),e.setIsSubmitting(!1),d?null:e.showRemindSuccessToast()]))),J(t=>(console.error(t),q(e.setIsSubmitting(!1)))),aV(e.setIsSubmitting(!0)))})),closeReminder:t=>t.pipe(am(t=>{let{params:n,ifShowToast:i}=t;return a.mutation.closeReminder(n).pipe(J(()=>K),a_(()=>ap(r([e.deleteLocalReminder(n),i?e.showCancelToast():null]))))})),readReminder:t=>t.pipe(am(()=>a.mutation.readReminder({time:Date.now(),isSingle:!1}).pipe(J(()=>K),ah(()=>e.setLastReadTime(null))))),readReminderWhenDeleteMessage:t=>t.pipe(am(t=>e.reminderList.find(e=>e.timestamp===t)?a.mutation.readReminder({time:t,isSingle:!0}).pipe(J(()=>K),H()):K))}}).create({customModalVisible:!1,reminderList:[],loading:!1,fetched:!1,currentEditingMessage:null,nowTime:Date.now(),isSubmitting:!1,ifHideSuccessToast:!1,lastReadTime:Date.now()},{sdk:uW,scroller:sM.create("reminders"),recentChatStore:yh,messageStore:yU}),yG=eb.object({start:eb.number().optional(),end:eb.number().optional(),loading:eb.boolean(),replyIds:eb.array(eb.string()),unsentReplies:eb.array(yk)});function yq(e,t){let{jid:a,name:n,avatar:i}=e,s=Date.now();return{id:sW(),channelJid:t,time:s,senderJid:a,senderName:n||"",senderAvatar:i,operType:em.new,messageXmlStr:"",isUnreadMsg:!1}}function y$(e,t,a){let{message:n,fontStyte:s,replyId:r,mainMsgTime:l,mention:o,allFiles:d=[]}=e,{mixSendFiles:c,mixShownFiles:u}=ru(d,n.length);return{mixMessage:{...yq(t,a),messageType:i.mix,replyId:r,replyThreadTime:l,...n?{message:n,fontStyte:s,mention:o}:{message:""}},files:c,allFiles:u}}function yK(e,t,a){let{message:n,fontStyte:s,replyId:r,mainMsgTime:l,mention:o}=e;return{...yq(t,a),messageType:i.text,message:n,fontStyte:s,replyId:r,replyThreadTime:l,mention:o}}function yJ(e,t,a){let{giphyInfo:n,replyId:s,mainMsgTime:r}=e;return{...yq(t,a),messageType:i.giphy,message:lh(n),replyId:s,replyThreadTime:r}}function yW(e,t,a){let{imgUrl:n,file:s,replyId:r,mainMsgTime:l}=e;return{...yq(t,a),messageType:i.image,message:n,file:{fileId:sW(),fileName:s.name,size:s.size},replyId:r,replyThreadTime:l}}function yY(e,t,a){let{file:n,replyId:s,mainMsgTime:r}=e,l=yq(t,a);return{...l,messageType:i.file,message:"",file:{fileId:l.id,fileName:n.name,size:n.size},replyId:s,replyThreadTime:r}}function yX(e,t,a){let{thirdPartyInfo:n,replyId:s,mainMsgTime:r}=e,l=yq(t,a);return{...l,messageType:i.file,message:"",file:{fileId:l.id,fileName:n.fileName,size:n.fileSize},replyId:s,replyThreadTime:r,thirdPartyType:rx[n.integrationType],thirdStorageInfo:{extFile:s2(n.fileName),...n}}}function yQ(e,t){return{...e,giphyInfo:t}}function yZ(e){return e.filter(e=>{if(e.messageType===i.call){if(e.callInfo?.subtype===1)return!0;if(e.callInfo?.action!=="invite")return!1}return!0})}function y1(e){let t={};if(fZ.includes(e.messageType)&&e.thirdStorageInfo){let a=e.thirdStorageInfo;t={thirdPartyType:e.messageType,thirdStorageInfo:e.thirdStorageInfo,file:{fileId:a?.id,fileName:a?.fileName,size:a?.fileSize}}}return t}let y0=e_().schema(()=>({channelJid:eb.string(),mode:eb.literal("normal").or(eb.literal("transient")),messageIds:eb.array(eb.string()),transientMessageIds:eb.array(eb.string()),forbiddenMessageIds:eb.array(eb.string()),unsentMessages:eb.array(yS),repliesMap:eb.map(eb.string(),yG),loading:eb.boolean(),fetched:eb.boolean(),previousLoading:eb.boolean(),nextLoading:eb.boolean(),hasBefore:eb.boolean(),hasAfter:eb.boolean(),transientHasBefore:eb.boolean(),transientHasAfter:eb.boolean(),firstTimestamp:eb.number(),lastTimestamp:eb.number(),transientFirstTimestamp:eb.number(),transientLastTimestamp:eb.number()})).views(e=>({replyIds:t=>e.repliesMap.get(t)?.replyIds??[],unsentReplies:t=>e.repliesMap.get(t)?.unsentReplies??[],isReplyLoading:t=>e.repliesMap.get(t)?.loading??!1,get hasBeforeMessages(){return"normal"===e.mode?e.hasBefore:e.transientHasBefore},get hasAfterMessages(){return"normal"===e.mode?e.hasAfter:e.transientHasAfter},get initialMsgFetched(){return e.fetched||"transient"===e.mode&&!!e.transientMessageIds.length}})).mutations((e,t)=>{let{scroller:a,fileStore:n,fileMap:i,messageStore:s,eventEmitter:r,messageError:l,settingsStore:o,visibleMessage:d}=t;function c(e,t){let a=t.findIndex(t=>t.id===e);-1!==a&&t.splice(a,1)}function u(e,t){let a=yP(e);return s.setMessages(a),aP([...t,...a.map(e=>{let{id:t}=e;return t})])}function m(e,t){let a=yP(e);return s.setMessages(a),aP([...a.map(e=>{let{id:t}=e;return t}),...t])}function p(t,a){let n=e.repliesMap.get(t);n?Object.assign(n,a):e.repliesMap.set(t,function(e){let{loading:t,replyIds:a,unsentReplies:n,start:i,end:s}=e;return{loading:t||!1,replyIds:a||[],unsentReplies:n||[],start:i,end:s}}(a))}function h(e){let{mainMsgId:t,start:a,end:n}=e;p(t,aa({start:a,end:n},aJ))}return{setMode(t){e.mode=t},setForbiddenMessage(t){s.setMessages([t]);let a=ep(s.messages([...e.forbiddenMessageIds,t.id]),e=>{let{time:t}=e;return t},"asc");e.forbiddenMessageIds=a.map(e=>{let{id:t}=e;return t})},setTransientMessages(t){let a=yP(t);s.setMessages(a),e.transientMessageIds=a.map(e=>{let{id:t}=e;return t})},deleteMessage(t){s.deleteMessage(t),e.messageIds=e.messageIds.filter(e=>e!==t),"transient"===e.mode&&(e.transientMessageIds=e.transientMessageIds.filter(e=>e!==t))},deleteReply(t){let{mainMsgId:a,msgId:n}=t;s.deleteMessage(n);let i=e.replyIds(a),r=i.findIndex(e=>e===n);-1!==r&&i.splice(r,1)},appendMessages(t){e.messageIds=u(t,e.messageIds)},appendTransientMessages(t){e.transientMessageIds=u(t,e.transientMessageIds)},prependMessages(t){e.messageIds=m(t,e.messageIds)},prependMessageIds(t){e.messageIds=aP([...t,...e.messageIds])},prependTransientMessages(t){e.transientMessageIds=m(t,e.transientMessageIds)},addUnsentMessage(t){let a=yO(t);a&&(e.unsentMessages.push(a),s.addUnsentMessage(a))},addUnsentMessageById(t){let a=s.message(t);if(a){if(yA(a)){let n=a.replyId,i=e.replyIds(n),s=[...e.unsentReplies(n),a];p(n,{unsentReplies:s});let r=i.findIndex(e=>e===t);if(-1===r)return;i.splice(r,1)}else e.unsentMessages.push(a),e.messageIds=e.messageIds.filter(e=>e!==t)}},deleteUnsentMessage(t){c(t,e.unsentMessages),s.deleteUnsentMessage(t)},appendReplies(t){let{mainMsgId:a,replies:n}=t,i=yF(n);s.setMessages(i);let r=aP([...e.replyIds(a),...i.map(e=>{let{id:t}=e;return t})]);p(a,{replyIds:r})},moveMainMsgToBottomIfNeeded(t){let{newRepliesAtBottomOfChat:a}=o.settings;function n(e){let a=e.findIndex(e=>e===t);-1!==a&&e.splice(a,1)}a&&(d.messages.includes(t)||(n(e.messageIds),"transient"===e.mode&&n(e.transientMessageIds),e.messageIds.push(t)))},sortMainMessagesByLatestReply(){if(!e.messageIds)return;let{newRepliesAtBottomOfChat:t}=o.settings;t&&(e.messageIds=ep(s.mainMessages(e.messageIds).map(t=>{let{id:a,lastCommentTimestamp:n,time:i}=t,r=aQ(e.replyIds(a)),l=!!r&&s.reply(r)?.time;return{id:a,time:l||n||i}}),e=>{let{time:t}=e;return t}).map(e=>{let{id:t}=e;return t}))},prependReplies(t){let{mainMsgId:a,replies:n}=t,i=yF(n);s.setMessages(i);let r=aP([...i.map(e=>{let{id:t}=e;return t}),...e.replyIds(a)]);p(a,{replyIds:r})},addUnsentReply(t){let{mainMsgId:a,reply:n}=t,i=yD(n);if(!i)return;let r=[...e.unsentReplies(a),i];p(a,{unsentReplies:r}),s.addUnsentMessage(i)},deleteUnsentReply(t){let{mainMsgId:a,msgId:n}=t,i=e.unsentReplies(a);c(n,i),s.deleteUnsentMessage(n)},setReplyLoading(e){let{mainMsgId:t,loading:a}=e;p(t,{loading:a})},closeReply(e){h({mainMsgId:e,start:-1,end:-1})},setReplyScope(e){h(e)},updateReplyScopeByDiff(t){let{mainMsgId:a,diff:n}=t;if(0===n)return;s.updateCommentTotal({mainMsgId:a,diff:n});let i=s.mainMessage(a);if(!i)return;let r=e.repliesMap.get(i.id);if(!r)return;let l=i.commentTotal??0,{start:o,end:d}=r;if(n>0){let e=r.replyIds.length;e&&e!==l?h({mainMsgId:i.id,end:l??0}):h({mainMsgId:i.id,start:-1===o?l-n:o,end:l??0})}else h({mainMsgId:i.id,end:Math.min(d??0,l??0)});if(!l||o&&l<=o){h({mainMsgId:i.id,start:-1,end:-1});return}},setLoading(t){e.loading=t},clearMessages(){e.messageIds=[]},markFetched(){e.fetched=!0},setPreviousLoading(t){e.previousLoading=t},setNextLoading(t){e.nextLoading=t},setHasBefore(t){e.hasBefore=t},setHasAfter(t){e.hasAfter=t},setTransientHasBefore(t){e.transientHasBefore=t},setTransientHasAfter(t){e.transientHasAfter=t},setFirstTimestamp(t){e.firstTimestamp=t},setLastTimestamp(t){e.lastTimestamp=t},setTransientFirstTimestamp(t){e.transientFirstTimestamp=t},setTransientLastTimestamp(t){e.transientLastTimestamp=t},scrollEnd(){requestAnimationFrame(()=>a.scrollEnd())},scrollToMessage(e){requestAnimationFrame(()=>{a.scrollToMessage(e)})},scrollToMessageWithHighlight(e){requestAnimationFrame(()=>{a.scrollToMessage(e,!0)})},tryScroll(){requestAnimationFrame(()=>{a.tryScrollEnd()||a.tryRestorePosition()})},removeFile(e){n.removeFile(e)},removeFileFromFileMap(e){"gif"!==e.type&&i.deleteFromMap(e.id)},removeFileFromFileStore(e){"gif"!==e.type&&n.removeFile(e.file)},persistFile(e){let{id:t,file:a}=e;n.persistFile(t,a)},messageError(e){"string"==typeof e&&l(e)},revokeFileURL(e){e&&URL.revokeObjectURL(e)},dispatchLatestMessageEvent(e){r.dispatch(oH.updateLatestMessage,[e])},dispatchRevokeFiles(e){let{channelJid:t,fileIds:a}=e;r.dispatch(oH.revokeFiles,{channelJid:t,fileIds:a})}}}).effects((e,t)=>{let{sdk:a,profile:n,fileMap:s,messageStore:l,reminderStore:d,scroller:c,eventEmitter:u,settingsStore:m,recentChatStore:p,connectionStore:h,groupChannelStore:f,mentionGroupsStore:g}=t,{settings:y}=m,[v,_]=lA();function b(t,a){void 0===a&&(a=!0);let n=ad(t),i=n?.replyId,s=n?.replyThreadTime,r=n?.replyOwnerJid;if(!i||!s||!r)return[];let o=[e.setForbiddenMessage(function(e){let{id:t,time:a,channelJid:n,senderJid:i}=e;return{id:t,time:a,channelJid:n,messageType:"forbidden",message:"",messageXmlStr:"",operType:em.new,senderJid:i,senderName:"",emojiVotes:{},isUnreadMsg:!1,optimisticRevoked:!1,isEditorOpen:!1,isEditing:!1,commentTotal:0,isPartial:!1}}({id:i,time:s,channelJid:e.channelJid,senderJid:r})),e.prependReplies({mainMsgId:i,replies:t}),l.updateCommentTotal({mainMsgId:i,diff:t.length}),e.setReplyScope({mainMsgId:i,start:0,end:t.length})];return a?[...o,e.moveMainMsgToBottomIfNeeded(i)]:o}function M(e,t,a){let n=t.some(e=>{let{time:t}=e;return t===a}),i=e?.commentTotal??0,s=0,r=0;if(n){if(i!==t.length)s=Math.max(i-t.length,0),r=Math.min(i);else{let e=t.findIndex(e=>e.time===a);s=Math.max(e-4,0),r=Math.min(e+4,i)}}else s=Math.max(Math.min(i-t.length,i-8),0),r=i;return[s,r]}function x(t){let a=o(t.map(e=>{let{id:t}=e;return t}),e.messageIds);return a.length?t.findIndex(e=>{let{id:t}=e;return t===a[0]}):-1}function C(t){if(!t||t.messageType===i.codeSnippet)return[];let a=[];return("file"in t&&a.push(t.file.fileId),"allFiles"in t&&a.push(...t.allFiles.map(e=>e.fileId)),a.length>0)?[e.dispatchRevokeFiles({channelJid:t.channelJid,fileIds:a})]:[]}function j(){let t=f.channelInfo(e.channelJid);return{jid:e.channelJid,name:t?.name}}function N(t){let a=f.channelInfo(e.channelJid);if(!yn(a?.sessionType)||!a||t)return!1;let n=window.pwaChatConfig.currentStorageType;switch(!0){case a.isBox:return n===an.chatBoxStorage||"box"===n;case a.isSharePoint:return n===an.sharepoint;default:return!1}}return{disposeFile:_,onChangeBackToChat:()=>lw(()=>p.chatId===e.channelJid,!1).pipe(eg(Boolean),aZ(1),ah(()=>e.sortMainMessagesByLatestReply())),onRestrictedError:()=>a.restrictedError$.pipe(a_(t=>q(e.addUnsentMessageById(t.errorInfo.id),e.scrollEnd()))),onReceiveMessages:()=>aB(a.message$,u.appendInfoMessage$.pipe(ah(e=>[function(e,t){return{...e,actionInfo:{...e.actionInfo,operator:{jid:t.jid,name:t.name??""}}}}(e,n.currentUser)]))).pipe(a_(t=>{let[n,i]=a0(t.filter(t=>{let{channelJid:a}=t;return a===e.channelJid}).filter(e=>{let{id:t}=e,a=l.message(t);return!a||a.isPartial}).map(e=>({...e,isRealTime:!0})),e=>{let{replyId:t}=e;return!t}),s=Object.entries(a2(i,"replyId"));function o(t){return[e.appendMessages(t)]}function d(t){return t.flatMap(t=>{let[a,n]=t;return[e.appendReplies({mainMsgId:a,replies:n}),e.moveMainMsgToBottomIfNeeded(a),e.updateReplyScopeByDiff({mainMsgId:a,diff:n.length})]})}if(y.newRepliesAtBottomOfChat){let[t,i]=a0(s,e=>{let[t]=e;return!!l.mainMessage(t)||!!n.find(e=>{let{id:a}=e;return a===t})}),c=r(i.map(e=>{let[,t]=e;return ad(t)?.replyThreadTime}));if(c.length)return a.query.fetchMsgByTimes({session:e.channelJid,msgTimes:c}).pipe(J(e=>(console.error(e),K)),a_(e=>{let t=c.filter(t=>!e.some(e=>{let{time:a}=e;return t===a})),[a,n]=a0(i,e=>{let[,a]=e;return t.some(e=>ad(a)?.replyThreadTime===e)});return ap([...o(e),...d(n),...a.flatMap(e=>{let[,t]=e;return b(t)})])}),aV(...o(n),...d(t)))}return[...o(n),...d(s)]})),onRevokeMessage:()=>a.revokeMessage$.pipe(a_(t=>{let{mainMsgId:a,msgId:n,hasComment:s,msgTimestamp:r}=t,o=a&&a!==n,d=l.message(n),c=d&&f.channelInfo(d.channelJid),u=!!c?.isMeetChat;if(!u&&d&&d.time!==r)return K;let m=d?.messageType===i.file?d.file.fileUrl:void 0,p=C(d);return o?q(e.deleteReply({mainMsgId:a,msgId:n}),e.updateReplyScopeByDiff({mainMsgId:a,diff:-1}),e.revokeFileURL(m),...p):s?q(l.updateMessage({id:n,operType:em.revoke}),e.revokeFileURL(m),...p):q(e.deleteMessage(n),e.revokeFileURL(m),...p)})),onStartChatMessage:()=>u.startChatMessage$.pipe(eg(t=>{let{chatId:a}=t;return a===e.channelJid}),aK(()=>lw(()=>e.fetched).pipe(eg(Boolean))),ah(t=>{let{message:a}=t;return e.sendMessage({content:a,isExternal:!1})})),onJumpToMessage:()=>u.jumpToMessage$.pipe(a_(t=>{let{chatId:a,sendTime:n,mainMsgId:i}=t;if(a!==e.channelJid)return K;let s="normal"===e.mode?e.messageIds:e.transientMessageIds,r=i?function(e,t){let a=yU.mainMessages(t);return a.find(t=>{let{id:a}=t;return e===a})}(i,s):yH(n,s,F(Array.from(e.repliesMap.values()).map(e=>{let{replyIds:t}=e;return t})));if(!r)return q(e.jumpFetchMessages({timestamp:n,onSuccess(t){let a=t.find(e=>e.time===n);if(a)return[e.scrollToMessageWithHighlight(a.id)]}}));{let t=n===r.time;if(t)return q(e.scrollToMessageWithHighlight(r.id));let a=l.replies(e.replyIds(r.id)),i=a.findIndex(e=>{let{time:t}=e;return t===n});if(-1===i)return q(e.scrollToMessage(r.id),e.setReplyScope({mainMsgId:r.id,start:0,end:r.commentTotal||0}),e.fetchHistoryReplies({replyId:r.id,threadTime:r.time,limit:r.commentTotal||0,sort:"asc",onSuccess(t){let a=t.find(e=>e.time===n),i=t.findIndex(e=>{let{time:t}=e;return t===n});if(a&&-1!==i){let[i,s]=M(r,t,n);return[e.setReplyScope({mainMsgId:r.id,start:i,end:s}),e.scrollToMessageWithHighlight(a.id)]}}}));let s=a[i],[o,d]=M(r,a,n);return q(e.setReplyScope({mainMsgId:r.id,start:o,end:d}),e.scrollToMessageWithHighlight(s.id))}})),onNewReplySettingChange:()=>lw(()=>y.newRepliesAtBottomOfChat).pipe(aZ(1),a_(()=>q(e.clearMessages(),e.fetchLatestMessages()))),onChatNavigation(){let t=!0;return lw(()=>p.chatId===e.channelJid,!1).pipe(a1(lw(()=>e.fetched).pipe(eg(Boolean))),a_(a=>{if(!a)return t=c.isScrollBottom,K;if("transient"===e.mode)return K;let n=yn(f.channelInfo(e.channelJid)?.sessionType);if(n){let a=y.channelUnreadStart===so.FIRST,n=l.mainMessages(e.messageIds).find(e=>{let{isUnreadMsg:t}=e;return t});if(a&&n&&t)return q(e.scrollToMessage(n.id))}return q(e.tryScroll())}))},sendMessage:t=>t.pipe(aK(()=>lw(()=>h.connectedChannelJid===e.channelJid,!1).pipe(eg(Boolean))),a_(t=>{let{content:a,isExternal:n}=t,{textContent:s,files:r,thirdPartyInfo:l}=a,{text:o,styleItems:d,mention:c}=s,u=rg(o,r,l),m=ri(r),p=N(n);switch(u){case i.mix:if(p)return q(e.sendMixMsgToThirdParty(a));return q(e.sendMixMessage({message:o,fontStyte:d,mention:c,allFiles:m}));case i.text:return q(e.sendTextMessage({message:o,fontStyte:d,mention:c}));case i.image:case i.screenshot:if(p&&u===i.image)return q(e.sendFileMessage({file:m[0].file,isThirdStorage:p}));return q(e.sendImageMessage({file:m[0].file,imgUrl:m[0].imgUrl,type:u}));case i.giphy:return q(e.sendGiphyMessage({giphyInfo:m[0].giphy}));case i.file:return q(e.sendFileMessage({file:m[0].file,isThirdStorage:p}));default:return K}})),replyMessage:t=>t.pipe(aK(()=>lw(()=>h.connectedChannelJid===e.channelJid,!1).pipe(eg(Boolean))),a_(t=>{let{content:a,mainMsgId:n,isExternal:s}=t,{textContent:r,files:l}=a,{text:o,styleItems:d,mention:c}=r,u=rg(o,l),m=ri(l),p=N(s);switch(u){case i.mix:if(p)return q(e.replyMixMsgToThirdParty({content:a,mainMsgId:n}));return q(e.replyMixMessage({replyId:n,message:o,fontStyte:d,mention:c,allFiles:m}));case i.text:return q(e.replyTextMessage({replyId:n,message:o,fontStyte:d,mention:c}));case i.image:case i.screenshot:if(p&&u===i.image)return q(e.replyFileMessage({replyId:n,file:m[0].file,isThirdStorage:p}));return q(e.replyImageMessage({replyId:n,file:m[0].file,imgUrl:m[0].imgUrl,type:u}));case i.giphy:return q(e.replyGiphyMessage({giphyInfo:m[0].giphy,replyId:n}));case i.file:return q(e.replyFileMessage({replyId:n,file:m[0].file,isThirdStorage:p}));default:return K}})),replyMixMsgToThirdParty:t=>t.pipe(a_(t=>{let{content:a,mainMsgId:n}=t,{textContent:s,files:r}=a,{text:l,styleItems:o,mention:d}=s,c=[];return l&&c.push(e.replyTextMessage({replyId:n,message:l,fontStyte:o,mention:d})),r.forEach(t=>{switch(t.type){case i.giphy:c.push(e.replyGiphyMessage({giphyInfo:t.giphy,replyId:n}));break;case i.screenshot:c.push(e.replyImageMessage({replyId:n,file:t.file,imgUrl:t.imgUrl,type:t.type}));break;case i.image:case i.file:c.push(e.replyFileMessage({replyId:n,file:t.file,isThirdStorage:!0}))}}),q(...c)})),sendMixMsgToThirdParty:t=>t.pipe(a_(t=>{let{textContent:a,files:n}=t,{text:s,styleItems:r,mention:l}=a,o=[];return s&&o.push(e.sendTextMessage({message:s,fontStyte:r,mention:l})),n.forEach(t=>{switch(t.type){case i.giphy:o.push(e.sendGiphyMessage({giphyInfo:t.giphy}));break;case i.screenshot:o.push(e.sendImageMessage({file:t.file,imgUrl:t.imgUrl,type:t.type}));break;case i.image:case i.file:o.push(e.sendFileMessage({file:t.file,isThirdStorage:!0}))}}),q(...o)})),fetchLatestMessages:t=>t.pipe(au(()=>a.query.fetchHistoryMsgs({session:e.channelJid,timestamp:0,limit:"15:",sortByTimestamp:!y.newRepliesAtBottomOfChat}).pipe(lQ(),J(e=>(console.error(e),K)),a_(t=>{let{result:a,hasMoreBefore:n,firstTimestamp:i}=t,s=yZ(a);return q(e.markFetched(),e.messageIds.length?e.prependMessages(s):e.appendMessages(s),e.setHasBefore(n),e.setFirstTimestamp(i),e.scrollEnd())}),aV(e.setLoading(!0)),aG(e.setLoading(!1))))),fetchPreviousMessages:t=>t.pipe(au(()=>{if(!e.hasBeforeMessages)return K;let t=e.mode,n="normal"===t?e.firstTimestamp:e.transientFirstTimestamp,i="normal"===t?e.messageIds:e.transientMessageIds,s=i[0],{restore:r,record:l}=s?c.restorePosition(s,17):{restore:void 0,record:void 0};return a.query.fetchHistoryMsgs({session:e.channelJid,timestamp:n-1,limit:"15:",sortByTimestamp:!y.newRepliesAtBottomOfChat}).pipe(lQ(),J(e=>(console.error(e),K)),U(()=>{requestAnimationFrame(()=>r?.())}),a_(a=>{let{result:n,hasMoreBefore:i,firstTimestamp:s}=a;l?.();let r=yZ(n);return ap("normal"===t?[e.prependMessages(r),e.setHasBefore(i),e.setFirstTimestamp(s)]:[e.prependTransientMessages(r),e.setTransientHasBefore(i),e.setTransientFirstTimestamp(s)])}),aV(e.setPreviousLoading(!0)),aG(e.setPreviousLoading(!1)))})),fetchNextMessages:t=>t.pipe(au(()=>{if("transient"!==e.mode||!e.hasAfterMessages)return K;let t=e.transientLastTimestamp,n=e.transientMessageIds,i=n[n.length-1],{restore:s,record:r}=i?c.restorePosition(i):{restore:void 0,record:void 0};return a.query.fetchHistoryMsgs({session:e.channelJid,timestamp:t+1,limit:":15",sortByTimestamp:!y.newRepliesAtBottomOfChat}).pipe(lQ(),J(e=>(console.error(e),K)),U(()=>{requestAnimationFrame(()=>s?.())}),a_(t=>{let{result:a,hasMoreAfter:n,lastTimestamp:i}=t;r?.();let s=yZ(a),l=x(s),o=-1!==l;return!n||o?q(e.setHasBefore(e.transientHasBefore),e.setFirstTimestamp(e.transientFirstTimestamp),e.setMode("normal"),e.markFetched(),e.prependMessages(o?s.slice(0,l):s),e.prependMessageIds(e.transientMessageIds)):q(e.appendTransientMessages(s),e.setTransientHasAfter(n),e.setTransientLastTimestamp(i))}),aV(e.setNextLoading(!0)),aG(e.setNextLoading(!1)))})),fetchHistoryReplies:t=>t.pipe(aU(e=>{let{replyId:t}=e;return t}),a_(t=>t.pipe(am(t=>{let{replyId:n,onSuccess:i,...s}=t;return a.query.fetchHistoryComments({...s,session:e.channelJid}).pipe(lQ(),J(e=>(console.error(e),K)),a_(t=>{let a=i?.(t)||[];return q(e.prependReplies({mainMsgId:n,replies:t}),...a)}),aV(e.setReplyLoading({mainMsgId:n,loading:!0})),aG(e.setReplyLoading({mainMsgId:n,loading:!1})))})))),sendTextMessage:t=>t.pipe(a_(t=>{t={...t,mention:g.fillMentionByMentionGroup(t.mention)};let i=yK(t,n.currentUser,e.channelJid);return a.mutation.sendMessage({...t,id:i.id,...yL(i.message,i.fontStyte||[]),channelInfo:j()}).pipe(a_(t=>q(l.updateMessage({id:t.id,time:t.time,messageXmlStr:t.messageXmlStr,isSending:!1}),e.dispatchLatestMessageEvent(t))),aV(e.appendMessages([yR(i,!0)]),e.scrollEnd()),J(()=>q(e.deleteMessage(i.id),e.addUnsentMessage(i))))})),sendCloudFileMessage:t=>t.pipe(a_(t=>{let i=yX(t,n.currentUser,e.channelJid),s=rb(i.file.fileName),r={...t,file:s,id:i.id,channelInfo:j(),sendAsFile:!0,thirdPartyInfo:t.thirdPartyInfo};return a.mutation.sendCloudFile(r).pipe(a_(t=>q(l.updateMessage({id:t.id,time:t.time,messageXmlStr:t.messageXmlStr,isSending:!1}),e.dispatchLatestMessageEvent(t))),aV(e.appendMessages([yR(i,!0)]),e.scrollEnd()),J(()=>q(e.deleteMessage(i.id),e.addUnsentMessage(i))))})),replyCloudFileMessage:t=>t.pipe(a_(t=>{let i=l.mainMessage(t.replyId);if(!i)return K;let s=yX({...t,mainMsgTime:i.time},n.currentUser,e.channelJid),o=rb(s.file.fileName),d={...t,file:o,id:s.id,channelInfo:j(),sendAsFile:!0,thirdPartyInfo:t.thirdPartyInfo,mainMsgTime:i.time,mainMsgOwnerJid:i.senderJid??void 0};return a.mutation.sendCloudFile(d).pipe(a_(t=>q(l.updateMessage({id:t.id,time:t.time,messageXmlStr:t.messageXmlStr,isSending:!1}),e.dispatchLatestMessageEvent(t))),aV(e.appendReplies({mainMsgId:t.replyId,replies:[yR(s,!0)]}),e.moveMainMsgToBottomIfNeeded(t.replyId),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:1})),J(()=>ap(r([e.deleteReply({mainMsgId:t.replyId,msgId:s.id}),e.addUnsentReply({mainMsgId:t.replyId,reply:s}),i.commentTotal&&e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:-1})]))))})),replyTextMessage:t=>t.pipe(a_(t=>{let i=l.mainMessage(t.replyId);if(!i)return K;t={...t,mention:g.fillMentionByMentionGroup(t.mention)};let s=yK({...t,mainMsgTime:i.time},n.currentUser,e.channelJid);return a.mutation.sendMessage({...t,id:s.id,mainMsgTime:i.time,mainMsgOwnerJid:i.senderJid??void 0,channelInfo:j()}).pipe(a_(t=>q(l.updateMessage({id:t.id,time:t.time,messageXmlStr:t.messageXmlStr,isSending:!1}),e.dispatchLatestMessageEvent(t))),aV(e.appendReplies({mainMsgId:t.replyId,replies:[yR(s,!0)]}),e.moveMainMsgToBottomIfNeeded(t.replyId),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:1})),J(()=>q(e.deleteReply({mainMsgId:t.replyId,msgId:s.id}),e.addUnsentReply({mainMsgId:t.replyId,reply:s}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:-1}))))})),sendGiphyMessage:t=>t.pipe(a_(t=>{let i=yJ(t,n.currentUser,e.channelJid);return a.mutation.sendGiphy({giphyInfo:t.giphyInfo,id:i.id,channelInfo:j()}).pipe(a_(t=>q(l.updateMessage(t),s.setImageSended({fileId:i.id}),e.dispatchLatestMessageEvent(t))),aV(e.appendMessages([i]),s.setSendingImageState({fileId:i.id,message:i.message,fileName:`${i.id}.gif`,isGiphy:!0}),e.scrollEnd()),J(()=>q(e.deleteMessage(i.id),e.addUnsentMessage(yQ(i,t.giphyInfo)),s.setImageSended({fileId:i.id}))))})),replyGiphyMessage:t=>t.pipe(a_(t=>{let i=l.mainMessage(t.replyId),r=yJ({...t,mainMsgTime:i?.time},n.currentUser,e.channelJid);return a.mutation.sendGiphy({...t,id:r.id,mainMsgTime:i?.time,mainMsgOwnerJid:i?.senderJid??void 0,channelInfo:j()}).pipe(a_(t=>q(l.updateMessage({id:t.id,time:t.time,messageXmlStr:t.messageXmlStr}),s.setImageSended({fileId:t.id}),e.dispatchLatestMessageEvent(t))),aV(e.appendReplies({mainMsgId:t.replyId,replies:[r]}),e.moveMainMsgToBottomIfNeeded(t.replyId),s.setSendingImageState({fileId:r.id,message:r.message,fileName:`${r.id}.gif`,isGiphy:!0}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:1})),J(()=>q(e.deleteReply({mainMsgId:t.replyId,msgId:r.id}),e.addUnsentReply({mainMsgId:t.replyId,reply:yQ(r,t.giphyInfo)}),s.setImageSended({fileId:r.id}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:-1}))))})),sendImageMessage:t=>t.pipe(a_(t=>{let r=yW(t,n.currentUser,e.channelJid),o=t.type===i.screenshot?a.mutation.sendScreenshot:a.mutation.sendImage;return o({file:t.file,id:r.id,channelInfo:j()}).pipe(a_(t=>{let a={time:t.time,messageXmlStr:t.messageXmlStr,file:t.file};return q(l.updateMessage({id:t.id,...a}),s.updateImageId({prevId:r.file?.fileId,newId:t.file?.fileId}),s.setImageSended({fileId:t.file?.fileId}),e.dispatchLatestMessageEvent(t))}),aV(e.appendMessages([r]),s.setSendingImageState({fileId:r.file?.fileId,message:r.message,fileName:r.file?.fileName}),e.scrollEnd()),J(()=>q(e.deleteMessage(r.id),e.addUnsentMessage(r),s.setImageSended({fileId:r.file?.fileId}))))})),replyImageMessage:t=>t.pipe(a_(t=>{let r=l.mainMessage(t.replyId);if(!r)return K;let o=yW({...t,mainMsgTime:r.time},n.currentUser,e.channelJid),d=t.type===i.screenshot?a.mutation.sendScreenshot:a.mutation.sendImage;return d({...t,id:o.id,mainMsgTime:r.time,mainMsgOwnerJid:r.senderJid??void 0,channelInfo:j()}).pipe(a_(t=>{let a={time:t.time,messageXmlStr:t.messageXmlStr,file:t.file};return q(l.updateMessage({id:t.id,...a}),s.updateImageId({prevId:o.file?.fileId,newId:t.file?.fileId}),s.setImageSended({fileId:t.file?.fileId}),e.dispatchLatestMessageEvent(t))}),aV(e.appendReplies({mainMsgId:t.replyId,replies:[o]}),e.moveMainMsgToBottomIfNeeded(t.replyId),s.setSendingImageState({fileId:o.file?.fileId,message:o.message,fileName:o.file?.fileName}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:1})),J(()=>q(e.deleteReply({mainMsgId:t.replyId,msgId:o.id}),e.addUnsentReply({mainMsgId:t.replyId,reply:o}),s.setImageSended({fileId:o.file?.fileId}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:-1}))))})),sendMixMessage:t=>t.pipe(a_(t=>{t={...t,mention:g.fillMentionByMentionGroup(t.mention)};let{mixMessage:i,files:o,allFiles:d}=y$(t,n.currentUser,e.channelJid);return a.mutation.sendMixMsg({...i,files:o,replyId:void 0,...yL(i.message,i.fontStyte||[]),channelInfo:j()}).pipe(a_(t=>{let a=t.allFiles||[],n={time:t.time,messageXmlStr:t.messageXmlStr,allFiles:a};return ap(r([l.updateMessage(yR({...n,id:t.id},!1)),...a.map(e=>{let{fileId:t,fileName:a,id:n,sendAsFile:i,file:r,fileUrl:l}=e;if(i)return s.setFileState({fileId:t,state:{status:i6.sended,progress:l||r?100:0,file:r,fileUrl:l||r&&URL.createObjectURL(r)}});{let e=s.getImageState(n??t),i=!n;return s.setSendingImageState({fileId:t,message:e.message||l||"",fileName:a,isSent:!0,isGiphy:i})}}),...o.map(t=>[e.removeFileFromFileMap(t),e.removeFileFromFileStore(t)]).flat(),e.dispatchLatestMessageEvent(t)]))}),aV(e.appendMessages([yR({...i,allFiles:d},!0)]),...d.map(e=>e.fileUrl?s.setSendingImageState({fileId:e.fileId,message:e.fileUrl,fileName:e.fileName,isSent:!0,isGiphy:"giphy"===e.fileType}):s.setFileState({fileId:e.fileId,state:{status:i6.sending}})),e.scrollEnd()),J(t=>{let a=t?.errorInfo?.response?.data?.message;return q(e.deleteMessage(i.id),e.addUnsentMessage({...i,allFiles:d}),...d.filter(e=>!e.fileUrl).map(t=>[s.setFileState({fileId:t.fileId,state:{status:i6.unsent}}),e.persistFile({id:t.fileId,file:t.file})]).flat(),e.messageError(a))}),aL(v.pipe(eg(e=>e===i.id))))})),replyMixMessage:t=>t.pipe(a_(t=>{let i=l.mainMessage(t.replyId);if(!i)return K;t={...t,mention:g.fillMentionByMentionGroup(t.mention)};let{mixMessage:o,files:d,allFiles:c}=y$({...t,mainMsgTime:i.time},n.currentUser,e.channelJid);return a.mutation.sendMixMsg({...o,files:d,replyId:t.replyId,mainMsgTime:i.time,mainMsgOwnerJid:i.senderJid??void 0,channelInfo:j()}).pipe(a_(a=>{let n=a.allFiles||[],i={time:a.time,messageXmlStr:a.messageXmlStr,allFiles:n};return ap(r([l.updateMessage(yR({...i,id:a.id,replyId:t.replyId},!1)),...n.map(e=>{let{fileId:t,id:a,sendAsFile:n,file:i,fileUrl:r,fileName:l}=e;if(n)return s.setFileState({fileId:t,state:{status:i6.sended,progress:r||i?100:0,file:i,fileUrl:r||i&&URL.createObjectURL(i)}});{let e=s.getImageState(a??t),n=!a;return s.setSendingImageState({fileId:t,message:e.message||r||"",fileName:l,isSent:!0,isGiphy:n})}}),...d.map(t=>[e.removeFileFromFileMap(t),e.removeFileFromFileStore(t)]).flat(),e.dispatchLatestMessageEvent(a)]))}),aV(e.appendReplies({mainMsgId:t.replyId,replies:[yR({...o,allFiles:c},!0)]}),e.moveMainMsgToBottomIfNeeded(t.replyId),...c.map(e=>e.fileUrl?s.setSendingImageState({fileId:e.fileId,message:e.fileUrl,fileName:e.fileName,isSent:!0,isGiphy:"giphy"===e.fileType}):s.setFileState({fileId:e.fileId,state:{status:i6.sending}})),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:1})),J(a=>{let n=a?.errorInfo?.response?.data?.message;return q(e.deleteReply({mainMsgId:t.replyId,msgId:o.id}),e.addUnsentReply({mainMsgId:t.replyId,reply:{...o,allFiles:c}}),...c.filter(e=>!e.fileUrl).map(t=>[s.setFileState({fileId:t.fileId,state:{status:i6.unsent}}),e.persistFile({id:t.fileId,file:t.file})]).flat(),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:-1}),e.messageError(n))}),aL(v.pipe(eg(e=>e===o.id))))})),sendFileMessage:t=>t.pipe(a_(t=>{let i=yY(t,n.currentUser,e.channelJid);return a.mutation.sendFile({file:t.file,id:i.id,channelInfo:j(),isThirdStorage:t.isThirdStorage}).pipe(a_(a=>{let n=y1(a),r={time:a.time,messageXmlStr:a.messageXmlStr,file:a.file,isSending:!1,...n},o=a.file?.fileUrl||URL.createObjectURL(t.file);return q(l.updateMessage({...r,id:a.id}),s.setFileState({fileId:a.file?.fileId,state:{status:i6.sended,progress:100,file:a.file?.file,fileUrl:o}}),s.deleteFromMap(i.file?.fileId),e.removeFile(t.file),e.dispatchLatestMessageEvent(a))}),aV(e.appendMessages([yR(i,!0)]),s.setFileState({fileId:i.file?.fileId,state:{status:i6.sending}}),e.scrollEnd()),J(a=>{let n=a?.errorInfo?.response?.data?.message||a?.errorInfo?.response?.data?.errorMessage||a?.errorInfo;return q(e.deleteMessage(i.id),e.addUnsentMessage(i),s.setFileState({fileId:i.file?.fileId,state:{status:i6.unsent}}),e.persistFile({id:i.id,file:t.file}),e.messageError(n))}),aL(v.pipe(eg(e=>e===i.file?.fileId))))})),replyFileMessage:t=>t.pipe(a_(t=>{let i=l.mainMessage(t.replyId);if(!i)return K;let r=yY({...t,mainMsgTime:i.time},n.currentUser,e.channelJid);return a.mutation.sendFile({...t,id:r.id,mainMsgTime:i.time,mainMsgOwnerJid:i.senderJid??void 0,channelInfo:j(),isThirdStorage:t.isThirdStorage}).pipe(a_(a=>{let n=y1(a),i={time:a.time,messageXmlStr:a.messageXmlStr,file:a.file,isSending:!1,...n},o=a.file?.fileUrl||URL.createObjectURL(t.file);return q(l.updateMessage({...i,id:a.id}),s.setFileState({fileId:a.file?.fileId,state:{status:i6.sended,progress:100,file:a.file?.file,fileUrl:o}}),s.deleteFromMap(r.file?.fileId),e.removeFile(t.file),e.dispatchLatestMessageEvent(a))}),aV(e.appendReplies({mainMsgId:t.replyId,replies:[yR(r,!0)]}),e.moveMainMsgToBottomIfNeeded(t.replyId),s.setFileState({fileId:r.file?.fileId,state:{status:i6.sending}}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:1})),J(a=>{let n=a?.errorInfo?.response?.data?.message||a?.errorInfo?.response?.data?.errorMessage||a?.errorInfo;return q(e.deleteReply({mainMsgId:t.replyId,msgId:r.id}),e.addUnsentReply({mainMsgId:t.replyId,reply:r}),s.setFileState({fileId:r.file?.fileId,state:{status:i6.unsent}}),e.updateReplyScopeByDiff({mainMsgId:t.replyId,diff:-1}),e.persistFile({id:r.id,file:t.file}),e.messageError(n))}),aL(v.pipe(eg(e=>e===r.file?.fileId))))})),revokeMessage:t=>t.pipe(aU(e=>{let{msgId:t}=e;return t}),a_(t=>t.pipe(am(t=>a.mutation.revokeMessage(t).pipe(a_(()=>{let a=l.mainMessage(t.msgId),n=C(a);return t.hasComment?q(l.updateMessage({id:t.msgId,operType:em.revoke}),e.revokeFileURL(t.fileUrl),...n):q(e.deleteMessage(t.msgId),e.revokeFileURL(t.fileUrl),d.readReminderWhenDeleteMessage(t.msgTimestamp),...n)}),aV(l.updateMessage({id:t.msgId,optimisticRevoked:!0})),J(e=>(console.error(e),q(l.updateMessage({id:t.msgId,optimisticRevoked:!1}))))))))),revokeReply:t=>t.pipe(aU(e=>{let{msgId:t}=e;return t}),a_(t=>t.pipe(am(t=>a.mutation.revokeMessage(t).pipe(a_(()=>{let a=l.reply(t.msgId),n=C(a);return q(e.deleteReply({mainMsgId:t.mainMsgId,msgId:t.msgId}),e.revokeFileURL(t.fileUrl),d.readReminderWhenDeleteMessage(t.msgTimestamp),...n)}),aV(l.updateMessage({id:t.msgId,optimisticRevoked:!0}),e.updateReplyScopeByDiff({mainMsgId:t.mainMsgId,diff:-1})),J(a=>(console.error(a),q(l.updateMessage({id:t.msgId,optimisticRevoked:!1}),e.updateReplyScopeByDiff({mainMsgId:t.mainMsgId,diff:1}))))))))),fetchForbiddenReplies:t=>t.pipe(am(t=>{let{mainMsgTime:n,commentsLimit:i}=t;return a.query.fetchHistoryComments({threadTime:n,limit:i,sort:"desc",session:e.channelJid}).pipe(lQ(),J(e=>(console.error(e),K)),a_(t=>{let a=b(t);if(!a.length)return K;let n=aQ(t)?.id;return n?ap([...a,e.scrollToMessage(n)]):K}))})),jumpFetchMessages:t=>t.pipe(am(t=>{let{onSuccess:n,commentsLimit:i,...s}=t;return a.query.jumpFetchHistoryMsgs({...s,session:e.channelJid,limit:"8:8",sortByTimestamp:!y.newRepliesAtBottomOfChat}).pipe(lQ(),J(e=>(console.error(e),K)),a_(l=>{let{result:o,hasMoreAfter:d,hasMoreBefore:c,firstTimestamp:u,lastTimestamp:m}=l,p=yZ(o),h=p.flatMap(e=>V(e.comments,"id")),f=n?.([...p,...h])||[],g=[...p,...h].find(e=>{let{time:a}=e;return a===t.timestamp});if(!g)return i?q(e.setMode("normal"),e.fetchForbiddenReplies({mainMsgTime:t.timestamp,commentsLimit:i})):a.query.fetchMsgByTimes({session:e.channelJid,msgTimes:[t.timestamp]}).pipe(J(e=>(console.error(e),K)),a_(t=>q(e.setMode("normal"),...b(t,!1))));let y=Object.entries(a2(h,"replyId")).flatMap(t=>{let[a,n]=t,{timestamp:i}=s,l=p.find(e=>{let{id:t}=e;return t===a}),[o,d]=M(l,n,i);return r([e.appendReplies({mainMsgId:a,replies:n}),l&&n.length?e.setReplyScope({mainMsgId:a,start:o,end:d}):null])}),v=x(p),_=-1!==v;return!d||_?q(e.setHasBefore(c),e.setFirstTimestamp(u),e.setMode("normal"),e.markFetched(),e.prependMessages(_?p.slice(0,v):p),...y,...f):q(e.setTransientHasAfter(d),e.setTransientHasBefore(c),e.setTransientFirstTimestamp(u),e.setTransientLastTimestamp(m),e.setMode("transient"),e.setTransientMessages(p),...y,...f)}),aV(e.setLoading(!0)),aG(e.setLoading(!1)))}))}}),y2=!1,y5=window.React.createContext,y3=window.React.useContext,y6={},y4=y5(null),y8=y4.Provider;function y7(e){let{channelJid:t,children:a,destroyOnUnmount:n=!0}=e,i=l3(()=>{if(y6[t])return y6[t];{let e=function(e){let t=uq(y0.schema(()=>({localMessages:eb.array(yS)})).mutations(e=>({cleanLocalMessages(){e.localMessages=[]}})).effects(e=>({onFetched:()=>lw(()=>e.fetched).pipe(eg(Boolean),ah(()=>e.cleanLocalMessages()))})),{storageKey:rQ.messages,persist(e){let{channelJid:t,messageIds:a}=e,n=yU.mainMessages(a).slice(-30).map(e=>x(e));return{channelJid:t,localMessages:n}},recover(t){let a=eb.object({channelJid:eb.string(),localMessages:eb.array(yS)});a.parse(t);let{channelJid:n,localMessages:i}=t;return n!==e?{}:{localMessages:i}},recoverTrigger$(){let e=y2?K:q(void 0);return y2=!0,e}});return t.create({channelJid:e,mode:"normal",messageIds:[],transientMessageIds:[],forbiddenMessageIds:[],unsentMessages:[],localMessages:[],repliesMap:new Map,loading:!1,fetched:!1,previousLoading:!1,nextLoading:!1,hasBefore:!1,hasAfter:!1,transientHasAfter:!1,transientHasBefore:!1,firstTimestamp:0,lastTimestamp:0,transientFirstTimestamp:0,transientLastTimestamp:0},{sdk:uW,profile:g2,fileMap:yw,messageStore:yU,reminderStore:yV,scroller:sM.create(e),fileStore:rw,eventEmitter:oz,messageError:o2.error,settingsStore:g4,recentChatStore:yh,connectionStore:yy,groupChannelStore:gQ,visibleMessage:sx.create(e),encryptedStorage:uV,mentionGroupsStore:yE})}(t);return y6[t]=e,e}},[t]);return l2(()=>()=>{let e=y6[t];n&&e&&(e.$destroy(),delete y6[t])},[t,n]),g.jsx(y8,{value:i,children:a})}function y9(){return y3(y4)||{}}let ve=(e,t)=>!e&&t?a5.add:e&&!t?a5.remove:a5.update,vt=e_().schema(()=>({visible:eb.boolean(),channelJid:eb.string(),desc:eb.string().nullable(),descLoading:eb.boolean(),descLoaded:eb.boolean(),activeAccordionKeysSet:eb.set(eb.string())})).mutations(e=>({setChannelActionsVisible(t){e.visible=t},toggleVisible(){e.visible=!e.visible},setChannelJid(t){e.channelJid=t},setDesc(t){e.desc=t},setDescLoading(t){e.descLoading=t},setDescLoaded(t){e.descLoaded=t},setActiveAccordionKeysSet(t){Array.isArray(t)&&(e.activeAccordionKeysSet=new Set([...t]))}})).effects((e,t)=>{let{sdk:a}=t;return{onDescChanged:()=>a.channelAction$.pipe(eg(t=>{let{room:{jid:a},type:n}=t;return a===e.channelJid&&n===aI.desc}),ah(t=>{let{data:{desc:a}}=t;return e.setDesc(a??"")})),getDesc:t=>t.pipe(au(()=>a.query.getChannel(e.channelJid).pipe(J(()=>K),a_(t=>{let{desc:a}=t;return q(e.setDesc(a??""),e.setDescLoaded(!0))}),aV(e.setDescLoading(!0)),aG(e.setDescLoading(!1))))),updateDesc:t=>t.pipe(au(t=>{let n=ve(e.desc,t);return a.mutation.updateChannelDesc({channelId:e.channelJid,desc:t,action:n}).pipe(J(()=>K),H(),aV(e.setDescLoading(!0)),aG(e.setDescLoading(!1)))})),viewPinList:t=>t.pipe(a_(()=>q(e.setChannelActionsVisible(!0),e.setActiveAccordionKeysSet([...e.activeAccordionKeysSet,i2.PIN_HISTORY]))))}}),va=e=>vt.create({visible:!1,channelJid:e,desc:null,descLoading:!1,descLoaded:!1,activeAccordionKeysSet:new Set([i2.MEMBER_LIST])},{sdk:uW}),vn=window.React.createContext,vi=window.React.useContext,vs=vn(null),vr=vs.Provider;function vl(e){let{channelJid:t,children:a}=e,n=l3(()=>lN(va)(t),[t]);return g.jsx(vr,{value:n,children:a})}function vo(){return vi(vs)}var vd=(e=>(e.REPLACE="replace",e.UNPIN="unpin",e.REMOVE="remove",e.UNPIN_REMOVE="unpinAndRemove",e))(vd||{});function vc(e){return r(e.map(e=>e.replyId?yD(e):yO(e)))}let vu=e_().schema(()=>({channelJid:eb.string(),hiddenPin:eb.number().optional(),topPin:eb.object(gS).optional().nullable(),confirmModal:eb.object({type:eb.nativeEnum(vd),onConfirm:eb.any()}).optional(),pinMsgIdList:eb.array(eb.string()),isPinListFetched:eb.boolean()})).mutations((e,t)=>{let{messageStore:a,fileMapStore:n,profileStore:s}=t;return{setTopPin(t){j(e,{topPin:t})},setTopPinFromMessage(t){let r=function(e){let{jid:t,name:r}=s.currentUser,l=a.message(e);if(!l)return null;let o={channelJid:l.channelJid,msgId:l.id,msgTimestamp:l.time,mainMsgId:l.replyId||l.id,mainMsgTimestamp:l.replyThreadTime||l.time,type:aN.top,pinner:{jid:t,name:r},pinTimestamp:Date.now(),msg:l.message};switch(l.messageType){case i.mix:return{...o,msgType:l.messageType,failureBody:l.failureBody,allFiles:l.allFiles.map(e=>rp(e.fileType)?{...e,fileUrl:e.fileUrl||n.getImageState(e.fileId).message}:rf(e.fileType)?e:null).filter(e=>e)};case i.image:case i.screenshot:{let{file:e}=l;return{...o,msgType:l.messageType,file:{...l.file,fileUrl:e.fileUrl||n.getImageState(e.fileId).message}}}case i.file:if(l.thirdPartyType)return{...o,msgType:l.thirdPartyType,file:l.file,thirdStorageInfo:l.thirdStorageInfo};return{...o,msgType:l.messageType,file:l.file};case i.e2e:case i.unknown:case i.call:case i.text:return{...o,msgType:l.messageType};default:return null}}(t);r&&j(e,{topPin:r})},setHiddenPin(t){e.hiddenPin=t},removeHiddenPin(){e.hiddenPin=void 0},setPinMsgIdList(t){e.pinMsgIdList=t},openConfirm(t){let{confirmType:a,onConfirm:n}=t;e.confirmModal={type:a,onConfirm:n}},closeConfirm(){j(e,{confirmModal:void 0})},setIsPinListFetched(t){e.isPinListFetched=t},removeTopPin(){j(e,{topPin:void 0})},removePinFromList(t){e.isPinListFetched&&(e.pinMsgIdList=e.pinMsgIdList.filter(e=>!t.includes(e)))},addPinIdsToList(t){e.isPinListFetched&&(e.pinMsgIdList=aP([...e.pinMsgIdList,...t]),e.pinMsgIdList.sort((e,t)=>(a.message(t)?.time??0)-(a.message(e)?.time??0)))}}}).effects((e,t)=>{let{sdk:a,messageStore:n}=t;return{onConnected:()=>a.channelChange$.pipe(eg(t=>{let{jid:a}=t;return a===e.channelJid}),am(()=>a.query.fetchTopPin(e.channelJid).pipe(J(()=>K),ah(t=>e.setTopPin(t))))),onUpdateTopPin:()=>a.channelAction$.pipe(eg(t=>{let{type:a,room:n}=t;return n.jid===e.channelJid&&[aI.pin,aI.unpin,aI.remove_pin].includes(a)}),a_(t=>{let{type:a,pins:i}=t;if(!i?.pinList?.length)return K;switch(a){case aI.pin:{let t=i.pinList[0];if(!e.isPinListFetched)return q(e.setTopPin(t));if(!n.message(t.msgId)){let a=vc([function(e){return{id:e.msgId,channelJid:e.channelJid,time:e.msgTimestamp,replyId:e.mainMsgId,replyThreadTime:e.mainMsgTimestamp,messageType:e.msgType,senderJid:e.msgSenderJid,senderName:e.msgSenderName,message:e.msg||"",messageXmlStr:"",file:e.file,allFiles:e.allFiles,thirdStorageInfo:e.thirdStorageInfo,operType:em.new}}(t)]);return q(n.setPartialMessages(a),e.setTopPin(t),e.addPinIdsToList([t.msgId]))}return q(e.setTopPin(t),e.addPinIdsToList([t.msgId]))}case aI.unpin:return q(e.removeTopPin(),e.removeHiddenPin());case aI.remove_pin:{let t=r(i.pinList.map(e=>e.msgId));if(i.pinList[0].type===aN.top)return q(e.removePinFromList(t),e.removeTopPin(),e.removeHiddenPin());return q(e.removePinFromList(t))}default:return K}})),pinMessage:t=>t.pipe(au(t=>{let n=x(e.topPin);return a.mutation.pinMsg(t).pipe(J(()=>q(e.setTopPin(n))),H(),aV(e.closeConfirm(),e.removeHiddenPin(),e.setTopPinFromMessage(t.msgId)))})),unpinMessage:t=>t.pipe(au(t=>{let n=x(e.topPin);return a.mutation.unpinMsg(t).pipe(J(()=>q(e.setTopPin(n))),H(),aV(e.closeConfirm()))})),fetchPinList:t=>t.pipe(au(()=>a.query.fetchPinMsgList({id:e.channelJid}).pipe(J(()=>K),au(t=>{let a=vc(t);return q(n.setPartialMessages(a),e.setPinMsgIdList(t.map(e=>e.id)))}),aG(e.setIsPinListFetched(!0))))),removeFromPinList:t=>t.pipe(au(t=>a.mutation.removePinMsg(t).pipe(J(()=>K),H(),aV(e.closeConfirm()))))}}),vm=(e,t)=>vu.create({channelJid:e,topPin:void 0,hiddenPin:t,confirmModal:void 0,pinMsgIdList:[],isPinListFetched:!1},{sdk:uW,messageStore:yU,fileMapStore:yw,profileStore:g2}),vp=window.React.createContext,vh=window.React.useContext,vf=vp(null),vg=vf.Provider;function vy(e){let{channelJid:t,children:a}=e,{storageHiddenPin:n,setStorageHiddenPin:i,removeStorageHiddenPin:s}=function(){let{getStorageValue:e,setStorageValue:t}=l1(rQ.hiddenPinTimestampKey,{}),a=e(),n=uQ((e,n)=>{t({...a,[e]:n})},[t,a]),i=uQ(e=>{t(h(a,e))},[t,a]);return{storageHiddenPin:a,setStorageHiddenPin:n,removeStorageHiddenPin:i}}(),r=l3(()=>vm(t,n[t]),[t]);return os(r,"setHiddenPin",e=>{i(t,e)}),os(r,"removeHiddenPin",()=>{s(t)}),g.jsx(vg,{value:r,children:a})}function vv(){return vh(vf)}let v_={ibOptions:eb.any().optional(),sharedTime:eb.number().optional(),shareeJid:eb.string().optional()},vb={fileId:eb.string().optional(),ownerId:eb.string().optional(),ownerJid:eb.string().optional(),name:eb.string().optional(),extName:eb.string().optional(),length:eb.number().optional(),createdTime:eb.number().optional(),modifiedInfo:eb.any().optional(),shared:eb.array(eb.object(v_)).optional(),highlight:eb.any().optional(),keyword:eb.string().optional(),channelTypes:eb.any().optional(),ibOptions:eb.number().optional(),resourceType:eb.any().optional(),folderId:eb.string().optional(),parentId:eb.string().optional(),location:eb.string().optional(),externalFileType:eb.string().optional(),ownerType:eb.string().optional(),scope:eb.number().optional(),file:eb.object(fU).optional()},vM={sessionId:eb.string(),msgId:eb.string(),senderJid:eb.string(),senderName:eb.string(),sendTime:eb.number(),chatType:eb.object({chatType:eb.number().optional(),receiverJid:eb.string().optional()}),highlightPosition:eb.array(eb.object({startPosition:eb.number().optional(),endPosition:eb.number().optional()})),keyword:eb.string(),content:eb.string(),cutTag:eb.number(),comments:eb.array(eb.any()),parentId:eb.string().optional(),parentTime:eb.number().optional(),detail:eb.union([eb.object(gk),eb.object(gE)]).optional()},vx={firstName:eb.string(),lastName:eb.string(),displayName:eb.string(),picUrl:eb.string(),snsEmail:eb.string(),jid:eb.string(),type:eb.number(),isSameAccount:eb.number(),cellPhoneNumber:eb.number().nullable(),pbx:eb.string(),isMasterOrSub:eb.number(),bindWithMobile:eb.number(),sipPhone:eb.number().nullable(),countryCode:eb.number().nullable(),contactType:eb.number(),ibOptions:eb.number(),phoneNumbers:eb.array(eb.object({phoneNumber:eb.string(),countryCode:eb.string()}))},vC={isPublic:eb.boolean(),canExternalAdd:eb.boolean(),isYourOrg:eb.boolean(),adminOnly:eb.boolean().optional(),adminAndSpecial:eb.boolean().optional(),fromChannel:eb.boolean(),fromChat:eb.boolean(),historyMessagesVisible:eb.boolean(),channelId:eb.string(),name:eb.string(),memberCount:eb.number().nullable(),admin:eb.array(eb.object({jid:eb.string(),displayname:eb.string(),name:eb.string(),role:eb.number().optional(),joinTime:eb.number().nullable().optional()})),option:eb.number()},vj=eb.object(vx),vN=eb.object(vC),vw=eb.object(vM),vI=eb.object(vb);vI.deepPartial();var vT=(e=>(e.Type="sortType",e.SearchIn="searchIn",e.From="from",e.AtMe="atMe",e.FileType="fileType",e.FileTime="fileTime",e))(vT||{}),vE=(e=>(e.Any="any",e.Today="today",e.Yesterday="yesterday",e.Last7Days="last7days",e.Last30Days="last30days",e))(vE||{});let vS=[{label:"Most Relevant",value:iX.SORTTYPE_SCORE,alias:"Most Relevant"},{label:"Most Recent",value:iX.SORTTYPE_TIMESTAMP}],vk=[{label:"All Files",value:iQ.ALL,alias:"Type"},{label:"Images",value:iQ.IMAGES},{label:"Videos",value:iQ.VIDEOS},{label:"Documents",value:iQ.DOCUMENTS},{label:"Presentations",value:iQ.PRESENTATIONS},{label:"Spreadsheets",value:iQ.SPREADSHEETS},{label:"Other File Types",value:iQ.OTHER}],vA=[{label:"Any Time",value:vE.Any,alias:"Time"},{label:"Today",value:vE.Today},{label:"Yesterday",value:vE.Yesterday},{label:"Last 7 Days",value:vE.Last7Days},{label:"Last 30 Days",value:vE.Last30Days}],vR={[vE.Any]:[void 0,void 0],[vE.Today]:[es().startOf("day"),es().endOf("day")],[vE.Yesterday]:[es().subtract(1,"day").startOf("day"),es().subtract(1,"day").endOf("day")],[vE.Last7Days]:[es().subtract(7,"day").startOf("day"),es().subtract(1,"day").endOf("day")],[vE.Last30Days]:[es().subtract(30,"day").startOf("day"),es().subtract(1,"day").endOf("day")]},vL={[vT.Type]:vS[0].value,[vT.SearchIn]:"all",[vT.From]:"anyone",[vT.AtMe]:!1,[vT.FileType]:vk[0].value,[vT.FileTime]:vA[0].value},vO={Messages:[vT.Type,vT.SearchIn,vT.From,vT.AtMe],Files:[vT.Type,vT.SearchIn,vT.From,vT.FileType,vT.FileTime]},vD=(e,t)=>{if("Messages"===t||"Files"===t)return aY(x(e),vO[t])};function vP(e,t){let a=vD(t??vL,e);return function(e){return void 0===e&&(e={}),Object.keys(e).reduce((t,a)=>{switch(a){case vT.Type:case vT.FileType:return{...t,[a]:e[a]};case vT.AtMe:{let n={...t,atJid:[window.pwaChatConfig.jid]};return e[a]?n:h(n,"atJid")}case vT.FileTime:if(e[a]){let[n,i]=vR[e[a]]??[];if(n&&i)return{...t,startTime:n.valueOf(),endTime:i.valueOf()}}return t;case vT.From:case vT.SearchIn:default:return t}},{})}(a)}let vF=e_().schema(()=>({isMeeting:eb.boolean()})).views(()=>({get userJid(){return window.pwaChatConfig.jid},get accountId(){return window.pwaChatConfig.accountId}})).mutations(e=>({setMeeting(t){e.isMeeting=t}})),vB=vF.create({isMeeting:!1}),vU=vB.userJid,vH=eb.object({[sX.KeyWord]:eb.string(),[sX.Type]:eb.nativeEnum(iX).optional(),[sX.GroupJid]:eb.string().optional(),[sX.SendByJid]:eb.string().optional(),[sX.FileType]:eb.nativeEnum(iQ).optional(),[sX.FileTime]:eb.nativeEnum(vE).optional(),[sX.OnlyP2P]:eb.boolean().optional(),[sX.UserJid]:eb.string().optional(),[sX.ChannelType]:eb.array(eb.nativeEnum(iZ)).optional()}).optional(),vz=e_().schema(()=>({files:eb.array(vI),loading:eb.boolean(),fetched:eb.boolean(),filesSearchFilterValues:vH})).views(e=>({getNewSearchValue(t){let a,n;if(!e.filesSearchFilterValues)return;let i=e.filesSearchFilterValues;t?.searchKey&&(i={...e.filesSearchFilterValues,[t.searchKey]:t.optionValue});let{fileTime:s,...r}=i,[l,o]=vR[i[sX.FileTime]]??[];l&&o&&s&&(a={startTime:l.valueOf(),endTime:o.valueOf()}),"BookMarks"===i.groupJid&&(n={[sX.GroupJid]:"",starred:!0});let d={...r,...a,...n};return d},get filesFilterValues(){return vP("Files",e.filesSearchFilterValues)}})).mutations((e,t)=>{let{download:a}=t;return{setFiles(t){e.files=t.map(e=>({...e,file:{progress:0,status:i6.notDownload,fileId:e.fileId??"",fileName:e.name??"",size:e.length??0}}))},updateFile(t){let a=a3(e.files,e=>e.fileId===t.fileId);a?.file&&(a.file={...a.file,...t.file})},setLoading(t){e.loading=t},markFetched(){e.fetched=!0},downloadFile(e){let{fileUrl:t,fileName:n}=e;t&&a(t,n)},updateSearchFilter(t){if(e.filesSearchFilterValues&&t?.searchKey){let a={...e.filesSearchFilterValues,[t.searchKey]:t.optionValue};e.filesSearchFilterValues=a}}}}).effects((e,t)=>{let{sdk:a}=t;return{fetchFiles:t=>t.pipe(au(t=>a.query.fetchSearchFiles(t,{fetchPolicy:uJ.cacheAndNetwork,cachedBy:e=>JSON.stringify(e)}).pipe(a_(t=>ap(r([e.setLoading(!1),e.markFetched(),e.setFiles(t?.data?.fileResult??[])]))),J(()=>q(e.setLoading(!1))),aV(e.setLoading(!0)))))}}),vV=vz.create({files:[],loading:!1,fetched:!1,filesSearchFilterValues:{keyword:"",sortType:iX.SORTTYPE_SCORE,groupJid:"",sendByJid:vU,fileType:iQ.ALL,fileTime:vE.Any}},{sdk:uW,download:lR}),vG=(e,t)=>({keyword:"",sortType:iX.SORTTYPE_TIMESTAMP,groupJid:rT(e)?e:void 0,sendByJid:"",fileType:iQ.ALL,fileTime:vE.Any,userJid:rT(e)?void 0:e,onlyP2P:!rT(e),channelType:t}),vq=(e,t)=>({channelJid:e,files:[],loading:!1,fetched:!1,filesSearchFilterValues:vG(e,t),moreActionsFileList:[],isMoreActionFilesFetched:!1}),v$=vz.schema(()=>({channelJid:eb.string(),moreActionsFileList:eb.array(vI),isMoreActionFilesFetched:eb.boolean()})).mutations(e=>({setMoreActionsFiles(t){e.moreActionsFileList=l$(t.map(e=>({...e,file:{progress:0,status:i6.notDownload,fileId:e.fileId??"",fileName:e.name??"",size:e.length??0}})),e=>e.file.fileId,!1)},removeFiles(t){e.files=e.files.filter(e=>e?.fileId&&!t.includes(e.fileId)),e.moreActionsFileList=e.moreActionsFileList.filter(e=>e?.fileId&&!t.includes(e.fileId))},updateFile(t){let a=[...e.files,...e.moreActionsFileList].filter(e=>e.fileId===t.fileId);a.forEach(e=>{e?.file&&(e.file={...e.file,...t.file})})},setIsMoreActionFilesFetched(t){e.isMoreActionFilesFetched=t},resetFileSearchFilter(){e.filesSearchFilterValues=vG(e.channelJid,e.filesSearchFilterValues?.channelType||[])}})).effects((e,t)=>{let{sdk:a}=t;return{onMessage:()=>aB(a.message$,oz.updateLatestMessage$).pipe(a_(e=>ap(e)),eg(t=>t.channelJid===e.channelJid),a_(t=>{if(!t)return K;let a=r([t.file,...(t.allFiles||[]).filter(e=>!rh(e.fileType))]).map(a=>({...a,length:a.size,name:a.fileName,ownerJid:t.senderJid??void 0,createdTime:t.time,channelTypes:e.filesSearchFilterValues?.channelType}));return 0===a.length?K:q(e.setMoreActionsFiles([...a,...e.moreActionsFileList]))})),onFileRevoked:()=>oz.revokeFiles$.pipe(eg(t=>{let{channelJid:a}=t;return a===e.channelJid}),ah(t=>{let{fileIds:a}=t;return e.removeFiles(a)})),fetchMoreActionFiles:t=>t.pipe(au(()=>{let t=e.getNewSearchValue({searchKey:sX.Type,optionValue:iX.SORTTYPE_TIMESTAMP});return t?a.query.fetchSearchFiles(t).pipe(ah(t=>e.setMoreActionsFiles(t?.data?.fileResult??[])),aG(e.setIsMoreActionFilesFetched(!0))):K}))}}),vK=e=>v$.create(vq(e,[iZ.ZOOM_FILES]),{sdk:uW,download:lR}),vJ=window.React.createContext,vW=window.React.useContext,vY=vJ(null),vX=vY.Provider;function vQ(e){let{channelJid:t,children:a}=e,n=l3(()=>lN(vK)(t),[t]);return g.jsx(vX,{value:n,children:a})}function vZ(){return vW(vY)}let v1=window.React.createContext,v0=window.React.useContext,v2=v1(0),v5=v2.Provider;function v3(){return v0(v2)}function v6(e,t){return t?.jid&&e.some(e=>e.channelId===t.jid)?e.map(e=>e.channelId===t.jid?{...e,...h(t,"jid","option")}:e):e}function v4(e,t){return t&&e.some(e=>e.channelId===t)?e.filter(e=>e.channelId!==t):e}function v8(e,t){let{type:a,buddyList:n=[],room:i,data:s}=t;switch(a){case aI.edit:case aI.subject:return v6(e,s);case aI.delete:return v4(e,i.jid);case aI.kick:case aI.quit:{let t=n.some(e=>rS(e.jid));return t?v4(e,i.jid):e}default:return e}}let v7=e_().schema(()=>({channels:eb.array(vN),loading:eb.boolean(),publicChannels:eb.array(vN)})).mutations(e=>({setChannels(t){e.channels=t},setPublicChannels(t){e.publicChannels=t},setLoading(t){e.loading=t},update(t){e.channels=v6(e.channels,t)},remove(t){e.channels=v4(e.channels,t)},updateOnChannelAction(t){e.channels=v8(e.channels,t)}})).effects((e,t)=>{let{sdk:a}=t;return{onChannelAction:()=>a.channelAction$.pipe(ah(t=>e.updateOnChannelAction(t))),fetchChannels:t=>t.pipe(au(t=>a.query.fetchSearchChannels(t).pipe(a_(a=>q(e.setLoading(!1),e.setChannels(a?.data?.data??[]),e.fetchPublicChannels(t.keyword))),J(()=>q(e.setLoading(!1))),aV(e.setLoading(!0),e.setPublicChannels([]))))),fetchPublicChannels:t=>t.pipe(eg(e=>!!e),au(t=>a.query.fetchSearchChannels({...oT,accountId:window.pwaChatConfig?.accountId,keyword:t,matchRange:ea.ALL,channelType:en.PUBLIC_NORMAL}).pipe(J(()=>K),ah(t=>e.setPublicChannels(t?.data?.data??[])))))}}).create({channels:[],loading:!1,publicChannels:[]},{sdk:uW}),v9={sourceType:4},_e=e_().schema(()=>({contacts:eb.array(vj),mucs:eb.array(vN),loading:eb.boolean()})).mutations(e=>({setContacts(t){e.contacts=t},setMucs(t){e.mucs=t},setLoading(t){e.loading=t},update(t){e.mucs=v6(e.mucs,t)},remove(t){e.mucs=v4(e.mucs,t)},updateOnChannelAction(t){e.mucs=v8(e.mucs,t)}})).effects((e,t)=>{let{sdk:a}=t;return{onChannelAction:()=>a.channelAction$.pipe(ah(t=>e.updateOnChannelAction(t))),fetchContacts:t=>t.pipe(au(t=>{let{keyword:n}=t,i={keyword:n,...v9},s={keyword:n,...oE,accountId:window.pwaChatConfig.accountId};return a6({contacts:a.query.fetchSearchContacts(i),mucs:a.query.fetchSearchChannels(s)}).pipe(a_(t=>{let{contacts:a,mucs:n}=t;return q(e.setContacts(a?.data?.data??[]),e.setMucs(n.data?.data??[]),e.setLoading(!1))}),J(()=>q(e.setLoading(!1))),aV(e.setLoading(!0)))}))}}).create({contacts:[],mucs:[],loading:!1},{sdk:uW}),_t={channelType:[iZ.INTEGRATION,iZ.SHAREPOINT,iZ.ZOOM_FILES,iZ.BOX,iZ.NEW_WHITEBOARD],extName:[]},_a=e_().schema(()=>({files:eb.array(vI),loading:eb.boolean()})).mutations((e,t)=>{let{download:a}=t;return{setFiles(t){e.files=t.map(e=>({...e,file:{progress:0,status:i6.notDownload,fileId:e.fileId??"",fileName:e.name??"",size:e.length??0}}))},updateFile(t){let a=a3(e.files,e=>e.fileId===t.fileId);a?.file&&(a.file={...a.file,...t.file})},setLoading(t){e.loading=t},downloadFile(e){let{fileUrl:t,fileName:n}=e;t&&a(t,n)}}}).effects((e,t)=>{let{sdk:a}=t;return{fetchFiles:t=>t.pipe(au(t=>a.query.fetchSearchFiles(t).pipe(a_(t=>q(e.setLoading(!1),e.setFiles(t?.data?.fileResult??[]))),J(()=>q(e.setLoading(!1))),aV(e.setLoading(!0)))))}}).create({files:[],loading:!1},{sdk:uW,download:lR}),_n={pageNum:1,pageSize:50};var _i=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.GROUP_CHAT=1]="GROUP_CHAT",e[e.P2P_CHAT=2]="P2P_CHAT",e))(_i||{});let _s=e_().schema(()=>({messages:eb.array(vw),loading:eb.boolean(),pageNum:eb.number(),nextLoading:eb.boolean(),hasMore:eb.boolean()})).mutations(e=>({setMessages(t){e.messages=t},setLoading(t){e.loading=t},setPageNum(t){e.pageNum=t},setNextLoading(t){e.nextLoading=t},setHasMore(t){e.hasMore=t},appendMessages(t){e.messages=[...e.messages,...t]}})).effects((e,t)=>{let{sdk:a}=t;return{fetchMessages:t=>t.pipe(au(t=>a.query.fetchSearchMessages(t).pipe(a_(t=>q(e.setLoading(!1),e.setHasMore(t?.data?.hasMore??!1),e.setMessages(t?.data?.msgResult??[]))),J(()=>q(e.setLoading(!1))),aV(e.setLoading(!0),e.setPageNum(t.pageNum??1))))),fetchNextMessages:t=>t.pipe(au(t=>a.query.fetchSearchMessages(t).pipe(a_(t=>q(e.setNextLoading(!1),e.setHasMore(t?.data?.hasMore??!1),e.appendMessages(t?.data?.msgResult??[]))),J(()=>q(e.setNextLoading(!1))),aV(e.setNextLoading(!0),e.setPageNum(t.pageNum??1)))))}}).create({messages:[],loading:!1,pageNum:1,nextLoading:!1,hasMore:!1},{sdk:uW}),_r=e_().schema(()=>({contacts:eb.array(vj),mucs:eb.array(vN),channels:eb.array(vN),messages:eb.array(vw),files:eb.array(vI),loading:eb.boolean()})).mutations(e=>({setContacts(t){e.contacts=t},setMucs(t){e.mucs=t},setChannels(t){e.channels=t},setMessages(t){e.messages=t},setFiles(t){e.files=t},setLoading(t){e.loading=t},update(t){e.channels=v6(e.channels,t),e.mucs=v6(e.mucs,t)},remove(t){e.channels=v4(e.channels,t),e.mucs=v4(e.mucs,t)},updateOnChannelAction(t){e.channels=v8(e.channels,t),e.mucs=v8(e.mucs,t)}})).effects((e,t)=>{let{sdk:a}=t;return{onChannelAction:()=>a.channelAction$.pipe(ah(t=>e.updateOnChannelAction(t))),fetchAll:t=>t.pipe(au(t=>{let{keyword:n,...i}=t,s={keyword:n,...v9},r={keyword:n,...oE},l={keyword:n,...oT,accountId:window.pwaChatConfig?.accountId},o={keyword:n,..._n,...vP("Messages",i)},d={keyword:n,..._t,...vP("Files",i)};return a6({contacts:a.query.fetchSearchContacts(s),mucs:a.query.fetchSearchChannels(r),channels:a.query.fetchSearchChannels(l),messages:a.query.fetchSearchMessages(o),files:a.query.fetchSearchFiles(d)}).pipe(a_(t=>{let{contacts:a,mucs:n,channels:i,messages:s,files:r}=t;return q(e.setContacts(a.data?.data??[]),e.setMucs(n.data?.data??[]),e.setChannels(i.data?.data??[]),e.setMessages(s.data?.msgResult??[]),e.setFiles(r.data?.fileResult??[]),e.setLoading(!1))}),J(t=>(console.error(t),q(e.setLoading(!1)))),aV(e.setLoading(!0)))}))}}).create({contacts:[],mucs:[],channels:[],messages:[],files:[],loading:!1},{sdk:uW}),_l=e_().schema(()=>({recentSearches:eb.array(eb.string())})).views(e=>({get showRecentSearches(){return e.recentSearches.slice(0,10)}})).mutations(e=>({setRecentSearches(t){e.recentSearches=t}})).create({recentSearches:[]}),_o=eb.union([eb.literal("TopResults"),eb.literal("Contacts"),eb.literal("Channels"),eb.literal("Messages"),eb.literal("Files")]),_d=eb.object({[vT.Type]:eb.nativeEnum(iX).optional(),[vT.SearchIn]:eb.string().optional(),[vT.From]:eb.string().optional(),[vT.AtMe]:eb.boolean().optional(),[vT.FileType]:eb.nativeEnum(iQ).optional(),[vT.FileTime]:eb.nativeEnum(vE).optional()}).optional(),_c="TopResults",_u=e_().schema(()=>({visible:eb.boolean(),dropdownVisible:eb.boolean(),tag:_o,searchKey:eb.string(),searchFilterValues:_d})).views(e=>({get filterValues(){return vP(e.tag,e.searchFilterValues)}})).mutations(e=>{function t(t){e.visible=t}return{setVisible(e){t(e)},setDropdownVisible(t){e.dropdownVisible=t},closeModal(){t(!1)},setSearchKey(t){e.searchKey=t.searchKey},setSearchFilterValues(t){e.searchFilterValues=t},setTag(t){e.tag=t}}}).effects((e,t)=>{let{contactStore:a,channelStore:n,messageStore:i,fileStore:s}=t;return{switchTag:t=>t.pipe(ah(t=>{let a=vP(t.tag,e.searchFilterValues);switch(t.tag){case"Contacts":return{tag:t.tag,keyword:e.searchKey,...v9};case"Channels":return{tag:t.tag,keyword:e.searchKey,...oT,accountId:window.pwaChatConfig?.accountId};case"Messages":return{tag:t.tag,keyword:e.searchKey,..._n,...a};case"Files":return{tag:t.tag,keyword:e.searchKey,..._t,...a};default:return{tag:t.tag,keyword:e.searchKey}}}),a_(t=>{let{tag:l,...o}=t;return ap(r([e.setTag(l),"Contacts"===l?a.fetchContacts(o):null,"Channels"===l?n.fetchChannels(o):null,"Messages"===l?i.fetchMessages(o):null,"Files"===l?s.fetchFiles(o):null]))}))}}).create({tag:_c,visible:!1,dropdownVisible:!1,searchKey:"",searchFilterValues:void 0},{contactStore:_e,channelStore:v7,messageStore:_s,fileStore:_a}),_m={danger:"_danger_wti2f_1",disabled:"_disabled_wti2f_5",dropdownMenuContent:"_dropdownMenuContent_wti2f_13",rightArrow:"_rightArrow_wti2f_17",smartReply:"_smartReply_wti2f_22"},_p=window.React.createElement,_h="data-dropdown-menu",_f=null;function _g(e){let{children:t,items:a,disabled:n,open:i,onOpenChange:s}=e;return!a.length||n?null:g.jsxs(cg,{open:i,onOpenChange:e=>{s?.(e),e&&(_f=document.activeElement),e||sk||requestAnimationFrame(()=>{_f&&(_f?.focus(),_f=null)})},children:[g.jsx(cv,{children:t}),g.jsx(cy,{container:document.body,children:g.jsx(c_,{...oI.Dropdown.messageDropdown,className:_m.dropdownMenuContent,onClick:e=>e.stopPropagation(),[_h]:!0,side:"bottom",align:"start",children:a.map((e,t)=>e.divider?g.jsx(cM,{},e.key+t):e.children?.length?g.jsxs(cx,{children:[g.jsxs(cC,{...oI.Main.msgMoreMenuItem(e.key),children:[e.label,g.jsx(a4,{className:_m.rightArrow})]}),g.jsx(cj,{children:e.children.map((t,a)=>t.divider?g.jsx(cM,{},t.key+a):_p(cb,{...oI.Main.msgMoreMenuItem(t.key,t.disabled),key:t.key,className:f({[_m.danger]:t.danger,[_m.disabled]:t.disabled},e.className),onClick:t.operate},t.label))})]},e.key):_p(cb,{...oI.Main.msgMoreMenuItem(e.key,e.disabled),key:e.key,className:f({[_m.danger]:e.danger,[_m.disabled]:e.disabled},e.className),onClick:e.operate},e.label))})})]})}let _y=window.React.createElement;function _v(e){let{children:t,items:a,disabled:n,onOpenChange:i}=e;return!a.length||n?g.jsx(g.Fragment,{children:t}):g.jsxs(cS,{onOpenChange:i,children:[g.jsx(cA,{children:t}),g.jsx(ck,{container:document.body,children:g.jsx(cR,{className:_m.dropdownMenuContent,children:a.map((e,t)=>e.divider?g.jsx(cO,{},e.key+t):e.children?.length?g.jsxs(cD,{children:[g.jsxs(cP,{...oI.Main.msgContextMenuItem(e.key),children:[e.label,g.jsx(a4,{className:_m.rightArrow})]}),g.jsx(cF,{children:e.children.map((t,a)=>t.divider?g.jsx(cO,{},t.key+a):_y(cL,{...oI.Main.msgContextMenuItem(t.key,t.disabled),key:t.key,className:f({[_m.danger]:t.danger,[_m.disabled]:t.disabled},e.className),onClick:t.operate},t.label))})]},e.key):_y(cL,{...oI.Main.msgContextMenuItem(e.key,e.disabled),key:e.key,className:f({[_m.danger]:e.danger,[_m.disabled]:e.disabled},e.className),onClick:e.operate},e.label))})})]})}let __=eb.object({id:eb.string(),time:eb.number()});function _b(e){let{id:t,time:a}=e;return{id:t,time:a}}function _M(e){return r(e.map(e=>e.replyId?yD(e):yO(e)))}function _x(e,t){return void 0===t&&(t="desc"),ep(e,e=>{let{time:t}=e;return t},t)}function _C(e){return F(e.map(e=>e.messages))}let _j=e_().schema(()=>({loading:eb.boolean(),fetched:eb.boolean(),timestampsFetched:eb.boolean(),bookmarksMessages:eb.array(__),bookmarksMessagesTimestamps:eb.array(eb.record(eb.string(),eb.array(eb.object({t:eb.string()})))),bookmarksMessagesMap:eb.map(eb.string(),eb.array(__)),bookmarksMessagesLoadingMap:eb.map(eb.string(),eb.boolean())})).views(e=>({get sortedBookmarksMessages(){return _x(e.bookmarksMessages,"asc")}})).mutations((e,t)=>{let{messageStore:a,scroller:n}=t;return{setLoading(t){e.loading=t},markFetched(){e.fetched=!0},setBookmarksMessages(t){let n=_x(_M(t));a.setPartialMessages(n),e.bookmarksMessages=n.map(_b)},markTimestampsFetched(){e.timestampsFetched=!0},setBookmarksMessagesTimestamps(t){e.bookmarksMessagesTimestamps=function(e){return e.map(e=>aa(e,(e,t)=>!rO(t))).filter(e=>!l(e))}(t)},setBookmarksMessagesMap(t){let{id:n,bookmarksMessages:i}=t,s=_x(_M(i));a.setPartialMessages(s),e.bookmarksMessagesMap.set(n,s.map(_b))},setBookmarksMessagesLoadingMap(t){let{id:a,loading:n}=t;e.bookmarksMessagesLoadingMap.set(a,n)},updateBookmark(t){!function(t){let{action:a,id:n,timeframe:i}=t;if("mark"===a){let t=e.bookmarksMessagesTimestamps.some(e=>Object.prototype.hasOwnProperty.call(e,n));e.bookmarksMessagesTimestamps=t?e.bookmarksMessagesTimestamps.map(e=>Object.prototype.hasOwnProperty.call(e,n)?{...e,[n]:[...e[n],{t:String(i)}]}:e):[...e.bookmarksMessagesTimestamps,{[n]:[{t:String(i)}]}]}else e.bookmarksMessagesTimestamps=e.bookmarksMessagesTimestamps.map(e=>Object.prototype.hasOwnProperty.call(e,n)?{...e,[n]:e[n].filter(e=>e.t!==String(i))}:e)}(t),function(t){let{action:a,timeframe:n,messages:i=[]}=t;"mark"===a?e.bookmarksMessages=_x([...e.bookmarksMessages,...i]):e.bookmarksMessages=e.bookmarksMessages.filter(e=>e.time!==n)}(t),function(t){let{action:a,id:n,timeframe:i,messages:s=[]}=t;if("mark"===a)e.bookmarksMessagesMap.set(n,_x([...e.bookmarksMessagesMap.get(n)??[],...s]));else{if(!e.bookmarksMessagesMap.has(n))return;e.bookmarksMessagesMap.set(n,e.bookmarksMessagesMap.get(n)?.filter(e=>e.time!==i)??[])}}(t)},scrollEnd(){requestAnimationFrame(()=>n.scrollEnd())}}}).effects((e,t)=>{let{sdk:a,messageStore:n}=t;return{onConnected:()=>a.connected$.pipe(ah(()=>e.fetchBookmark())),onBookmark:()=>a.bookmark$.pipe(a_(t=>q("mark"===t.action?e.addBookmarkMessage(t):e.updateBookmark(t)))),fetchBookmark:t=>t.pipe(au(()=>a.query.fetchBookmark().pipe(J(()=>K),a_(t=>q(e.markTimestampsFetched(),e.setBookmarksMessagesTimestamps(t)))))),fetchMessageByBookmark:t=>t.pipe(aK(()=>lw(()=>e.timestampsFetched,!1).pipe(eg(Boolean))),au(()=>e.bookmarksMessagesTimestamps.length?a.query.fetchMessageByBookmark(e.bookmarksMessagesTimestamps).pipe(J(()=>K),ah(t=>e.setBookmarksMessages(_C(t?.data??[]))),aV(e.setLoading(!0)),aG(e.setLoading(!1),e.markFetched())):K)),fetchBookmarkMessageByChatId:t=>t.pipe(au(t=>{let n=function(e,t){let a=t.find(t=>Object.prototype.hasOwnProperty.call(t,e));if(a)return[{[e]:a[e]}]}(t,e.bookmarksMessagesTimestamps);return n?a.query.fetchMessageByBookmark(n).pipe(au(a=>q(e.setBookmarksMessagesMap({id:t,bookmarksMessages:_C(a?.data??[])}))),aV(e.setBookmarksMessagesLoadingMap({id:t,loading:!0})),aG(e.setBookmarksMessagesLoadingMap({id:t,loading:!1}))):K})),addBookmarkMessage:t=>t.pipe(a_(t=>{let i=[{[t.id]:[{t:String(t.timeframe)}]}];return a.query.fetchMessageByBookmark(i).pipe(a_(a=>{let i=_M(_C(a?.data??[]));return q(n.setPartialMessages(i),e.updateBookmark({...t,messages:i.map(_b)}))}))})),bookmark:e=>e.pipe(am(e=>a.mutation.bookmark(e).pipe(J(()=>K),H()))),removeBookmark:e=>e.pipe(am(e=>a.mutation.removeBookmark(e).pipe(J(()=>K),H())))}}).create({loading:!1,fetched:!1,timestampsFetched:!1,bookmarksMessages:[],bookmarksMessagesTimestamps:[],bookmarksMessagesMap:new Map,bookmarksMessagesLoadingMap:new Map},{sdk:uW,messageStore:yU,scroller:sM.create("bookmarks")}),_N=window.React.useCallback;function _w(e){let{bookmarksMessagesTimestamps:t,bookmark:a,removeBookmark:n}=_j,{time:i,channelJid:s,senderJid:r}=e,l=lU(s,r),o=_N(()=>{a({id:l,timeframe:i})},[a,l,i]),d=_N(()=>{n({id:l,timeframe:i})},[n,l,i]),c=oa(()=>!!t.find(e=>a8(e).includes(l))?.[l]?.some(e=>e.t===String(i)),[t,l,i]);return{isBookmarked:c,bookmark:o,removeBookmark:d}}let _I={portal:"_portal_12gpw_1",icon:"_icon_12gpw_10",rotateIcon:"_rotateIcon_12gpw_18",container:"_container_12gpw_30",headerContainer:"_headerContainer_12gpw_37",info:"_info_12gpw_46",avatar:"_avatar_12gpw_51",infoTitle:"_infoTitle_12gpw_54",infoLabel:"_infoLabel_12gpw_64",headerRight:"_headerRight_12gpw_70",actionList:"_actionList_12gpw_76",actionDivider:"_actionDivider_12gpw_80",contentContainer:"_contentContainer_12gpw_88",arrowLeftBtn:"_arrowLeftBtn_12gpw_94",arrowRightBtn:"_arrowRightBtn_12gpw_100",imgPreviewContainer:"_imgPreviewContainer_12gpw_106",imgContainer:"_imgContainer_12gpw_111",sliderContainer:"_sliderContainer_12gpw_122"},_T=ex(function(e){let{message:t,options:a,onDownload:n,onRotate:i,onMenuOpenChange:s}=e,{$t:r}=oA(),{isBookmarked:l,bookmark:o,removeBookmark:d}=_w(t);return g.jsxs("div",{className:_I.actionList,onKeyDown:lr(),children:[g.jsx(dj,{...oI.Main.imgRotateBtn,className:_I.icon,type:"text",size:"small","aria-label":r({id:"2MN1aB",defaultMessage:[{type:0,value:"Rotate"}]}),icon:g.jsx(sU,{className:_I.rotateIcon}),onClick:()=>i()}),g.jsx(dj,{...oI.Main.imgDownloadBtn,className:_I.icon,type:"text",size:"small","aria-label":r({id:"5q3qC0",defaultMessage:[{type:0,value:"Download"}]}),icon:g.jsx(a7,{}),onClick:n}),l?g.jsx(dj,{...oI.Main.imgRemoveBookmarkBtn,className:_I.icon,type:"text",size:"small","aria-label":r({id:"f7kP7R",defaultMessage:[{type:0,value:"Remove bookmark"}]}),icon:g.jsx(ne,{}),onClick:d}):g.jsx(dj,{...oI.Main.imgBookmarkBtn,className:_I.icon,type:"text",size:"small","aria-label":r({id:"Rs4kCE",defaultMessage:[{type:0,value:"Bookmark"}]}),icon:g.jsx(a9,{}),onClick:o}),g.jsx(_g,{items:a,onOpenChange:s,children:g.jsx(dj,{...oI.Main.imgMoreBtn,"aria-label":r({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]}),className:_I.icon,type:"text",size:"small",icon:g.jsx(nt,{})})})]})}),_E=window.React.useRef,_S=window.React.useState,_k=na([nn,ni]),_A=ex(function(e){let{msgId:t,fileId:a,rotate:n=0,onClose:i}=e,{getImageState:s,getIsImageLoaded:r}=yw,l=!r({fileId:a,isHQ:!0}),o=s(a).message,[d,c]=_S(100),[u,m]=_S(d),[p,h]=_S(!1),[f,y]=_S(!1),[v,_]=_S({x:0,y:0}),[b,M]=_S({top:0,left:0,right:0,bottom:0}),x=_E(null),C=_E(null),j=Mo({msgId:t,fileId:a,isHQ:!0});oe(()=>{j()},[j]),l2(()=>{let e=e=>e.preventDefault();return document.addEventListener("gesturestart",e),document.addEventListener("gesturechange",e),document.addEventListener("gestureend",e),()=>{document.removeEventListener("gesturestart",e),document.removeEventListener("gesturechange",e),document.removeEventListener("gestureend",e)}},[]),l2(()=>{h(!1)},[o]);let N=e=>{if(C.current){let{naturalWidth:t,naturalHeight:a}=C.current,n=t*e/100,i=a*e/100,s=t*d/100,r=a*d/100,l=Math.floor((n-s)/2),o=Math.floor((i-r)/2);_(e=>({x:Math.min(Math.max(e.x,-l),l),y:Math.min(Math.max(e.y,-o),o)})),M({top:-o,left:-l,right:l,bottom:o})}m(e)},w=()=>{if(!x.current||!C.current)return 100;let{clientWidth:e,clientHeight:t}=x.current,{naturalWidth:a,naturalHeight:n}=C.current,i=Math.floor(.8*e/a*100),s=Math.floor(.8*t/n*100);return Math.min(i,s,100)};_k({onPinch:e=>{let{origin:[t,a],first:n,movement:[i],offset:[s],memo:r}=e;if(n&&C.current){let{width:e,height:n,x:i,y:s}=C.current.getBoundingClientRect();r=[v.x,v.y,t-(i+e/2),a-(s+n/2)]}let l=r[0]-(i-1)*r[2],o=r[1]-(i-1)*r[3];return _({x:l,y:o}),N(Math.floor(100*s)),r},onMove:e=>{let{pinching:t,down:a,offset:[n,i]}=e;!t&&a&&(_({x:n,y:i}),y(!0))}},{target:C,pinch:{from:[u/100,0],scaleBounds:{min:d/100,max:2},modifierKey:null},move:{from:[v.x,v.y],bounds:b}});let I=()=>{let e=w();c(e),m(e),_({x:0,y:0}),h(!0)},T=()=>{requestAnimationFrame(()=>{y(!1)})},E=e=>{void 0===e&&(e=1);let t=`translate(${v.x}px, ${v.y}px)`,a=`scale(${u/100})`,i=`rotate(${n}deg)`;return{transform:`${t} ${a} ${i}`,opacity:p?e:0,cursor:f?"grab":u===d?"zoom-in":"zoom-out"}};return g.jsxs("div",{ref:x,className:_I.imgPreviewContainer,onClick:e=>{e.target===e.currentTarget&&i&&i()},children:[g.jsx("div",{...oI.Main.imgContainer,className:_I.imgContainer,children:l?g.jsx(e4,{loading:!0,children:o&&g.jsx("img",{ref:C,style:E(.5),src:o,alt:"",onLoad:I})}):g.jsx("img",{ref:C,style:E(),src:o,draggable:!1,alt:"",onLoad:I,onMouseUp:T,onMouseLeave:T,onClick:()=>{if(!f)N(u===d?d<100?100:200:d)}})}),g.jsx("div",{className:_I.sliderContainer,children:g.jsx(c1,{min:d,max:200,step:1,value:u,onChange:N,onStartClick:()=>{N(d)},onEndClick:()=>{u<100?N(100):N(200)}})})]})}),_R={avatar:"_avatar_mtmdf_1",extraLarge:"_extraLarge_mtmdf_5",initials:"_initials_mtmdf_10",large:"_large_mtmdf_13",medium:"_medium_mtmdf_21",small:"_small_mtmdf_29",mini:"_mini_mtmdf_37",deleted:"_deleted_mtmdf_45",image:"_image_mtmdf_58"},_L=ex(e=>{let{jid:t,name:a,image:n,deleted:i=!1,size:s="md",className:r,zoomRoom:l=!1,isAlwaysColorful:o=!1}=e,[d,c]=om(!1),u=function(e){return e||0===e?la(String(e))?String(e)[0].toUpperCase():function(e){let t=e.split(" "),a=[],n="";for(let e of t)""!==e&&a.push(e.slice(0,1).toUpperCase());if(a.length){if(1===a.length)n=a[0];else{let e=a[0].replace(/[^\x00-\xff]/g,"**").length;n=2===e?a[0]:a[0]+a[1]}}else n="\xa0";return n}(String(e)):""}(a||""),m=bL(t??void 0),p=l3(()=>(function(e,t){void 0===t&&(t=!1);let a=0;if(t||!e)return"#dfe3e8";for(let t=0;t<e.length;t++)a+=e.charCodeAt(t),a%=lO.length;return`#${lO[a]}`})(o?t||a||"":t||"",m),[t,m,o,a]);return g.jsx("div",{className:f(_R.avatar,{[_R.extraLarge]:"xl"===s,[_R.large]:"lg"===s,[_R.medium]:"md"===s,[_R.small]:"sm"===s,[_R.mini]:"min"===s}),children:(()=>i?g.jsx("div",{className:_R.deleted,children:g.jsx(ns,{})}):l?g.jsx("div",{className:_R.initials,style:{background:p},children:g.jsx(nr,{})}):n&&!d?g.jsx("img",{className:_R.image,src:n,alt:`${a}'s avatar`,onError:c,loading:"lazy"}):g.jsx("div",{...oI.Sidebar.sidebarAvatar(a),className:f(_R.initials,r),style:{background:p},"aria-label":`${a}'s avatar`,"aria-hidden":"true",children:u}))()})});_L.displayName="Avatar";let _O=e=>{let{activated:t,className:a}=e,{$t:n}=oA();return g.jsx("div",{className:f("_deactivatedBadge_1ol6a_1",a,{_activated_1ol6a_19:t}),children:n({id:"plMsEA",defaultMessage:[{type:0,value:"Deactivated"}]})})},_D=e=>{let{className:t,leftSpacing:a=!0,activated:n,isDark:i}=e,{$t:s}=oA();return g.jsx("div",{className:f("_externalBadge_1kiy2_1",t,{_leftSpacing_1kiy2_14:a,_activated_1kiy2_17:n,_externalBadgeDark_1kiy2_21:i}),children:s({id:"QG6+rR",defaultMessage:[{type:0,value:"External"}]})})},_P={badge:"_badge_13kgt_1",baseBadge:"_baseBadge_13kgt_6"},_F=e=>{let{className:t,children:a}=e;return g.jsx("div",{className:f(_P.baseBadge,t),children:a})},_B=ex(function(e){let{className:t,userJid:a,isGuest:n=!1}=e,i=bA(a),s=bL(a),r=bO(i),l=bc(a),{$t:o}=oA();return n?g.jsx(_F,{className:f(_P.badge,t),children:o({id:"gSHIRF",defaultMessage:[{type:0,value:"GUEST"}]})}):l?g.jsx(_F,{className:f(_P.badge,t),children:o({id:"pyCXE9",defaultMessage:[{type:0,value:"APP"}]})}):s?g.jsx(_O,{className:f(_P.badge,t)}):r?g.jsx(_D,{className:f(_P.badge,t)}):null}),_U=ex(function(e){let{message:t,fileName:a}=e,n=g2.userInfo(t.senderJid),{$t:i}=oA(),s=function(){let{senderName:e}=t;return n?lT(n)||e||"":e||""}(),r=rS(t.senderJid)?i({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):s;return g.jsxs("div",{className:_I.info,children:[g.jsx("div",{className:_I.avatar,children:g.jsx(_L,{jid:t.senderJid,image:n?.avatar||t.senderAvatar,name:s,size:"sm"})}),g.jsxs("div",{className:_I.infoContent,children:[g.jsxs("div",{className:_I.infoTitle,children:[g.jsx("div",{className:_I.imageName,tabIndex:0,children:a}),g.jsx(_B,{userJid:n?.jid})]}),g.jsxs("div",{className:_I.infoLabel,children:[r,", ",oK(t.time)]})]})]})}),_H=window.React.useState,_z=window.React.useCallback,_V=window.ReactDOM,_G="image-portal",_q=()=>{let[e,t]=_H(!1);l4(()=>{t(!0)},[]);let a=_z(e=>{t(!e)},[]),{visible:n}=_u;return oe(()=>{a(n)},[a,n]),{focusContain:e,setFocusContain:a}},_$=ex(function(e){let{messageId:t,messageIds:a,isMix:n,mixImgIndex:s,onClose:r}=e,[l,o]=_H([]),[d,c]=_H(0),[u,m]=_H(0),{$t:p}=oA(),{focusContain:h,setFocusContain:y}=_q(),v=yU.messages(a),_=l[d],b=oa(()=>v.find(e=>!!_&&e.id===_.messageId),[_,v]),M=oa(()=>{if(_&&b)switch(b.messageType){case i.image:case i.screenshot:return b.file.fileId;case i.giphy:return b.id;case i.mix:return b.allFiles[_.mixIndex].fileId}return""},[b,_]),{getImageState:x}=yw,C=x(M),j=e=>{let t=[];return e.forEach(e=>{switch(e.messageType){case i.image:case i.screenshot:case i.giphy:t.push({messageId:e.id,mixIndex:-1});break;case i.mix:e.allFiles.forEach((a,n)=>{rp(a.fileType)&&t.push({messageId:e.id,mixIndex:n})})}}),t};nl(()=>{let e=j(v);o(e);let a=e.findIndex(e=>e.messageId===t);-1!==a&&(n&&s?c(a+s):c(a))});let N=[{label:p({id:"4l6vz1",defaultMessage:[{type:0,value:"Copy"}]}),key:"copy",operate:()=>{_&&rX.copyImage(C.message)}}];return g.jsx(no,{contain:h,restoreFocus:!0,autoFocus:!0,children:g.jsx("div",{className:_I.portal,tabIndex:-1,onContextMenu:e=>{e.stopPropagation()},onKeyDown:ll([sN.esc],r),children:!!b&&g.jsxs("div",{className:_I.container,children:[g.jsxs("div",{className:_I.headerContainer,children:[g.jsx(_U,{message:b,fileName:C.fileName}),g.jsxs("div",{className:_I.headerRight,children:[g.jsx(_T,{message:b,options:N,onDownload:()=>{lR(C.message,C.fileName)},onRotate:()=>{m(e=>e+90)},onMenuOpenChange:y}),g.jsx("div",{className:_I.actionDivider}),g.jsx(dj,{...oI.Main.closeImageBtn,type:"text","aria-label":p({id:"rbrahO",defaultMessage:[{type:0,value:"Close"}]}),icon:g.jsx(e8,{}),onClick:r})]})]}),g.jsx(_v,{items:N,onOpenChange:y,children:g.jsxs("div",{className:_I.contentContainer,...oI.Main.imgPreviewContainer,"data-image-index":d,children:[g.jsx(_A,{msgId:b.id,fileId:M,rotate:u,onClose:r}),d>0&&g.jsx(dj,{...oI.Main.imgPreviousBtn,className:f(_I.icon,_I.arrowLeftBtn),type:"text","aria-label":p({id:"JJNc3c",defaultMessage:[{type:0,value:"Previous"}]}),icon:g.jsx(nd,{}),onClick:()=>{c(e=>e-1)}}),d<l.length-1&&g.jsx(dj,{...oI.Main.imgNextBtn,className:f(_I.icon,_I.arrowRightBtn),type:"text","aria-label":p({id:"9+Ddtu",defaultMessage:[{type:0,value:"Next"}]}),icon:g.jsx(nc,{}),onClick:()=>{c(e=>e+1)}})]})})]})})})});function _K(e){let{show:t,...a}=e,n=document.getElementById(_G);return t?_V.createPortal(g.jsx(_$,{...a}),n):null}let _J=window.React.createContext,_W=window.React.useCallback,_Y=window.React.useContext,_X=window.React.useState,_Q=_J(ec);function _Z(e){let{messageIds:t,children:a}=e,[n,i,s]=om(!1),[r,l]=_X(),o=Q(n),d=Q(t),c=_W(e=>{!o.current&&d.current.length&&(l(e),i())},[]);return g.jsxs(_Q.Provider,{value:c,children:[r&&g.jsx(_K,{show:n,messageIds:t,...r,onClose:s}),a]})}let _1=window.React.useState;function _0(e){let{channelJid:t}=y9(),a=oa(()=>M(e)?x(e):e,[e]),n=Q(a),[i,s]=_1(a),r=a!==i;return l2(()=>{if(!r)return;let e=uW.channelChange$.pipe(eg(e=>{let{jid:a}=e;return a===t})).subscribe(()=>s(n.current));return()=>e.unsubscribe()},[r,t,n]),[i,s]}let _2=window.React.useState;function _5(){let[e,t]=_2([]);return(a,n,i,s)=>{if(e.includes(n))return!1;yU.setEmojiVote({msgId:a.id,emoji:n,action:i,senderJid:s}),t([...e,n]);let r={msgId:a.id,msgTimestamp:a.time,emoji:n,action:"add"===i?nu.add:nu.remove,session:a.channelJid};return uv.mutation.setEmojiVote(r).then(()=>{t(e.filter(e=>e!==n))}).catch(()=>{t(e.filter(e=>e!==n));let r=i===nu.add?nu.remove:nu.add;yU.setEmojiVote({msgId:a.id,emoji:n,action:r,senderJid:s})}),!0}}let _3=window.React.useCallback,_6=window.React.useState;function _4(e){let[t,a]=_6(),[n,i]=_6(!1),s=_3(e=>{i(!0),uv.query.getChannel(e).then(e=>{a(e)}).catch(ec).finally(()=>i(!1))},[]);return l2(()=>{e&&s(e)},[e]),{data:t,loading:n}}let _8=window.React.useState,_7=window.React.useCallback,_9=window.React.useState;function be(e,t,a){let[n,i]=_9([]),[s,r]=_9(!1);return l2(()=>{e&&!a&&(r(!0),uv.query.fetchSpecialMembers({channelJid:e,role:t}).then(e=>{e?.length?i(e):i([])}).catch(()=>{i([])}).finally(()=>{r(!1)}))},[e,t,a]),{data:n,loading:s}}function bt(){let{$t:e}=oA(),{data:t}=g2;return a=>{let{jid:n,name:i}=a;if(!n)return i;let s=t.get(n),r=s?.nickname||i;return n&&window.pwaChatConfig.jid.indexOf(n)>-1?e({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):r}}let ba=e_().schema(()=>({users:eb.array(eb.object(fP)),modalVisible:eb.boolean(),loading:eb.boolean()})).views(e=>({isBlocked:t=>!!t&&e.users.some(e=>e.jid===t)})).mutations(e=>({setLoading(t){e.loading=t},openModal(){e.modalVisible=!0},closeModal(){e.modalVisible=!1},setUsers(t){e.users=t},blockUsers(t){e.users=l$([...e.users,...t],e=>e.jid)},unblockByIds(t){e.users=e.users.filter(e=>!t.includes(e.jid))}})).effects((e,t)=>{let{sdk:a}=t;return{onConnected:()=>a.connected$.pipe(ah(()=>e.fetchBlockList())),onContactBlocked:()=>a.contactBlocked$.pipe(ah(t=>{let{isBlock:a,userInfo:n}=t,i=n.map(e=>e.jid);return a?e.blockUsers(n):e.unblockByIds(i)})),fetchBlockList:t=>t.pipe(au(()=>a.query.fetchBlockList().pipe(J(()=>K),ah(t=>e.setUsers(t)),aV(e.setLoading(!0)),aG(e.setLoading(!1))))),block:e=>e.pipe(a_(e=>a.mutation.block(e).pipe(J(e=>(console.error(e),K)),H()))),unblock:e=>e.pipe(a_(e=>a.mutation.unblock(e).pipe(J(e=>(console.error(e),K)),H())))}}).create({users:[],modalVisible:!1,loading:!1},{sdk:uW}),bn=nm.offline,bi=e_().schema(()=>({presenceMap:eb.map(eb.string(),eb.object({presenceType:eb.nativeEnum(nm),count:eb.number()}))})).views(e=>({presence:t=>e.presenceMap.get(t)})).mutations(e=>({setPresences(t){t?.forEach(t=>(function(t){let{jid:a,presenceType:n}=t;if(!a)return;let i=e.presenceMap.get(a);i?i.presenceType=n:e.presenceMap.set(a,{presenceType:n,count:0})})(t))},setPresenceCount(t){let{jid:a,count:n}=t,i=e.presenceMap.get(a);i?i.count=Math.max(i.count+n,0):e.presenceMap.set(a,{presenceType:bn,count:Math.max(n,0)})}})).effects((e,t)=>{let{sdk:a}=t;return{onUserStatusNotify:()=>a.userStatusNotify$.pipe(ah(t=>e.setPresences(t))),onCheckRepeatSubPresence:()=>a.checkRepeatSubPresence$.pipe(ah(t=>{let a=t.filter(t=>{let a=e.presence(t)?.count||0;return a>0});return e.queryPresences(a)})),queryPresences:t=>t.pipe(aD(t.pipe(aA(60,void 0,{leading:!1,trailing:!0}))),au(t=>t.length?a.query.queryPresences(t.flat()).pipe(J(()=>K),ah(t=>e.setPresences(t))):K)),subscribePresence:t=>t.pipe(aD(t.pipe(aA(60,void 0,{leading:!1,trailing:!0}))),au(t=>t.length?a.query.subscribePresences(t.flat().map(e=>({jid:e,expireTime:108e5}))).pipe(J(()=>K),ah(()=>e.setPresences([]))):K)),changePresence:e=>e.pipe(au(e=>a.mutation.changeSelfPresenceType(e).pipe(J(e=>(console.error(e),K)),H())))}}),bs=bi.create({presenceMap:new Map},{sdk:uW}),br={externalContact:eb.array(eb.string()),chatAppMap:eb.map(eb.string(),gU)},bl=e_().schema(()=>br).views((e,t)=>{let{profileStore:a}=t;return{get chatAppIds(){let t=Array.from(e.chatAppMap.keys());return function(e,t){return ep(e,e=>(t.get(e)?.name||"").toLowerCase())}(t,a.data)},getIsExternalContact:t=>e.externalContact.includes(t),getChatApp:t=>e.chatAppMap.get(t),isChatApp:t=>!!t&&e.chatAppMap.has(t)}}).mutations((e,t)=>{let{eventEmitter:a}=t;return{setExternalContact(t){e.externalContact=t.items.map(e=>{let{jid:t}=e;return t})},addContact(t){e.externalContact.push(t)},deleteContact(t){let a=e.externalContact.findIndex(e=>e===t);-1!==a&&e.externalContact.splice(a,1)},setChatAppMap(t){let n=t.reduce((e,t)=>{let a=t.apps.filter(e=>e.extension?.notShow!==1);return[...e,...a]},[]),i=n.reduce((e,t)=>({...e,[t.jid]:t}),{}),s=n.map(e=>e.jid);Array.from(e.chatAppMap.keys()).filter(t=>{s.includes(t)||N(e.chatAppMap,t)}),j(e.chatAppMap,i),a.dispatch(oH.appChats,s)},addChatApp(t){j(e.chatAppMap,t.jid,t)},deleteChatApp(t){N(e.chatAppMap,t.jid)}}}).effects((e,t)=>{let{sdk:a}=t;return{onExternalSubsync:()=>a.onExternalSubsync$.pipe(a_(t=>{let{type:a,jid:n}=t;switch(a){case"add":return q(e.addContact(n));case"remove":return q(e.deleteContact(n));default:return K}})),onAppActions:()=>a.appAction$.pipe(a_(t=>{let{action:a,appInfo:n}=t;switch(a){case"add_member":return q(e.addChatApp(n));case"del_member":return q(e.deleteChatApp(n));default:return K}})),fetchExternalResource:t=>t.pipe(aA(6e4,void 0,{leading:!0,trailing:!1}),am(()=>a.query.fetchExternalResource().pipe(J(()=>K),a_(t=>q(e.setExternalContact(t.externalContacts),e.setChatAppMap(t.appList)))))),onConnected:()=>a.connected$.pipe(ah(()=>e.fetchExternalResource()))}}),bo=uq(bl,{storageKey:rQ.appsInfo,persist(e){let{chatAppMap:t,externalContact:a}=e;return{externalContact:x(a),appsInfo:Array.from(x(t).entries())}},recover(e){let t=eb.object({appsInfo:eb.array(eb.tuple([eb.string(),gU])),externalContact:br.externalContact});t.parse(e);let{appsInfo:a,externalContact:n}=e;return{chatAppMap:new Map(a),externalContact:n}}}),bd=bo.create({externalContact:[],chatAppMap:new Map},{sdk:uW,eventEmitter:oz,profileStore:g2,encryptedStorage:uV});function bc(e){return bd.isChatApp(e)}function bu(e,t){let a;let{$t:n}=oA(),{presence:i,setPresenceCount:s,queryPresences:r,subscribePresence:l}=bs,o=e?i(e):void 0,d=bc(e);l2(()=>(e&&(t?l(e):r(e),s({jid:e,count:1})),()=>{e&&s({jid:e,count:-1})}),[]),a=d?nm.available:ba.isBlocked(e)?"blocked":o?.presenceType??void 0;let c={dnd:n({id:"7lQCA8",defaultMessage:[{type:0,value:"Do not disturb"}]}),presenting:n({id:"BlxYo7",defaultMessage:[{type:0,value:"Presenting"}]}),zoommeeting:n({id:"xMw8VF",defaultMessage:[{type:0,value:"In a Zoom meeting"}]}),pbx:n({id:"bX5EMt",defaultMessage:[{type:0,value:"On a call"}]}),calendar:n({id:"+2nbLm",defaultMessage:[{type:0,value:"In a calendar event"}]}),available:n({id:"PgJGHT",defaultMessage:[{type:0,value:"Available"}]}),away:n({id:"0JXAsk",defaultMessage:[{type:0,value:"Away"}]}),offline:n({id:"7UOvbT",defaultMessage:[{type:0,value:"Offline"}]}),mobile:n({id:"PgJGHT",defaultMessage:[{type:0,value:"Available"}]}),busy:n({id:"cEiQad",defaultMessage:[{type:0,value:"Busy"}]}),blocked:n({id:"qUJTsT",defaultMessage:[{type:0,value:"Blocked"}]})};return{presenceType:a,presenceText:a?c[a]:void 0}}let bm={channelId:eb.string().optional(),channelName:eb.string().optional(),chatType:eb.nativeEnum(i1).optional(),memberCount:eb.number().optional(),isLeave:eb.boolean().optional(),jid:eb.string().optional(),email:eb.string().optional(),name:eb.string().optional(),fileId:eb.string().optional(),meetingType:eb.union([eb.literal(i3.CHAT),eb.literal(i3.GROUP_CHAT)]).optional(),meetingWithVideo:eb.boolean().optional(),onAction:eb.function().args(eb.object({jid:eb.string()})).returns(eb.void()).optional(),revoke:eb.boolean().optional(),titleText:eb.string().optional(),messageText:eb.string().optional(),confirmButtonText:eb.string().optional(),isConfirmButtonDanger:eb.boolean().optional(),confirmCallback:eb.function().args(eb.function().args().returns(eb.void())).returns(eb.void()).optional(),notifyType:eb.nativeEnum(np).optional(),mentionJid:eb.string().optional(),isApp:eb.boolean().optional()},bp=eb.object(bm),bh=e_().schema(()=>({visible:eb.boolean(),type:eb.nativeEnum(st).nullable(),options:bp.nullable().optional()})).mutations(e=>({open(t){let{type:a,options:n}=t;e.visible=!0,e.type=a,e.options=n},close(){e.visible=!1,e.type=null,e.options=null}})),bf=bh.create({visible:!1,type:null,options:null});var bg=(e=>(e[e.SUBSCRIBE_REQ_PENDING=0]="SUBSCRIBE_REQ_PENDING",e[e.SUBSCRIBE_REQ_ACCEPTED=1]="SUBSCRIBE_REQ_ACCEPTED",e[e.SUBSCRIBE_REQ_DECLINED=2]="SUBSCRIBE_REQ_DECLINED",e[e.SUBSCRIBE_REQ_STATUS_UNKNOWN=3]="SUBSCRIBE_REQ_STATUS_UNKNOWN",e))(bg||{}),by=(e=>(e[e.SUBSCRIBE_REQ_TYPE_RECEIVED=0]="SUBSCRIBE_REQ_TYPE_RECEIVED",e[e.SUBSCRIBE_REQ_TYPE_SENT=1]="SUBSCRIBE_REQ_TYPE_SENT",e))(by||{}),bv=(e=>(e[e.Subscribe_Req_UnReaded=0]="Subscribe_Req_UnReaded",e[e.Subscribe_Req_Readed=1]="Subscribe_Req_Readed",e))(bv||{});function b_(e){let{name:t,jid:a,email:n,isFromChat:i,isSent:s,requestStatus:r,time:l,readStatus:o}=e;return{requestId:sW(),requestTimstamp:l??Date.now(),requestStatus:r??0,requestMsg:{be:!!n,e:n||"",ext:i?1:0,pj:a||"",rm:!1,screenname:t||"",t:l??Date.now()},requestType:s?1:0,readedStatus:o??1,securityOption:0}}function bb(e){let{originalData:t,changeData:a={}}=e,{requestMsg:n}=t;return{requestId:t.requestId,requestTimstamp:a.time??t.requestTimstamp,requestStatus:a.requestStatus??t.requestStatus,requestMsg:{be:!!(a.email??n.e),e:a.email??n.e,ext:n.ext,pj:a.jid??n.pj,rm:!!a.isDelete,screenname:a.name??n.screenname,t:a.time??n.t},requestType:a.requestType??t.requestType,readedStatus:a.readStatus??t.readedStatus,securityOption:t.securityOption}}let bM=e_().schema(()=>({subscribeDataList:eb.array(eb.object({requestId:eb.string(),requestTimstamp:eb.number(),requestStatus:eb.nativeEnum(bg),requestMsg:eb.object({be:eb.boolean(),e:eb.string(),ext:eb.number(),pj:eb.string(),rm:eb.boolean(),screenname:eb.string(),t:eb.number()}),requestType:eb.nativeEnum(by),readedStatus:eb.nativeEnum(bv),securityOption:eb.number()})),isLoading:eb.boolean(),fetched:eb.boolean()})).views(e=>({get sortedSubscribeDataList(){return e.subscribeDataList.slice().sort((e,t)=>e.requestTimstamp-t.requestTimstamp)},get unreadNum(){return e.subscribeDataList.filter(e=>e.readedStatus===bv.Subscribe_Req_UnReaded).length},getDataByRequestId:t=>e.subscribeDataList.find(e=>e.requestId===t),getPendingRequestListByEmailOrJid(t){let{jid:a,email:n}=t;return e.subscribeDataList.filter(e=>{let t=void 0!==n&&e.requestMsg.e===n,i=void 0!==a&&e.requestMsg.pj===a;return e.requestStatus===bg.SUBSCRIBE_REQ_PENDING&&(t||i)})},getRequestListByUnread:()=>e.subscribeDataList.filter(e=>e.readedStatus===bv.Subscribe_Req_UnReaded)})).mutations(e=>{function t(t){let a=e.subscribeDataList.findIndex(e=>e.requestId===t);-1!==a&&e.subscribeDataList.splice(a,1)}return{setLoading(t){e.isLoading=t},removeByRequestId:t,setContactRequestList(t){e.subscribeDataList=t},addContactRequestList(a){t(a.requestId),e.subscribeDataList.push(a)},updateContactRequestList(t){!function(t){let a=e.subscribeDataList.findIndex(e=>e.requestId===t.requestId);-1!==a&&e.subscribeDataList.splice(a,1,t)}(t)},markFetched(){e.fetched=!0}}}).effects((e,t)=>{let{sdk:a,recentChatStore:n}=t;return{onConnected:()=>a.connected$.pipe(ah(()=>e.fetchContactRequestList())),clearUnreadNum:t=>t.pipe(au(()=>{let t=e.getRequestListByUnread().map(e=>bb({originalData:e,changeData:{readStatus:bv.Subscribe_Req_Readed}}));return q(...t.map(t=>e.updateContactRequestList(t)),e.addDataToStorage(t))})),onSubScribeSync:()=>a.onSubScribeSync$.pipe(aK(()=>lw(()=>e.fetched).pipe(eg(Boolean))),a_(t=>{let{action:a,peeremail:n="",peername:i,peerjid:s="",extension:r}=t;switch(a){case nh.subsent:{let t=b_({email:n,jid:s,name:i,isSent:!0,isFromChat:!!r});return q(e.addContactRequestList(t),e.addDataToStorage([t]))}case nh.subreject:{let t=e.getPendingRequestListByEmailOrJid({jid:s,email:n}).map(e=>bb({originalData:e,changeData:{requestStatus:bg.SUBSCRIBE_REQ_DECLINED,requestType:by.SUBSCRIBE_REQ_TYPE_RECEIVED,readStatus:bv.Subscribe_Req_Readed,time:Date.now()}}));return q(...t.map(t=>e.updateContactRequestList(t)),e.addDataToStorage(t))}case nh.doaccept:{let t=e.getPendingRequestListByEmailOrJid({jid:s,email:n}).map(e=>bb({originalData:e,changeData:{requestStatus:bg.SUBSCRIBE_REQ_ACCEPTED,requestType:by.SUBSCRIBE_REQ_TYPE_RECEIVED,readStatus:bv.Subscribe_Req_Readed,time:Date.now()}}));return q(...t.map(t=>e.updateContactRequestList(t)),e.addDataToStorage(t))}case nh.subreaded:return q(e.clearUnreadNum());default:return K}})),onSubscription:()=>a.onSubscription$.pipe(aK(()=>lw(()=>e.fetched).pipe(eg(Boolean))),a_(t=>{let{type:a,from:i,status:s,a_email:r,extension:l}=t,{t:o,screenname:d,e:c}=s,u=n.chatId===sn.CONTACT,m=u?bv.Subscribe_Req_Readed:bv.Subscribe_Req_UnReaded;switch(a){case nf.subscribe:{if(e.subscribeDataList.find(e=>e.requestTimstamp===o))return K;let t=b_({email:c,jid:i,name:d,time:o,requestStatus:bg.SUBSCRIBE_REQ_PENDING,isSent:!1,readStatus:m,isFromChat:!!l});return q(e.addContactRequestList(t),e.addDataToStorage([t]))}case nf.unsubscribed:{let t=e.getPendingRequestListByEmailOrJid({jid:i,email:r}).map(e=>bb({originalData:e,changeData:{requestStatus:bg.SUBSCRIBE_REQ_DECLINED,requestType:by.SUBSCRIBE_REQ_TYPE_SENT,time:o,readStatus:m}}));return q(...t.map(t=>e.updateContactRequestList(t)),e.addDataToStorage(t))}case nf.subscribed:{let t=e.getPendingRequestListByEmailOrJid({jid:i,email:r}).map(e=>bb({originalData:e,changeData:{jid:i,email:r,name:d,requestStatus:bg.SUBSCRIBE_REQ_ACCEPTED,requestType:by.SUBSCRIBE_REQ_TYPE_SENT,time:o,readStatus:m}}));return q(...t.map(t=>e.updateContactRequestList(t)),e.addDataToStorage(t))}case nf.unsubscribe:default:return K}})),fetchContactRequestList:t=>t.pipe(au(()=>a.query.fetchContactRequestList().pipe(J(()=>K),am(t=>q(e.setContactRequestList(t),e.markFetched())),aV(e.setLoading(!0)),aG(e.setLoading(!1))))),syncAllSubScribeReqAsReaded:t=>t.pipe(aK(()=>lw(()=>e.fetched).pipe(eg(Boolean))),am(()=>a.mutation.syncAllSubScribeReqAsReaded().pipe(J(()=>K),ah(()=>e.clearUnreadNum())))),addContact:t=>t.pipe(am(t=>{let n,{email:i,jid:s,name:r,onAction:l}=t,o=e.getPendingRequestListByEmailOrJid({jid:s,email:i});if(o.length){let t=o.map(e=>bb({originalData:e,changeData:{time:Date.now()}}));return l(!0),q(...t.map(t=>e.updateContactRequestList(t)),e.addDataToStorage(t))}let d=b_({email:i,jid:s,name:r,isSent:!0});if(s)n=a.mutation.addBuddyByJID({jid:s,screenname:r});else{if(!i)return K;n=a.mutation.addBuddyByEmail(i)}return n.pipe(J(()=>(l(),K)),U(()=>l(!0)),a_(()=>q(e.addContactRequestList(d),e.addDataToStorage([d]))))})),onInvitation:()=>a.onInvitation$.pipe(aK(()=>lw(()=>e.fetched).pipe(eg(Boolean))),a_(t=>{let{action:a,emailList:n}=t;if("add"===a){let t=n.filter(t=>!e.getPendingRequestListByEmailOrJid({email:t}).length),a=t.map(e=>b_({email:e,isSent:!0,isFromChat:!0}));return q(...a.map(t=>e.addContactRequestList(t)),e.addDataToStorage(a))}return K})),deleteContact:e=>e.pipe(am(e=>{let{jid:t,name:n,email:i,onAction:s}=e;return a.mutation.removeBuddy({jid:t,screenname:n,email:i}).pipe(J(()=>(s(),K)),U(()=>s()),H())})),rejectContact:t=>t.pipe(am(t=>{let{jid:n,name:i,requestId:s}=t,r=e.getDataByRequestId(s);if(!r)return K;let l=bb({originalData:r,changeData:{requestStatus:bg.SUBSCRIBE_REQ_DECLINED,requestType:by.SUBSCRIBE_REQ_TYPE_RECEIVED,time:Date.now()}});return a.mutation.unSubscribedByJid({jid:n,name:i}).pipe(J(()=>K),a_(()=>q(e.updateContactRequestList(l),e.addDataToStorage([l]))))})),acceptContact:t=>t.pipe(am(t=>{let{jid:n,requestId:i,onAction:s}=t,r=e.getDataByRequestId(i);if(!r)return s(),K;let l=bb({originalData:r,changeData:{requestStatus:bg.SUBSCRIBE_REQ_ACCEPTED,requestType:by.SUBSCRIBE_REQ_TYPE_RECEIVED,time:Date.now()}});return a.mutation.subscribeByJid({jid:n,screenname:"",email:""}).pipe(J(()=>(s(),K)),U(()=>s()),a_(()=>q(e.updateContactRequestList(l),e.addDataToStorage([l]))))})),addDataToStorage:e=>e.pipe(am(e=>e.length?a.mutation.addDataToStorage(e).pipe(J(()=>K),H()):K)),deleteContactReq:t=>t.pipe(am(t=>{let{requestId:n}=t;return a.mutation.deleteContactReq(n).pipe(J(()=>K),ah(()=>e.removeByRequestId(n)))}))}}).create({subscribeDataList:[],isLoading:!1,fetched:!1},{sdk:uW,recentChatStore:yh}),bx=eb.object(gD),bC=e_().schema(()=>({folderList:eb.array(bx),fetched:eb.boolean(),channelId:eb.string(),folderID:eb.string(),currentFolder:eb.object({...gD,toDelete:eb.set(eb.string()).optional()}).optional(),modalVisible:eb.boolean(),deleteChannelVisible:eb.boolean(),isEdit:eb.boolean(),isSubmitting:eb.boolean()})).views(e=>{function t(t){return e.folderList.find(e=>e.folderID===t)}return{get folders(){return oV(e.folderList)},get lastFolder(){return oG(e.folderList)},get membersInFolder(){let t=new Set;return e.folderList.forEach(e=>{e.members.forEach(e=>{t.add(e.objid)})}),t},getFolder:e=>t(e),getLastMember(e){let a=t(e);return a?oG(a.members):null},getFolderByMember:t=>e.folderList.find(e=>{let{members:a}=e;return a.find(e=>e.objid===t)})}}).mutations((e,t)=>{let{recentChatStore:a}=t;function n(t){e.folderList.forEach(e=>{let a=e.members,n=a.findIndex(e=>e.objid===t);-1!==n&&a.splice(n,1)})}return{setChannelId(t){e.channelId=t},markedFetched(){e.fetched=!0},setFolderList(t){t.length||a.markFolderChatsFetched(),e.folderList=t},setSubmitting(t){e.isSubmitting=t},folderCreate(t){e.modalVisible=!0,e.channelId=t??""},folderEdit(t){e.isEdit=!0,e.modalVisible=!0,e.currentFolder={...t,toDelete:new Set}},removeFolderEditMember(t){e.currentFolder&&e.currentFolder?.toDelete?.add(t)},folderDelete(t){e.currentFolder=t,e.deleteChannelVisible=!0},closeModal(){e.modalVisible=!1,e.deleteChannelVisible=!1,e.isEdit=!1,e.channelId="",e.folderID="",e.currentFolder=void 0},updateFolderName(t){t.forEach(t=>(function(t,a){let n=e.folderList.findIndex(e=>e.folderID===t);-1!==n&&(e.folderList[n].name=a)})(t.folderID,t.name))},removeFolder(t){let a=e.folderList.findIndex(e=>e.folderID===t);-1!==a&&e.folderList.splice(a,1)},removeLocalMember(e){n(e)},updateOnChannelAction(e){let{type:t,buddyList:a=[],room:i}=e;switch(t){case aI.delete:n(i.jid);break;case aI.kick:case aI.quit:{let e=a.some(e=>rS(e.jid));e&&n(i.jid)}}}}}).effects((e,t)=>{let{sdk:a,recentChatStore:n}=t;return{onConnected:()=>a.connected$.pipe(ah(()=>e.fetchFolderList())),fetchFolderList:t=>t.pipe(au(()=>a.query.getFolderList().pipe(J(()=>K),a_(t=>(t=t.map(e=>({...e,members:e.members||[]})),q(e.setFolderList(t),e.markedFetched())))))),createFolder:t=>t.pipe(au(t=>{if(!e.fetched)return K;let i=new Map;t.membersAdded.forEach(t=>{let a=e.getFolderByMember(t.sessionId);if(a){let e=i.get(a.folderID)||[];i.set(a.folderID,[...e,t.sessionId])}});let s=[...i].map(e=>({folderId:e[0],sessionIds:e[1]}));return a.mutation.createFolder(t).pipe(J(()=>K),a_(()=>q(e.closeModal(),e.deleteMemberWithoutEffect(s),e.fetchFolderList(),n.unStarChats(t.membersAdded.map(e=>e.sessionId)),e.removeFromRecent(t.membersAdded.map(e=>e.sessionId)))),aV(e.setSubmitting(!0)),aG(e.setSubmitting(!1)))})),deleteMemberWithoutEffect:t=>t.pipe(au(t=>e.fetched?a.mutation.deleteMemberFromFolder(t).pipe(J(()=>K),H()):K)),updateFolder:t=>t.pipe(au(t=>e.fetched?a.mutation.updateFolder(t).pipe(J(()=>K),a_(()=>q(e.closeModal(),e.updateFolderName(t))),aV(e.setSubmitting(!0)),aG(e.setSubmitting(!1))):K)),moveFolder:t=>t.pipe(au(t=>{let{folderID:n,index:i}=t;if(!e.fetched)return K;let s=e.getFolder(n);if(!s)return K;let r=e.folders.filter(e=>e.folderID!==n&&Number(e.index)>=Number(i)).reduce((e,t)=>[...e,{version:t.version,index:String(Number(t.index)+1),folderID:t.folderID,name:t.name}],[{version:s.version,index:String(i),folderID:s.folderID,name:s.name}]);return a.mutation.updateFolder(r).pipe(J(()=>K),ah(()=>e.fetchFolderList()))})),deleteFolder:t=>t.pipe(au(t=>{if(!e.fetched)return K;let n=e.getFolder(t)?.members.map(e=>e.objid);return a.mutation.deleteFolder(t).pipe(J(()=>K),a_(()=>q(e.closeModal(),e.removeFolder(t),e.addToRecent(n||[]))),aV(e.setSubmitting(!0)),aG(e.setSubmitting(!1)))})),moveToFolder:t=>t.pipe(au(t=>{if(!e.fetched)return K;let i=function(t){let{folderID:a,index:n,sessionId:i}=t,s=e.getFolder(a),r=e.getLastMember(a)?.index||-1;if(!s)return null;let l=[],o=[],d=new Map,c=e.getFolderByMember(i),u=!1;c&&(c.folderID!==a?d.set(c.folderID,[i]):u=!0);let m=h(n)?Number(r)+1:n,p={sessionId:i,index:String(m)};if(u?o.push(p):l.push(p),!h(n)){let e=s.members.filter(e=>e.objid!==i&&Number(e.index)>=Number(n));o=[...o,...e.map(e=>({sessionId:e.objid,index:String(Number(e.index)+1)}))]}function h(e){return void 0===e}return{membersAdded:l,membersUpdated:o,membersRemoved:d}}(t);return i?a.mutation.addMemberToFolder({folderId:t?.folderID,...i}).pipe(J(()=>K),a_(()=>q(n.unStarChats([t.sessionId]),e.fetchFolderList(),e.removeFromRecent(i.membersAdded.map(e=>e.sessionId))))):K})),addMembersToFolder:t=>t.pipe(au(t=>{if(!e.fetched)return K;let{sessionIds:i,folderID:s}=t,r=e.getFolder(s),l=e.getLastMember(s)?.index||-1;if(!r)return K;let o=[],d=new Map;return i.forEach((t,a)=>{o.push({index:String(Number(l)+a+1),sessionId:t});let n=e.getFolderByMember(t);if(n){let e=d.get(n?.folderID)||[];d.set(n?.folderID,[...e,t])}}),a.mutation.addMemberToFolder({folderId:t?.folderID,membersAdded:o,membersUpdated:[],membersRemoved:d}).pipe(J(()=>K),a_(()=>q(e.fetchFolderList(),n.unStarChats(i),e.removeFromRecent(o.map(e=>e.sessionId)))))})),deleteMemberFromFolder:t=>t.pipe(au(t=>e.fetched?a.mutation.deleteMemberFromFolder([t]).pipe(J(()=>K),au(()=>q(e.fetchFolderList(),e.addToRecent(t.sessionIds)))):K)),onFolderSync:()=>a.folderSync$.pipe(ah(()=>e.fetchFolderList())),onChannelAction:()=>a.channelAction$.pipe(a_(t=>{if(t.type===aI.delete){let a=t.room.jid,n=e.getFolderByMember(a)?.folderID;if(n)return q(e.removeLocalMember(a),e.deleteMemberWithoutEffect([{folderId:n,sessionIds:[]}]))}return q(e.updateOnChannelAction(t))})),onStarFromFolders:()=>oz.starFromFolders$.pipe(a_(t=>{let{jid:a}=t;if(!e.membersInFolder.has(a))return K;let n=e.getFolderByMember(a);if(!n)return K;let i={folderId:n?.folderID,sessionIds:[a]};return q(e.deleteMemberFromFolder(i))})),addToRecent:e=>e.pipe(au(e=>{let t=e.filter(e=>n.chatMap.has(e));return q(n.batchAddChats(t))})),removeFromRecent:e=>e.pipe(au(e=>q(n.batchRemoveChats(e))))}}),bj=uq(bC,{storageKey:rQ.folder,persist(e){let{folderList:t}=e;return{folderList:x(t)}},recover(e){let t=eb.object({folderList:eb.array(bx)});return t.parse(e),e}}),bN=bj.create({folderList:[],fetched:!1,channelId:"",folderID:"",currentFolder:void 0,modalVisible:!1,deleteChannelVisible:!1,isEdit:!1,isSubmitting:!1},{sdk:uW,recentChatStore:yh,encryptedStorage:uV}),bw=window.React.useCallback;function bI(){let{$t:e}=oA(),{addContact:t,acceptContact:a,deleteContact:n}=bM,i=function(){let{getFolderByMember:e,deleteMemberWithoutEffect:t}=bN,{isChatStarred:a,batchRemoveChats:n,removeChat:i,unStar:s}=yh,r=bw(r=>{let l=e(r),o=a(r);l?t([{folderId:l.folderID,sessionIds:[r]}]):o&&s({jid:r}),n([r]),i(r)},[a,n,i,s,e,t]);return r}();return{handleAddContact:a=>{let{jid:n,email:i,name:s}=a;bf.open({type:st.MESSAGE_BOX,options:{titleText:e({id:"qVK1m+",defaultMessage:[{type:0,value:"Add "},{type:1,value:"name"},{type:0,value:" as Contact"}]},{name:s}),messageText:e({id:"bx6YzM",defaultMessage:[{type:0,value:"If this user accepts your request, your profile information (including your status) will be visible to this contact."}]}),confirmButtonText:e({id:"h/XIMH",defaultMessage:[{type:0,value:"Add Contact"}]}),confirmCallback:e=>{t({name:s,jid:n,email:i,onAction(t){e(),t&&bf.open({type:st.CONTACT_INVITATION,options:{name:s}})}})}}})},handleDeleteContact:t=>{let{jid:a,email:s,name:r}=t;bf.open({type:st.MESSAGE_BOX,options:{titleText:e({id:"JpsXCp",defaultMessage:[{type:0,value:"Delete "},{type:1,value:"name"}]},{name:r}),messageText:e({id:"My4tzQ",defaultMessage:[{type:0,value:"You will not be able to contact "},{type:1,value:"name"},{type:0,value:". This action will also clear your chat history with "},{type:1,value:"name"},{type:0,value:"."}]},{name:r}),isConfirmButtonDanger:!0,confirmButtonText:e({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),confirmCallback:e=>{n({name:r,jid:a,email:s,onAction:()=>{i(a),e()}})}}})},handleAcceptContact:t=>{let{jid:n,requestId:i}=t;bf.open({type:st.MESSAGE_BOX,options:{titleText:e({id:"7LiREj",defaultMessage:[{type:0,value:"Accept Contact Request"}]}),messageText:e({id:"aHleAU",defaultMessage:[{type:0,value:"By accepting this request, your profile information (including your status) will be visible to this contact."}]}),confirmButtonText:e({id:"ce4fID",defaultMessage:[{type:0,value:"Accept Request"}]}),confirmCallback:e=>{a({jid:n,requestId:i,onAction:e})}}})}}}let bT=window.React.useCallback;function bE(){let{$t:e}=oA();return bT((t,a)=>{switch(t){case o7.offline:o2.warning(e({id:"WuMWqL",defaultMessage:[{type:0,value:"You can not send message in offline status."}]}));break;case o7.textOverflow:o2.warning(e({id:"2smOUR",defaultMessage:[{type:0,value:"Your message is too long. Please try sending multiple shorter messages."}]}));break;case o7.fileExceed:o2.warning(e({id:"7Xshjj",defaultMessage:[{type:0,value:"You can only send up to "},{type:1,value:"fileLimit"},{type:0,value:" files at time"}]},{fileLimit:10}));break;case o7.fileOverSize:o2.warning(e({id:"Gu8sW9",defaultMessage:[{type:0,value:"Transfer of files larger than "},{type:1,value:"fileLimit"},{type:0,value:" is restricted by your account admin"}]},{fileLimit:s0(536870912,0)}));break;case o7.fileNotSupport:o2.warning(e({id:"Ggcl3g",defaultMessage:[{type:0,value:'"'},{type:1,value:"fileName"},{type:0,value:'" is not a supported file format'}]},{fileName:a?.fileName}));break;case o7.fileRepeat:o2.warning(e({id:"3ug09o",defaultMessage:[{type:0,value:"The file you select is already in the input box and cannot be uploaded again"}]}));break;case o7.screenshot:o2.warning(e({id:"F36cF4",defaultMessage:[{type:0,value:"Permission denied by user or system, please enable screen recording permission."}]}))}},[e])}let bS=window.React.useRef;function bk(e){let{currentUser:t}=g2,{getIsExternalContact:a,fetchExternalResource:n}=bd,i=bc(e?.jid);return l2(()=>{n()},[n]),!!e&&(!rI(e,t)||a(e.jid)||i)}function bA(e){let{userInfo:t,fetchProfileLazy:a}=g2,n=e&&!rT(e);return(l2(()=>{n&&a(e)},[e]),n)?t(e):null}function bR(e){let{batchData:t,batchFetchProfileLazy:a}=g2,n=t(e);return l2(()=>{e?.length&&a(e)},[e]),n}function bL(e){let t=bA(e),a=t?.accountStatus==="inactive";return a}function bO(e){let{currentUser:t}=g2;return rI(e,t)&&!rE(e?.jid)}function bD(){let e=function(){let{mode:e,messageIds:t,transientMessageIds:a,forbiddenMessageIds:n}=y9();return"transient"===e?a:n.length?l$([...n,...t],G,!0):t}();return oa(()=>yU.mainMessages(e),[e])}let bP=window.React.useRef,bF=window.React.useCallback;function bB(e){let{markRead:t,getTarget:a}=e,{channelJid:n}=y9(),i=bP(),s=bF(()=>{t().then(()=>{i.current?.()}).catch(e=>{console.error(e)})},[t]),r=bF(()=>sM.queryScroll(n),[n]);i.current=oo({onIntersect:s,getBoundary:r,getTarget:a})}let bU=window.React.useCallback;function bH(e){let t=bz();return bU((a,n)=>t(a,n,rT(e),e??""),[t,e])}function bz(){let{$t:e}=oA(),{mentionList:t,mentionMemberDetail:a}=yE;return bU(async(n,i,s,r)=>{if(!s&&i!==ev.CHANNEL||!r)return[];if(i===ev.MEMBER){let s=function(e,t){let a;let n=e===ev.CHANNEL?"#":t;if(!n)throw Error("must pass a groupId for member mention cache");a=dt.get(n);let i=e===ev.CHANNEL?"#":"@";return{set:(e,t)=>{a||(a=new Map),a.set(e||i,t),dt.set(n,a)},get:e=>a&&a.has(e||i)&&a.get(e||i)||[],has:e=>!!a&&a.has(e||i),clear:e=>{e?a?.delete(e):dt.delete(n)}}}(i,r),l=[];if(s.has(n))l=s.get(n);else{let{data:t}=await uv.query.searchChannelMembers({userName:n,groupId:r}).catch(()=>(o2.error(e({id:"hhzsGW",defaultMessage:[{type:0,value:"Failed to load members"}]})),{data:null}));t?.data&&(l=t.data.filter(e=>{let{jid:t}=e;return!rS(t)}).map(e=>({id:e.jid,label:e.name,prefix:i,mentionType:aw.user})),s.set(n,l))}let o=t(r).filter(e=>!n||String(e.name).toLowerCase().startsWith(n.toLowerCase())),d=o.map(e=>{let t=a(e.jid);return{id:e.jid,label:e.name||"",prefix:i,mentionType:aw.mentionGroup,num:t?.members.length}}),c=[];return(!n||String("all").startsWith(n.toLowerCase()))&&(l.length||!l.length&&s.get("").length)&&c.push({id:r,label:"all",prefix:i,mentionType:aw.all}),[...c,...d,...l]}let l=gQ.groupChannels(i1.CHANNEL);return l.filter(e=>!n||e.name.toString().toLowerCase().includes(n.toLowerCase())).map(e=>({id:e.jid,label:e.name,prefix:i,mentionType:aw.channel}))},[e,t,a])}let bV={[np.all]:{action:"allow",type:"any",timing:"always"},[np.mention]:{action:"allow",type:"p2p_or_highlights",timing:"always"},[np.off]:{action:"deny",type:"any",timing:"always"}},bG=[i.info,i.composing,i.inactive,i.active,i.gone,i.error,i.unknown];function bq(e){let t=Object.entries(bV).find(t=>{let[,a]=t;return a.type===e.type&&a.action===e.action});return t?.[0]}function b$(e,t){return e.filter(e=>t.has(e.jid)&&e.type!==np.off).map(e=>e.jid)}let bK=eb.object({jid:eb.string(),type:eb.nativeEnum(np)}),bJ=eb.union([eb.literal("default"),eb.literal("denied"),eb.literal("granted")]),bW=e_().schema(()=>({notificationsMap:eb.map(eb.string(),bK),muteSet:eb.set(eb.string()),userNotifyType:eb.nativeEnum(np),userNotifyPermission:bJ})).views(e=>({isChannelMuted:t=>e.muteSet.has(t),get muteGroupChatIds(){return Array.from(e.muteSet)}})).mutations(e=>{function t(t,a){switch(void 0===a&&(a=ny.update),a){case ny.add:e.notificationsMap.set(t.jid,t);break;case ny.update:e.notificationsMap.set(t.jid,{...e.notificationsMap.get(t.jid),...t});break;case ny.remove:e.notificationsMap.delete(t.jid)}}function a(){oz.dispatch(oH.muteGroupChats,Array.from(e.muteSet))}return{setUserNotifyType(t){e.userNotifyType=t},setUserNotifyPermission(t){e.userNotifyPermission=t},setNotifications(t){e.notificationsMap=new Map(t.map(e=>[e.jid,e]))},setMuteSet(t){e.muteSet=new Set(t),a()},updateNotifications(e){e.forEach(e=>t(e,e.action))},updateMuteSet(n){n.jids.forEach(a=>{n.mute?(e.muteSet.add(a),t({jid:a,type:np.off},ny.update)):e.muteSet.delete(a)}),a()},notify(e){let t=e[0];!function(e){let t=new ux;t.notify(e)}({title:t.channelName??"",options:function(e){let{messageType:t}=e,a={data:e};return t===i.text||t===i.file||t===i.mix?a.body=e.message:t===i.codeSnippet&&e.file?.fileName?a.body=`{${e.file?.fileName.replace(/.zip$/,"")}}`:a.body=oL.$t({id:"pYf53Y",defaultMessage:[{type:0,value:"you received a "},{type:1,value:"messageType"},{type:0,value:" message"}]},{messageType:e.messageType}),a}(t),listeners:{onClick:function(){window.focus(),o6({type:uf.ROUTE_TO_CHAT}),yf({jid:this.data.channelJid})}}})}}}).effects((e,t)=>{let{sdk:a}=t;return{onConnected:()=>a.connected$.pipe(a_(()=>q(e.getUserNotify(),e.getChannelNotify(),e.getMuteChannel()))),onNotification:()=>a.notification$.pipe(a_(t=>{let a=b$(t,e.muteSet);return q(e.updateNotifications(t),e.unmuteChannel(a))})),onUserNotification:()=>a.userNotification$.pipe(a_(t=>{let a=bq(t);return a?q(e.setUserNotifyType(a)):K})),onMessage:()=>a.message$.pipe(eg(t=>{if("visible"===document.visibilityState)return!1;let a=t[0];if(bG.includes(a.messageType)||rS(a.senderJid))return!1;if(rT(a.channelJid)){let t=e.notificationsMap.get(a.channelJid),n=t?.type??e.userNotifyType;if(n===np.off)return!1;if(n===np.mention)return function(e){let t=e.mention?.some(e=>e.type===aw.all)??!1,a=e.mention?.some(e=>e.type===aw.user&&rS(e.jid))??!1;return t||a}(a)||function(e){return!!e.replyId&&rS(e.replyOwnerJid)}(a);np.all}return!0}),ah(t=>e.notify(t))),getUserNotify:t=>t.pipe(au(()=>a.query.getUserNotify().pipe(J(()=>K),a_(t=>{let a=bq(t.data);return a?q(e.setUserNotifyType(a)):K})))),getChannelNotify:t=>t.pipe(au(()=>a.query.getChannelNotify().pipe(J(()=>K),ah(t=>e.setNotifications(t.data??[]))))),getMuteChannel:t=>t.pipe(au(()=>a.query.getMuteChannel().pipe(J(()=>K),ah(t=>e.setMuteSet(t.data??[]))))),setUserNotify:t=>t.pipe(au(t=>a.mutation.setUserNotify(bV[t]).pipe(J(()=>K),ah(()=>e.setUserNotifyType(t))))),setChannelNotify:t=>t.pipe(a_(t=>a.mutation.setChannelNotify(t).pipe(J(()=>K),a_(()=>{let a=t.notifyChannels.map(e=>{let{channelJid:a,type:n}=e;return{jid:a,type:n,action:t.action??ny.update}}),n=b$(a,e.muteSet);return q(e.updateNotifications(a),e.unmuteChannel(n))})))),muteChannel:t=>t.pipe(au(t=>a.mutation.setMuteChannel(t).pipe(J(()=>K),ah(()=>e.updateMuteSet({jids:t,mute:!0}))))),unmuteChannel:t=>t.pipe(au(t=>a.mutation.setChannelUnMute(t).pipe(J(()=>K),ah(()=>e.updateMuteSet({jids:t,mute:!1})))))}}).create({notificationsMap:new Map,muteSet:new Set,userNotifyType:np.all,userNotifyPermission:Notification?.permission??"default"},{sdk:uW});function bY(){let{$t:e}=oA(),{userNotifyType:t,notificationsMap:a}=bW,{groupChannels:n}=gQ,i=n().map(e=>({...x(e),notifyType:a.get(e.jid)?.type})),s=i.filter(e=>aJ(e.notifyType)||e.notifyType===t).sort((e,t)=>String(e.name).localeCompare(String(t.name))),r=i.filter(e=>!s.find(t=>t.jid===e.jid)).sort((e,t)=>String(e.name).localeCompare(String(t.name))),l={[np.all]:{label:e({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]}),subLabel:e({id:"XMhUcZ",defaultMessage:[{type:0,value:"Get notified for all message activity"}]}),value:np.all},[np.mention]:{label:e({id:"gxYb25",defaultMessage:[{type:0,value:"Direct Messages, Mentions and Replies"}]}),subLabel:e({id:"o/tbnP",defaultMessage:[{type:0,value:"Includes all direct messages, group or personal mentions, and replies to you"}]}),value:np.mention},[np.off]:{label:e({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]}),subLabel:e({id:"AYdeQY",defaultMessage:[{type:0,value:"Turn off all chat notifications"}]}),value:np.off}};return{NOTIFY_TYPE_MAP:l,notificationsMap:a,userNotifyType:t,exceptPreferencesChannels:r,includePreferencesChannels:s,filterPreferencesChannels:(e,t)=>(void 0===t&&(t=""),e.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase())))}}let bX=e_().schema(()=>({memberNameList:eb.map(eb.string(),eb.array(eb.object(gI))),memberNumTotal:eb.map(eb.string(),eb.number())})).views(e=>({isMemberListLoaded:t=>e.memberNameList.has(t),getMemberListValue:t=>e.memberNameList.get(t),getMemberNumTotal:t=>e.memberNumTotal.get(t)})).mutations(e=>({setMucMember(t){t.data.length&&t.total&&(j(e.memberNameList,t.jid,t.data),j(e.memberNumTotal,t.jid,t.total||0))},addMucMember(t){let{channelId:a,memberList:n}=t;e.memberNameList.has(a)&&j(e.memberNameList,a,e.memberNameList.get(a).concat(n)),e.memberNumTotal.has(a)&&j(e.memberNumTotal,a,e.memberNumTotal.get(a)+n.length)},removeMucMember(t){if(e.memberNameList.has(t.channelId)){let a=t.memberList.map(e=>e.jid),n=e.memberNameList.get(t.channelId).filter(e=>!a.includes(e.jid));j(e.memberNameList,t.channelId,n)}if(e.memberNumTotal.has(t.channelId)){let a=e.memberNumTotal.get(t.channelId);if(a){let n=Math.max(a-t.memberList.length,0);j(e.memberNumTotal,t.channelId,n)}}}})).effects((e,t)=>{let{sdk:a}=t;return{onMucMemberClientChange:()=>a.channelAction$.pipe(a_(t=>{let{type:a,buddyList:n,room:i}=t,s=n?.map(e=>{let{jid:t,name:a}=e;return{jid:t,name:a}});switch(a){case aI.invite:return q(e.addMucMember({channelId:i.jid,memberList:s??[]}));case aI.create:return q(e.setMucMember({jid:i.jid,data:s??[],total:s?.length||0}));case aI.kick:case aI.quit:return q(e.removeMucMember({channelId:i.jid,memberList:s??[]}));default:return K}})),fetchMUCMembers:t=>t.pipe(a_(t=>e.memberNameList.has(t)?K:a.query.fetchMembers({channelJid:t,size:20,pureRequest:!0}).pipe(J(()=>K),ah(a=>e.setMucMember({jid:t,...a})))))}}),bQ=bX.create({memberNameList:new Map,memberNumTotal:new Map},{sdk:uW}),bZ=window.React.useState;function b1(e){let{userNotifyType:t,notificationsMap:a,isChannelMuted:n,setChannelNotify:i,muteChannel:s,unmuteChannel:r}=bW,l=rT(e)?a.get(e)?.type??t:np.all,o=!!rT(e)&&n(e),d=rT(e)?()=>s([e]):ec,c=rT(e)?()=>r([e]):ec;return{notifyType:l,isMuted:o,setNotification:t=>rT(e)?i({notifyChannels:[{channelJid:e,type:t}]}):ec(),mute:d,unmute:c}}let b0=window.React.useCallback;function b2(e){return gQ.channelInfo(e)??{}}function b5(e){let{adminOnly:t,adminAndSpecial:a,isUniversalChannel:n}=b2(e),{isMioLicensedUser:i}=up,s=v3();return(!n||!!i)&&(!t&&!a||(t?rR(s):!![i4.OWNER,i4.ADMIN,i4.ANNOUNCER].includes(s)))}let b3=window.React.useState;function b6(e,t,a,n,i){let[s,r]=b3([]),[l,o]=b3([]),[d,c]=b3(!1);l2(()=>{uv.query.fetchPendingExtMembers({sessions:[e]}).then(t=>{let a=t.data,n=a?.[e]||[];o(n.map(e=>({email:e.invitee_email,name:e.invitee_email,jid:"",role:0,joinTime:null})))}).catch(()=>{o([])})},[e]),l2(()=>{!e||t&&t.length<3||(c(!0),uv.query.searchChannelMembers({userName:t,groupId:e,page:n||0,size:i||200}).then(e=>{e?.data?.data?.length?a?r(lG(e.data.data)):r(e.data.data):r([])}).catch(()=>{r([])}).finally(()=>{c(!1)}))},[e,t,a,n,i]);let u=l3(()=>{if(t)return s;if(!s.length)return l;let{important:e,common:a}=lq(s);return[...e,...l,...a]},[s,l,t]);return{data:s,loading:d,pendingData:l,includeAllData:u}}function b4(e){let t=e.commentTotal||0,{repliesMap:a,closeReply:n,setReplyScope:i,replyIds:s}=y9(),r=s(e.id),l=a.get(e.id),o=l?.start??0,d=l?.end??0,c=()=>{i({mainMsgId:e.id,start:0,end:Math.min(20,t)})};return{isOpen:d>o,showFromStart:c,showFromEnd:()=>{i({mainMsgId:e.id,start:Math.max(t-20,0),end:t})},showFromMiddle:a=>{let n=r.findIndex(e=>e===a);if(n>=0){let a=Math.floor(10);i({mainMsgId:e.id,start:Math.max(n-a,0),end:Math.min(n+a,t)})}else c()},loadToStart:()=>{i({mainMsgId:e.id,start:0})},loadToEnd:()=>{i({mainMsgId:e.id,end:t})},hideAll:()=>{n(e.id)},start:o,end:d,commentTotal:t,unFinishLoad:!!r.length&&r.length<t}}let b8=window.React.useCallback;function b7(e){let{channelJid:t}=y9(),{setIsEditorOpen:a}=yU,n=l3(()=>sM.create(t),[t]),i=e.replyId||e.id,s=b8(()=>{a({mainMsgId:i,isOpen:!0}),requestAnimationFrame(()=>{n.scrollToReplyInput(i)})},[a,i,n]),r=b8(()=>{a({mainMsgId:i,isOpen:!1})},[a,i]);return{isEditorOpen:e.isEditorOpen||!1,openEditor:s,closeEditor:r}}let b9=window.React.useState,Me=eb.map(eb.string(),eb.object(gP)),Mt=e_().schema(()=>({userRolesMap:Me})).mutations(e=>{function t(t){e.userRolesMap.has(t)&&e.userRolesMap.delete(t)}function a(t,a){e.userRolesMap.set(t,{groupId:t,role:a})}return{updateOnChannelAction(n){let{type:i,room:s,operator:r,buddyList:l,data:o}=n;switch(i){case aI.edit:o.adminAndSpecial&&!rk(e.userRolesMap.get(s.jid)?.role)&&t(s.jid);break;case aI.transfer:case aI.assign:rS(r.jid)?t(s.jid):l?.some(e=>rS(e.jid))&&a(s.jid,i4.OWNER);break;case aI.add_admin:l?.some(e=>rS(e.jid))&&a(s.jid,i4.ADMIN);break;case aI.del_admin:l?.some(e=>rS(e.jid))&&t(s.jid);break;case aI.kick:case aI.quit:l?.some(e=>rS(e.jid))&&t(s.jid)}},clearUserRole(e){t(e)},setUserRolesMap(t){let{jid:a,userRoles:n}=t,i=n.find(e=>e.groupId===a);i&&e.userRolesMap.set(a,i)}}}).effects((e,t)=>{let{sdk:a}=t;return{onChannelAction:()=>a.channelAction$.pipe(a_(t=>{let{type:a,data:n,room:i}=t,s=a===aI.edit&&!!n?.adminAndSpecial&&!rk(e.userRolesMap.get(i.jid)?.role);return ap(r([e.updateOnChannelAction(t),s&&e.fetchUserRole(i.jid)]))})),fetchUserRole:t=>t.pipe(eg(e=>rT(e)),am(t=>e.userRolesMap.has(t)?K:a.query.fetchUserRoles([t]).pipe(J(()=>K),ah(a=>e.setUserRolesMap({jid:t,userRoles:a??[]})))))}}),Ma=Mt.create({userRolesMap:new Map},{sdk:uW});function Mn(e){return(l2(()=>{e&&Ma.fetchUserRole(e)},[e]),e)?Ma.userRolesMap.get(e)?.role??0:0}function Mi(e){let t=Mn(e);return rk(t)}function Ms(e){let t=Mn(e);return rR(t)}let Mr=window.React.useCallback,Ml=window.React.useRef;function Mo(e){let{fileId:t,msgId:a,isHQ:n}=e,{message:r}=yU,{fetchMsgFile:l}=yw,o=Mr(()=>{let e=r(a);if(e)switch(e.messageType){case i.codeSnippet:l({type:yv.codeSnippet,fileId:e.file.fileId,fileName:e.file.fileName});return;case i.image:case i.screenshot:{let t=e.file;l({type:yv.image,fileId:t.fileId,fileName:t.fileName,isHQ:n||t.size<102400});return}case i.mix:{let a=e.allFiles.find(e=>e.fileId===t);if(!a?.fileType||!rp(a.fileType))return;if(a.fileType===s.Giphy){let{reserve1:e}=a,i=e?.[function(){return window.pwaChatConfig.giphyImageSize||ai.pc}()]?.url||e?.pcInfo?.url;l({type:yv.giphy,fileId:t,fileUrl:i,isHQ:n});return}l({type:yv.image,fileId:a.fileId,fileName:a.fileName,isHQ:n||a.size<102400});return}case i.giphy:l({type:yv.giphy,fileId:t,messageXmlStr:e.messageXmlStr,isHQ:n});return;default:return}},[t,l,a,r,n]);return o}function Md(e){let{fileId:t,msgId:a,isHQ:n}=e,i=Ml(null),s=Ml(),r=Mr(()=>i.current,[]),l=Mr(()=>{let e=i.current,t=e?.closest('[role="list"]');return t||document.body},[]),o=Mo({fileId:t,msgId:a,isHQ:n}),d=Mr(()=>{s.current?.(),o()},[o]);return s.current=oo({getBoundary:l,onIntersect:d,getTarget:r}),{targetRef:i,handleLoad:o}}let Mc=window.React.useCallback;function Mu(){let e=o3(),t=Mc(e=>{let{jid:t,type:a,channelChanged:n}=e;o6({type:uf.ROUTE_TO_CHAT}),n||yf({jid:t,type:a}),_u.closeModal()},[]),a=Mc(e=>{Array.isArray(e)&&e.length>0&&(o6({type:uf.START_MEETING,payload:e}),_u.closeModal())},[]),n=Mc(e=>{o6({type:uf.JOIN_MEETING,payload:e})},[]),i=Mc(e=>{o6({type:uf.CHANNEL_MEETING_REQ,payload:e})},[]),s=Mc(e=>{Array.isArray(e)&&e.length>0&&(o6({type:uf.START_PHONE_CALL,payload:e}),_u.closeModal())},[]),r=Mc(()=>{e?o6({type:uf.OPEN_SETTING}):g4.openModal()},[e]),l=Mc(e=>{o6({type:uf.PMC_TIPS_CLOSE,payload:e})},[]);return{isMicro:e,gotoChat:t,startMeeting:a,startPhoneCall:s,joinMeeting:n,requestPmcInfo:i,openChatSetting:r,onPmcTipsClose:l}}let Mm=window.React.useCallback;function Mp(){let e=Mm(e=>{bf.open({type:st.VIEW_PROFILE,options:e})},[]),t=Mm(e=>{bf.open({type:st.MEETING,options:e})},[]),a=Mm(e=>{bf.open({type:st.ADD_MEMBER,options:e})},[]),n=Mm(e=>{bf.open({type:st.ADD_MEMBER_P2P,options:e})},[]),i=Mm(e=>{bf.open({type:st.EDIT_CHANNEL,options:e})},[]),s=Mm(e=>{bf.open({type:st.DELETE_CHANNEL,options:e})},[]),r=Mm(e=>{let{channelId:t,status:a}=e;"read"===a?(yU.markChatRead(t),gq.markChatAsUnread({chatId:t,action:n_.UNMARK})):gq.markChatAsUnread({chatId:t,action:n_.MARK})},[]),l=Mm(e=>{let{channelId:t}=e;yh.star({jid:t})},[]),o=Mm(e=>{let{channelId:t}=e;yh.unStar({jid:t})},[]),d=Mm(e=>{let{jid:t}=e;ba.block(t)},[]),c=Mm(e=>{let{jid:t}=e;ba.unblock(t)},[]);return{openProfileModal:e,openMeetingModal:t,openAddMemberModal:a,openAddMemberP2PModal:n,openEditChannelModal:i,openDeleteChannelModal:s,markChatReadStatus:r,starChat:l,unStarChat:o,blockUser:d,unblockUser:c}}function Mh(e){return e?yh.chatMap.has(e)?yh.chatMap.get(e).type:e===g8?i1.UNKNOWN:sd.includes(e)?i1.TOP_MENU:rT(e)?gQ.channelInfo(e)?.sessionType??i1.CHANNEL:i1.CHAT:null}function Mf(e){let[t,a]=a0(nb(e,rO),rT),n=bR(a),i=nM(n,(e,t,a)=>{let n=lT(t||{});return n?{...e,[a]:n}:e},{}),s=nM(t,(e,t)=>{let a=gQ.channelInfo(t)?.name;return a?{...e,[t]:a}:e},{});return{...i,...s}}function Mg(){let{chats:e}=yh,t=Mf(e.map(e=>e.jid));return e.map(e=>({...e,name:t[e.jid]}))}let My=window.React.useCallback;function Mv(e){let{data:t}=g2,{isMicro:a,startPhoneCall:n}=Mu(),{canStartPhoneCall:i}=up,s=rS(e),r=t.get(e)?.contactInfo,l=a&&i&&!s&&!!r,o=My(e=>ab(aO(e?.phones||[],"label"),"value"),[]),d=o(r),c=function(e,t,a,n,i){return t||(a?.length?a[0]:n||(e?String(e):i||null))}(d.Mobile,r?.extension,r?.dn,r?.cn,d.Home),u=My(()=>{c&&n([c])},[c,n]);return{phoneVisible:l,contacts:d,phoneNumber:c,startContactPhoneCall:u}}let M_=e_().schema(()=>({channelJid:eb.string(),chatType:eb.nativeEnum(i1).nullable().optional(),memberCount:eb.number(),previewMembers:eb.array(eb.object(gw)),pendingMembers:eb.array(eb.string()),pendingMembersLoaded:eb.boolean(),memberLoading:eb.boolean(),memberLoaded:eb.boolean()})).views(e=>({get previewList(){let t=e.pendingMembers.map(e=>({email:e,name:e,jid:"",role:0,joinTime:null}));if(!e.previewMembers.length)return t.slice(0,5);let{important:a,common:n}=lq(e.previewMembers);return[...a,...t,...n].slice(0,5)},get showViewMore(){return e.memberCount>e.previewMembers.length||e.previewMembers.length+e.pendingMembers.length>5}})).mutations(e=>({setChannelJid(t){e.channelJid=t},setChatType(t){e.chatType=t},setMemberCount(t){e.memberCount=t},updateMemberCount(t){e.memberCount+=t},setPreviewMembers(t){e.previewMembers=lG(t)},setMemberLoading(t){e.memberLoading=t},setMemberLoaded(t){e.memberLoaded=t},setInvitation(t){e.pendingMembers=aP([...e.pendingMembers,...t])},removeInvitation(t){e.pendingMembers=e.pendingMembers.filter(e=>!t.includes(e))},setPendingMembersLoaded(){e.pendingMembersLoaded=!0}})).effects((e,t)=>{let{sdk:a}=t;return{onConnected:()=>a.bufferedChannelChange$.pipe(eg(t=>{let{jid:a}=t;return a===e.channelJid}),au(t=>{let{sType:a,option:n}=t;if(a!==i3.GROUP_CHAT)return q(e.setChatType(i1.CHAT));{let t=rP(n??0);return ap(r([e.setChatType(t?i1.CHANNEL:i1.MUC),e.memberLoaded?null:e.getPreviewMembers(),e.pendingMembersLoaded?null:e.getPendingExtMembers()]))}})),onRemoveInvitation:()=>oz.removeInvitation$.pipe(eg(t=>{let{sessionId:a}=t;return a===e.channelJid}),ah(t=>{let{emailList:a}=t;return e.removeInvitation(a)})),onInvitation:()=>a.onInvitation$.pipe(eg(t=>{let{sessionId:a}=t;return a===e.channelJid}),a_(t=>{let{action:a,emailList:n}=t;switch(a){case"add":return q(e.setInvitation(n));case"remove":return q(e.removeInvitation(n));default:return K}})),onChannelAction:()=>a.channelAction$.pipe(eg(t=>{let{room:{jid:a}}=t;return a===e.channelJid}),a_(t=>{let{type:a,data:n,buddyList:i}=t;switch(a){case aI.edit:if(n.adminAndSpecial)return q(e.getPreviewMembers());return K;case aI.invite:case aI.transfer:case aI.assign:case aI.quit:case aI.add_admin:case aI.del_admin:return q(e.getPreviewMembers());case aI.kick:if(i?.every(e=>{let{jid:t}=e;return!rS(t)}))return q(e.getPreviewMembers());return K;default:return K}})),getPendingExtMembers:t=>t.pipe(am(()=>a.query.fetchPendingExtMembers({sessions:[e.channelJid]}).pipe(J(()=>K),am(t=>{let a=t.data,n=a?.[e.channelJid]||[],i=n.map(e=>e.invitee_email);return q(e.setInvitation(i),e.setPendingMembersLoaded())})))),getPreviewMembers:t=>t.pipe(am(()=>a.query.fetchMembers({channelJid:e.channelJid,size:5}).pipe(J(()=>K),a_(t=>q(e.setPreviewMembers(t.data),e.setMemberCount(t.total),e.setMemberLoaded(!0))),aV(e.setMemberLoading(!0)),aG(e.setMemberLoading(!1)))))}}),Mb=e=>M_.create({channelJid:e,chatType:null,memberCount:0,previewMembers:[],memberLoading:!1,memberLoaded:!1,pendingMembers:[],pendingMembersLoaded:!1},{sdk:uW}),MM={},Mx=e=>{let t=l3(()=>{if(MM[e])return MM[e];{let t=Mb(e);return MM[e]=t,t}},[e]);return t};function MC(e){let t=Mh(e),{previewList:a}=Mx(e),{currentUser:n}=g2,i=a.find(e=>rk(e.role)),s=bA(i?.jid);return t===i1.CHANNEL&&!!i&&rI(s,n)}function Mj(e){let{mentionMembers:t,mentionMemberDetail:a,fetchMentionGroupMembers:n}=yE;return oe(()=>{let t=a(e);t||n(e)},[a,e,n]),t(e)}let MN=e_().schema(()=>({data:eb.array(eb.string()),globalDisabled:eb.boolean()})).views((e,t)=>{let{recentChatStore:a}=t;function n(){return e.data.filter(e=>a.chatMap.has(e))}function i(){let{chatId:e}=a;if(!e)return -1;let t=n();return t.indexOf(e)}return{get historyList(){return n()},get cursor(){return i()},get forwardEnabled(){if(e.globalDisabled)return!1;let t=i(),a=n();return t>=0&&t<a.length-1},get backwardEnabled(){if(e.globalDisabled)return!1;let t=i();return t>0}}}).mutations((e,t)=>{let{recentChatStore:a}=t;return{push(t){let a=e.historyList.filter(e=>e!==t);a.push(t),a.length>10?e.data=a.slice(a.length-10):e.data=a},forward(){if(!e.forwardEnabled)return;let t=e.historyList[e.cursor+1];a.setChatIdByHistory(t)},backward(){if(!e.backwardEnabled)return;let t=e.historyList[e.cursor-1];a.setChatIdByHistory(t)},setGlobalDisabled(t){e.globalDisabled=t}}}).effects((e,t)=>{let{eventEmitter:a}=t;return{onUIChannelChanged:()=>a.channelChanged$.pipe(eg(e=>{let{fromHistory:t}=e;return!t}),ah(t=>{let{jid:a}=t;return e.push(a)}))}}),Mw=uq(MN,{storageKey:rQ.chatHistory,persist(e){let{data:t}=e;return{data:[...t]}},recover(e){let t=eb.object({data:eb.array(eb.string())});t.parse(e);let{data:a}=e;return{data:a}}}),MI=Mw.create({data:[],globalDisabled:!0},{encryptedStorage:uV,recentChatStore:yh,eventEmitter:oz}),MT=eb.object({description:eb.string(),favicon:eb.string().optional(),faviconV2:eb.string().optional(),imageUrl:eb.string().optional(),imageUrlV2:eb.string().optional(),link:eb.string(),siteName:eb.string(),title:eb.string(),type:eb.string(),loadDone:eb.boolean().optional()}),ME=e_().schema(()=>({linkMap:eb.map(eb.string(),eb.array(MT))})).views(e=>({getLinkPreviewById:t=>e.linkMap.get(t)||[]})).mutations(e=>({updateLinkPreview(t){let{linkPreviews:a,isDone:n}=t;a.forEach(t=>e.linkMap.set(t.messageGuid,t.previews.map(e=>({...e,loadDone:!!n}))))}})).effects((e,t)=>{let{sdk:a}=t;return{onLinkPreview:()=>a.linkPreview$.pipe(a_(t=>{let a=t.map(e=>({...e,previews:e.previews.filter(e=>{let{link:t}=e;return!function(e){return!!lJ(e)}(t)})}));return q(e.updateLinkPreview({linkPreviews:a}),...a.map(t=>e.linkToBase64(t)))})),linkToBase64:t=>t.pipe(a_(t=>a.mutation.linkToBase64(t).pipe(ah(t=>e.updateLinkPreview({linkPreviews:[t],isDone:!0})))))}}).create({linkMap:new Map},{sdk:uW});function MS(e){let{getLinkPreviewById:t}=ME;return oa(()=>{let a=t(e.id),{links:n}=yL(e.message,e.fontStyle||[]);return a.filter(e=>n?.includes(e.link))},[e,t])}let Mk=e_().schema(()=>({channelMap:eb.map(eb.string(),eb.object({hostId:eb.string(),hostName:eb.string(),topic:eb.string(),meetingNumber:eb.number(),password:eb.string().optional(),startTime:eb.number(),duration:eb.number()}).nullable()),mcpMap:eb.map(eb.string(),eb.nativeEnum(nx).optional())})).views(e=>({getMeetingDetail:t=>e.channelMap.get(t)})).mutations(e=>({setMeetings(t){Object.entries(t).forEach(t=>{let[a,n]=t;e.channelMap.set(a,n)})},setMCP(t){let{jid:a,mcp:n}=t;e.mcpMap.set(a,n)}})).effects((e,t)=>{let{sdk:a}=t;return{onMCPChanged:()=>a.channelAction$.pipe(eg(e=>e.type===aI.pmc_edit),ah(t=>e.setMCP({jid:t.room.jid,mcp:t.room.mcpType})))}}),MA=Mk.create({channelMap:new Map,mcpMap:new Map},{sdk:uW}),MR={command:eb.string(),shortDescription:eb.string()},ML={jid:eb.string(),slash:eb.string(),cmdModifyTime:eb.number(),commands:eb.array(eb.object(MR))},MO=e_().schema(()=>({appCmdFetched:eb.boolean(),appCmdInfoMap:eb.map(eb.string(),eb.object(ML))})).mutations(e=>({markAppCmdInfoFetch(){e.appCmdFetched=!0},setAppCmdInfo(t){let{jid:a,cmdInfo:n}=t;e.appCmdInfoMap.set(a,{...n,commands:[...n.commands,{command:"",shortDescription:""}]})}})).effects((e,t)=>{let{sdk:a,externalContactStore:n}=t;return{fetchCmdInfo:t=>t.pipe(aK(()=>lw(()=>yh.appsListFetched).pipe(eg(Boolean))),ag(1),au(()=>{if(e.appCmdFetched)return K;let t=n.chatAppIds;return a.query.fetchAppCmdInfo({jids:t,pageNo:1}).pipe(au(t=>{if(!t)return K;let{slashes:a}=t;return ap([...a.map(t=>e.setAppCmdInfo({jid:t.jid,cmdInfo:t})),e.markAppCmdInfoFetch()])}))}))}}).create({appCmdFetched:!1,appCmdInfoMap:new Map},{sdk:uW,externalContactStore:bd}),MD=window.React.useCallback;function MP(e){let{fetchCmdInfo:t,appCmdInfoMap:a}=MO;nl(t);let n=bc(e);return MD(t=>{let i=[];for(let[e,t]of a){let a=bd.getChatApp(e);t.commands.forEach(n=>{i.push({appJid:e,appName:`${a?.firstName} ${a?.lastName}`,picUrl:a?.picUrl||"",id:`${e} ${n.command}`,label:`/${t.slash} ${n.command}`.trim(),description:n.shortDescription,prefix:"/"})})}return n?i.filter(a=>a.appJid===e&&a.label.startsWith(t,1)):i.filter(e=>e.label.startsWith(t,1))},[a,e,n])}let MF=ex(function(e){let{members:t,children:a,open:n}=e,{$t:i}=oA(),{userJid:s}=vB,r=oa(()=>[...t.filter(e=>e===s),...t.filter(e=>e!==s)].slice(0,20),[t,s]),l=bR(r.slice(0,20)),o=oa(()=>t.length?g.jsxs(g.Fragment,{children:[r.map(e=>{let t=lT(l[e]??{});return t?g.jsxs("div",{children:[t,e===s&&`(${i({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`]},e):null}),t.length>20&&g.jsx("div",{children:i({id:"tpWU0/",defaultMessage:[{type:0,value:"And More ..."}]})})]}):g.jsx(g.Fragment,{children:i({id:"YZeYbZ",defaultMessage:[{type:0,value:"No mention group members"}]})}),[i,r,l,t,s]);return g.jsx(dA,{className:"_memberList_1v2dt_1",arrowClassName:"_arrow_1v2dt_9",content:o,arrowVisible:!0,side:"top",open:n,children:a})}),MB=ex(function(e){let{jids:t}=e,{$t:a}=oA(),n=bR(t),{userJid:i}=vB;return g.jsx(g.Fragment,{children:Object.values(n).map(e=>{if(e.jid===i)return a({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]});let t=lT(e);return t}).join(",")})}),MU={mentionName:"_mentionName_zecdc_1"},MH=ex(function(e){let{mentionId:t,className:a,isOpen:n,isShowName:i,mentionName:s}=e,r=Mj(t),{mentionGroupDetail:l}=yE,o=l(t);return o?g.jsx(MF,{members:r,open:n,children:g.jsx("span",{className:a,children:i&&g.jsxs("span",{className:MU.mentionName,children:["@",o.name]})})}):g.jsx(g.Fragment,{children:s?`@${s}`:null})}),Mz={info:"_info_1hauh_1",html:"_html_1hauh_8",emailInvitation:"_emailInvitation_1hauh_11",bold:"_bold_1hauh_16"},MV=window.React.useCallback,MG=ex(function(e){let{message:t}=e,{$t:a}=oA(),n=bt(),{userJid:i}=vB,{removedMentionGroupName:s}=yE,r=MV((e,t)=>g.jsxs(g.Fragment,{children:[e,g.jsx("span",{className:Mz.html,children:lk(t,{link:!1})})]}),[]),l=MV(e=>{if(!e)return"";let t=e.slice(0,9).map(e=>n(e)).join(", ");return e.length<=9?t:a({id:"lCBeyA",defaultMessage:[{type:1,value:"buddyMember"},{type:0,value:", and "},{type:1,value:"number"},{type:0,value:" others"}]},{buddyMember:t,number:e.length-9})},[a,n]),o=MV((e,t)=>{if(!e?.length)return null;let n=Array(22);return e.forEach(e=>{n[e.reason]?n[e.reason].push(e):n[e.reason]=[e]}),n.reduce((e,n,i)=>{if(!n?.length)return e;let s=l(n),r="";switch(i){case sm.REASON_INVITE_DUPLICATE_USER:r=1===n.length?a({id:"iohslB",defaultMessage:[{type:1,value:"buddy"},{type:0,value:" cannot be added because this user is an existing member"}]},{buddy:s}):a({id:"WNsb0B",defaultMessage:[{type:1,value:"buddy"},{type:0,value:" cannot be added because they are existing members"}]},{buddy:s});break;case sm.REASON_BLOCKED_NOT_PERMISSION:r=1===n.length?a({id:"+OVZlj",defaultMessage:[{type:0,value:"You cannot add "},{type:1,value:"buddy"},{type:0,value:" because you have been blocked by this user"}]},{buddy:s}):a({id:"jliSXK",defaultMessage:[{type:0,value:"You cannot add "},{type:1,value:"buddy"},{type:0,value:" because you have been blocked by these users"}]},{buddy:s});break;case sm.REASON_BLOCK_NOT_PERMISSION:default:r=1===n.length?t?a({id:"cnFgUm",defaultMessage:[{type:1,value:"buddy"},{type:0,value:" is not allowed to join this group chat"}]},{buddy:s}):a({id:"Cdsxzz",defaultMessage:[{type:1,value:"buddy"},{type:0,value:" is not allowed to join this channel"}]},{buddy:s}):t?a({id:"F7smv8",defaultMessage:[{type:1,value:"buddy"},{type:0,value:" are not allowed to join this group chat"}]},{buddy:s}):a({id:"QQS1Lx",defaultMessage:[{type:1,value:"buddy"},{type:0,value:" are not allowed to join this channel"}]},{buddy:s})}return r?[...e,g.jsx("p",{children:r},`invite-${r}`)]:e},[])},[a,l]);return g.jsx("div",{className:Mz.info,children:(()=>{let{actionInfo:e}=t;if(!e)return t.message;let{type:d,operator:c,buddyList:u,emailList:m=[],notAllowedList:p,room:{name:h,desc:f,descAction:y,option:v,mentionGroupData:_},pins:b,errorType:M}=e,x=rD(v),C=n(c);switch(d){case aI.create:if(x)return a({id:"7ved0R",defaultMessage:[{type:1,value:"operator"},{type:0,value:" created this group chat "},{type:1,value:"channelName"}]},{operator:C,channelName:h});return a({id:"vvMMok",defaultMessage:[{type:1,value:"operator"},{type:0,value:" created this channel "},{type:1,value:"channelName"}]},{operator:C,channelName:h});case aI.quit:if(x)return a({id:"Q7G0z0",defaultMessage:[{type:1,value:"operator"},{type:0,value:" left the group chat"}]},{operator:C});return a({id:"Rd6uPL",defaultMessage:[{type:1,value:"operator"},{type:0,value:" left the channel"}]},{operator:C});case aI.invite:{let e=null;m?.length===1?e=g.jsx("div",{className:Mz.emailInvitation,children:a({id:"GvCapO",defaultMessage:[{type:0,value:"A contact request has been sent to "},{type:1,value:"userName"},{type:0,value:". If this request is accepted, "},{type:1,value:"userName"},{type:0,value:" will be added to this chat."}]},{userName:g.jsx("span",{className:Mz.bold,children:m[0]})})}):m?.length>1&&(e=g.jsx("div",{className:Mz.emailInvitation,children:a({id:"e91QTY",defaultMessage:[{type:0,value:"A contact request has been sent to "},{type:1,value:"userName"},{type:0,value:" and "},{type:1,value:"lastUserName"},{type:0,value:". If this request is accepted, these users will be added to this chat."}]},{userName:g.jsx("span",{className:Mz.bold,children:m.slice(0,-1).join(", ")}),lastUserName:g.jsx("span",{className:Mz.bold,children:m[m?.length-1]})})}));let t=null;u?.length===1&&u[0].jid===c.jid?t=x?a({id:"0bY4PF",defaultMessage:[{type:1,value:"operator"},{type:0,value:" joined this group chat"}]},{operator:C}):a({id:"heg25N",defaultMessage:[{type:1,value:"operator"},{type:0,value:" joined this channel"}]},{operator:C}):u?.length&&(t=a({id:"/HRJXx",defaultMessage:[{type:1,value:"operator"},{type:0,value:" added "},{type:1,value:"buddy"}]},{operator:C,buddy:l(u)}));let n=o(p?.filter(e=>!rS(e.jid)),x);return g.jsxs(g.Fragment,{children:[t,n,e]})}case aI.kick:if(!rS(c.jid))return null;if(x)return a({id:"UzUS9F",defaultMessage:[{type:1,value:"operator"},{type:0,value:" removed "},{type:1,value:"buddy"},{type:0,value:" from this group chat"}]},{operator:C,buddy:l(u)});return a({id:"yy1QRX",defaultMessage:[{type:1,value:"operator"},{type:0,value:" removed "},{type:1,value:"buddy"},{type:0,value:" from this channel"}]},{operator:C,buddy:l(u)});case aI.subject:if(x)return a({id:"rsCV6N",defaultMessage:[{type:1,value:"operator"},{type:0,value:' changed the group chat topic to "'},{type:1,value:"channelName"},{type:0,value:'"'}]},{operator:C,channelName:h});return a({id:"lQql3Z",defaultMessage:[{type:1,value:"operator"},{type:0,value:' changed the channel name to "'},{type:1,value:"channelName"},{type:0,value:'"'}]},{operator:C,channelName:h});case aI.pin:if(x)return a({id:"z9kKDx",defaultMessage:[{type:1,value:"name"},{type:0,value:" pinned a message to this chat"}]},{name:C});return a({id:"MA/i0Y",defaultMessage:[{type:1,value:"name"},{type:0,value:" pinned a message to this channel"}]},{name:C});case aI.unpin:return a({id:"ImTyDZ",defaultMessage:[{type:1,value:"name"},{type:0,value:" unpinned a message"}]},{name:C});case aI.remove_pin:if(b?.pinList?.[0].type===aN.top)return a({id:"ImTyDZ",defaultMessage:[{type:1,value:"name"},{type:0,value:" unpinned a message"}]},{name:C});return null;case aI.assign:case aI.transfer:return a({id:"TvVAcr",defaultMessage:[{type:1,value:"operator"},{type:0,value:" assigned "},{type:1,value:"buddy"},{type:0,value:" as the owner"}]},{operator:C,buddy:l(u)});case aI.desc:switch(y){case a5.add:if(x)return r(a({id:"kzAzDu",defaultMessage:[{type:1,value:"operator"},{type:0,value:" added a chat description:"}]},{operator:C}),f);return r(a({id:"XjMheW",defaultMessage:[{type:1,value:"operator"},{type:0,value:" added a channel description:"}]},{operator:C}),f);case a5.update:if(x)return r(a({id:"XLDye3",defaultMessage:[{type:1,value:"operator"},{type:0,value:" updated the chat description:"}]},{operator:C}),f);return r(a({id:"sGly12",defaultMessage:[{type:1,value:"operator"},{type:0,value:" updated the channel description:"}]},{operator:C}),f);case a5.remove:if(x)return a({id:"4Emjmn",defaultMessage:[{type:1,value:"operator"},{type:0,value:" cleared the chat description"}]},{operator:C});return a({id:"M3OxaQ",defaultMessage:[{type:1,value:"operator"},{type:0,value:" cleared the channel description"}]},{operator:C});default:return null}case aI.add_admin:return a({id:"HwuKKQ",defaultMessage:[{type:1,value:"operator"},{type:0,value:" assigned "},{type:1,value:"buddy"},{type:0,value:" as an admin"}]},{operator:C,buddy:l(u)});case aI.del_admin:return a({id:"A4Ejti",defaultMessage:[{type:1,value:"operator"},{type:0,value:" unassigned "},{type:1,value:"buddy"},{type:0,value:" as an admin"}]},{operator:C,buddy:l(u)});case aI.error:switch(M){case su.Self_Restrict:return a({id:"YO7zFo",defaultMessage:[{type:0,value:"Chat with contacts outside of the account have been restricted by your account admin"}]});case su.Peer_Restrict:return a({id:"Zn97kO",defaultMessage:[{type:0,value:"Message can not be sent because "},{type:1,value:"buddy"},{type:0,value:" has been restricted by their account admin"}]},{buddy:l(u)});case su.Blocked:return a({id:"/Vr05i",defaultMessage:[{type:0,value:"Message can not be sent because you have been blocked by "},{type:1,value:"buddy"}]},{buddy:l(u)});default:return null}case aI.mention_group:switch(_?.action){case aT.create:{let e=_.members?.length||0,t={operator:g.jsx(MB,{jids:[_.owner||i]}),mentionNum:e,mentionName:g.jsx(MH,{isShowName:!0,mentionId:_.jid,mentionName:_.name})};return Number(e)>1?a({id:"Twd/o0",defaultMessage:[{type:1,value:"operator"},{type:0,value:" added the mention group "},{type:1,value:"mentionName"},{type:0,value:" with "},{type:1,value:"mentionNum"},{type:0,value:" members"}]},t):a({id:"cxpMz0",defaultMessage:[{type:1,value:"operator"},{type:0,value:" added the mention group "},{type:1,value:"mentionName"},{type:0,value:" with "},{type:1,value:"mentionNum"},{type:0,value:" member"}]},t)}case aT.delete:return a({id:"ste/9r",defaultMessage:[{type:1,value:"operator"},{type:0,value:" deleted mention group @"},{type:1,value:"mentionName"}]},{operator:g.jsx(MB,{jids:[_.owner||i]}),mentionName:s(_.jid)});default:return null}default:return t.message}})()})}),Mq={pmc:"_pmc_12m0l_1",info:"_info_12m0l_9",time:"_time_12m0l_15",subInfo:"_subInfo_12m0l_19"},M$=ex(function(e){let{message:t}=e,{$t:a}=oA(),{pmcMsgInfo:n,time:i}=t;switch(n?.status){case 1:return g.jsxs("div",{className:Mq.pmc,children:[g.jsxs("div",{className:Mq.info,children:[g.jsx(nj,{}),g.jsx("span",{className:Mq.time,children:oY(n.realStartTime)}),g.jsx("span",{children:" - "}),a({id:"Fk8C6i",defaultMessage:[{type:0,value:"Meeting started"}]})]}),g.jsx("div",{className:Mq.subInfo,children:a({id:"tJdj7w",defaultMessage:[{type:0,value:"Messages sent during the meeting will be visible to all meeting participants"}]})})]});case 2:return g.jsx("div",{className:Mq.pmc,children:g.jsxs("div",{className:Mq.info,children:[g.jsx(nj,{}),g.jsx("span",{className:Mq.time,children:oY(n.realEndTime)}),g.jsx("span",{children:" - "}),a({id:"Wcl9Zl",defaultMessage:[{type:0,value:"Meeting ended"}]})]})});case 12:return g.jsx("div",{className:Mq.pmc,children:g.jsxs("div",{className:Mq.info,children:[g.jsx(nC,{}),g.jsx("span",{className:Mq.time,children:oY(i)}),g.jsx("span",{children:" - "}),a({id:"BNlTHT",defaultMessage:[{type:0,value:"Meeting Canceled"}]})]})});default:return null}});function MK(e){let{type:t}=e;return t?dL[t]:g.jsx(g.Fragment,{})}let MJ={popover:"_popover_1tqha_1",noContent:"_noContent_1tqha_11",profile:"_profile_1tqha_15",profileUpper:"_profileUpper_1tqha_19",avatar:"_avatar_1tqha_24",badge:"_badge_1tqha_32",nameContainer:"_nameContainer_1tqha_39",presenceStatus:"_presenceStatus_1tqha_44",presenting:"_presenting_1tqha_55",zoommeeting:"_zoommeeting_1tqha_56",dnd:"_dnd_1tqha_57",pbx:"_pbx_1tqha_58",busy:"_busy_1tqha_59",calendar:"_calendar_1tqha_60",blocked:"_blocked_1tqha_61",away:"_away_1tqha_64",status:"_status_1tqha_68",statusGrey:"_statusGrey_1tqha_68",statusIcon:"_statusIcon_1tqha_79",statusIconCircle:"_statusIconCircle_1tqha_79",statusGreyIconCircle:"_statusGreyIconCircle_1tqha_79",name:"_name_1tqha_39",pronoun:"_pronoun_1tqha_107",signature:"_signature_1tqha_116",profileLower:"_profileLower_1tqha_127",info:"_info_1tqha_131",copy:"_copy_1tqha_143",infoTitle:"_infoTitle_1tqha_148",infoValue:"_infoValue_1tqha_157",copyIcon:"_copyIcon_1tqha_185",buttonContainer:"_buttonContainer_1tqha_190",actions:"_actions_1tqha_199",chatIcon:"_chatIcon_1tqha_207"},MW=ex(function(e){let{jid:t,className:a}=e,{presenceType:n,presenceText:i}=bu(t);return g.jsxs("div",{className:f(a,MJ.presenceStatus),children:[g.jsx(MK,{type:n}),g.jsx("span",{className:n?MJ[n]:"",children:i})]})}),MY=ex(function(e){let{allowCopy:t=!0,data:a}=e,{$t:n}=oA(),{jobInfo:i,contactInfo:s,email:r,contacts:l,introduction:o}=a,d=[{title:n({id:"eXcD4S",defaultMessage:[{type:0,value:"Department"}]}),value:i?.department},{title:n({id:"9YazHG",defaultMessage:[{type:0,value:"Company"}]}),value:i?.company},{title:n({id:"w7sjvQ",defaultMessage:[{type:0,value:"Job Title"}]}),value:i?.job},{title:n({id:"rvirM2",defaultMessage:[{type:0,value:"Location"}]}),value:i?.address},{title:n({id:"i8CwA4",defaultMessage:[{type:0,value:"Extension"}]}),value:s?.extension,canCopy:!0},{title:n({id:"O95R3Z",defaultMessage:[{type:0,value:"Phone"}]}),value:l.Phone,canCopy:!0},{title:n({id:"GWtmtu",defaultMessage:[{type:0,value:"Mobile"}]}),value:l.Mobile,canCopy:!0},{title:n({id:"+4MjlG",defaultMessage:[{type:0,value:"Office"}]}),value:l.Office,canCopy:!0},{title:n({id:"ejEGdx",defaultMessage:[{type:0,value:"Home"}]}),value:l.Home,canCopy:!0},{title:n({id:"etKfZA",defaultMessage:[{type:0,value:"Fax"}]}),value:l.Fax,canCopy:!0},{title:n({id:"/VnDMl",defaultMessage:[{type:0,value:"Other"}]}),value:l.Other,canCopy:!0},{title:n({id:"sy+pv5",defaultMessage:[{type:0,value:"Email"}]}),value:r},{title:n({id:"g5pX+a",defaultMessage:[{type:0,value:"About"}]}),value:o}].filter(e=>{let{value:t}=e;return!!t});return d.length?g.jsx("div",{className:MJ.profileLower,children:d.map(e=>g.jsxs("div",{className:MJ.info,children:[g.jsx("div",{className:MJ.infoTitle,children:e.title}),g.jsx("div",{className:MJ.infoValue,children:e.value}),t&&e.canCopy&&g.jsx("div",{className:MJ.copy,onClick:()=>{rX.copyText(e.value)},children:g.jsx(nN,{className:MJ.copyIcon})})]},e.title))}):null}),MX=ex(function(e){let{jid:t}=e,{$t:a}=oA(),n=bA(t),i=lT(n??{});return g.jsx("div",{className:MJ.profile,children:g.jsxs("div",{className:MJ.profileUpper,children:[g.jsx("div",{className:MJ.avatar,children:g.jsx(_L,{jid:t,name:i,size:"xl"})}),g.jsxs("div",{className:MJ.nameContainer,children:[g.jsx("div",{className:MJ.name,children:i}),g.jsxs("div",{className:MJ.statusGrey,children:[g.jsx("span",{className:MJ.statusIconCircle}),g.jsx("span",{children:a({id:"plMsEA",defaultMessage:[{type:0,value:"Deactivated"}]})})]})]})]})})}),MQ=ex(function(e){let{jid:t,onAction:a}=e,{$t:n}=oA(),i=bA(t),s=bk(i),{handleAddContact:r}=bI(),l=bc(t),{phoneVisible:o,phoneNumber:d,startContactPhoneCall:c,contacts:u}=Mv(t),{isMeeting:m}=vB,{isNoMeetingsLicenseTypeUser:p}=up,h=rS(t),{isMicro:f,gotoChat:y,startMeeting:v}=Mu();if(!i)return null;let{avatar:_,pronoun:b,nickname:M,firstname:x,lastname:C,jobInfo:j,contactInfo:N,email:w,signature:I}=i,T=oQ(I),E=lT({nickname:M,firstname:x,lastname:C,email:w}),S=l?bd.getChatApp(t)?.introduction:"",k=f&&!p&&!h&&!!t&&!!E&&!l,A=o&&!!d,R=()=>{y({jid:t,type:i1.CHAT}),a?.({jid:t})},L=()=>{r({email:w,name:E,jid:t})},O=()=>{v([{jid:t,name:E,type:i3.CHAT,withVideo:!1}])};return g.jsxs("div",{className:MJ.profile,children:[g.jsxs("div",{className:MJ.profileUpper,children:[g.jsxs("div",{className:MJ.avatar,children:[g.jsx(_L,{jid:t,name:E,image:_,size:"xl"}),g.jsx(_B,{className:MJ.badge,userJid:t})]}),g.jsxs("div",{className:MJ.nameContainer,children:[g.jsx("div",{className:MJ.name,children:E}),s&&g.jsx(MW,{jid:t}),!!b&&g.jsx("div",{className:MJ.pronoun,children:b}),!!T&&g.jsx("div",{className:MJ.signature,children:T})]})]}),g.jsx("div",{className:MJ.actions,children:(()=>rE(t)&&!l?null:g.jsxs(g.Fragment,{children:[s?g.jsx(dj,{onClick:R,icon:g.jsx(ez,{className:MJ.chatIcon}),children:n({id:"WTrOy3",defaultMessage:[{type:0,value:"Chat"}]})}):g.jsx(dj,{onClick:L,icon:g.jsx(nw,{className:MJ.chatIcon}),children:n({id:"h/XIMH",defaultMessage:[{type:0,value:"Add Contact"}]})}),k&&g.jsx(dj,{onClick:O,icon:g.jsx(nI,{className:MJ.chatIcon}),children:m?n({id:"Q72/t8",defaultMessage:[{type:0,value:"Invite to Meeting"}]}):n({id:"voU5xP",defaultMessage:[{type:0,value:"Meet"}]})}),A&&g.jsx(dj,{onClick:c,icon:g.jsx(nT,{className:MJ.chatIcon}),children:n({id:"f+GKc4",defaultMessage:[{type:0,value:"Call"}]})})]}))()}),g.jsx(MY,{data:{jobInfo:j,contactInfo:N,email:w,contacts:u,introduction:S}})]})}),MZ=ex(function(e){let t=bL(e.jid);return t?g.jsx(MX,{jid:e.jid}):g.jsx(MQ,{...e})}),M1=ex(function(e){let{userName:t}=e,{$t:a}=oA(),{handleAddContact:n}=bI();return g.jsxs("div",{className:MJ.profile,children:[g.jsxs("div",{className:MJ.profileUpper,children:[g.jsx("div",{className:MJ.avatar,children:g.jsx(_L,{isAlwaysColorful:!0,jid:"",name:t,size:"xl"})}),g.jsx("div",{className:MJ.nameContainer,children:g.jsx("div",{className:MJ.name,children:t})})]}),g.jsx("div",{className:MJ.actions,children:g.jsx(dj,{onClick:()=>{n({email:t,name:t})},icon:g.jsx(nw,{className:MJ.chatIcon}),children:a({id:"h/XIMH",defaultMessage:[{type:0,value:"Add Contact"}]})})})]})}),M0=window.React.useState,M2=window.React.useCallback,M5=ex(function(e){let{userJid:t,userName:a,children:n,side:i="right",portalContainer:s,containerClassName:r,onAction:l}=e,{data:o,fetchProfile:d}=g2,[c,u]=M0(!1),m=M2(e=>{u(e),e&&d(t)},[d,t]),p=M2(()=>{u(!1),l?.({jid:t})},[l,t]),h=!t&&a,y=!o.has(t)&&!h;return g.jsx(cc,{open:c,onOpenChange:m,content:t?g.jsx(MZ,{jid:t,onAction:p}):g.jsx(M1,{userName:a||""}),trigger:"hover",side:i,align:"start",sideOffset:8,alignOffset:36,className:f(MJ.popover,{[MJ.noContent]:y}),portalContainer:s,children:g.jsx("div",{className:f(MJ.buttonContainer,r),children:n})})}),M3=e=>{let{popover:t,...a}=e;return t?g.jsx(M5,{...a}):e.children},M6={message:"_message_lmy5o_1",isReply:"_isReply_lmy5o_8",followed:"_followed_lmy5o_12",isBot:"_isBot_lmy5o_15",isOnlyYou:"_isOnlyYou_lmy5o_19",avatar:"_avatar_lmy5o_38",small:"_small_lmy5o_67",contentWrapper:"_contentWrapper_lmy5o_72",header:"_header_lmy5o_94",sender:"_sender_lmy5o_100",visible:"_visible_lmy5o_107",visibleIcon:"_visibleIcon_lmy5o_111",time:"_time_lmy5o_114",edited:"_edited_lmy5o_120",unread:"_unread_lmy5o_125",content:"_content_lmy5o_72",revoked:"_revoked_lmy5o_135",options:"_options_lmy5o_146",isPinned:"_isPinned_lmy5o_151",pinIcon:"_pinIcon_lmy5o_158",bottomControls:"_bottomControls_lmy5o_166",isOpen:"_isOpen_lmy5o_178",unsentActions:"_unsentActions_lmy5o_185",dangerText:"_dangerText_lmy5o_191",retryButton:"_retryButton_lmy5o_194",deleteButton:"_deleteButton_lmy5o_197"},M4=ex(function(e){let{isReply:t,revoked:a,newLine:n,senderJid:i,userName:s,avatar:r}=e;return g.jsxs("div",{className:f(M6.avatar,{[M6.small]:t}),children:[a&&g.jsx(_L,{deleted:!0}),!a&&i&&n&&g.jsx(M5,{userJid:i,children:g.jsx(_L,{jid:i,image:r,name:s,size:t?"sm":"lg"})})]})}),M8={voteBox:"_voteBox_1ksmi_1",voteItem:"_voteItem_1ksmi_10",userActive:"_userActive_1ksmi_40",emojiVotedList:"_emojiVotedList_1ksmi_50",baseTooltip:"_baseTooltip_1ksmi_57",noContent:"_noContent_1ksmi_60",arrow:"_arrow_1ksmi_63"},M7=window.React.useState,M9=ex(e=>{let{message:t,voteInfo:a,disabled:n=!1}=e,[i,s]=M7([]),[r,l]=M7(!1),{$t:o}=oA(),d=_5(),c=nE(),{channelJid:u}=y9(),m=bL(u);return g.jsx(dA,{content:g.jsxs("div",{className:M8.emojiVotedList,children:[i.slice(0,12).map((e,t)=>g.jsx("div",{className:M8.emojiVotedItem,children:e.username},t)),i.length>12&&g.jsx("div",{className:M8.emojiVotedItem,children:o({id:"tpWU0/",defaultMessage:[{type:0,value:"And More ..."}]})})]}),className:f(M8.baseTooltip,{[M8.noContent]:!i.length}),arrowClassName:M8.arrow,arrowVisible:!0,open:r,side:"top",onOpenChange:e=>{l(e),e&&uv.query.fetchEmojiVoteList({msgId:t.id,msgTimestamp:t.time,emoji:a.emoji}).then(e=>{e&&(s(e),yU.correctEmojiVoteCount({msgId:t.id,emoji:a.emoji,count:e.length}))}).catch(e=>{console.error(e)})},children:g.jsxs("button",{className:f(M8.voteItem,{[M8.userActive]:a.haveIEmojied}),onClick:m||n?void 0:()=>{let e=a.emoji,n=a.haveIEmojied?nu.remove:nu.add;d(t,e,n,g2.currentUser.jid)},children:[g.jsx("img",{"data-img":a.emoji,src:c(a.emoji)}),g.jsx("p",{children:a.count})]})})}),xe=ex(e=>{let{message:t,disabled:a}=e,n=oU(t.emojiVotes);return n.length?g.jsx("div",{className:M8.voteBox,children:n.map(e=>g.jsx(M9,{message:t,voteInfo:e,disabled:a},e.emoji))}):null}),xt={buttonWrapper:"_buttonWrapper_1h1g6_1"},xa=window.React.useCallback,xn=ex(function(e){let{message:t,disabled:a=!1}=e,{isOpen:n,showFromStart:i,hideAll:s}=b4(t),{closeEditor:r,openEditor:l}=b7(t),{replyIds:o,isReplyLoading:d,fetchHistoryReplies:c}=y9(),{$t:u}=oA(),m=d(t.id),p=o(t.id).length,h=t.commentTotal??0,f=Math.max(h-p,0),y=xa(()=>{s(),r()},[s,r]);return h?n?g.jsx("div",{className:xt.buttonWrapper,children:g.jsx(dj,{type:"link",size:"small",icon:g.jsx(nS,{}),iconPlacement:"right",loading:m,onClick:y,children:u({id:"fqHkSl",defaultMessage:[{type:0,value:"Collapse All"}]})})}):g.jsx(dj,{...oI.Main.toggleReplyBtn,type:"link",size:"small",icon:g.jsx(tC,{}),iconPlacement:"right",onClick:a?void 0:()=>{i(),f&&c({replyId:t.id,threadTime:t.time,limit:f,sort:"asc"}),l()},children:1===h?u({id:"b6xkKi",defaultMessage:[{type:0,value:"1 Reply"}]}):u({id:"umlky9",defaultMessage:[{type:1,value:"count"},{type:0,value:" Replies"}]},{count:h})}):null}),xi=ex(function(e){let{message:t,isReply:a}=e,{initialMsgFetched:n}=y9(),{isOpen:i}=b4(t),s=eC();return g.jsxs("div",{className:f(M6.bottomControls,{[M6.isOpen]:i}),children:[s&&g.jsx(xe,{message:t,disabled:!n}),!a&&g.jsx(xn,{message:t,disabled:!n})]})}),xs={attachmentsContainer:"_attachmentsContainer_1syrk_1",attachmentsHeader:"_attachmentsHeader_1syrk_4",foldBtn:"_foldBtn_1syrk_9",folded:"_folded_1syrk_20",attachmentList:"_attachmentList_1syrk_23",attachmentItem:"_attachmentItem_1syrk_27",attachmentImg:"_attachmentImg_1syrk_38",attachmentContent:"_attachmentContent_1syrk_50",attachmentIcon:"_attachmentIcon_1syrk_55",fileIcon:"_fileIcon_1syrk_58",downloadIcon:"_downloadIcon_1syrk_62",attachmentMain:"_attachmentMain_1syrk_72",attachmentTitle:"_attachmentTitle_1syrk_77",attachmentDesc:"_attachmentDesc_1syrk_81",downloadLabel:"_downloadLabel_1syrk_85"},xr=ex(function(e){let{attachment:t}=e,{imgUrl:a,information:n,resourceUrl:i}=t,{$t:s}=oA();return g.jsxs("div",{className:xs.attachmentItem,tabIndex:0,"aria-label":s({id:"YQwI2r",defaultMessage:[{type:0,value:"Click to download "},{type:1,value:"title"}]},{title:n.title.text}),...ld(()=>{window.open(i,"_blank")},!0,!1),children:[g.jsx("div",{className:xs.attachmentImg,children:g.jsx("img",{src:a,alt:""})}),g.jsxs("div",{className:xs.attachmentContent,children:[g.jsxs("div",{className:xs.attachmentIcon,children:[g.jsx(sA,{className:xs.fileIcon}),g.jsx(sR,{className:xs.downloadIcon})]}),g.jsxs("div",{className:xs.attachmentMain,children:[g.jsx("div",{className:xs.attachmentTitle,children:n.title.text}),n.description&&g.jsx("div",{className:xs.attachmentDesc,children:n.description.text}),g.jsx("div",{className:xs.downloadLabel,children:s({id:"V+r2K0",defaultMessage:[{type:0,value:"Click to download"}]})})]})]})]})}),xl=window.React.useState,xo=ex(function(e){let{attachments:t}=e,[a,n]=xl(!1),{$t:i}=oA();return g.jsxs("div",{className:f(xs.attachmentsContainer,{[xs.folded]:a}),children:[g.jsxs("div",{className:xs.attachmentsHeader,children:[i({id:"yBLyDy",defaultMessage:[{type:1,value:"count"},{type:0,value:" Attachment"}]},{count:t.length}),g.jsx("button",{className:xs.foldBtn,"aria-label":i(a?{id:"vO4Vto",defaultMessage:[{type:0,value:"Unfold attachments"}]}:{id:"r6dm7K",defaultMessage:[{type:0,value:"Fold attachments"}]}),onClick:()=>{n(e=>!e)},children:g.jsx(nk,{})})]}),g.jsx("div",{className:xs.attachmentList,children:t.map(e=>g.jsx(xr,{attachment:e},e.eventId))})]})}),xd=window.React.createContext,xc=window.React.useContext,xu=xd(null),xm=xu.Provider,xp=e=>{let{children:t,...a}=e;return g.jsx(xm,{value:a,children:t})},xh=()=>xc(xu),xf=window.React.useCallback;function xg(){let{messageId:e,channelJid:t,appJid:a,asyncid:n,time:i}=xh(),s=xf((s,r)=>{uv.mutation.sendAppMessage({appMsg:{to:a,version:r,value:{asyncid:n,thread_id:e,message_id:e,session_id:t,message_t:i,callback_id:sW(),...s}}})},[a,n,t,e,i]);return{sendCommand:s}}let xy=ex(function(e){let{className:t,buttonInfo:a,onAction:n}=e,i=a.style===s_.DEFAULT?"default":"primary",s=a.style===s_.DANGER,r=a.style===s_.DISABLED;return g.jsx(g.Fragment,{children:g.jsx(dj,{className:t,size:"small",type:i,danger:s,disabled:r,onClick:()=>{n(a)},children:a.text})})}),xv=window.PWAModal.Modal,x_=window.React.useState,xb=e=>{let{visible:t,shouldCloseOnEsc:a=!0,shouldCloseOnOverlayClick:n=!1,children:i,...s}=e,[r,l]=x_(),[o,d]=x_();return g.jsx(xv,{contentRef:e=>l(e),isOpen:t,centered:!0,isDraggable:!1,needBackdrop:!0,shouldCloseOnEsc:a,shouldCloseOnOverlayClick:n,onRequestClose:a||n?s.onCancel:void 0,shouldFocusAfterRender:!1,onAfterOpen:()=>{setTimeout(()=>{d(document.activeElement),r?.focus()},10)},onAfterClose:()=>{o?.focus()},aria:{labelledby:dP,describedby:dF},children:g.jsx(dB,{...s,children:i})})},xM=window.ReactDOM,xx=ee(()=>{let e=document.createElement("div");return document.body.appendChild(e),e});function xC(e){let{title:t,content:a,onConfirm:n,okDanger:i,okText:s,onCancel:r,hideCancel:l}=e,o=()=>{xM.unmountComponentAtNode(xx())};xM.render(g.jsx(oD,{children:g.jsx(xb,{visible:!0,title:t,onOk:()=>{n(),o()},onCancel:()=>{r?.(),o()},okDanger:i,okText:s,hideCancel:l,children:a})}),xx())}xb.confirm=xC;class xj{static #e=(()=>{this.pendingDisposer=null})();constructor(e){this.api={config:()=>Promise.resolve({clientVersion:"5.15.10"}),getChatContext:()=>Promise.resolve(this._config.getChatContext()),openUrl:e=>(window.open(e.url,"_blank"),this.resolveSuccess()),closeModal:()=>(this._config.closeModal(),this.resolveSuccess()),composeCard:e=>(this._config.composeCard(e),this.resolveSuccess()),composeText:e=>(this._config.composeText(e),this.resolveSuccess()),zmSetConfirmationOnDiscard:e=>(this._config.zmSetConfirmationOnDiscard(e),this.resolveSuccess()),zmResize:e=>(this._config.zmResize(e),this.resolveSuccess())},this._config=e,this.listener=this.listener.bind(this)}formatEventData(e){return"string"==typeof e?rJ(e,{}):p(e)?e:{}}isAppRequest(e){let{jsCallId:t,apiName:a}=e;return"string"==typeof t&&"string"==typeof a}sendResponse(e,t){this._config.postMessage({type:"apiResponse",data:{result:t,jsCallId:e}})}withResponse(e){return async(t,a)=>{let n=await e(a);this.sendResponse(t,n)}}isDefinedApi(e){return"function"==typeof this.api[e]}listener(e){if(e.origin!==window.location.origin)return;let t=this.formatEventData(e.data);if(!this.isAppRequest(t))return;let{jsCallId:a,apiName:n,data:i}=t;if(!this.isDefinedApi(n)){console.error(`Undefined api: ${n}`);return}this.withResponse(this.api[n])(a,i)}listenAppRequest(){return xj.pendingDisposer?.(),window.addEventListener("message",this.listener),xj.pendingDisposer=this.disposeListener,this.disposeListener}disposeListener(){window.removeEventListener("message",this.listener),xj.pendingDisposer=null}resolveSuccess(){return Promise.resolve("Success")}}async function xN(e){let t,{homeUri:a,actionId:n,headers:i,injectTheme:s=!1,injectHistory:r=!1,injectClose:l=!1,replaceNonce:o=!1,injectCrossOrigin:d=!1,fetchAppDoc:c}=e;if(c)t=await c(a);else{let e=aa({action_id:n,...i},e=>!e),{data:s}=await ax(uW.query.fetchAppDoc({url:a,headers:{...e,"from-pwa":"true"},withCredentials:!0}));t=s}return s&&(t=function(e){let t=document.createElement("script");return xw&&t.setAttribute("nonce",xw),t.textContent='window.document.dispatchEvent(new Event("DOMContentLoaded"));',e.replace(xE,`<body>$1${t.outerHTML}</body>`)}(function(e){let t=document.createElement("script");return xw&&t.setAttribute("nonce",xw),t.textContent='window.theme = "light";',e.replace(xT,`<head>$1${t.outerHTML}</head>`)}(t))),r&&(t=function(e,t){let a=new URL(t).pathname,n=document.createElement("script");return xw&&n.setAttribute("nonce",xw),n.textContent=`history.replaceState(null, "", "${a}");`,e.replace(xT,`<head>$1${n.outerHTML}</head>`)}(t,a)),l&&(t=function(e){let t=document.createElement("script");return xw&&t.setAttribute("nonce",xw),t.textContent=`
    window.close = () => {
      window.parent.postMessage({
        jsCallId: "",
        apiName: "closeModal"
      });
    };
  `,e.replace(xT,`<head>$1${t.outerHTML}</head>`)}(t)),d&&(t=function(e){return e.replace(xS,"<script crossorigin $1>").replace(xk,"<link crossorigin $1>")}(t)),o&&(t=function(e){return xw?e.replace(xI,`nonce="${xw}"`):e}(t)),t}let xw=window.pwaChatConfig.cspNonce,xI=/nonce="[^"]*"/g,xT=/<head>((.|\n)*)<\/head>/,xE=/<body>((.|\n)*)<\/body>/,xS=/<script ([^>]*src=".*"[^>]*)>/g,xk=/<link ([^>]*href=".*"[^>]*)>/g,xA=window.ReactDOM,xR=window.React.useRef,xL=window.React.useState;function xO(e){let{editorRef:t,defaultSize:a,getMsgContent:n,onOpen:i,onClose:s,onCloseEvent:r}=e,l=xR(null),[o,d,c]=om(!1),[u,m]=xL(a??{}),p=xR(),h=xR(!1),f=xR(!1),y=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];l.current?.contentWindow?.postMessage(...t)},v=()=>{s?.(),p.current?.disposeListener(),f.current=!0,h.current=!1,m(a??{}),c()},_=()=>{},b=e=>{let{message:a,action:n}=e;setTimeout(()=>{"replace"===n?t?.current?.setTextContent(a):"append"===n&&t?.current?.appendTextContent(a)},100)},M=()=>{let e=t?.current?.getTextContent()??"",a=n?.()??e;return{content:a,compose:e}},x=e=>{let{needConfirmation:t}=e;h.current=t};return{loading:o,size:u,needConfirmation:()=>h.current,renderIframe:()=>g.jsx("div",{style:u,children:g.jsx("iframe",{src:"about:blank",className:"_appIframe_188a6_1",ref:l})}),openIframe:e=>{i?.(),d(),f.current=!1,xN(e).then(e=>{if(!l.current||f.current)return;let t=new xj({postMessage:y,closeModal:()=>{r?.(),v()},zmResize:m,getChatContext:M,composeCard:_,composeText:b,zmSetConfirmationOnDiscard:x});t.listenAppRequest(),p.current=t,l.current.contentDocument?.write(e)}).catch(e=>{console.error(e),v()}).finally(()=>{c()})},closeIframe:v}}let xD={modal:"_modal_1afug_1",title:"_title_1afug_5",subTitle:"_subTitle_1afug_14"},xP=ex(function(e){let{className:t,buttonInfo:a}=e,{channelJid:n,time:i}=xh(),{fetchMsgByTimes:s}=yU,{dialog:r}=a,{renderModal:l,openModal:o}=function(e){let[t,a,n]=om(!1),{dialogConfig:i,robotIcon:s,robotName:r,editorRef:l,onCloseEvent:o}=e,{title:d,width:c,height:u}=i??{},m=d?.text,{loading:p,size:h,closeIframe:f,openIframe:y,renderIframe:v}=xO({editorRef:l,defaultSize:{width:c,height:u},onOpen:a,onClose:n,onCloseEvent:o}),_=()=>{if(!m&&!s)return null;let e="number"==typeof h.width?Math.max(h.width-36,0):void 0;return g.jsxs("div",{style:{maxWidth:e},children:[g.jsx("div",{className:xD.title,children:m}),g.jsxs("div",{className:xD.subTitle,children:[s&&g.jsx("img",{alt:"App Icon",src:s}),r&&g.jsx("span",{children:r})]})]})};return{renderModal:()=>g.jsx(xb,{className:xD.modal,width:"auto",closable:!0,visible:t,loading:p,title:_(),footer:null,onCancel:f,children:v()}),openModal:y}}({dialogConfig:a.dialog,onCloseEvent:()=>{setTimeout(()=>{s({params:{session:n,msgTimes:[i]},forceUpdate:!0})},2e3)}}),d=async()=>{if(!r?.link)return"";let e=new URL(r.link),t=e.pathname+e.search,{data:a}=await at.get(t,{headers:{"X-Client-Type":"pwa"}});return a};return g.jsxs(g.Fragment,{children:[g.jsx(xy,{className:t,buttonInfo:a,onAction:()=>{let e=r?.link;e&&o({homeUri:e,fetchAppDoc:d,injectTheme:!0,injectClose:!0})}}),l()]})}),xF={actionsContainer:"_actionsContainer_2i4ed_1",actionButton:"_actionButton_2i4ed_6"},xB=window.React.useCallback,xU=ex(function(e){let{actions:t}=e,{sendCommand:a}=xg(),{$t:n}=oA(),i=oa(()=>t.limit?t.items.slice(0,t.limit-1):t.items,[t]),s=xB(e=>{a({action:sb.Action,eventid:t.eventId,action_item:{text:e.text,value:e.value}},t.version)},[t.eventId,t.version,a]),l=oa(()=>{let e=t.limit?t.items.slice(t.limit-1):[];return e.map(e=>({label:e.text,key:e.value,operate:()=>s(e)}))},[t.items,t.limit,s]);return g.jsxs("div",{className:xF.actionsContainer,children:[r(i.map(e=>e.action?e.dialog?g.jsx(xP,{className:xF.actionButton,buttonInfo:e},e.value):null:g.jsx(xy,{className:xF.actionButton,buttonInfo:e,onAction:s},e.value))),t.limit&&g.jsx(_g,{items:l,children:g.jsxs(dj,{className:xF.actionButton,size:"small",type:"default",children:[n({id:"I5NMJ8",defaultMessage:[{type:0,value:"More"}]}),g.jsx(tU,{})]})})]})}),xH=window.React.useState,xz=ex(function(e){let{datePicker:t}=e,{initialDate:a}=t,[n,i]=xH(new Date(a)),{sendCommand:s}=xg();return g.jsx("div",{className:"_datePickerContainer_6gqmf_1",children:g.jsx(cB,{className:"_datePicker_6gqmf_1",date:n,setDate:e=>{i(e),s({action:sb.Datepicker,eventid:t.eventId,datepicker:{action_id:t.actionId,year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}},t.version)}})})}),xV=ex(function(e){let{divider:t}=e,{style:a}=t;return g.jsx("div",{className:"_dividerBar_jrnmq_1",children:g.jsx("div",{className:"_divider_jrnmq_1",style:(()=>{let e={};return a&&(a.bold&&(e.borderBottomWidth=2),a.color&&(e.borderBottomColor=a.color),a.dotted&&(e.borderBottomStyle="dashed")),e})()})})}),xG={textContainer:"_textContainer_1bkcf_1",textContent:"_textContent_1bkcf_6",normalText:"_normalText_1bkcf_24",blockImage:"_blockImage_1bkcf_27",monospace:"_monospace_1bkcf_33",linkToLink:"_linkToLink_1bkcf_39",mentionLink:"_mentionLink_1bkcf_46",active:"_active_1bkcf_50",editBtn:"_editBtn_1bkcf_56",editTextarea:"_editTextarea_1bkcf_60"},xq=window.React.Fragment;function x$(e){let{text:t,italic:a,bold:n,strikethrough:i,monospace:s,quotes:r,color:l}=e,o=l3(()=>{let e=le(t);if(!e.length)return[{text:t}];let a=[],n=0;return e.forEach(e=>{let{link:i,start:s,end:r}=e;s>n&&a.push({text:t.substring(n,s)}),a.push({link:i}),n=r+1}),n<t.length&&a.push({text:t.substring(n,t.length)}),a},[t]),d=l3(()=>{let e={};return a&&(e.fontStyle="italic"),n&&(e.fontWeight="bold"),i&&(e.textDecorationLine="line-through"),l&&(e.color=l),r&&(e.textIndent=2*r+"em"),e},[n,l,a,r,i]),c=e=>e.link?g.jsx("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.link}):e.text;return g.jsx("span",{className:f(xG.normalText,{[xG.monospace]:s}),style:d,children:o.map((e,t)=>g.jsx(xq,{children:c(e)},t))})}let xK=window.React,xJ=ex(function(e){let{markdownData:t}=e,{$t:a}=oA(),{currentUser:n}=g2,i=1===t.length&&!!t[0].img,s=e=>{if(!(e.target instanceof HTMLElement))return;let{id:t}=e.target.dataset;t&&yf({jid:t})},r=e=>{if(e.hyperlink)return g.jsx("a",{href:e.hyperlink,target:"_blank",rel:"noreferrer",children:e.text||e.hyperlink});if(e.img)return g.jsx("img",{className:f({[xG.blockImage]:i}),src:e.img,alt:e.imgAlt});if(e.mention)return g.jsxs("span",{className:f(xG.mentionLink,{[xG.active]:n.jid===e.mention}),"data-id":e.mention,children:["@",e.text]});if(e.mentionAll)return g.jsxs("span",{className:f(xG.mentionLink,xG.active),children:["@",a({id:"zQvVDJ",defaultMessage:[{type:0,value:"All"}]})]});if(e.linkto)return g.jsx(M5,{userJid:e.linkto,children:g.jsxs("span",{className:xG.linkToLink,"data-id":e.linkto,tabIndex:0,onClick:s,children:["@",e.text]})});if(e.text){let{text:t,...a}=e;return g.jsx(x$,{text:t,...a})}return null};return g.jsx(g.Fragment,{children:t.map((e,t)=>g.jsx(xK.Fragment,{children:r(e)},t))})}),xW=window.React.useState,xY=ex(function(e){let{className:t,name:a,text:n,link:i,markdownData:s,textStyle:r,editable:l,onTextChange:o}=e,[d,c]=xW(!1),[u,m]=xW(n||""),[p,h]=xW(u),{$t:y}=oA(),v=!p||p===u;return g.jsxs("div",{className:xG.textContainer,children:[g.jsx("div",{className:f(xG.textContent,t),children:(()=>i?g.jsx("a",{target:"_blank",href:i,rel:"noreferrer",children:n||i}):s?g.jsx(xJ,{markdownData:s}):g.jsx(x$,{text:u,...r}))()}),l&&g.jsxs(g.Fragment,{children:[g.jsx(dj,{className:xG.editBtn,type:"text",size:"small","aria-label":y({id:"s3IOQQ",defaultMessage:[{type:0,value:"Edit "},{type:1,value:"name"}]},{name:a}),icon:g.jsx(nA,{}),onClick:()=>{c(!0)}}),g.jsx(xb,{visible:d,width:400,title:y({id:"wEQDC6",defaultMessage:[{type:0,value:"Edit"}]}),okText:y({id:"jvo0vs",defaultMessage:[{type:0,value:"Save"}]}),onCancel:()=>{c(!1)},onOk:()=>{c(!1),m(p),o?.(p,u)},okDisable:v,children:g.jsx("textarea",{autoFocus:!0,className:xG.editTextarea,rows:5,value:p,onChange:e=>{h(e.target.value)}})})]})]})}),xX=ex(function(e){let{field:t,onChange:a}=e;return g.jsxs("div",{className:f("_fieldsItem_g72af_8",{_short_g72af_14:t.short}),children:[g.jsx("div",{className:"_fieldName_g72af_17",children:t.key}),g.jsx(xY,{name:t.key,text:t.value,link:t.link,textStyle:t.style,markdownData:t.extractedMessages,editable:t.editable,onTextChange:(e,n)=>{a?.({key:t.key,currentValue:n,newValue:e})}})]})}),xQ=ex(function(e){let{fields:t}=e,{sendCommand:a}=xg(),n=e=>{a({action:sb.FieldEdit,eventid:t.eventId,field_edit_item:e},t.version)};return g.jsx("div",{className:"_fieldsContainer_g72af_1",children:t.items.map(e=>g.jsx(xX,{field:e,onChange:n},e.key))})}),xZ={fileContainer:"_fileContainer_nizp9_1",fileIcon:"_fileIcon_nizp9_6",fileContent:"_fileContent_nizp9_15",fileTitle:"_fileTitle_nizp9_18",fileDesc:"_fileDesc_nizp9_28"},x1=ex(function(e){let{file:t}=e,{iconUrl:a,title:n,description:i}=t;return g.jsxs("div",{className:xZ.fileContainer,children:[a&&g.jsx("div",{className:xZ.fileIcon,children:g.jsx("img",{src:a,alt:""})}),g.jsxs("div",{className:xZ.fileContent,children:[n&&g.jsx("a",{className:xZ.fileTitle,href:n.fileUrl,target:"_blank",rel:"noreferrer",children:n.text}),i&&g.jsx("div",{className:xZ.fileDesc,children:i.text})]})]})}),x0={messageContainer:"_messageContainer_2f7g2_1",messageContent:"_messageContent_2f7g2_5",showLess:"_showLess_2f7g2_8",showBtn:"_showBtn_2f7g2_11"},x2=window.React.useRef,x5=window.React.useState,x3=ex(function(e){let{message:t}=e,[a,n]=x5(0),{$t:i}=oA(),{sendCommand:s}=xg(),r=x2(null);l2(()=>{if(r.current){let e=r.current.getBoundingClientRect();e.height>180&&n(-1)}},[]);let l=i(-1===a?{id:"aWpBzj",defaultMessage:[{type:0,value:"Show more"}]}:{id:"qyJtWy",defaultMessage:[{type:0,value:"Show less"}]});return g.jsxs("div",{className:x0.messageContainer,children:[g.jsx("div",{className:f(x0.messageContent,{[x0.showLess]:-1===a}),ref:r,children:g.jsx(xY,{text:t.text,link:t.link,textStyle:t.style,markdownData:t.extractedMessages,editable:t.editable,onTextChange:(e,a)=>{s({action:sb.Edit,eventid:t.eventId,edit_item:{origin:a,target:e}},t.version)}})}),0!==a&&g.jsx("button",{className:x0.showBtn,onClick:()=>{n(e=>-1===e?1:-1)},children:l})]})}),x6=ex(function(e){let{progress:t}=e;return g.jsx("div",{className:"_progressBar_1i612_1",children:g.jsx("div",{className:"_progressOuter_1i612_6",children:g.jsx("div",{className:"_progressInner_1i612_14",style:(()=>{let e={},a=Math.min(Math.max(t.value,0),100);return e.width=`${a}%`,e})()})})})}),x4=window.React.useState,x8=ex(function(e){let{radioGroup:t}=e,{options:a,initialOption:n}=t,[i,s]=x4(n.value),{sendCommand:r}=xg(),l=a.map(e=>({label:e.text,value:e.value}));return g.jsx("div",{className:"_radioGroupContainer_rls3n_1",children:g.jsx(cq,{labelClassName:"_radioItem_rls3n_1",value:i,options:l,onChange:e=>{s(e);let n=a.find(t=>t.value===e);r({action:sb.RadioButtons,eventid:t.eventId,radio_buttons:{action_id:t.actionId,text:n?.text,value:n?.value}},t.version)}})})}),x7=window.React.useState,x9=ex(function(e){let{defaultValue:t,options:a=[],searchFixedOptions:n,showSearch:i,loading:s,onChange:r,onSearch:l,onVisibleChange:o,...d}=e,[c,u]=x7(t),m=l3(()=>a.find(e=>e.value===c),[a,c]),{$t:p}=oA();return g.jsx(cE,{value:c,showSearch:i,options:a,searchFixedOptions:n,loading:s,onSearch:l,dropDownWidth:200,onChange:e=>{u(e),r?.(e)},onDropDownOpenChange:o,children:g.jsxs("div",{className:"_selectBox_1y1f0_8",children:[g.jsx("input",{className:"_selectInner_1y1f0_14",value:m?.label??"",placeholder:p({id:"kQAf2d",defaultMessage:[{type:0,value:"Select"}]}),readOnly:!0,...d}),g.jsx(tC,{className:"_arrowIcon_1y1f0_32"})]})})}),Ce=window.React.useState,Ct=ex(function(e){let{name:t,onChange:a}=e,[n,i]=Ce([]),{groupChannels:s}=gQ,{$t:r}=oA(),l=oa(()=>s().map(e=>({label:e.name,value:e.jid})),[s]);return oe(()=>{i(l)},[l]),g.jsx(x9,{options:n,showSearch:!0,searchFixedOptions:l,"aria-label":r({id:"G65XME",defaultMessage:[{type:0,value:"Select "},{type:1,value:"name"}]},{name:t}),onChange:a,onSearch:e=>{let t=e.toLowerCase(),a=l.filter(e=>e.label.toLowerCase().includes(t));i(a)}})}),Ca=window.React.useState,Cn=ex(function(e){let{name:t,onChange:a}=e,[n,i]=Ca(""),{channelJid:s}=y9(),{data:r,loading:l}=b6(s,n),{$t:o}=oA(),d=r.map(e=>({label:e.name,value:e.jid}));return g.jsx(x9,{options:d,loading:l,"aria-label":o({id:"G65XME",defaultMessage:[{type:0,value:"Select "},{type:1,value:"name"}]},{name:t}),showSearch:!0,onChange:a,onSearch:i,onVisibleChange:()=>{i("")}})}),Ci=window.React.useState,Cs=ex(function(e){let{name:t,selectItems:a,selectedItem:n,onChange:i}=e,{$t:s}=oA(),r=a.map(e=>({label:e.text,value:e.value})),[l,o]=Ci(r);return g.jsx(x9,{defaultValue:n?.value,options:l,searchFixedOptions:r,showSearch:l.length>5,"aria-label":s({id:"G65XME",defaultMessage:[{type:0,value:"Select "},{type:1,value:"name"}]},{name:t}),onChange:i,onSearch:e=>{let t=e.toLowerCase(),a=r.filter(e=>e.label.toLowerCase().includes(t));o(a)}})}),Cr=ex(function(e){let{select:t}=e,{text:a,selectedItems:n,groupItems:i,staticSource:s}=t,{sendCommand:r}=xg(),l=e=>{r({action:sb.Select,eventid:t.eventId,selected_options:[{value:e}]},t.version)};return g.jsxs("div",{className:"_selectContainer_1y1f0_1",children:[g.jsx("div",{className:"_selectName_1y1f0_4",children:a}),(()=>"members"===s?g.jsx(Cn,{name:a,onChange:l}):"channels"===s?g.jsx(Ct,{name:a,onChange:l}):i?g.jsx(Cs,{name:a,selectItems:i[0].items,selectedItem:n[0],onChange:l}):null)()]})}),Cl=window.React.useState,Co=(()=>{let e=[],t=nR(0,24,1),a=nR(0,60,15);return t.forEach(t=>{let n=t.toString();a.forEach(t=>{let a=t.toString(),i=`${nL(n,2,"0")}:${nL(a,2,"0")}`;e.push({label:i,value:i})})}),e})(),Cd=ex(function(e){let{timePicker:t}=e,{initialTime:a}=t,[n,i]=Cl(a),{$t:s}=oA(),{sendCommand:r}=xg();return g.jsx("div",{className:"_timePickerContainer_ir32o_1",children:g.jsx(cE,{value:n,options:Co,onChange:e=>{i(e);let[a,n]=e.split(":");r({action:sb.Timepicker,eventid:t.eventId,timepicker:{action_id:t.actionId,hour:parseInt(a).toString(),min:parseInt(n).toString()}},t.version)},children:g.jsxs("div",{className:"_selectBox_ir32o_4",children:[g.jsx("input",{className:"_selectInner_ir32o_10",value:n??"","aria-label":s({id:"tzylNI",defaultMessage:[{type:0,value:"Select time"}]}),placeholder:s({id:"tzylNI",defaultMessage:[{type:0,value:"Select time"}]}),readOnly:!0}),g.jsx(nO,{className:"_clockIcon_ir32o_28"}),g.jsx(tC,{className:"_arrowIcon_ir32o_35"})]})})})}),Cc=ex(function(e){let{item:t}=e;return g.jsx(g.Fragment,{children:(()=>{switch(t.type){case sv.MESSAGE:return g.jsx(x3,{message:t});case sv.ACTIONS:return g.jsx(xU,{actions:t});case sv.FIELDS:return g.jsx(xQ,{fields:t});case sv.SELECT:return g.jsx(Cr,{select:t});case sv.TIME_PICKER:return g.jsx(Cd,{timePicker:t});case sv.DATE_PICKER:return g.jsx(xz,{datePicker:t});case sv.RADIO_BUTTONS:return g.jsx(x8,{radioGroup:t});case sv.DIVIDER:return g.jsx(xV,{divider:t});case sv.PROGRESS_BAR:return g.jsx(x6,{progress:t});case sv.FILE:return g.jsx(x1,{file:t});default:return null}})()})}),Cu={botCard:"_botCard_1du31_1",botHeader:"_botHeader_1du31_12",title:"_title_1du31_15",subTitle:"_subTitle_1du31_18",botBody:"_botBody_1du31_23",messageList:"_messageList_1du31_33",sidebar:"_sidebar_1du31_36"};function Cm(e){let{color:t}=e;return g.jsx("div",{className:Cu.sidebar,style:{backgroundColor:t}})}let Cp={sectionsContainer:"_sectionsContainer_jgq7k_1",sectionsContent:"_sectionsContent_jgq7k_5",sectionFooter:"_sectionFooter_jgq7k_8",footerIcon:"_footerIcon_jgq7k_16"},Ch=ex(function(e){let{section:t,showSidebar:a,sidebarColor:n}=e,{sections:i}=t,s=oa(()=>{if(!i)return[];let e=[];return i.forEach(t=>{if(t.type===sv.ATTACHMENTS){let a=e[e.length-1];Array.isArray(a)?a.push(t):e.push([t])}else e.push(t)}),e},[i]);return g.jsxs("div",{className:Cp.sectionsContainer,children:[a&&g.jsx(Cm,{color:t.sidebarColor||n}),g.jsxs("div",{className:Cp.sectionsContent,children:[s.map((e,t)=>Array.isArray(e)?g.jsx(xo,{attachments:e},`${e[0].eventId}_${t}`):e.type!==sv.SECTION?g.jsx(Cc,{item:e},`${e.eventId}_${t}`):null),t.footer&&g.jsxs("div",{className:Cp.sectionFooter,children:[t.footerIcon&&g.jsx("img",{className:Cp.footerIcon,src:t.footerIcon,alt:""}),t.footer&&g.jsx("span",{children:t.footer}),t.ts&&g.jsx("span",{children:oK(t.ts,"MM/DD/YYYY, h:mm A")})]})]})]})}),Cf=ex(function(e){let{body:t,settings:a}=e,n=oa(()=>{if(t&&a){let e=t.some(e=>e.type===sv.SECTION);return a.isSplitSidebar&&e}return!1},[t,a]),i=oa(()=>{if(!t)return[];let e=[];return t.forEach(t=>{if(t.type===sv.ATTACHMENTS){let a=e[e.length-1];Array.isArray(a)?a.push(t):e.push([t])}else e.push(t)}),e},[t]);return g.jsxs("div",{className:Cu.botBody,children:[!n&&g.jsx(Cm,{color:a?.defaultSidebarColor}),g.jsx("div",{className:Cu.messageList,children:i.map((e,t)=>Array.isArray(e)?g.jsx(xo,{attachments:e},`${e[0].eventId}_${t}`):e.type===sv.SECTION?g.jsx(Ch,{section:e,showSidebar:n,sidebarColor:a?.defaultSidebarColor},`${e.sections[0].eventId}_${t}`):g.jsx(Cc,{item:e},`${e.eventId}_${t}`))})]})}),Cg=ex(function(e){let{head:t}=e;return g.jsxs("div",{className:Cu.botHeader,children:[g.jsx(xY,{className:Cu.title,text:t.text,textStyle:t.style,markdownData:t.extractedMessages}),t.subHead&&g.jsx(xY,{className:Cu.subTitle,text:t.subHead.text,textStyle:t.subHead.style,markdownData:t.subHead.extractedMessages})]})}),Cy=window.React.forwardRef,Cv=ex(Cy(function(e,t){let{message:a}=e,{botTemplate:n,channelJid:i,time:s,id:r}=a,{head:l,body:o,settings:d}=n.messageData;return g.jsx(xp,{channelJid:i,messageId:r,time:s,appJid:n.from,appName:n.name,asyncid:n.asyncid,children:g.jsxs("div",{className:Cu.botCard,ref:t,children:[l&&g.jsx(Cg,{head:l}),o&&g.jsx(Cf,{body:o,settings:d})]})})})),C_={callMessage:"_callMessage_xux4v_1",callLabel:"_callLabel_xux4v_10",outgoingCall:"_outgoingCall_xux4v_15",incomingCall:"_incomingCall_xux4v_16",missedCall:"_missedCall_xux4v_26"},Cb=ex(function(e){let{message:t}=e,{$t:a}=oA(),{meetingMap:n}=yU,i=n.get(t.callInfo?.raw.meetingNo??""),s=t.senderJid,r=vB.userJid,l=!!i&&i.callInfo?.subtype===1,o=i?i.callInfo?.action:"";return l?g.jsx("div",{className:C_.callMessage,children:g.jsxs("div",{className:C_.missedCall,children:[g.jsx(nD,{}),g.jsx("div",{className:C_.callLabel,children:a({id:"E5R/YZ",defaultMessage:[{type:0,value:"Missed Call"}]})})]})}):g.jsx("div",{className:C_.callMessage,children:r===s?g.jsxs("div",{className:C_.outgoingCall,children:[g.jsx(nP,{}),g.jsx("div",{className:C_.callLabel,children:a({id:"lcz+OT",defaultMessage:[{type:0,value:"Outgoing Call"}]})})]}):g.jsxs("div",{className:C_.incomingCall,children:[g.jsx(nF,{}),g.jsxs("div",{className:C_.callLabel,children:[a({id:"6XKwgo",defaultMessage:[{type:0,value:"Incoming Call"}]}),!!o&&` - ${(e=>{switch(e){case"accept":return a({id:"aFyFm0",defaultMessage:[{type:0,value:"Accepted"}]});case"decline":return a({id:"uRYIb9",defaultMessage:[{type:0,value:"Declined"}]});case"cancel":return a({id:"PFtMy9",defaultMessage:[{type:0,value:"Canceled"}]});default:return""}})(o)}`]})]})})}),CM={codeSnippetViewer:"_codeSnippetViewer_ffliw_1",noWrap:"_noWrap_ffliw_15",line:"_line_ffliw_19",lineNum:"_lineNum_ffliw_22",lineCode:"_lineCode_ffliw_26",pre:"_pre_ffliw_46",viewMoreBtn:"_viewMoreBtn_ffliw_49"},Cx=ex(function(e){let{fileId:t,isNoWrap:a=!1,hideOverLength:n=!1,height:i}=e,{getCodeSnippetState:s}=yw,{codeSnippet:r}=s(t),{html:l="",total_lines:o=0}=r||{},{$t:d}=oA(),c=function(e){let t=e.match(/<body bgcolor="#FFFFFF">((.|\n)*)<\/body>/);if(!t)return e.split("\n").map(e=>`<span class="${CM.pre}">${nU(e)}</span>`);{let e=t[1]||"";return e.split("<br />").map(e=>nB.sanitize(e,{ALLOWED_TAGS:["span"],ALLOWED_ATTR:["style"]}))}}(l),u=n?Math.min(5,o):o;c.length=u;let m={};return i&&(m.height=i),g.jsxs("ul",{className:f(CM.codeSnippetViewer,{[CM.noWrap]:a}),style:m,children:[c.map((e,t)=>g.jsxs("li",{className:CM.line,children:[g.jsx("div",{className:CM.lineNum,children:t+1}),g.jsx("div",{className:CM.lineCode,dangerouslySetInnerHTML:{__html:e}})]},t)),u<o&&g.jsxs("li",{className:CM.line,children:[g.jsx("div",{className:CM.lineNum}),g.jsx(dj,{className:CM.viewMoreBtn,type:"link",size:"small",onClick:()=>{bf.open({type:st.CODE_SNIPPET,options:{fileId:t}})},children:d({id:"fSyLZf",defaultMessage:[{type:0,value:"View "},{type:1,value:"number"},{type:0,value:" more lines"}]},{number:o-u})})]})]})}),CC={codeSnippet:"_codeSnippet_d2cr4_1",showToggle:"_showToggle_d2cr4_5",codeName:"_codeName_d2cr4_10",codeContainer:"_codeContainer_d2cr4_15",loading:"_loading_d2cr4_19"},Cj=ex(function(e){let{message:t}=e,{$t:a}=oA(),[n,,,i]=om(!0),{getCodeSnippetState:s}=yw,r=t.file?.fileId,{codeSnippet:l,fileName:o=""}=s(r),{targetRef:d}=Md({fileId:r,msgId:t.id});return l?g.jsxs("div",{className:CC.codeSnippet,children:[g.jsxs("div",{className:CC.showToggle,...ld(i),children:[a({id:"WCeVZT",defaultMessage:[{type:0,value:"Added this "},{type:1,value:"name"},{type:0,value:" snippet:"}]},{name:l.type}),g.jsx("span",{className:CC.codeName,children:o.split(".")[0]||""}),n?g.jsx(nk,{}):g.jsx(e9,{})]}),n&&g.jsx("div",{className:CC.codeContainer,children:g.jsx(Cx,{fileId:r,hideOverLength:!0})})]}):g.jsx("div",{className:CC.loading,ref:d,children:g.jsx(e4,{loading:!0})})}),CN={unknown:"_unknown_5gy4k_1",icon:"_icon_5gy4k_7"};function Cw(){let{$t:e}=oA();return g.jsxs("div",{className:CN.unknown,children:[g.jsx(nH,{className:CN.icon}),e({id:"vH6W0k",defaultMessage:[{type:0,value:"To view this message, please use your ACE-enabled client"}]})]})}let CI=e_().schema(()=>({replyId:eb.string().nullable().optional(),cloudStorage:eb.nativeEnum(sh).optional()})).mutations(e=>({setReplyId(t){e.replyId=t},setCloudStorage(t){e.cloudStorage=t},stopFileSharing(){e.replyId=void 0,e.cloudStorage=void 0}})),CT=CI.create({});function CE(e){return new Promise(t=>{if(!e.textContent.text){t(!0);return}uv.query.checkMsgPolicy(e.textContent.text).then(e=>{switch(e){case nz.AskUserToConfirm:xC({title:oL.$t({id:"BK8bb6",defaultMessage:[{type:0,value:"Send Message?"}]}),content:oL.$t({id:"tqrv6/",defaultMessage:[{type:0,value:"Your message contains some words or phrases that are defined as unwanted by a Chat Policy."}]}),okText:oL.$t({id:"9WRlF4",defaultMessage:[{type:0,value:"Send"}]}),onConfirm:()=>{t(!0)},onCancel:()=>{t(!1)}});break;case nz.BlockTheMessage:xC({title:oL.$t({id:"PNfAR6",defaultMessage:[{type:0,value:"Unable to Send Message"}]}),content:oL.$t({id:"mrGAFw",defaultMessage:[{type:0,value:"Your message contains some words or phrases that are prohibited by a Chat Policy and cannot be sent. Contact your account admin for more information."}]}),okText:oL.$t({id:"kAEQyV",defaultMessage:[{type:0,value:"OK"}]}),onConfirm:()=>{t(!1)},hideCancel:!0});break;case nz.NoAction:default:t(!0)}})})}let CS={user:"_user_12vy3_1",selected:"_selected_12vy3_10",info:"_info_12vy3_17",role:"_role_12vy3_17",hideBadgeOnHover:"_hideBadgeOnHover_12vy3_20",badge:"_badge_12vy3_20",isPending:"_isPending_12vy3_23",name:"_name_12vy3_33",blocked:"_blocked_12vy3_44",operations:"_operations_12vy3_49",operation:"_operation_12vy3_49",visible:"_visible_12vy3_73",hasOperations:"_hasOperations_12vy3_80",deactivatedName:"_deactivatedName_12vy3_86"},Ck=window.React.useCallback,CA=window.React.useState,CR=ex(function(e){let{className:t,data:a,showOps:n=!0,size:i="normal",isSelected:s=!1,onSelect:r,onAction:l,myRole:o,style:d,hidePopover:c=!1,portalContainer:u,hideBadgeOnHover:m=!1,channelId:p,chatType:h,ariaAttrs:y,isPending:v=!1,displayNameRenderer:_,prefixRenderer:b}=e,{jid:M,name:x,role:C}=a,{$t:j}=oA(),{presenceType:N}=bu(M),w=bA(M),I=bO(w),T=bL(M),E=bk(w),{handleAddContact:S,handleDeleteContact:k}=bI(),A=rS(M),{firstname:R,lastname:L,nickname:O,email:D}=w||{},[P,F]=CA(!1),B=rk(o),U=rR(o),H=rk(C),z=rA(C),V=rL(C),G=h===i1.MUC,{isBlocked:q}=ba,$=lT({firstname:R,lastname:L,nickname:O,email:D,name:x}),K=Ck(()=>{r&&r(M)},[r,M]),J=[{key:"ViewProfile",text:j({id:"Jkxa7F",defaultMessage:[{type:0,value:"View Profile"}]}),invisible:A,testKey:"viewProfile",separator:!0,operate(){bf.open({type:st.VIEW_PROFILE,options:{jid:M,email:a.email}})}},{key:"AssignAdmin",text:j({id:"JLHEZ9",defaultMessage:[{type:0,value:"Assign as Admin"}]}),invisible:v||!U||H||z||G,testKey:"assignAdmin",separator:!0,operate(){bf.open({type:st.ASSIGN_ADMIN,options:{jid:M,name:$,channelId:p}})}},{key:"UnassignAdmin",text:j({id:"IXKBiJ",defaultMessage:[{type:0,value:"Unassign as Admin"}]}),invisible:v||!U||H||!z||G,testKey:"unassignAdmin",separator:!0,operate(){bf.open({type:st.ASSIGN_ADMIN,options:{jid:M,name:$,channelId:p,revoke:!0}})}},{key:"RemoveMember",text:j({id:"G/yZLu",defaultMessage:[{type:0,value:"Remove"}]}),invisible:!U||H||A,testKey:"removeMember",operate(){bf.open({type:st.REMOVE_MEMBER,options:{jid:M,email:a.email,name:$,channelId:p,chatType:h}})}},{key:"DeleteContact",text:j({id:"62mqGj",defaultMessage:[{type:0,value:"Delete Contact"}]}),invisible:T||!E||!I,testKey:"deleteMemberContact",danger:!0,operate(){k({jid:M,email:D||"",name:$})}}],W=[{key:"RemoveMember",text:j({id:"G/yZLu",defaultMessage:[{type:0,value:"Remove"}]}),invisible:!B,testKey:"removeMember",operate(){bf.open({type:st.REMOVE_MEMBER,options:{jid:M,email:a.email,name:$,channelId:p,chatType:h,isApp:!0}})}}],Y=l3(()=>{switch(C){case i4.OWNER:return j({id:"zINlao",defaultMessage:[{type:0,value:"Owner"}]});case i4.ADMIN:return j({id:"iHN12u",defaultMessage:[{type:0,value:"Admin"}]});case i4.ANNOUNCER:return j({id:"t/CWO7",defaultMessage:[{type:0,value:"Announcer"}]});default:return""}},[C,j]),X=V?W:J,Q=!!X?.some(e=>!e.invisible),Z=l3(()=>V?g.jsx(_F,{className:CS.badge,children:j({id:"pyCXE9",defaultMessage:[{type:0,value:"APP"}]})}):g.jsx(_B,{className:CS.badge,userJid:M}),[V,M,j]);return g.jsxs("div",{...oI.Main.userItem($),...ld(K),"aria-label":$,...y,className:f(t,CS.user,sl.LIGHT,{[CS.large]:"large"===i,[CS.selected]:s,[CS.hideBadgeOnHover]:m,[CS.visible]:P}),style:d,children:[g.jsxs("div",{className:f(CS.info,{[CS.hasOperations]:n&&!A,[CS.isPending]:!!v}),children:[b?.()||null,g.jsx(M3,{popover:!c,userName:x,userJid:M,side:"large"===i?"right":"left",portalContainer:u,children:g.jsx(dO,{status:N,size:"sm",children:g.jsx(_L,{jid:M,name:$,image:w?.avatar,size:"sm"})})}),g.jsx("span",{className:f(CS.name,{[CS.deactivatedName]:T}),"aria-hidden":"true",children:_?.($)||$}),!!v&&g.jsxs("span",{className:CS.role,children:[" ",j({id:"PmVVN7",defaultMessage:[{type:0,value:"(Pending)"}]})]}),q(M)&&g.jsxs("span",{className:CS.blocked,children:["(",j({id:"qUJTsT",defaultMessage:[{type:0,value:"Blocked"}]}),")"]}),!!Y&&g.jsxs("span",{className:CS.role,children:["(",Y,")"]}),Z]}),n&&g.jsxs("div",{className:CS.operations,children:[E&&!T&&g.jsx("button",{"aria-label":j({id:"fB674g",defaultMessage:[{type:0,value:"chat "},{type:1,value:"chatName"}]},{chatName:x}),className:CS.operation,onClick:()=>{gK.startP2P({jid:M}),l?.()},children:g.jsx(ez,{})}),!E&&!T&&g.jsx("button",{"aria-label":j({id:"49eAFw",defaultMessage:[{type:0,value:"send contact request to "},{type:1,value:"chatName"}]},{chatName:x}),...oI.MoreActions.sendContactRequestBtn,className:CS.operation,onClick:()=>{S({jid:M,name:$,email:a.email})},children:g.jsx(nw,{})}),Q&&g.jsx(cQ,{side:"bottom",align:"start",options:X,onOpenChange:F,children:g.jsx("span",{...oI.MoreActions.userItemMoreBtn,"aria-label":j({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]}),className:CS.operation,tabIndex:0,children:g.jsx(nV,{"aria-hidden":"true"})})})]})]})}),CL={item:"_item_aaesa_1",selected:"_selected_aaesa_12",slashItemDescription:"_slashItemDescription_aaesa_16",groupItem:"_groupItem_aaesa_19",teamName:"_teamName_aaesa_30",teamIcon:"_teamIcon_aaesa_36",slashPrefix:"_slashPrefix_aaesa_48",slashItemHeader:"_slashItemHeader_aaesa_55"},CO=window.React.useState,CD=window.React.useRef;function CP(e){let{data:t=[],selectedIndex:a,onSelect:n}=e,[i,s]=CO(280),r=CD(null),l=t.length;return(l2(()=>{s(Math.min(40*l,280))},[l]),l2(()=>{r.current?.scrollToItem(a,"smart")},[a]),l2(()=>{if(t[a]){let e=t[a].label,n=`${e}, ${a+1} of ${l}`;sT(n)}},[l,t,a]),l)?g.jsx(nG,{ref:r,width:"100%",height:i,itemSize:40,itemCount:l,itemKey:e=>t[e].id,children:e=>{let{style:i,index:s}=e;switch(t[s].mentionType){case aw.channel:return g.jsx("div",{...oI.Mention.item(t[s].label),className:f(CL.item,{[CL.selected]:s===a}),style:{...i,lineHeight:"40px"},onClick:()=>n(s),children:g.jsxs("span",{"aria-hidden":"true",children:["#",t[s].label]})});case aw.mentionGroup:case aw.all:return g.jsxs("div",{...oI.Mention.item(t[s].label),className:f(CL.item,CL.groupItem,{[CL.selected]:s===a}),style:{...i,lineHeight:"40px"},onClick:()=>n(s),children:[g.jsx("div",{className:CL.teamIcon,children:g.jsx(nq,{})}),g.jsxs("div",{className:CL.teamName,children:[t[s].mentionType===aw.mentionGroup&&"@",t[s].label,void 0!==t[s].num&&`(${t[s].num})`]})]});case aw.user:return g.jsx(CR,{className:f(CL.item,{[CL.selected]:s===a}),style:i,data:{jid:t[s].id,name:t[s].label,role:0,joinTime:null},isSelected:s===a,showOps:!1,hidePopover:!0,onSelect:()=>n(s)});default:return null}}}):null}let CF=window.React.useState,CB=window.React.useRef,CU=window.React.useCallback;function CH(e){let{data:t=[],selectedIndex:a,onSelect:n}=e,i=t.length,[s,r]=CF(280),[l,o]=CF(!1),d=CB(null),c=CU(e=>0===e||t[e].appName!==t[e-1].appName?58:26,[t]);return(l2(()=>{let e=t.reduce((e,t,a)=>e+c(a),0);r(Math.min(e,280)),d.current?.resetAfterIndex(0)},[i,t,c]),l2(()=>{d.current?.scrollToItem(a,"smart")},[a]),l2(()=>{if(t[a]){let e=t[a].label,n=`${e}, ${a+1} of ${i}`;sT(n)}},[i,t,a]),i)?g.jsx(n$,{ref:d,width:"100%",height:s,itemSize:c,itemCount:t.length,itemKey:e=>t[e].id,children:e=>{let{style:i,index:s}=e,r=t[s],d=r.label.split(" "),c=[d.shift(),d.join(" ")];return g.jsxs("div",{onMouseMove:()=>{o(!0)},style:i,children:[(0===s||r.appName!==t[s-1].appName)&&g.jsxs("div",{className:CL.slashItemHeader,style:{height:"32px"},children:[g.jsx("div",{className:CL.avatar,children:g.jsx(_L,{size:"min",jid:r.appJid,image:r.picUrl,name:r.appName})}),r.appName]}),g.jsxs("div",{style:{lineHeight:"26px"},className:f(CL.item,{[CL.selected]:s===a}),onClick:()=>{n(s,!0)},onMouseEnter:()=>{l&&n(s,!1)},children:[g.jsx("span",{className:CL.slashPrefix,children:`${c[0]}`}),c[1]&&g.jsx("span",{children:` ${c[1]}`}),r.description&&g.jsx("span",{className:CL.slashItemDescription,children:` - ${r.description}`})]})]})}}):null}function Cz(e){return ex(t=>{let{message:a,innerRef:n,...s}=t,{$t:r}=oA(),{channelJid:l,deleteMessage:o,deleteReply:d,disposeFile:c}=y9(),{getImageState:u}=yw,{setCloudStorage:m}=CT,{message:p,mention:h,fontStyle:f,messageType:y}=a,v=y===i.mix,_=lE(a),b=function(e){let{fontStyle:t,mention:a,message:n}=e,i=oa(()=>aP((a||[]).filter(e=>e.type===aw.user&&e.start!==e.end).map(e=>e.jid)),[a]),s=bR(i);return i.length&&Object.keys(s).length?function(e,t){let{message:a,fontStyte:n=[],mention:i}=e,s=0,r=a,l=x(n),o=i?.filter(e=>{let{start:t,end:a}=e;return t!==a}).map(e=>{let{jid:a,start:n,end:i,type:o}=e,d=n+s,c=i+s;if(t[a]){let{nickname:e,firstname:n,lastname:i,email:u}=t[a],m=lT({nickname:e,firstname:n,lastname:i,email:u}),p=r.substring(d+1,c+1);if(m!==p){r=r.substring(0,d+1)+m+r.substring(c+1);let e=m.length-p.length;return s+=e,l.forEach(t=>{if(!A(t.startpos)||!A(t.endpos))return;let{startpos:a=0,endpos:n=0}=t;a>=c&&(t.startpos=a+e),n>=c&&(t.endpos=n+e)}),{jid:a,start:d,end:c+e,type:o}}}return{jid:a,start:d,end:c,type:o}});return{message:r,fontStyle:l,mention:o??[]}}({message:n,fontStyte:t,mention:a},s):e}(_?{message:"",mention:[],fontStyle:[]}:{message:p,mention:h,fontStyle:f}),M=y===i.mix?a.allFiles:[],C={...x(a),...b,isSending:!!v&&a.isSending},j=rd(M,u),N=uu(),w=aP([...N,...v?[]:[o8.file,o8.giphy]]),I=()=>yU.setIsEditing({id:a.id,isEditing:!1}),T=function(e,t){let{editTextMessage:a,editMixMessage:n}=yU;return s=>{let{textContent:{text:r,styleItems:l,mention:o},files:d}=s;switch(e.messageType){case i.text:{if(nK({text:e.message,styleItems:e.fontStyle||[],mention:e.mention||[]},{text:r,styleItems:l||[],mention:o||[]}))return t();let n={id:e.id,message:r,fontStyte:l,mention:o,originMsgXmlStr:e.messageXmlStr};a(n),t();return}case i.mix:{let{allFiles:a}=e,i=lE(e)?"":e.message,s=rm(a,d);if(nK({text:i,styleItems:e.fontStyle||[],mention:e.mention||[]},{text:r,styleItems:l||[],mention:o||[]})&&s)return t();let c={id:e.id,message:r,fontStyte:l,mention:o,originMsgXmlStr:e.messageXmlStr,files:d};n(c),t();return}default:return}}}(C,I),E=bE(),S=bH(l);return C.isEditing?g.jsx(ud,{textContent:{text:C.message,styleItems:C.fontStyle,mention:C.mention.filter(e=>e.start!==e.end)},defaultFiles:j,handleCloud:m,onWarning:E,disabled:!1,placeholder:r({id:"hQvHTH",defaultMessage:[{type:0,value:"Edit message..."}]}),onClose:I,onEdit:T,onMentionSearch:S,mentionSuggestionRender:CP,disabledFeatures:w,contentCheck:CE,giphyConfig:uY}):g.jsx(e,{...s,message:C,deleteMessage:o,deleteReply:d,disposeFile:c,ref:n})})}let CV={file:"_file_141oa_1",thirdPartyIcon:"_thirdPartyIcon_141oa_15",fileDetail:"_fileDetail_141oa_18",fileSize:"_fileSize_141oa_18",hoverTip:"_hoverTip_141oa_18",fileTip:"_fileTip_141oa_21",fileStatusIcon:"_fileStatusIcon_141oa_27",fileIcon:"_fileIcon_141oa_31",fileStatus:"_fileStatus_141oa_27",statusIcon:"_statusIcon_141oa_42",isSpinning:"_isSpinning_141oa_53",fileName:"_fileName_141oa_76",errorTip:"_errorTip_141oa_85",loading:"_loading_141oa_112",innerLoading:"_innerLoading_141oa_121",progressIcon:"_progressIcon_141oa_128"},{getExtension:CG,getFileIcon:Cq,getFileStatusIcon:C$,modifySize:CK,FileStatusIconMap:CJ,thirdPartyNameMap:CW,openThirdPartyLink:CY}=rj,CX={[i6.unsent]:"unsent",[i6.sending]:"sending",[i6.sended]:"sended",[i6.sendError]:"sendError",[i6.notDownload]:"notDownload",[i6.downloading]:"downloading",[i6.downloaded]:"downloaded",[i6.downloadError]:"downloadError",[i6.downloadErrorNotReady]:"downloadErrorNotReady",[i6.paused]:"paused"},CQ=ex(e=>{let{message:t,fileDetail:a,deleteMessage:n,deleteReply:i,disposeFile:s,ariaProps:r}=e,{$t:l}=oA(),{getFileState:o,setFileState:d,disposeFile:c,downloadFilesFile:u}=yw,m=t?.thirdStorageInfo,p=t?.file.fileId||a?.fileId,h=t?.file.fileName||a?.fileName,y=t?.file.size||a?.size||0,v=t?.file||a||null;if(!p||!h)return null;let _=o(p),b=_.status===i6.downloadErrorNotReady,M=Cq(CG(h)),x=CJ[i6.unsent],C=C$(_.status||0),j=[i6.sending,i6.downloading].includes(_.status),N=()=>{t&&(t.replyId?i?.({mainMsgId:t.replyId,msgId:t.id}):n?.(t.id))},w=e=>{let t=_.fileUrl;t?(lR(t,e.fileName),d({fileId:p,state:{status:i6.downloaded}})):u({fileId:p,fileName:h})},I=e=>{e?.stopPropagation(),_.status===i6.downloading?(c(p),d({fileId:p,state:{status:i6.notDownload}})):_.status===i6.sending&&(s?.(p),N())},T=()=>{let e=l({id:"DoeRUK",defaultMessage:[{type:0,value:"Click to Download"}]}),a=l({id:"PFtMy9",defaultMessage:[{type:0,value:"Canceled"}]});switch(_.status){case i6.sended:case i6.downloaded:case i6.notDownload:return g.jsxs("div",{className:CV.hoverTip,children:[" - ",e]});case i6.unsent:return g.jsxs(g.Fragment,{children:[" - ",a]});case i6.downloading:case i6.sending:{let e=_.progress??0;return g.jsxs(g.Fragment,{children:[g.jsx("div",{...oI.File.fileLoadingProgress,className:CV.loading,children:g.jsx("div",{style:{width:`${e}%`},className:CV.innerLoading})}),(!!t||_.status===i6.downloading)&&g.jsx(ae,{...oI.File.fileCancelBtn,style:{fontSize:"10px"},onClick:I,className:CV.progressIcon})]})}default:return null}};return g.jsxs("div",{...oI.File.file(h),className:CV.file,...ld(()=>{if(m){CY(m);return}[i6.notDownload,i6.downloaded,i6.sended,i6.downloadError,i6.downloadErrorNotReady].includes(_.status)&&v&&w(v)},!1,!0),"aria-label":l({id:"4INbP1",defaultMessage:[{type:0,value:"File selected, "},{type:1,value:"fileName"},{type:0,value:", "},{type:1,value:"fileSize"},{type:0,value:" Click to download"}]},{fileName:h,fileSize:CK(y)}),...r,children:[g.jsxs("div",{...oI.File.fileIcon,className:CV.fileStatusIcon,children:[g.jsx(M,{className:CV.fileIcon}),g.jsx("div",{...oI.File.fileStatus(CX[_.status]),className:CV.fileStatus,children:t?.thirdPartyType?g.jsx(x,{className:f(CV.statusIcon,CV.thirdPartyIcon)}):g.jsx(C,{className:f(CV.statusIcon,{[CV.isSpinning]:j})})})]}),g.jsxs("div",{className:CV.fileDetail,children:[g.jsx("div",{...oI.File.fileName,className:CV.fileName,children:h}),b&&!m?g.jsx("div",{className:CV.errorTip,children:l({id:"FNgKSl",defaultMessage:[{type:0,value:"File is still downloading. Try again later"}]})}):g.jsxs("div",{...oI.File.fileSize,className:CV.fileSize,children:[CK(y),(()=>{let e=t?.thirdPartyType;if(!e)return T();let a=CW[e],n=l({id:"L/gtLk",defaultMessage:[{type:0,value:"Click to open in "},{type:1,value:"thirdPartyName"}]},{thirdPartyName:a}),i=l({id:"ZH++ls",defaultMessage:[{type:0,value:"File from "},{type:1,value:"thirdPartyName"}]},{thirdPartyName:a});return g.jsxs(g.Fragment,{children:[g.jsxs("span",{...oI.File.fileThirdStorageTag,className:CV.fileTip,children:["- ",i]}),g.jsxs("span",{className:CV.hoverTip,children:["- ",n]})]})})()]})]})]})}),CZ={image:"_image_1xqxh_1",imgPlaceholder:"_imgPlaceholder_1xqxh_38",errorPlaceholder:"_errorPlaceholder_1xqxh_48",icon:"_icon_1xqxh_48",errorTip:"_errorTip_1xqxh_52"},C1=ex(function(e){let{imageId:t,msgId:a,preview:n=!0,isMix:i,mixImgIndex:s,ariaProps:r}=e,{$t:l}=oA(),{getImageState:o,getIsImageLoaded:d}=yw,c=function(e){let{message:t}=yU,{isPMC:a}=gQ,n=t(e)?.channelJid;return a(n??"")}(a),u=d({fileId:t}),m=o(t),{targetRef:p,handleLoad:h}=Md({fileId:t,msgId:a,isHQ:c}),f=function(){return _Y(_Q)}();return[sZ.loadErrorNotReady,sZ.loadError].includes(m.loadingStatus)?g.jsxs("div",{className:CZ.errorPlaceholder,children:[g.jsx("div",{className:CZ.imgPlaceholder,onClick:h,children:g.jsx(nH,{className:CZ.icon})}),m.loadingStatus===sZ.loadErrorNotReady&&g.jsx("div",{className:CZ.errorTip,children:l({id:"b3U0LY",defaultMessage:[{type:0,value:"Unable to download the image in this chat at this time"}]})})]}):u?g.jsx("div",{className:CZ.image,"data-image":t,...ld(()=>{n&&f({messageId:a,isMix:i,mixImgIndex:s})},!1,!0),"aria-label":l({id:"iEBf+N",defaultMessage:[{type:0,value:"Image, "},{type:1,value:"fileName"},{type:0,value:" selected"}]},{fileName:m.fileName}),...r,children:g.jsx(e4,{className:CZ.loading,loading:m.isSending,children:g.jsx("img",{src:m.message})})}):g.jsx("div",{className:CZ.imgPlaceholder,ref:p,"aria-label":l({id:"vMB48v",defaultMessage:[{type:0,value:"Image, "},{type:1,value:"fileName"},{type:0,value:" loading"}]},{fileName:m.fileName}),...r,children:g.jsx(e4,{loading:!0})})}),C0={deepLink:"_deepLink_avxe5_1",isLoading:"_isLoading_avxe5_11",foldIcon:"_foldIcon_avxe5_36",linkType:"_linkType_avxe5_41",linkIcon:"_linkIcon_avxe5_44",channelName:"_channelName_avxe5_49",chatName:"_chatName_avxe5_59",name:"_name_avxe5_66",chatDetail:"_chatDetail_avxe5_73",image:"_image_avxe5_85"},C2=window.React.useCallback,C5=ex(function(e){let{msgId:t,fileId:a}=e,{targetRef:n}=Md({msgId:t,fileId:a}),{getImageState:i}=yw,s=i(a)?.message;return s?g.jsx("div",{className:C0.image,children:g.jsx("img",{src:s})}):g.jsx("div",{ref:n})}),C3=ex(function(e){let{fontStyle:t}=e,{firstAvailableDeepLink:a}=function(e){let{fontStyle:t}=e,[a,n]=o_([]),[,i]=o_([]),{message:s,fetchMsgByTimes:r}=yU,{isPublic:l,checkPublic:o,isJoined:d}=gQ,c=C2(e=>d(e)||!rT(e)&&!rS(e),[d]),u=oa(()=>t.reduce((e,t)=>{let{type:a,reserve1:n}=t,i=lW(n||"");return 4096===a&&n&&i?e.set(n,i):e},new Map),[t]);oe(()=>{[...u.values()].forEach(e=>{c(e.sid)&&e.mid&&e.time&&!i.hasItem(e.mid)&&!n.hasItem(e.mid)&&!s(e.mid)&&(n.addItem(e.mid),r({params:{session:e.sid,msgTimes:[e.time]},onAction(t){e.mid&&(n.removeItem(e.mid),t.find(t=>t.id===e.mid)||i.addItem(e.mid))}}))})},[u,i,n,r,s,c]),oe(()=>{[...u.values()].forEach(e=>{e.sid&&!d(e.sid)&&o(e.sid)})},[u,d,o]);let m=[...u.entries()].map(e=>{let[t,n]=e,i=c(n.sid),r=s(n.mid||""),o=n.mid&&a.has(n.mid),d=l(n.sid);switch(!0){case!n.sid:case!i&&!d:return{link:t,isHideDetail:!0};case!i&&d:return{link:t,isChannel404:!0};case!!o:return{link:t,isLoading:!0};case!!n.mid&&!r:return{link:t,isMessage404:!0,chatId:n.sid};case!!i&&!n.mid:case!!i&&!!r:return{link:t,chatId:n.sid,message:n.mid?r:void 0};default:return{link:t,isHideDetail:!0}}}),p=m.find(e=>{let{isChannel404:t,isMessage404:a,isHideDetail:n,isLoading:i}=e;return!t&&!a&&!n&&!i})||m.find(e=>{let{isLoading:t}=e;return t})||m.find(e=>{let{isMessage404:t}=e;return t})||m.find(e=>{let{isChannel404:t}=e;return t})||null;return{firstAvailableDeepLink:p}}({fontStyle:t}),{isMessage404:n,isHideDetail:s,isLoading:r,chatId:l,message:o}=a||{},[d,,,c]=om(!0),{$t:u}=oA(),{sessionType:m,name:p,isPublic:h}=b2(l??""),{senderJid:y,senderName:v}=o||{},_=bA(y),b=lT(_||{name:v||""}),M=oa(()=>l?o||n?"message":ya(m)?"muc":yn(m)&&h?"publicChannel":yn(m)&&!h?"privateChannel":null:null,[o,l,n,h,m]),x={message:{icon:g.jsx(ez,{}),text:u({id:"R7x0mX",defaultMessage:[{type:0,value:"Chat Message"}]})},muc:{icon:g.jsx(nJ,{}),text:u({id:"WTrOy3",defaultMessage:[{type:0,value:"Chat"}]})},publicChannel:{icon:g.jsx(eU,{}),text:u({id:"zCG0Yw",defaultMessage:[{type:0,value:"Public Channel"}]})},privateChannel:{icon:g.jsx(nW,{}),text:u({id:"u2QZlZ",defaultMessage:[{type:0,value:"Private Channel"}]})}},C=oa(()=>o?o.messageType===i.bot?o.botTemplate.name:b:null,[o,b]),j=oa(()=>{if(!o)return null;switch(o.messageType){case i.codeSnippet:case i.file:return o.file?.fileName;case i.image:case i.screenshot:case i.giphy:case i.unknown:case i.call:case i.bot:return null;case i.mix:if(o?.failureBody!==1)return o.message;return null;default:return o.message}},[o]),N=oa(()=>{if(!o)return null;switch(o.messageType){case i.image:case i.screenshot:return o.file.fileId;default:return null}},[o]);return r?g.jsx("div",{className:f(C0.deepLink,C0.isLoading)}):s||!M?null:g.jsxs("div",{className:C0.deepLink,children:[g.jsx(dj,{className:C0.foldIcon,size:"small",type:"text",onClick:c,icon:d?g.jsx(nk,{}):g.jsx(e9,{})}),g.jsxs("div",{...oI.Main.deepLinkType,className:C0.linkType,children:[g.jsx("span",{className:C0.linkIcon,children:x[M].icon}),x[M].text]}),(()=>d?n?g.jsx("div",{className:C0.chatName,children:u({id:"OTocct",defaultMessage:[{type:0,value:"Message cannot be found"}]})}):o?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:C0.chatName,children:[g.jsx("span",{...oI.Main.deepLinkTitle,className:C0.name,children:C}),`(${oY(o.time)})`]}),g.jsx("div",{...oI.Main.deepLinkDetail,className:C0.chatDetail,children:j}),!!N&&g.jsx(C5,{msgId:o.id,fileId:N})]}):g.jsx("div",{...oI.Main.deepLinkTitle,className:C0.channelName,children:p}):null)()]})}),C6={extraDetail:"_extraDetail_7unem_1",titleImage:"_titleImage_7unem_9",linkContent:"_linkContent_7unem_23",linkName:"_linkName_7unem_27",linkDetail:"_linkDetail_7unem_32",linkAddress:"_linkAddress_7unem_38",linkIcon:"_linkIcon_7unem_46"},C4=window.React.createElement,C8=ex(function(e){let{message:t}=e,a=MS(t);return a.length?g.jsx(g.Fragment,{children:a.map((e,t)=>{let{loadDone:a,imageUrlV2:n,faviconV2:i}=e;return C4("div",{...oI.Main.linkPreviewDetail,className:C6.extraDetail,key:t},g.jsx("div",{className:C6.titleImage,children:!!a&&!!n&&g.jsx("img",{src:n,alt:""})}),g.jsxs("div",{className:C6.linkContent,children:[g.jsx("div",{className:C6.linkName,children:e.title}),g.jsx("div",{className:C6.linkDetail,children:e.description}),g.jsxs("div",{className:C6.linkAddress,children:[!!a&&!!i&&g.jsx("img",{className:C6.linkIcon,src:i,alt:""}),g.jsx("span",{children:e.siteName})]})]}))})}):null}),C7=window.React.useState;function C9(e){let{isJoined:t,isPublic:a}=gQ,[n]=C7(Date.now()),i=e.filter(e=>e.type===aw.channel&&!t(e.jid)).map(e=>e.jid);return!function(e){let{isChecked:t,checkPublicBatch:a}=gQ,n=e.filter(e=>!t(e));l2(()=>{n.length&&a(n)},[])}(i),oa(()=>e.filter(e=>e.start!==e.end&&(e.type!==aw.channel||t(e.jid)||a(e.jid))).map((e,t)=>({...e,key:`${t}-${e.jid}-${n}`})),[e,t,a,n])}function je(e){let{id:t}=e,a=vv(),n=a?.topPin;if(!n)return{isPinned:!1,pinner:null};let{msgId:i,pinner:s}=n;return{isPinned:i===t,pinner:s}}let jt={text:"_text_13jk6_1",textHead:"_textHead_13jk6_8",textDetail:"_textDetail_13jk6_13",foldArrow:"_foldArrow_13jk6_16",popContainer:"_popContainer_13jk6_22",textPop:"_textPop_13jk6_25",textContent:"_textContent_13jk6_34",hasLinkDetail:"_hasLinkDetail_13jk6_41",preview:"_preview_13jk6_44",previewText:"_previewText_13jk6_47",isPinned:"_isPinned_13jk6_53",highlight:"_highlight_13jk6_56"},ja=window.React.forwardRef,jn=window.React.useCallback,ji=window.React.useState,js=window.ReactDOM.createPortal,jr=ex(ja(function(e,t){let{message:a,moreActionsRender:n=null,linkPreviewAvailable:i}=e,{$t:s}=oA(),r=function(e){let{fontStyle:t}=e;return!!t.find(e=>{let{type:t,reserve1:a}=e,n=lW(a||"");return 4096===t&&a&&n})}(a),{message:l}=yU,{isPinned:o}=je({id:a.id}),{isMicro:d,joinMeeting:c}=Mu(),{isJoined:u,isPublic:m}=gQ,p=function(e){let t=l3(()=>e.filter(e=>e.type===aw.mentionGroup).map(e=>e.jid),[e]),a=function(e){let{mentionMembers:t,mentionMemberDetail:a,fetchMentionGroupMembers:n}=yE;return oe(()=>{e.forEach(e=>{let t=a(e);t||n(e)})},[a,e,n]),oa(()=>new Map(e.map(e=>[e,t(e).some(e=>rS(e))])),[t,e])}(t);return l3(()=>e.map(e=>{switch(e.type){case aw.all:return{...e,highlight:!0};case aw.user:return{...e,highlight:rS(e.jid)};case aw.mentionGroup:return{...e,highlight:!!a.get(e.jid)};default:return e}}),[e,a])}(C9(a.mention||[])),h=MS(a),[y,,,v]=om(!0),{settings:_}=g4,b=i&&_.showLinkPreview&&!!h?.length;eC();let M=e=>{let t=lW(e);if(!t)return o2.error(s({id:"N7Ba9L",defaultMessage:[{type:0,value:"This link is broken. Contact the person who sent it to you to request a new link."}]}));let{sid:a,mid:n,time:i}=t,r=!rT(a);if(u(a)&&!r)yf({jid:a});else{if(!r)return m(a)?void bf.open({type:st.PREVIEW_CHANNEL,options:{channelId:a}}):o2.error(s({id:"GSpU6c",defaultMessage:[{type:0,value:"The channel cannot be found. Contact the person who sent you the link for more information."}]}));if(!n||!i)return;let e=l(n);if(!e||rS(a)){o2.error(s({id:"lGJ/Wv",defaultMessage:[{type:0,value:"The message cannot be found. Contact the person who sent you the link for more information."}]}));return}yf({jid:a,type:i1.CHAT}),oz.dispatch(oH.jumpToMessage,{chatId:a,msgId:n,sendTime:i,mainMsgId:e.replyId})}if(!n||!i)return;let o=l(n);o?oz.dispatch(oH.jumpToMessage,{chatId:a,msgId:n,sendTime:i,mainMsgId:o.replyId}):o2.error(s({id:"lGJ/Wv",defaultMessage:[{type:0,value:"The message cannot be found. Contact the person who sent you the link for more information."}]}))},x=e=>{let{type:t,id:a,label:n,mentionType:i}=e.target.dataset;if("mention"===t&&a)switch(Number(i)){case aw.channel:u(a)?yf({jid:a,type:i1.CHANNEL}):bf.open({type:st.PREVIEW_CHANNEL,options:{channelId:a,channelName:n}});return;case aw.mentionGroup:case aw.all:case aw.user:default:return}},C=e=>{let t=e.target.getAttribute("href");if(t){if(lJ(t??""))e.preventDefault(),M(t??"");else if(d){let a=ln(t??"");if(!a)return;e.preventDefault(),c(a)}}},j=l3(()=>g.jsx("span",{...ld(v),className:jt.foldArrow,"aria-label":s({id:"Fr6/ZL",defaultMessage:[{type:0,value:"show or hide link preview"}]}),children:y?g.jsx(nk,{...oI.Main.foldLinkPreview}):g.jsx(e9,{...oI.Main.unfoldLinkPreview})}),[y,v,s]),[N,w]=ji(null),I=jn(()=>{w(p.map(e=>{let t=document.querySelector(`[data-message-id="${a.id}"] [data-key="${e.key}"]`);if(!t)return null;switch(e.type){case aw.mentionGroup:return js(g.jsx(MH,{mentionId:e.jid,className:jt.textPop},e.key),t);case aw.user:return js(g.jsx(M5,{containerClassName:jt.popContainer,userJid:e.jid,side:"top",children:g.jsx("span",{className:jt.textPop})},e.key),t);default:return null}}))},[w,p,a.id]);return g.jsxs("div",{className:jt.text,children:[g.jsxs("div",{className:jt.textHead,children:[g.jsxs("div",{className:jt.textDetail,children:[N,g.jsx(nY,{ref:t,className:f(jt.textContent,{[jt.hasLinkDetail]:b,[jt.isPinned]:o,[jt.highlight]:rS(a.senderJid)}),onTextChanged:I,onClick:e=>{e.stopPropagation(),x(e),C(e)},content:{text:a.message,styleItems:a.fontStyle,mention:p},mentionHighlight:e=>!!e.highlight}),b&&j]}),n]}),b&&y&&g.jsx(C8,{message:a}),r&&g.jsx(C3,{fontStyle:a.fontStyle})]})})),jl={mix:"_mix_haz7o_1",mixItem:"_mixItem_haz7o_4",loading:"_loading_haz7o_13",fileContainer:"_fileContainer_haz7o_22",imageContainer:"_imageContainer_haz7o_30"},jo=window.React.forwardRef,jd=ex(jo(function(e,t){let{message:a,moreActionsRender:n=null,linkPreviewAvailable:i,deleteMessage:r,deleteReply:l,disposeFile:o}=e,{$t:d}=oA(),{allFiles:c}=a,u=c.filter(e=>rp(e.fileType||s.OtherFile)),m=c.filter(e=>rf(e.fileType||s.OtherFile)),p=g.jsxs(g.Fragment,{children:[a.isSending&&g.jsx("div",{className:jl.loading,children:g.jsx(e4,{loading:!0})}),n]}),h={text:{isShow:a?.failureBody!==1&&!!a.message,render:()=>g.jsx(jr,{message:a,ref:t,linkPreviewAvailable:i,moreActionsRender:p})},file:{isShow:!!m.length,render:()=>g.jsx(dE,{className:jl.fileContainer,"aria-label":d({id:"HPLTeo",defaultMessage:[{type:0,value:"Message file container, press arrow key to select files"}]}),dataList:m,keyedBy:e=>e.fileId,dataRender:(e,t)=>g.jsx(CQ,{fileDetail:e,deleteMessage:r,deleteReply:l,disposeFile:o,ariaProps:t})})},image:{isShow:!!u.length,render:()=>g.jsx(dE,{className:jl.imageContainer,"aria-label":d({id:"qkeJsl",defaultMessage:[{type:0,value:"Message image container, press arrow key to select images"}]}),dataList:u,keyedBy:(e,t)=>`${e.fileId}_${t}`,dataRender:(e,t,n)=>g.jsx(C1,{imageId:e.fileId,msgId:a.id,isMix:!0,mixImgIndex:n,ariaProps:t})})}};return g.jsx("div",{className:jl.mix,children:Object.entries(h).filter(e=>{let[,t]=e;return t.isShow}).map((e,t)=>{let[a,{render:n}]=e;return g.jsxs("div",{className:jl.mixItem,children:[n(),0===t&&"text"!==a&&p]},a)})})}));function jc(){let{channelJid:e}=y9(),t=MA.mcpMap.get(e);return!d([nx.hostAndCoHosts,nx.noOne],t)}let ju=window.React.useState,jm=ex(e=>{let{emojiSkinTone:t,voteList:a,handleEmojiClick:n,handleMoreClick:i}=e,[s,r]=ju([]),{latestFrqEmoji:l}=nX(da);return l2(()=>{nQ.fetchResource().then(()=>{let{emojiMetaSet:e,emojiSet:a,emojiCodeSet:n}=nQ.resourceSet;if(e&&a&&n){let i=[],s={...l.current,...e};for(let e in s){let r=s[e].code_points.base;""!==t&&s[e].diversities.length>0&&(r=nZ(s[e],t)),i.push({...s[e],emoji:n[r],baseCode:r,src:a[r]})}i.sort((e,t)=>e.order-t.order),i.splice(6),r(i)}}).catch(e=>{console.error(e)})},[t,l]),g.jsxs("div",{className:"_baseEmojiReaction_1rrnp_1",onKeyDown:lr(),children:[g.jsx("div",{className:"_reactionList_1rrnp_13",children:s?.map((e,t)=>g.jsx("button",{className:f("_reactionImg_1rrnp_25",{_reactionActive_1rrnp_50:a.find(t=>t.emoji===e.emoji&&t.haveIEmojied)}),onClick:()=>{n(e)},children:g.jsx("img",{src:e.src,alt:e.shortname})},t))}),g.jsx("button",{className:"_reactionMoreBtn_1rrnp_54",onClick:i,children:g.jsx(nV,{})})]})}),jp={moreOptions:"_moreOptions_1qihp_1",icon:"_icon_1qihp_11",disabled:"_disabled_1qihp_39",isShow:"_isShow_1qihp_47",reactionEmojiPicker:"_reactionEmojiPicker_1qihp_55",popover:"_popover_1qihp_65"},jh=window.React.useState,jf=ex(function(e){let{message:t,onPopoverOpenChange:a,...n}=e,{$t:i}=oA(),{emojiSkinTone:s,setEmojiSkinTone:r}=dn,[l,o]=jh(null),d=eC(),c=()=>{o("reaction")},u=()=>{o("picker")},m=()=>{o(null)},p=_5(),h=t.emojiVotes,y=e=>{a(!1);let n=e.emoji??"";if(!n)return;let i=t.emojiVotes?.[n]?.haveIEmojied,s=i?nu.remove:nu.add;p(t,n,s,g2.currentUser.jid),m()};return g.jsx(cc,{open:!!l,content:d&&(()=>{switch(l){case"reaction":return g.jsx(jm,{emojiSkinTone:s,voteList:oU(h),handleEmojiClick:y,handleMoreClick:u});case"picker":return g.jsx("div",{className:jp.reactionEmojiPicker,children:g.jsx(n1,{frqUniqId:da,onPick:y,skinTone:s,onSkinToneChange:r,crossOrigin:"anonymous"})});default:return null}})(),trigger:"picker"===l?"click":"hover",side:"top",align:"center",className:jp.popover,onOpenChange:e=>{a(e),e?c():m()},children:g.jsx("button",{...n,className:f(jp.icon,{[jp.disabled]:!d}),"aria-label":i({id:"34NuzG",defaultMessage:[{type:0,value:"Emoji"}]}),disabled:!d,children:g.jsx(sB,{})})})}),jg=window.React.useState,jy=window.React.useCallback,jv="data-more-option",j_=ex(function(e){let{dropDownMenuItems:t,replyVisible:a=!0,emojiVisible:n=!0,disabled:i=!1,className:s,message:l}=e,{$t:o}=oA(),{openEditor:d}=b7(l),[c,u]=jg(!1),[m,p]=jg(!1),{channelJid:h}=y9(),y=jc(),v=bL(h),_=ba.isBlocked(h),b=l3(()=>sM.create(h),[h]),M=jy(()=>{d(),de.getReplyEditor(l.replyId||l.id)?.current?.focus(),requestAnimationFrame(()=>{b.scrollToReplyInput(l.replyId||l.id)})},[d,b,l]);if(i)return null;let x=y&&!v&&!_;return g.jsx(dE,{[jv]:!0,className:f(jp.moreOptions,s,{[jp.isShow]:m||c}),dataList:r([x&&a&&"reply",x&&n&&uc(o4.emoji)&&"emoji","more"]),keyedBy:e=>e,dataRender:(e,a)=>{switch(e){case"reply":return g.jsx("div",{children:g.jsx("button",{...oI.Main.msgReplyBtn,className:jp.icon,onClick:M,"aria-label":o({id:"9HU8vw",defaultMessage:[{type:0,value:"Reply"}]}),...a,children:g.jsx(sF,{})})});case"emoji":return g.jsx("div",{children:g.jsx(jf,{...oI.Main.msgEmojiBtn,message:l,onPopoverOpenChange:p,...a})});case"more":return g.jsx("div",{children:g.jsx(_g,{items:t,open:c,onOpenChange:u,children:g.jsx("button",{...oI.Main.msgMoreBtn,className:jp.icon,"aria-label":o({id:"Ntr8Pk",defaultMessage:[{type:0,value:"More Option"}]}),...a,children:g.jsx(nV,{})})})})}}})}),jb=ex(function(){let{$t:e}=oA();return g.jsx("div",{className:"_pmcDisabled_wlafa_1",children:e({id:"Kre2aK",defaultMessage:[{type:0,value:"You can't view this content."}]})})});function jM(){let{$t:e}=oA();return g.jsxs("div",{className:CN.unknown,children:[g.jsx(nH,{className:CN.icon}),e({id:"XeIT3L",defaultMessage:[{type:0,value:"Unsupported type of message"}]})]})}let jx=eb.object({title:eb.object({text:eb.string()}),height:eb.number(),width:eb.number(),hideApp:eb.boolean(),hideTitle:eb.boolean()}),jC=eb.object({actionId:eb.string(),label:eb.string(),icon:eb.string(),action:eb.string(),dialog:jx.optional()}),jj=eb.object({robotJid:eb.string(),robotName:eb.string(),robotIcon:eb.string(),modifyTime:eb.number(),isFront:eb.boolean(),group:eb.string(),allowedDomains:eb.string().optional(),appFeatures:eb.number(),homeUri:eb.string().optional(),shortcuts:eb.object({message:eb.object({actions:eb.array(jC)}).optional(),compose:eb.object({actions:eb.array(jC)}).optional()})}),jN=new URL(window.pwaChatConfig.mpCdnURL).origin,jw=e_().schema(()=>({apps:eb.array(jj)})).views(e=>{function t(){return e.apps.find(e=>{let{robotJid:t}=e;return t===window.pwaChatConfig.appAllowMap?.ZOOM_IQ})}function a(){return t()?.shortcuts.compose?.actions.find(e=>{let{actionId:t}=e;return"compose"===t})}function n(){return t()?.shortcuts.message?.actions.find(e=>{let{actionId:t}=e;return"reply"===t})}return{get zoomIQ(){return t()},get smartComposeAction(){return a()},get smartComposeEnabled(){return!!window.pwaChatConfig.isIMSmartChatComposeEnabled&&!!a()},get smartReplAction(){return n()},get smartReplyEnabled(){return!!window.pwaChatConfig.isIMSmartChatComposeEnabled&&!!n()}}}).mutations(e=>({setAppInfo(t){t&&(e.apps=t.chatAppsInfo.map(e=>{let{robotIcon:t,...a}=e;return{...a,robotIcon:jN+t}}))}})).effects((e,t)=>{let{sdk:a}=t;return{fetchInstalledChatAppInfo:t=>t.pipe(am(()=>a.query.fetchInstalledChatAppInfo().pipe(J(()=>K),ah(t=>e.setAppInfo(t)))))}}).create({apps:[]},{sdk:uW});jw.fetchInstalledChatAppInfo();let jI=window.React.forwardRef,jT="data-smart-reply-anchor",jE=ex(jI(function(e,t){let{threadId:a,...n}=e,{smartReplyEnabled:i}=jw;return i?g.jsx("div",{...n,[jT]:a,ref:t}):null})),jS=window.React.forwardRef,jk=jS(function(e,t){let{robotIcon:a,...n}=e;return g.jsx("button",{...n,ref:t,className:"_icon_1ylkj_1",children:g.jsx("img",{alt:"App Icon",src:a})})}),jA={popover:"_popover_1n30c_1",title:"_title_1n30c_5"},jR=ex(function(e){let{open:t,onOpenChange:a,editorRef:n,anchor:i,dialogConfig:s,robotIcon:r,alignOffset:l,children:o,getMsgContent:d,...c}=e,{$t:u}=rV(),[m,p,h]=om(!1),{title:f,width:y,height:v}=s??{},_=f?.text,b=()=>{a(!1)},{loading:M,size:x,needConfirmation:C,closeIframe:j,openIframe:N,renderIframe:w}=xO({editorRef:n,defaultSize:{width:y,height:v},getMsgContent:d,onCloseEvent:b}),I=()=>{N(c)};l2(()=>{t?I():j()},[t]);let T=g.jsx(xb,{visible:m,title:u({id:"aS7Fag",defaultMessage:[{type:0,value:"Discard Generated Text"}]}),okDanger:!0,okText:u({id:"nmpevl",defaultMessage:[{type:0,value:"Discard"}]}),onOk:()=>{b(),h()},onCancel:h,children:u({id:"H5qLAD",defaultMessage:[{type:0,value:"Are your sure you want to discard this generated text? This action cannot be undone."}]})}),E=g.jsxs("div",{children:[!!_&&g.jsxs("div",{className:jA.title,style:{maxWidth:x.width},children:[g.jsx("img",{src:r}),g.jsx("span",{children:_}),g.jsx(dj,{size:"small",type:"text",icon:g.jsx(n0,{}),onClick:b})]}),g.jsx(e4,{loading:M,children:w()}),T]});return g.jsx(cc,{align:"start",side:"top",alignOffset:l,open:t,onOpenChange:a,content:E,className:jA.popover,anchorDomNode:i,onInteractOutside:e=>{C()&&(e.preventDefault(),p())},children:o})}),jL=ex(function(e){let{open:t,onOpenChange:a,editorRef:n,anchor:i,msgContent:s,sessionId:r,threadId:l,messageId:o}=e,{zoomIQ:d,smartReplAction:c,smartReplyEnabled:u}=jw,{homeUri:m,robotIcon:p}=d??{},{actionId:h,dialog:f}=c??{},y={of:"shortcutInMessage",open_from:"shortcutInMessage",typ:rT(r)?"channel":"chat",session_id:r,thread_id:l,message_id:o};return u&&m&&h?g.jsx(jR,{open:t,onOpenChange:e=>{a?.(e),e||(uX.enableBlur(),n.current?.focus())},getMsgContent:()=>s,editorRef:n,anchor:i,dialogConfig:f,robotIcon:p,homeUri:m,actionId:h,headers:y,injectTheme:!0,injectHistory:!0,injectCrossOrigin:!0,replaceNonce:!0}):null}),jO=function(e){let t=ee(()=>{let e=document.createElement("div");return document.body.appendChild(e),e});return a=>{function n(n){let s={...a,open:n,onOpenChange:i};xA.render(g.jsx(oD,{children:g.jsx(e,{...s})}),t())}function i(e){n(e)}n(!0)}}(jL),jD=e=>{jO({...e,anchor:function(e){return document.querySelector(`[${jT}="${e}"]`)}(e.threadId)})};function jP(){let e=es().startOf("day").add(1,"day");return new Date(e.format())}function jF(){let e=es().add(5,"minute").startOf("minute");return new Date(e.format())}function jB(){let e=es().add(90,"day").startOf("minute");return new Date(e.format())}function jU(e){let t=es(e).startOf("day"),a=es(e).hour(),n=es(e).minute();return{date:new Date(t.format()),time:[a,n]}}function jH(e){let{date:t,time:[a,n]}=e,i=es(t).startOf("day").add(a,"hour").add(n,"minute");return new Date(i.format())}let jz=window.React.useCallback,jV=(e,t)=>{let{$t:a}=oA(),{openCustomReminder:n,setReminder:i}=yV,s=jz(a=>{e&&i({msg:e,note:"",time:a,ifHideToast:t})},[t,i,e]);return e?[[{text:a({id:"h1e37g",defaultMessage:[{type:0,value:"In "},{type:1,value:"count"},{type:0,value:" minutes"}]},{count:30}),key:"remindMe30Min",operate:()=>{let e=es().add(30,"minute").valueOf();s(e)}},{text:a({id:"/qJpQY",defaultMessage:[{type:0,value:"In 1 hour"}]}),key:"remindMe1hour",operate:()=>{let e=es().add(1,"hour").valueOf();s(e)}},{text:a({id:"XhWMaa",defaultMessage:[{type:0,value:"In "},{type:1,value:"count"},{type:0,value:" hours"}]},{count:3}),key:"remindMe3hours",operate:()=>{let e=es().add(3,"hour").valueOf();s(e)}},{text:a({id:"UGYuI7",defaultMessage:[{type:0,value:"Tomorrow at 9 AM"}]}),key:"remindMe9Tomorrow",operate:()=>{let e=(function(){let e=es().startOf("day").add(1,"day").add(9,"hour");return new Date(e.format())})().valueOf();s(e)}},{text:a({id:"YQwCuT",defaultMessage:[{type:0,value:"Next Monday at 9 AM"}]}),key:"remindMeNxtMon",operate:()=>{let e=(function(){let e=es().startOf("week").add(1,"week").add(9,"hour");return new Date(e.format())})().valueOf();s(e)}}],[{text:a({id:"Sjo1P4",defaultMessage:[{type:0,value:"Custom"}]}),key:"remindMeCustom",operate:()=>n({message:e,ifHideToast:t})}]]:[]};function jG(e,t){let{getImageState:a,getFileState:n,getCodeSnippetState:s}=yw;switch(e.messageType){case i.text:case i.bot:t.current&&rX.copyRichText(t.current);return;case i.image:{let t=a(e.file.fileId).message;if(!t)return;s5(e.file.fileName)?rX.copyGif(t):rX.copyImage(t);return}case i.giphy:{let t=a(e.id).message;if(!t)return;rX.copyGif(t);return}case i.file:{let t=n(e.file.fileId).file,a=e.thirdStorageInfo;if(a){let{previewLink:e,previewPath:t}=a,n=ry(e,t);rX.copyText(n);return}if(!t||!(t instanceof File))return;rX.copyFile(t);return}case i.mix:rX.copyMix({element:t.current,files:rc(e.allFiles,{getImageState:a,getFileState:n})});return;case i.call:{let t=e.callInfo?.raw.meetingNo;if(!t)return;let a=`${li()}/j/${t}`;rX.copyText(a);return}case i.codeSnippet:{let t=e.file?.fileId,a=s(t).codeSnippet?.code;a&&rX.copyText(a);return}default:return}}let jq=window.React.useCallback;function j$(e){let{topPin:t,pinMessage:a,unpinMessage:n,openConfirm:i,removeFromPinList:s}=vv();return{onPin:()=>{if(!e)return;let{channelJid:n,id:s,time:r,replyId:l,replyThreadTime:o}=e,d={channelJid:n,msgId:s,msgTimestamp:r,mainMsgId:l||s,mainMsgTimestamp:o||r};t?i({confirmType:vd.REPLACE,onConfirm:()=>a(d)}):a(d)},onUnpin:()=>{if(!t)return;let{channelJid:e,msgId:a,msgTimestamp:s}=t;i({confirmType:vd.UNPIN,onConfirm:()=>n({channelJid:e,id:a,msgTimestamp:s})})},onRemoveFromPinList:()=>{if(!e)return;let{channelJid:a,id:n,time:r}=e,l=n===t?.msgId;i({confirmType:l?vd.UNPIN_REMOVE:vd.REMOVE,onConfirm:()=>s({channelJid:a,id:n,msgTimestamp:r})})}}}function jK(e){let t=!!e.meetChat,a=e.meetChat?.isSupportPMCSync?[i.mix,i.giphy]:[i.file,i.image,i.mix,i.giphy];return t&&a.includes(e.messageType)}function jJ(e){let{fileStateMap:t,imageStateMap:a,codeSnippetStateMap:n,getIsImageLoaded:s}=yw;return{isLoading:(e=>{switch(e.messageType){case i.image:{let t=e.file.fileId;return!s({fileId:t})}case i.giphy:{let t=e.id;return!s({fileId:t})}case i.codeSnippet:{let t=e.file.fileId;return!n.get(t)?.codeSnippet}default:return!1}})(e),isSending:(e=>{switch(e.messageType){case i.file:{let a=e.file?.fileId||"";return!!e.isSending||t.get(a)?.status===i6.sending}case i.image:{let t=e.file.fileId;return!!a.get(t)?.isSending}case i.giphy:{let t=e.id;return!!a.get(t)?.isSending}case i.mix:return!!e.isSending;default:return!1}})(e)}}let jW=window.React.useRef,jY=Cz(jr),jX=Cz(jd),jQ="data-msg-content",jZ=ex(function(e){let{message:t,revoked:a,newLine:n,isMarked:s,senderJid:r,senderName:l}=e,{$t:o}=oA(),{initialMsgFetched:d,channelJid:c,deleteMessage:u,deleteReply:m,disposeFile:p}=y9(),h=t.operType===em.edit,f=t.messageType===i.unknown,y=t.messageType===i.e2e,v=t.messageType===i.mix,_=t.messageType===i.text,b=t.meetChat?.showGuestLabel,M=t.messageType!==i.call,x=t.messageType===i.bot,C=x&&1===t.botTemplate.onlyyou,j=b5(c),{isSending:N}=jJ(t),w=jW(null),I=function(e){let{message:t,richTextRef:a,onEdit:n}=e,{channelJid:s}=y9(),{isLoading:r,isSending:l}=jJ(t),o=function(e){let t;let{channelJid:a,revokeMessage:n,revokeReply:s}=y9(),r=!function(e){return[i.file,i.image].includes(e.messageType)}(e)?{}:{shareJids:[a],fileId:e.file.fileId};return e.messageType===i.file&&(t=e.file.fileUrl),()=>{e.replyId?e.replyThreadTime&&s({...r,msgId:e.id,msgTimestamp:e.time,mainMsgId:e.replyId,mainMsgTimestamp:e.replyThreadTime,hasComment:!1,fileUrl:t}):n({...r,msgId:e.id,msgTimestamp:e.time,hasComment:!!e.commentTotal,fileUrl:t})}}(t),{isPinned:d}=je({id:t.id}),{onPin:c,onUnpin:u}=j$(t),{isMarked:m,onMark:p}=function(e){let{channelJid:t}=y9(),{isMarked:a,markAsUnread:n}=gq,{time:i,replyId:s,replyThreadTime:r}=e,l=a(t,i),o=jq(e=>{n({timestamp:i,action:e,mainMsgId:s,mainMsgTime:r})},[i,s,r,n]);return{isMarked:l,onMark:o}}(t),{isBookmarked:h,bookmark:f,removeBookmark:y}=_w(t),v=jV(t),{isReminded:_,removeReminder:b}=function(e){let{getIsReminded:t,closeReminder:a,getReminderByMsgId:n}=yV,{id:i}=e;return{isReminded:t(i),removeReminder:()=>{let e=n(i);e&&a({params:{session:e.sessionId,svrTime:e.timestamp},ifShowToast:!0})}}}(t),{getFileState:M}=yw,x=jc(),C=b5(s),{smartReplyEnabled:j,smartReplyLabel:N,onSmartReply:w}=function(){let{$t:e}=oA(),{zoomIQ:t,smartReplyEnabled:a}=jw,{robotIcon:n}=t??{},i=g.jsxs("div",{className:"_label_6kanr_1",children:[g.jsx("img",{alt:"App Icon",src:n}),e({id:"aKxKo6",defaultMessage:[{type:0,value:"Reply with Zoom IQ"}]})]});return{smartReplyEnabled:a,onSmartReply:jD,smartReplyLabel:i}}(),{openEditor:I}=b7(t),{$t:T}=oA(),E=rS(s),S=rS(t.senderJid),k=t.messageType===i.text,A=t.messageType===i.file,R=t.messageType===i.file?t.thirdStorageInfo:null,L=t.messageType===i.file?t.thirdPartyType:null,O=t.messageType===i.mix,D=t.messageType===i.call,P=t.messageType===i.bot,B=t.operType===em.revoke,U=bL(s),H=!t.isSending,z=C&&rT(s)&&[i.text,i.image,i.screenshot,i.file,i.mix,i.codeSnippet].includes(t.messageType),V=jK(t),G=O&&t.allFiles.some(e=>{let{fileType:t}=e;return rh(t)}),q=[[{label:T({id:"lbr3Lq",defaultMessage:[{type:0,value:"Copy link"}]}),key:"copyLink",visible:D,operate:()=>{jG(t,a)}}]],$=[[{label:T({id:"Fpscrv",defaultMessage:[{type:0,value:"Mark as Unread"}]}),key:"markAsUnread",visible:!m&&H,operate:()=>p(n_.MARK)},{label:T({id:"CVph6v",defaultMessage:[{type:0,value:"Mark as Read"}]}),key:"markAsRead",visible:m&&H,operate:()=>p(n_.UNMARK)},{label:T({id:"Rs4kCE",defaultMessage:[{type:0,value:"Bookmark"}]}),key:"Bookmark",visible:!h&&H,operate:f},{label:T({id:"RokVj/",defaultMessage:[{type:0,value:"Remove Bookmark"}]}),key:"RemoveBookmark",visible:h&&H,operate:y},{label:T({id:"eLInf4",defaultMessage:[{type:0,value:"Remind Me"}]}),key:"remindMe",visible:!_&&H,children:F(lD(v.map(e=>e.map(e=>{let{key:t,operate:a,text:n}=e;return{key:t,label:n,operate:a}})),[{key:"divider",divider:!0}]))},{label:T({id:"C2223g",defaultMessage:[{type:0,value:"Cancel Reminder"}]}),key:"CancelReminder",visible:_&&H,operate:b}],[{label:T({id:"fVvgzA",defaultMessage:[{type:0,value:"Copy Link To Message"}]}),key:"copyDeepLink",visible:!V&&!B&&!l&&!E,operate:()=>{let e=lY({sid:s,mid:t.id,time:t.time});o2.info(T({id:"2yCGR2",defaultMessage:[{type:0,value:"Link copied to clipboard"}]})),rX.copyText(e)}},{label:T({id:"4l6vz1",defaultMessage:[{type:0,value:"Copy"}]}),key:"copy",visible:!V&&!B&&!r&&!R,disabled:A&&t.file&&!M(t.file.fileId).file,operate:()=>{jG(t,a)}},{label:T({id:"u5aHb4",defaultMessage:[{type:0,value:"Copy Link"}]}),key:"copyFileLink",visible:!!R,operate:()=>{jG(t,a)}},{label:O?T({id:"tq00X8",defaultMessage:[{type:0,value:"Quote Text"}]}):T({id:"atzUcB",defaultMessage:[{type:0,value:"Quote"}]}),key:"quote",visible:(O||k)&&!B&&!U,operate:()=>{de.addQuoteMessage(a)}}],[{label:T({id:"rkI2tJ",defaultMessage:[{type:0,value:"Open in "},{type:1,value:"thirdPartyName"}]},{thirdPartyName:L&&rC[L]}),key:"openLink",visible:!!R,operate:()=>R&&r_(R)}],[{label:T({id:"wEQDC6",defaultMessage:[{type:0,value:"Edit"}]}),key:"edit",visible:!V&&S&&(k||O)&&!B&&!U&&H,disabled:G,operate:n},{label:T({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),key:"delete",danger:!0,visible:S&&!B&&!l&&!U&&!P,operate:()=>{xb.confirm({title:T({id:"TwEM4f",defaultMessage:[{type:0,value:"Delete Message"}]}),content:T({id:"ZrmUoS",defaultMessage:[{type:0,value:"Are you sure you want to delete this message? This action cannot be undone."}]}),onConfirm:o,okDanger:!0,okText:T({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]})})}}],[{label:T({id:"Rklgbn",defaultMessage:[{type:0,value:"Pin for Everyone"}]}),key:"pin",visible:!V&&x&&!d&&z&&!B&&!l&&H,operate:c},{label:T({id:"ooSyC0",defaultMessage:[{type:0,value:"Unpin for Everyone"}]}),key:"unpin",visible:!V&&x&&d&&z&&!B&&!l&&H,operate:u}],[{label:N,key:"smart-reply",visible:j&&(k||O),className:_m.smartReply,operate:()=>{I(),uX.disableBlur(),setTimeout(()=>{let e=t.replyId||t.id,a=de.getReplyEditor(e);a&&w({editorRef:a,sessionId:s,threadId:e,messageId:t.id,msgContent:t.message})},300)}}]];return F(lD((D?q:$).filter(e=>!!e.filter(e=>{let{visible:t}=e;return t}).length),[{key:"divider",visible:!0,divider:!0}])).filter(e=>{let{visible:t}=e;return t})}({message:t,richTextRef:w,onEdit:()=>{requestAnimationFrame(()=>{yU.setIsEditing({id:t.id,isEditing:!0})})}}),T=g.jsx(j_,{className:M6.options,dropDownMenuItems:I,emojiVisible:!a&&M&&!C,replyVisible:M&&j&&!C,disabled:t.isEditing||N||f||y||!d,message:t}),E=fA.useRerenderWhenHidden?.();return g.jsx(_v,{items:I,disabled:t.isEditing||f||y||!d,children:g.jsxs("div",{ref:E,[jQ]:!0,children:[n&&g.jsxs("div",{className:M6.header,children:[g.jsx("div",{className:M6.sender,children:l}),(rT(c)||rE(c))&&g.jsx(_B,{userJid:r,isGuest:b}),C&&g.jsxs("div",{className:M6.visible,children:[g.jsx(n2,{className:M6.visibleIcon}),o({id:"VAsUyo",defaultMessage:[{type:0,value:"Only visible to you"}]})]}),g.jsx("div",{className:M6.time,children:oK(t.time)}),h&&g.jsx("div",{className:M6.edited,children:o({id:"KIEDgv",defaultMessage:[{type:0,value:"(Edited)"}]})}),s&&g.jsx("span",{className:M6.unread,...oI.Main.messageUnreadTip,children:o({id:"rYVPFu",defaultMessage:[{type:0,value:"Unread"}]})})]}),g.jsxs("div",{className:M6.content,children:[(()=>{if(a)return g.jsx("div",{className:M6.revoked,children:o({id:"NehiuU",defaultMessage:[{type:0,value:"This message has been deleted"}]})});if(jK(t))return g.jsx(jb,{});switch(t.messageType){case i.text:return g.jsx(jY,{message:t,innerRef:w,moreActionsRender:T,linkPreviewAvailable:!0});case i.image:case i.screenshot:return g.jsx(C1,{imageId:t.file.fileId,msgId:t.id});case i.giphy:return g.jsx(C1,{imageId:t.id,msgId:t.id});case i.file:return g.jsx(CQ,{message:t,deleteMessage:u,deleteReply:m,disposeFile:p});case i.mix:return g.jsx(jX,{message:t,moreActionsRender:T,innerRef:w,linkPreviewAvailable:!0});case i.call:return g.jsx(Cb,{message:t});case i.e2e:return g.jsx(Cw,{});case i.codeSnippet:return g.jsx(Cj,{message:t});case i.bot:return g.jsx(Cv,{message:t,ref:w});case i.unknown:return g.jsx(jM,{});default:return null}})(),g.jsx("br",{}),!v&&!_&&T]})]})})}),j1=ex(function(e){let{msgId:t}=e,{$t:a}=oA(),{isPinned:n,pinner:i}=je({id:t}),s=bt();return n?g.jsxs("div",{className:M6.isPinned,children:[g.jsx(n5,{className:M6.pinIcon}),a({id:"1J+gut",defaultMessage:[{type:0,value:"Pinned by "},{type:1,value:"name"}]},{name:s({jid:i?.jid,name:i?.name})})]}):null}),j0=window.React.forwardRef,j2=ex(j0(function(e,t){let{message:a,leading:n,className:s,isMarked:r=!1}=e,{$t:l}=oA(),o=n||r,d=a.operType===em.revoke||a.optimisticRevoked,c=a.messageType===i.bot,u=!!a.replyId,m=c?a.botTemplate.from:a.senderJid,p=c&&1===a.botTemplate.onlyyou,h=bA(m),y=(()=>c?a.botTemplate.name||"":h?lT(h)||a.senderName||"":a.senderName||"")(),v=rS(m)?l({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):y,_={...oI.Main.message(u?"reply":"main"),...sM.msgAttrs(a.id)};return d&&!a.commentTotal?null:a.messageType===i.pmc?g.jsx("div",{..._,ref:t,children:g.jsx(M$,{message:a})}):a.messageType===i.info?g.jsx("div",{..._,ref:t,children:g.jsx(MG,{message:a})}):g.jsxs("div",{..._,ref:t,className:f(M6.message,{[M6.followed]:!o,[M6.isReply]:u,[M6.isBot]:c,[M6.isOnlyYou]:p},s),children:[g.jsx(M4,{isReply:u,revoked:d,newLine:o,senderJid:m,userName:y,avatar:h?.avatar||a.senderAvatar}),g.jsxs("div",{className:M6.contentWrapper,tabIndex:0,children:[g.jsx(jZ,{message:a,revoked:d,newLine:o,isMarked:r,senderJid:m,senderName:v}),g.jsx(j1,{msgId:a.id}),g.jsx(xi,{message:a,isReply:u})]})]})})),j5=window.React.useRef,j3=window.React.useCallback,j6=ex(function(e){let t=j5(null),a=j3(()=>t.current,[]),{time:n,replyId:i,replyThreadTime:s}=e.message,r=j3(()=>uv.mutation.markMsgAsUnread({timestamp:n,action:n_.UNMARK,mainMsgId:i??void 0,mainMsgTime:s??void 0}),[n,i,s]);return bB({markRead:r,getTarget:a}),g.jsx(j2,{...e,ref:t,isMarked:!0})}),j4=window.React.useRef,j8=window.React.useCallback,j7=ex(function(e){let{channelJid:t}=y9(),a=j4(null),n=j8(()=>a.current,[]),{id:i,time:s,replyThreadTime:r}=e.message,l=j8(()=>(yU.updateMessage({id:i,isUnreadMsg:!1}),uv.mutation.markMsgRead({channelJid:t,time:s,threadTime:r??void 0})),[t,s,r,i]);return bB({markRead:l,getTarget:n}),g.jsx(j2,{...e,ref:a})}),j9=ex(function(e){let{message:t}=e,a=gq.markedMsgState(t.channelJid,t.time);switch(!0){case"marked"===a:return g.jsx(j6,{...e});case"markedPending"===a:return g.jsx(j2,{...e,isMarked:!0});case t.isUnreadMsg:return g.jsx(j7,{...e});default:return g.jsx(j2,{...e})}});function Ne(e){let{deleteUnsentMessage:t,deleteUnsentReply:a}=y9();return()=>{e.replyId?a({mainMsgId:e.replyId,msgId:e.id}):t(e.id)}}let Nt=ex(function(e){let{message:t,leading:a}=e,{$t:n}=oA(),s=Ne(t),r=function(e){let{sendTextMessage:t,replyTextMessage:a,sendImageMessage:n,replyImageMessage:s,sendFileMessage:r,replyFileMessage:l,sendMixMessage:o,replyMixMessage:d,sendGiphyMessage:c,replyGiphyMessage:u,sendCloudFileMessage:m,replyCloudFileMessage:p}=y9(),h=Ne(e),f=function(e){let t=MC(e),a=b2(e),n=oa(()=>{if(!yn(a?.sessionType)||t)return!1;let e=window.pwaChatConfig.currentStorageType;switch(!0){case a.isBox:return e===an.chatBoxStorage||"box"===e;case a.isSharePoint:return e===an.sharepoint;default:return!1}},[a,t]);return n}(e.channelJid);return()=>{switch(h(),e.messageType){case i.text:yA(e)?a({replyId:e.replyId,message:e.message,fontStyte:e.fontStyle,mention:e.mention}):t({message:e.message,fontStyte:e.fontStyle,mention:e.mention});return;case i.image:case i.screenshot:{let t=re(e.message,s3(e.file.fileName));if(!t)return;yA(e)?s({replyId:e.replyId,file:t,imgUrl:e.message,type:e.messageType}):n({file:t,imgUrl:e.message,type:e.messageType});return}case i.giphy:{let t=e.giphyInfo;if(!t)return;yA(e)?u({replyId:e.replyId,giphyInfo:t}):c({giphyInfo:t});return}case i.file:{let{thirdStorageInfo:t}=e,a=rw.getFile(e.file.fileId);if(a){yA(e)?l({replyId:e.replyId,file:a,isThirdStorage:f}):r({file:a,isThirdStorage:f});return}t&&(yA(e)?p({replyId:e.replyId,fileId:t.id,fileName:t.fileName,fileSize:t.fileSize,thirdPartyInfo:t}):m({fileId:t.id,fileName:t.fileName,fileSize:t.fileSize,thirdPartyInfo:t}));return}case i.mix:{let t=rs(e.allFiles,rw.getFile),a={message:e.message,fontStyte:e.fontStyle,mention:e.mention,allFiles:t};yA(e)?d({replyId:e.replyId,...a}):o(a);return}default:return}}}(t),{deleteMessage:l,deleteReply:o,disposeFile:d}=y9(),c=()=>{t.messageType===i.file&&rw.removeFileById(t.id),s()},u=[{key:"copy",label:n({id:"4l6vz1",defaultMessage:[{type:0,value:"Copy"}]})},{key:"divider",divider:!0},{key:"delete",label:n({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),danger:!0,operate:c}];return g.jsxs("div",{"data-message":t.id,className:f(M6.message,{[M6.followed]:!a,[M6.isReply]:!!t?.replyId}),children:[g.jsx("div",{className:M6.avatar,children:t.senderJid&&a&&g.jsx(M5,{userJid:t.senderJid,children:g.jsx(_L,{jid:t.senderJid,image:t.senderAvatar,name:t.senderName,size:t.replyId?"sm":"lg"})})}),g.jsxs("div",{className:M6.contentWrapper,children:[g.jsx(_v,{items:u,children:g.jsxs("div",{children:[a&&g.jsx("div",{className:M6.header,children:g.jsx("div",{className:M6.sender,children:n({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})}),g.jsx("div",{className:M6.content,children:(()=>{switch(t.messageType){case i.text:return g.jsx(jr,{message:t});case i.image:case i.screenshot:return g.jsx(C1,{imageId:t.file.fileId,msgId:t.id});case i.giphy:return g.jsx(C1,{imageId:t.id,msgId:t.id});case i.file:return g.jsx(CQ,{message:t,deleteMessage:l,deleteReply:o,disposeFile:d});case i.mix:return g.jsx(jd,{message:t,deleteMessage:l,deleteReply:o,disposeFile:d});default:return null}})()})]})}),g.jsxs("div",{className:M6.unsentActions,children:[g.jsx("div",{className:M6.dangerText,children:n(t.replyId?{id:"0CIZd1",defaultMessage:[{type:0,value:"Reply could not be sent"}]}:{id:"sTdqwP",defaultMessage:[{type:0,value:"Message could not be sent"}]})}),g.jsx(dj,{type:"link",size:"small",className:M6.retryButton,onClick:r,children:n({id:"62nsdy",defaultMessage:[{type:0,value:"Retry"}]})}),g.jsx(dj,{type:"link",size:"small",className:M6.deleteButton,onClick:c,children:n({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]})})]})]})]})}),Na=window.React.useCallback,Nn=ex(function(e){let{message:t}=e,{$t:a}=oA(),{isJoined:n}=gQ,s=C9(t.mention||[]),r=Na(e=>{e.stopPropagation();let{type:t,id:a,prefix:i,label:s}=e.target.dataset;if("mention"===t&&a&&i&&i===lm.CHANNEL){n(a)?yh.setChatId(a):bf.open({type:st.PREVIEW_CHANNEL,options:{channelId:a,channelName:s}});return}},[n]),l=(e,t)=>({text:`${e.message}${t??""}`,styleItems:e.fontStyle,mention:s});return t.messageType===i.mix?g.jsx("div",{className:f(jt.text,jt.preview),children:g.jsx(nY,{className:jt.previewText,onClick:r,content:l(t,(e=>e?1===e?`[1 ${a({id:"gyrIEl",defaultMessage:[{type:0,value:"File"}]})}]`:`[${e} ${a({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]})}]`:"")(t.allFiles?.length))})}):g.jsx("div",{className:f(jt.text,jt.preview),children:g.jsx(nY,{className:jt.previewText,onClick:r,content:l(t)})})}),Ni=ex(function(e){let{message:t}=e,{$t:a}=oA(),n=bA(t.senderJid),s=(()=>n?lT(n)||t.senderName||"":t.senderName||"")();return g.jsxs("div",{className:M6.message,children:[g.jsx("div",{className:M6.avatar,children:g.jsx(_L,{jid:t.senderJid,image:n?.avatar||t.senderAvatar,name:s})}),g.jsxs("div",{className:M6.contentWrapper,children:[g.jsxs("div",{className:M6.header,children:[g.jsx("div",{className:M6.sender,children:s}),g.jsx("div",{className:M6.time,children:oK(t.time)})]}),g.jsx("div",{className:M6.content,children:(()=>{switch(t.messageType){case i.text:return g.jsx(Nn,{message:t});case i.image:case i.giphy:return g.jsxs("div",{className:jt.text,children:["[",a({id:"+0zv6g",defaultMessage:[{type:0,value:"Image"}]}),"]"]});case i.file:return g.jsxs("div",{className:jt.text,children:["[1 ",a({id:"gyrIEl",defaultMessage:[{type:0,value:"File"}]}),"]"]});case i.mix:return g.jsx(Nn,{message:t});default:return null}})()})]})]})}),Ns=ex(function(e){let{message:t}=e,{$t:a}=oA(),{isOpen:n}=b4(t),i=sM.msgAttrs(t.id);return g.jsxs("div",{...i,className:"_message_1buy9_1",children:[g.jsx("div",{className:"_avatar_1buy9_7",children:g.jsx(n3,{})}),g.jsxs("div",{children:[g.jsx("div",{className:"_content_1buy9_21",children:a({id:"0CJbdJ",defaultMessage:[{type:0,value:"Unable to show history due to admin setting"}]})}),g.jsx("div",{className:f("_bottomControls_1buy9_26",{_isOpen_1buy9_33:n}),children:g.jsx(xn,{message:t})})]})]})}),Nr={loader:"_loader_11v0i_1",loading:"_loading_11v0i_5"},Nl=window.React.useRef,No=window.React.useCallback;function Nd(e){let{loading:t,loadingTip:a,className:n,...i}=e;return t?g.jsx(e4,{className:f(Nr.loading,n),loading:!0,tip:a}):g.jsx(Nc,{...i})}function Nc(e){let{onLoad:t,...a}=e,n=Nl(null),i=No(()=>n.current,[]);return oo({...a,onIntersect:t,getTarget:i}),g.jsx("div",{ref:n,className:Nr.loader})}let Nu=window.React.forwardRef,Nm=ex(Nu(function(e,t){let{zoomIQ:a,smartComposeEnabled:n}=jw,{robotIcon:i}=a??{};return n&&i?g.jsx(jk,{...e,robotIcon:i,ref:t}):null})),Np=window.React.useState,Nh=ex(function(e){let[t,a]=Np(!1),{editorRef:n,anchor:i,alignOffset:s,sessionId:r,threadId:l,children:o}=e,{zoomIQ:d,smartComposeEnabled:c,smartComposeAction:u}=jw,{homeUri:m,robotIcon:p}=d??{},{actionId:h,dialog:f}=u??{},y={of:"shortcutInCompose",open_from:"shortcutInCompose",typ:rT(r)?"channel":"chat",session_id:r,thread_id:l};return c&&m&&h?g.jsx(jR,{open:t,onOpenChange:a,editorRef:n,anchor:i,dialogConfig:f,robotIcon:p,alignOffset:s,homeUri:m,actionId:h,headers:y,injectTheme:!0,injectHistory:!0,injectCrossOrigin:!0,replaceNonce:!0,children:o}):null}),Nf=window.React.useState,Ng=ex(function(e){let{anchorRef:t,...a}=e,[n,i]=Nf(!1);return(l4(()=>{i(!0)},[]),n)?g.jsx(Nh,{...a,anchor:t.current,children:g.jsx(Nm,{})}):g.jsx(Nm,{})}),Ny=window.React.forwardRef,Nv=Ny(function(e,t){return g.jsx("div",{...e,ref:t})}),N_=window.React.useRef;function Nb(e){let{editorRef:t,sessionId:a,threadId:n,alignOffset:i,anchorClassName:s}=e,{smartComposeEnabled:r}=jw,l=N_(null);return l3(()=>({smartComposeAnchor:r?g.jsx(Nv,{className:s,ref:l}):null,smartCompose:r?g.jsx(Ng,{editorRef:t,anchorRef:l,alignOffset:i,sessionId:a,threadId:n}):null}),[r,s,t,i,a,n])}let NM={replies:"_replies_5acsd_1",moreButton:"_moreButton_5acsd_7",replyEditor:"_replyEditor_5acsd_13",unreadReply:"_unreadReply_5acsd_27",anchorContainer:"_anchorContainer_5acsd_43",anchor:"_anchor_5acsd_43"},Nx=window.React.useRef,NC=ex(function(e){let{message:t}=e,{channelJid:a,replyIds:n,unsentReplies:i,replyMessage:s,fetchHistoryReplies:r,isReplyLoading:l}=y9(),{isEditorOpen:o,closeEditor:d}=b7(t),{isOpen:c,loadToEnd:u,loadToStart:m,start:p,end:h,commentTotal:f,unFinishLoad:y}=b4(t),{currentUser:v}=g2,{$t:_}=oA(),b=bE(),M=yU.replies(n(t.id)),x=function(e,t){let a=gq.lastReadReplyTime(e,t),[n,i]=_0(a);return l2(()=>{void 0===n&&a&&i(a)},[n,a,i]),n}(t.channelJid,t.time),C=i(t.id),j=l(t.id),N=bL(a),w=Nx(null),{smartCompose:I,smartComposeAnchor:T}=Nb({editorRef:w,sessionId:a,threadId:t.id,anchorClassName:NM.anchor}),E=MC(a),{setCloudStorage:S,setReplyId:k}=CT,A=uu(),R=e=>e?_({id:"BqyjsF",defaultMessage:[{type:0,value:"View "},{type:1,value:"count"},{type:0,value:" More..."}]},{count:e}):_({id:"1EgHWP",defaultMessage:[{type:0,value:"View More..."}]}),L=p>0&&p<h||y,O=!!M.length&&h<f&&!y,D=p+h-f,[P,F]=y?[p-D,h-D]:[p,h],B=bH(a);if(l2(()=>{de.setReplyEditor(t.id,w)},[t.id]),!o&&!c)return g.jsx(g.Fragment,{});let U=c&&g.jsxs("div",{children:[L&&!j&&g.jsx(dj,{type:"text",size:"small",onClick:()=>{m(),y&&r({replyId:t.id,threadTime:t.time,limit:Math.min(f-M.length+1,f),sort:"asc"})},className:NM.moreButton,children:R(y?0:p)}),M.filter(e=>{let{optimisticRevoked:t}=e;return!t}).map((e,t)=>({reply:e,index:t})).slice(P,F).map(e=>{let{reply:t,index:a}=e,n="number"==typeof x&&t.time>x;return g.jsx(j9,{message:t,leading:Nj(M,t,a),className:n?NM.unreadReply:void 0},t.id)}),C.map((e,t)=>g.jsx(Nt,{message:e,leading:Nj(C,e,t)},e.id)),O&&g.jsx(dj,{type:"text",size:"small",onClick:u,className:NM.moreButton,children:R(f-h)})]}),H=sM.replyAttrs(t.id),z=(o||c)&&g.jsxs("div",{className:NM.replyEditor,...H,children:[g.jsx(_L,{jid:v.jid,name:lT(v),image:v?.avatar,size:"sm"}),g.jsxs("div",{className:NM.anchorContainer,children:[T,g.jsx(jE,{className:NM.anchor,threadId:t.id}),g.jsx(ur,{...oI.Main.replyChatBox,baseEditorRef:w,placeholder:_({id:"WyBF9l",defaultMessage:[{type:0,value:"Reply..."}]}),onWarning:b,onReply:e=>{let{textContent:a,files:n}=e;t.senderJid&&s({content:{textContent:a,files:n},mainMsgId:t.id,isExternal:E})},onBlur:e=>{e&&uX.canBlur&&d()},onFocus:()=>{de.setLastActiveEditor(w)},onMentionSearch:B,mentionSuggestionRender:CP,getPreventBlurElements:NN,disabledFeatures:A,contentCheck:CE,giphyConfig:uY,handleCloud:e=>{S(e),k(t.id)},appButtons:I})]})]});return g.jsxs("div",{className:NM.replies,children:[U,!N&&z]})});function Nj(e,t,a){let n=t.operType===em.edit;function s(e){return e.messageType===i.text}function r(e){return!!oU(e.emojiVotes).length}if(0===a||n||!s(t)||r(t))return!0;let l=e[a-1];if(!s(l)||r(l))return!0;let o=l.senderJid!==t.senderJid,d=oX(l.time,t.time)>0;return o||d}function NN(){return[...function(){return[...document.querySelectorAll(`[${jv}]`)]}(),...function(){return[...document.querySelectorAll(`[${_h}]`)]}(),...function(){return[...document.querySelectorAll(`[data-state="open"][${jQ}]`)]}()]}let Nw={unread:"_unread_1sl1f_1",jumpRecent:"_jumpRecent_1sl1f_1",arrow:"_arrow_1sl1f_15",reversed:"_reversed_1sl1f_22"},NI=ex(function(e){let{className:t}=e,{$t:a}=oA(),{channelJid:n,setMode:i}=y9(),s=l3(()=>sM.create(n),[n]);return g.jsxs("button",{className:f(Nw.jumpRecent,t),onClick:()=>{i("normal"),requestAnimationFrame(()=>{s.scrollEnd()})},children:[a({id:"j4ZKI6",defaultMessage:[{type:0,value:"Jump to the latest"}]}),g.jsx(n6,{className:Nw.arrow})]})}),NT=ex(function(e){let{marks:t,className:a}=e,{channelJid:n,mode:i,messageIds:s,repliesMap:r,transientMessageIds:l}=y9(),{$t:o}=oA(),d=l3(()=>sM.create(n),[n]),c=t.length,u=ad(t),m=yH(u,"normal"===i?s:l,F(Array.from(r.values()).map(e=>{let{replyIds:t}=e;return t}))),p=function(e,t){if(!t)return!1;{let a=sM.queryScroll(e),n=sM.queryMessage(e,t.id);return!!a&&!!n&&a.scrollTop<n.offsetTop}}(n,m),h=oa(()=>{if(!m?.id)return!1;let e=sM.queryMessage(n,m.id);return!!e&&d.isInView(e)},[m,n,d]);return h?null:g.jsxs("button",{className:f(Nw.unread,a),onClick:()=>{u&&oz.dispatch(oH.jumpToMessage,{chatId:n,sendTime:u})},children:[g.jsxs("span",{children:[c,"\xa0",o({id:"VsGWdb",defaultMessage:[{type:0,value:"Marked as Unread"}]})]}),g.jsx(n4,{className:f(Nw.arrow,{[Nw.reversed]:p})})]})}),NE=window.React.useRef,NS=ex(function(e){let{className:t}=e,{channelJid:a,replyIds:n,setMode:i,jumpFetchMessages:s,fetchHistoryReplies:r,setReplyScope:l}=y9(),o=bD(),{unreadCount:d,unreadThreads:c,markAllRead:u}=gq,m=d(a),{$t:p}=oA(),h=l3(()=>sM.create(a),[a]),y=NE(null),v=ad(c(a)),_=o.find(e=>{let{time:t}=e;return t===v?.threadTime}),b=function(e,t,a,n){if(!n)return!0;let i=aQ(a);if(!t)return!!i&&n.threadTime>i.time;{let a=sM.queryScroll(e),n=sM.queryMessage(e,t.id);return!!a&&!!n&&a.scrollTop<n.offsetTop}}(a,_,o,v),M=()=>{i("normal"),requestAnimationFrame(()=>{h.scrollEnd()})};return g.jsxs("button",{...oI.Main.unreadNewMsgBtn,className:f(Nw.unread,t),onClick:()=>{if(!v){M(),u();return}let{threadTime:e,unreadCount:t,lastReadTime:a}=v;if(_){if(h.scrollToMessage(_.id),y.current===_.id){let e=n8(yU.replies(n(_.id)),e=>{let{time:t}=e;return t<a});if(!e)return;requestAnimationFrame(()=>h.scrollToMessage(e.id));return}if(t){y.current=_.id;let e=_.commentTotal??0,a=n(_.id).length,i=t+a;l({mainMsgId:_.id,start:Math.max(e-i,0),end:e}),r({replyId:_.id,threadTime:_.time,limit:i,sort:"desc",onSuccess(e){let t=aQ(e);t&&requestAnimationFrame(()=>{h.scrollToMessage(t.id)})}})}}else s({timestamp:e,commentsLimit:t,onSuccess(t){let[a,n]=a0(t,e=>{let{replyId:t}=e;return!t}),i=aQ(n)?.id??a.find(t=>{let{time:a}=t;return a===e})?.id;i&&requestAnimationFrame(()=>h.scrollToMessage(i))}})},children:[g.jsxs("span",{children:[m,"\xa0",p(m<=1?{id:"8HgntJ",defaultMessage:[{type:0,value:"New Message"}]}:{id:"C4QVdx",defaultMessage:[{type:0,value:"New Messages"}]})]}),g.jsx(n4,{className:f(Nw.arrow,{[Nw.reversed]:b})})]})}),Nk=window.React.useRef,NA=ex(function(e){let{className:t}=e,{channelJid:a,mode:n}=y9(),{unreadCount:i}=gq,s=function(e){let{marked:t}=gq,a=oa(()=>[...t(e).values()],[t,e]),[n,i]=_0(a),s=Nk(a);return l2(()=>{if(a.length<s.current.length){let e=n7(s.current,a);i(t=>t.filter(t=>!e.includes(t)))}},[a,i]),l2(()=>{s.current=a},[a]),n}(a);switch(!0){case!!i(a):return g.jsx(NS,{className:t});case!!s.length:return g.jsx(NT,{marks:s,className:t});case"transient"===n:return g.jsx(NI,{className:t});default:return null}}),NR={chatAvatar:"_chatAvatar_6qhkg_1",large:"_large_6qhkg_18",medium:"_medium_6qhkg_29",small:"_small_6qhkg_37",middleStatus:"_middleStatus_6qhkg_42"},NL=ex(function(e){let{className:t,jid:a,name:n,url:i,chatType:s,size:r="md",status:l,statusOnly:o,statusLongConnection:d,topType:c,zoomRoom:u,deactivatedAvatarClass:m,isMuted:p,chatIsPublic:h,hideStatus:y}=e,{isPublic:v,isPMC:_,isPMCCurring:b,isSpotChannel:M}=gQ,x=yt(s),{isBlocked:C}=ba,{presenceType:j}=bu(x?a:null,d),N=C(a)?"blocked":l||j,w=oa(()=>{let e=!!h||v(a);switch(!0){case p:return g.jsx(il,{"aria-hidden":"true",className:"icon-bell-notification-off"});case yi(s):return g.jsx(ez,{"aria-hidden":"true",className:"icon-chat"});case yt(s):if(o)return g.jsx("span",{className:NR.middleStatus,children:g.jsx(MK,{type:j})});return null;case M(a):return g.jsx(ir,{"aria-hidden":"true"});case ya(s)&&!_(a):return g.jsx(nJ,{"aria-hidden":"true",className:"icon-team"});case _(a):if(b(a))return g.jsx(ii,{"aria-hidden":"true",className:"icon-team"});return g.jsx(is,{"aria-hidden":"true",className:"icon-team"});case yn(s)&&!e:return g.jsx(nW,{"aria-hidden":"true",className:"icon-lock-locked"});case yn(s)&&e:return g.jsx(eU,{"aria-hidden":"true",className:"icon-number-italic"});case rF(c):return g.jsx(ia,{"aria-hidden":"true",className:"icon-top-menu"});case rU(c):return g.jsx(it,{"aria-hidden":"true",className:"icon-top-menu"});case rB(c):return g.jsx(ie,{"aria-hidden":"true",className:"icon-top-menu"});case function(e){return e===sn.MORE}(c):return g.jsx(nt,{"aria-hidden":"true",className:"icon-top-menu"});case rH(c):return g.jsx(n9,{"aria-hidden":"true",className:"icon-top-menu"});case rz(c):return g.jsx(eG,{"aria-hidden":"true",className:"icon-top-menu"});case function(e){return e===si.ANYONE}(c):return g.jsx(eF,{"aria-hidden":"true",className:"icon-top-menu"});default:return null}},[a,p,h,o,j,s,c,v,_,b,M]),I=f(NR.chatAvatar,t,{[NR.large]:"lg"===r,[NR.medium]:"md"===r,[NR.small]:"sm"===r});return!x||o||!function(e){return!!e&&Object.keys(dL).includes(e)}(N)?g.jsx("div",{className:I,children:w}):g.jsx(dO,{size:r,status:N,hidden:y,children:g.jsx(_L,{jid:a,name:n,image:i,size:r,zoomRoom:u,className:m})})});var NO=(e=>(e[e.App=0]="App",e[e.Sidebar=1]="Sidebar",e[e.MainPanel=2]="MainPanel",e[e.MoreActions=3]="MoreActions",e[e.Search=4]="Search",e))(NO||{});let ND={0:"light",1:"dark",2:"light",3:"light",4:"light"};function NP(e){let{type:t}=e,{$t:a}=oA();return g.jsxs("div",{className:f("_fallback_b7oxp_1",{_dark_b7oxp_13:"dark"===ND[t],_light_b7oxp_17:"light"===ND[t]}),role:"alert",children:[g.jsx(n3,{className:"_icon_b7oxp_21"}),g.jsx("span",{className:"_text_b7oxp_25",children:a({id:"27ymjk",defaultMessage:[{type:0,value:"Loading error, please try again"}]})})]})}let NF=e=>t=>g.jsx(NP,{...e,...t}),NB=(e,t)=>{fS.error(e.message+t.componentStack),console.error("Fallback Error:",e,t.componentStack)},NU=e=>{let{children:t,...a}=e;return g.jsx(io,{fallbackRender:NF(a),onError:NB,children:t})},NH={disabled:"_disabled_kk504_1",actionButton:"_actionButton_kk504_9"};function Nz(e){let{children:t,disabled:a,invisible:n,operate:i,...s}=e;return n?null:g.jsx("button",{...s,disabled:a,className:f(NH.actionButton,{[NH.disabled]:a}),onClick:i,children:t})}let NV={actions:"_actions_ykdk0_1",action:"_action_ykdk0_1",large:"_large_ykdk0_26",medium:"_medium_ykdk0_31",small:"_small_ykdk0_36"};var NG=(e=>(e[e.NORMAL=0]="NORMAL",e[e.DROPDOWN=1]="DROPDOWN",e))(NG||{});function Nq(e){let{className:t,actions:a=[],size:n="md",portalContainer:i,onDropDownOpenChange:s}=e;return g.jsx("div",{className:f(t,NV.actions),onClick:e=>{e.stopPropagation()},children:a.map(e=>{switch(e.type){case 0:{let{key:t,icon:a,...i}=h(e,"type");return g.jsx(Nz,{...i,children:g.jsx("div",{className:f(NV.action,{[NV.large]:"lg"===n,[NV.medium]:"md"===n,[NV.small]:"sm"===n}),children:a})},t)}case 1:{let{key:t,icon:a,options:r,...l}=h(e,"type");return g.jsx(cQ,{options:r,portalContainer:i,onOpenChange:s,children:g.jsx("button",{...l,className:f(NV.action,{[NV.large]:"lg"===n,[NV.medium]:"md"===n,[NV.small]:"sm"===n}),children:a})},t)}default:return null}})})}window.React.Fragment;let N$={trigger:"_trigger_a2632_1",menu:"_menu_a2632_5",searchInput:"_searchInput_a2632_8",titleText:"_titleText_a2632_28",item:"_item_a2632_41",checkboxLabel:"_checkboxLabel_a2632_47",checkboxText:"_checkboxText_a2632_52",searchContent:"_searchContent_a2632_60",searchContentItem:"_searchContentItem_a2632_65",hasCheckMark:"_hasCheckMark_a2632_70",danger:"_danger_a2632_81",disabled:"_disabled_a2632_85",noHoverChange:"_noHoverChange_a2632_93"},NK=window.React.Fragment;function NJ(e){let{classNames:t,extraData:a,dropDownOptions:n=[],onDropDownAction:i,portalContainer:s=document.body,children:r,open:l,onOpenChange:o,side:d="bottom",sideOffset:c,align:u="start",onSearchChange:m,title:p}=e,{$t:h}=oA(),y=e=>{i?.({eventKey:e,extraData:a})},v=n.reduce((e,t)=>{let a=t.filter(e=>!e.hidden);return 0===a.length?e:[...e,a]},[]);return v.length?g.jsxs(cg,{open:l,onOpenChange:o,children:[g.jsx(cv,{className:N$.trigger,children:r}),g.jsx(cy,{container:s,children:g.jsxs(c_,{className:f(N$.menu,t),onClick:e=>e.stopPropagation(),side:d,sideOffset:c,align:u,children:[!!m&&g.jsx(d$,{autoFocus:!0,closable:!1,showSearch:!1,allowClear:!1,stopPropagation:!0,onChange:tr(m,300),maxLength:256,className:N$.searchInput}),p&&g.jsx("div",{className:N$.titleText,children:p}),g.jsx("div",{...oI.Dropdown.actionMenuContainer,className:f({[N$.searchContent]:!!m}),children:v.map((e,t)=>g.jsxs(NK,{children:[e.map(e=>g.jsxs(cb,{...e.testKey?oI.Dropdown[e.testKey]:{},disabled:e.disabled,className:f(N$.item,{[N$.danger]:e.danger,[N$.disabled]:e.disabled,[N$.noHoverChange]:e.noHoverChange,[N$.hasCheckMark]:e.hasCheckMark,[N$.searchContentItem]:!!m}),onClick:()=>{e.operate?.(),y(e.key)},children:[e.hasCheckBox&&g.jsxs("label",{className:N$.checkboxLabel,children:[g.jsx(cz,{ariaLabel:[e.text,e.checkBoxValue?h({id:"sMlxOq",defaultMessage:[{type:0,value:"checked"}]}):h({id:"6Q1O+x",defaultMessage:[{type:0,value:"unchecked"}]})].join(", "),checked:!!e.checkBoxValue,name:"meetMode"}),g.jsx("span",{className:f(N$.checkboxText),children:e.text})]}),!e.hasCheckBox&&!e.hasElement&&e.text,e.hasElement&&e.element,e.hasCheckMark&&g.jsx(tx,{})]},e.key)),t<v.length-1&&g.jsx(cM,{})]},t))})]})})]}):null}let NW=ex(function(e){let{jid:t,hovered:a,role:n,children:i}=e,s=Ma.userRolesMap.get(t),r=rk(n||s?.role),l=rA(n||s?.role);return l2(()=>{a&&!n&&Ma.fetchUserRole(t)},[a,t,n]),g.jsx(g.Fragment,{children:i({isAdmin:l,isOwner:r})})});function NY(e){let{visible:t,className:a,children:n}=e,i=sM.activeAttrs(t);return g.jsx("div",{...t?oI.Main.activePanel:{},...i,className:f("_panel_bw5a5_1",a,{_visible_bw5a5_7:t}),children:g.jsx("div",{className:"_content_bw5a5_10",children:n})})}function NX(e){let{title:t}=e;return g.jsx("div",{...oI.Main.panelHeader,className:"_header_3pz4g_1",children:t})}let NQ={unreadDot:"_unreadDot_3wpiz_1",unreadDotWithoutCount:"_unreadDotWithoutCount_3wpiz_15",mention:"_mention_3wpiz_26"},NZ=window.React.useCallback;function N1(e){let{count:t=0,overflowCount:a=99,mentioned:n,className:i,hideCount:s,forceShow:r=!1}=e,l=t>a?`${a}+`:t,{$t:o}=oA(),d=NZ(()=>n===gH.me?o({id:"EN3W/P",defaultMessage:[{type:0,value:"@me"}]}):n===gH.all?o({id:"5d1FDE",defaultMessage:[{type:0,value:"@all"}]}):"",[o,n]),c=d();return l||c||r?g.jsx("span",{...n?{}:oI.Sidebar.unreadInfo,className:f(s?NQ.unreadDotWithoutCount:NQ.unreadDot,{[NQ.mention]:!!c},i),children:c||l}):null}let N0=eb.object({id:eb.string(),time:eb.number()}),N2=vB.userJid,N5={atJid:[N2],keyword:"",pageNum:1,pageSize:20,sortType:1,scope:1};function N3(e){return{limit:"1",sessions:e.map(e=>({jid:e.chatType.receiverJid||"",timeframe:`0:${e.sendTime}`,type:az.groupchat,visible_filter:!0}))}}function N6(e){return!!e.msgId}let N4=e_().schema(()=>({messages:eb.array(N0),loading:eb.boolean(),fetched:eb.boolean(),pageNum:eb.number(),previousLoading:eb.boolean(),scopeType:eb.number(),hasMore:eb.boolean()})).views(e=>({get sortedMentionsMessages(){return ep(e.messages,e=>{let{time:t}=e;return t},"asc")}})).mutations((e,t)=>{let{messageStore:a,scroller:n}=t;function i(e){return r(e.map(e=>e.replyId?yD(e):yO(e)))}function s(e){let{id:t,time:a}=e;return{id:t,time:a}}return{scrollEnd(){requestAnimationFrame(()=>n.scrollEnd())},setLoading(t){e.loading=t},markFetched(){e.fetched=!0},setPageNum(t){e.pageNum=t},setPreviousLoading(t){e.previousLoading=t},setHasMore(t){1!==e.scopeType||t?e.hasMore=t:(e.hasMore=!0,e.scopeType=2,e.pageNum=0)},setMentionsMessages(t){let n=i(t);a.setPartialMessages(n),e.messages=n.map(s)},appendMentionsMessages(t){let n=i([t]);a.setPartialMessages(n),e.messages=l$([...e.messages,...n.map(s)],e=>{let{id:t}=e;return t},!0)},prependMentionsMessages(t){let n=i(F(t.map(e=>{let{messages:t}=e;return t})));a.setPartialMessages(n),e.messages=l$([...n.map(s),...e.messages],e=>{let{id:t}=e;return t})},removeMentionsMessages(t){let a=N6(t)?t.msgId:t.id;e.messages=e.messages.filter(e=>{let{id:t}=e;return t!==a})}}}).effects((e,t)=>{let{sdk:a,scroller:n}=t;return{onMentionMeMessage:()=>a.mentionMeMessage$.pipe(a_(t=>{let a=N6(t)||"remove"===t.mentionMeType;return a?q(e.removeMentionsMessages(t)):ap([e.appendMentionsMessages(t),e.scrollEnd()])})),fetchMentionMessages:t=>t.pipe(au(t=>a.query.fetchSearchMessages(t).pipe(a_(t=>{let a=t?.data?.msgResult?.length===20&&t?.data?.hasMore;return q(e.setHasMore(a),e.fetchHistoryLastMsg(t?.data?.msgResult??[]))}),J(()=>q(e.setLoading(!1))),aV(e.setLoading(!0),e.setPageNum(t.pageNum??1))))),fetchHistoryLastMsg:t=>t.pipe(au(t=>{let n=N3(t);return a.query.fetchHistoryLastMsg(n).pipe(ah(a=>{let n=F(a.data.map(e=>e.messages));return n.forEach(e=>{let a=t.find(t=>{let{msgId:a}=t;return e.id===a})?.detail?.name?.toString();a&&(e.channelName=a)}),e.setMentionsMessages(n)}),aV(e.setLoading(!0)),aG(e.setLoading(!1),e.markFetched(),e.scrollEnd()))})),fetchPreviousMentionMessages:t=>t.pipe(au(t=>a.query.fetchSearchMessages(t).pipe(a_(t=>{let a=t?.data?.msgResult?.length===20&&t?.data?.hasMore;return q(e.setHasMore(a),e.fetchPreviousHistoryLastMsg(t?.data?.msgResult??[]))}),J(()=>q(e.setPreviousLoading(!1))),aV(e.setPreviousLoading(!0),e.setPageNum(t.pageNum??1))))),fetchPreviousHistoryLastMsg:t=>t.pipe(au(t=>{let i=N3(t),s="",l=!e.sortedMentionsMessages.length;e.sortedMentionsMessages.length&&(s=e.sortedMentionsMessages[0].id);let{restore:o,record:d}=n.restorePosition(s,17);return a.query.fetchHistoryLastMsg(i).pipe(a_(t=>(d?.(),ap(r([e.prependMentionsMessages(t.data),e.setPreviousLoading(!1),l&&e.scrollEnd()])))),U(()=>{requestAnimationFrame(()=>{o?.()})}),J(()=>q(e.setPreviousLoading(!1))))}))}}).create({messages:[],loading:!1,fetched:!1,pageNum:1,scopeType:1,previousLoading:!1,hasMore:!0},{sdk:uW,messageStore:yU,scroller:sM.create("mentions")}),{settings:N8}=g4,N7=e_().schema(()=>({unreadTotal:eb.number(),unreadChannelTotal:eb.number(),unreadReminderTotal:eb.number(),unreadContactTotal:eb.number()})).mutations(e=>{function t(e){switch(e.type){case uf.EXPIRED:case uf.CONFLICT:case uf.REVOKE_TOKEN:o6(e),o3()||(window.location.href="/signin");break;case uf.UNREAD_COUNT:o6(e)}}function a(){let a=e.unreadTotal+e.unreadReminderTotal+e.unreadContactTotal;t({type:uf.UNREAD_COUNT,payload:{total:a,shown:N8.channelShowUnreadMessageCount?a:a-e.unreadChannelTotal}})}return{dispatchUnread(){a()},dispatch(e){t(e)},setUnreadTotal(t){e.unreadTotal!==t&&(e.unreadTotal=t,a())},setUnreadChannelTotal(t){e.unreadChannelTotal!==t&&(e.unreadChannelTotal=t,a())},setUnreadReminderTotal(t){e.unreadReminderTotal!==t&&(e.unreadReminderTotal=t,a())},setUnreadContactTotal(t){e.unreadContactTotal!==t&&(e.unreadContactTotal=t,a())}}}).effects((e,t)=>{let{sdk:a}=t;return{onConnectionConflict:()=>a.connectionConflict$.pipe(ah(()=>e.dispatch({type:uf.CONFLICT}))),onRevokeToken:()=>a.revokeToken$.pipe(ah(()=>e.dispatch({type:uf.REVOKE_TOKEN}))),onUnread:()=>a.unreadChannel$.pipe(a_(t=>{let a=t.reduce((e,t)=>e+t.unreadCount,0),n=t.filter(e=>{let t=yh.chats.find(t=>t.jid===e.sessionId);return t?.type===i1.CHANNEL?e.unreadCount:0}).reduce((e,t)=>e+t.unreadCount,0);return q(e.setUnreadTotal(a),e.setUnreadChannelTotal(n))})),onSettingChange:()=>lw(()=>N8.channelShowUnreadMessageCount).pipe(aZ(1),ah(()=>e.dispatchUnread()))}}),N9=N7.create({unreadTotal:0,unreadChannelTotal:0,unreadReminderTotal:0,unreadContactTotal:0},{sdk:uW,settingsStore:g4,recentChatStore:yh}),we=e=>{let{messages:t}=N4,{unreadNum:a}=yV,{unreadNum:n}=bM,{setUnreadReminderTotal:i,setUnreadContactTotal:s}=N9,{chatId:r}=yh,{reminders:l,contactRequests:o}=g4.settings;switch(l2(()=>{i(a)},[a,i]),l2(()=>{s(n)},[n,s]),e){case sn.MENTION:return function(e){return e.filter(e=>{let{id:t}=e;return!!yU.message(t)?.isUnreadMsg}).length}(t);case sn.REMINDERS:return a;case sn.CONTACT:return n;case sn.MORE:{let e=o||r===sn.CONTACT,t=l||r===sn.REMINDERS;return 0+(e?0:n)+(t?0:a)}default:return 0}},wt={topMenuItem:"_topMenuItem_ml0gc_1",topMenuInner:"_topMenuInner_ml0gc_4",hovered:"_hovered_ml0gc_34",topMenuInnerName:"_topMenuInnerName_ml0gc_40",activated:"_activated_ml0gc_43",topMenuInnerIconAvatar:"_topMenuInnerIconAvatar_ml0gc_55",topMenuInnerIcon:"_topMenuInnerIcon_ml0gc_55",topMenuInnerAction:"_topMenuInnerAction_ml0gc_81"},wa=window.React.forwardRef;function wn(e){switch(e){case sn.MENTION:return oL.$t({id:"d7LCRi",defaultMessage:[{type:0,value:"Mentions"}]});case sn.CONTACT:return oL.$t({id:"+oCyqh",defaultMessage:[{type:0,value:"Contact Requests"}]});case sn.BOOKMARKS:return oL.$t({id:"nGBrvw",defaultMessage:[{type:0,value:"Bookmarks"}]});case sn.REMINDERS:return oL.$t({id:"+vBFap",defaultMessage:[{type:0,value:"Reminders"}]});case sn.FILES:return oL.$t({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]});case sn.MORE:return oL.$t({id:"I5NMJ8",defaultMessage:[{type:0,value:"More"}]});default:return""}}let wi=ex(wa(function(e,t){let{menuId:a,isActive:n,hovered:i,onClick:s}=e,r=we(a),l=wn(a);return g.jsx("li",{className:wt.topMenuItem,children:g.jsxs(dj,{...oI.Sidebar.topMenuBtn(l,n),ref:t,...lc({isActive:n,label:l}),className:f(wt.topMenuInner,{[wt.activated]:n,[wt.hovered]:i}),onClick:s??(()=>{yf({jid:a,type:i1.TOP_MENU})}),children:[g.jsxs("div",{className:wt.topMenuInnerIcon,children:[g.jsx(NL,{className:wt.topMenuInnerIconAvatar,size:"sm",statusOnly:!1,statusLongConnection:!0,topType:a}),g.jsx("span",{className:wt.topMenuInnerName,title:l,children:l})]}),g.jsx("div",{className:wt.topMenuInnerAction,children:g.jsx(N1,{className:wt.chatUnread,count:r})})]})})})),ws={icon:"_icon_mdwbg_1",dropdownMenuContent:"_dropdownMenuContent_mdwbg_11",settingsDropdownItem:"_settingsDropdownItem_mdwbg_15",settingsDropdownItemInner:"_settingsDropdownItemInner_mdwbg_24",settingsDropdownItemLast:"_settingsDropdownItemLast_mdwbg_29",settingsText:"_settingsText_mdwbg_39"},wr=window.React.createElement,wl=window.React.useState,wo=window.React.useRef,wd=ex(function(e){let{hideDivider:t}=e,{settings:a}=g4,{chatId:n}=yh,{$t:i}=oA(),{openChatSetting:s}=Mu(),[r,l]=wl(!1),o=we(sn.REMINDERS),d=we(sn.CONTACT),c=wo(null),u=()=>setTimeout(()=>c.current?.focus(),10),m=e=>{yf({jid:e,type:i1.TOP_MENU}),u()};return g.jsxs(g.Fragment,{children:[g.jsx(wi,{ref:c,menuId:sn.MORE,hovered:r,onClick:()=>l(!0)}),g.jsxs(cg,{open:r,onOpenChange:l,children:[g.jsx(cv,{children:g.jsx("li",{})}),g.jsx(cy,{container:document.body,children:g.jsxs(c_,{onEscapeKeyDown:u,className:ws.dropdownMenuContent,onClick:e=>e.stopPropagation(),side:"bottom",align:"start",children:[!a.contactRequests&&n!==sn.CONTACT&&wr(cb,{...oI.Sidebar.topMenuMoreItem("Contact"),key:"Contact",className:ws.settingsDropdownItem,onClick:()=>m(sn.CONTACT)},g.jsxs("div",{className:ws.settingsDropdownItemInner,children:[g.jsxs("div",{children:[g.jsx(it,{className:ws.icon}),i({id:"+oCyqh",defaultMessage:[{type:0,value:"Contact Requests"}]})]}),g.jsx("div",{children:g.jsx(N1,{count:d})})]})),!a.bookmarks&&n!==sn.BOOKMARKS&&wr(cb,{...oI.Sidebar.topMenuMoreItem("Bookmarks"),key:"Bookmarks",className:ws.settingsDropdownItem,onClick:()=>m(sn.BOOKMARKS)},g.jsxs("div",{children:[g.jsx(ie,{className:ws.icon}),i({id:"nGBrvw",defaultMessage:[{type:0,value:"Bookmarks"}]})]})),!a.reminders&&n!==sn.REMINDERS&&wr(cb,{...oI.Sidebar.topMenuMoreItem("Reminders"),key:"Reminders",className:ws.settingsDropdownItem,onClick:()=>m(sn.REMINDERS)},g.jsxs("div",{className:ws.settingsDropdownItemInner,children:[g.jsxs("div",{children:[g.jsx(n9,{className:ws.icon}),i({id:"+vBFap",defaultMessage:[{type:0,value:"Reminders"}]})]}),g.jsx("div",{children:g.jsx(N1,{count:o})})]})),!a.files&&n!==sn.FILES&&wr(cb,{...oI.Sidebar.topMenuMoreItem("Files"),key:"Files",className:ws.settingsDropdownItem,onClick:()=>m(sn.FILES)},g.jsxs("div",{children:[g.jsx(eG,{className:ws.icon}),i({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]})]})),!t&&g.jsx(cM,{}),wr(cb,{...oI.Sidebar.topMenuMoreItem("CustomizeSettings"),key:"CustomizeSettings",className:ws.settingsDropdownItemLast,onClick:s},i({id:"F7SRdK",defaultMessage:[{type:0,value:"Customize this list in "},{type:8,value:"span",children:[{type:0,value:"Settings"}]}]},{span:e=>g.jsx("span",{className:ws.settingsText,children:e})}))]})})]})]})}),wc=ex(function(){let{chatId:e}=yh,{bookmarks:t,reminders:a,files:n,contactRequests:i}=g4.settings,s=i||e===sn.CONTACT,r=t||e===sn.BOOKMARKS,l=a||e===sn.REMINDERS,o=n||e===sn.FILES,d=s&&r&&l&&o;return g.jsxs(g.Fragment,{children:[g.jsx(wi,{menuId:sn.MENTION,isActive:e===sn.MENTION}),s&&g.jsx(wi,{menuId:sn.CONTACT,isActive:e===sn.CONTACT}),r&&g.jsx(wi,{menuId:sn.BOOKMARKS,isActive:e===sn.BOOKMARKS}),l&&g.jsx(wi,{menuId:sn.REMINDERS,isActive:e===sn.REMINDERS}),o&&g.jsx(wi,{menuId:sn.FILES,isActive:e===sn.FILES}),g.jsx(wd,{hideDivider:d})]})});function wu(e){let{src:t,...a}=e;if(!t)return null;let n=[window.pwaChatConfig.chatCdnPath||"",...t.split("/").slice(-2)].join("/");return g.jsx("img",{...a,src:n})}let wm=window.React.useCallback,wp=()=>{let e=bD(),{repliesMap:t,unsentReplies:a,unsentMessages:n}=y9(),i=wm(e=>{let a=e.commentTotal||0,n=t.get(e.id),i=n?.replyIds??[],s=yU.replies(i),r=n?.start??0,l=n?.end??0;if(!(i.length<a))return s.slice(r,l);{let e=r+l-a;return s.slice(r-e,l-e)}},[t]),s=oa(()=>{let t=e.reduce((e,t)=>{e.push(t);let n=i(t),s=a(t.id);return e.concat(n,s)},[]);return[...t,...n]},[i,e,n,a]);return s},wh=ex(function(e){let{message:t,leading:a}=e,n=function(e){let t=od(null);return l4(()=>{let a=sx.create(e),n=t.current;if(n)return a.observe(n),()=>{a.unobserve(n)}},[e]),t}(t.channelJid),i={[sx.MAIN_MSG_ATTR]:t.id};return g.jsxs("div",{...i,ref:n,children:["forbidden"===t.messageType?g.jsx(Ns,{message:t}):g.jsx(j9,{message:t,leading:a}),g.jsx(NC,{message:t})]})}),wf={messages:"_messages_fn14n_1",afterLoading:"_afterLoading_fn14n_7",loading:"_loading_fn14n_11",dateIndicator:"_dateIndicator_fn14n_16",newIndicator:"_newIndicator_fn14n_24"},wg=window.React.useRef,wy=window.React.useCallback,wv=ex(function(e){let{emptyPlaceholder:t}=e,{connectedChannelJid:a}=yy,{channelJid:n,mode:i,loading:s,fetched:r,unsentMessages:l,localMessages:o,previousLoading:d,nextLoading:c,hasBeforeMessages:u,hasAfterMessages:m,fetchLatestMessages:p,fetchPreviousMessages:h,fetchNextMessages:f,scrollEnd:y}=y9(),{$t:v}=oA(),_=wg(null),b=wy(()=>_.current,[]),M=bD(),x=!r&&"normal"===i&&!!o.length,C=x?[...o,...M]:M,j=function(e){let t=e.find(e=>e.isUnreadMsg)?.time,[a]=_0(t),n=e.findIndex(e=>{let t="date"===e.messageType?void 0:e.time;return!!a&&"number"==typeof t&&a<=t});return -1===n?e:[...e.slice(0,n),{messageType:"new"},...e.slice(n)]}(w_(C,v)),N=function(){let e=wp();return e.map(e=>e.id)}(),w=sM.scrollAttrs(n),I=!j.length&&!l.length&&!u&&!m;return(l2(()=>{a!==n||"normal"!==i||r||s||p()},[a,n,i,r,s,p]),nl(()=>{I||y()}),l2(()=>{x&&y()},[x,y]),!x&&s)?g.jsx(e4,{className:wf.loading,loading:!0}):I?g.jsx(g.Fragment,{children:t}):g.jsx(_Z,{messageIds:N,children:g.jsxs("div",{...oI.Main.messageLoaded,...w,ref:_,className:wf.messages,children:[u&&g.jsx(Nd,{loading:d,onLoad:h,getBoundary:b}),j.map((e,t)=>{switch(e.messageType){case"new":return g.jsx("div",{className:wf.newIndicator,children:v({id:"C4QVdx",defaultMessage:[{type:0,value:"New Messages"}]})},"new");case"date":return g.jsx("div",{className:wf.dateIndicator,children:e.message},e.message);case"call":if(e.callInfo?.action==="invite")return g.jsx(wh,{message:e,leading:!0},e.id);return null;default:return g.jsx(wh,{message:e,leading:wb(j,e,t)},e.id)}}),l.map((e,t)=>g.jsx(Nt,{message:e,leading:wb(l,e,t)},e.id)),m&&g.jsx(Nd,{className:wf.afterLoading,loading:c,onLoad:f,getBoundary:b})]})})});function w_(e,t){let{newRepliesAtBottomOfChat:a}=g4.settings,n=a?"lastCommentTimestamp":"time",i=ad(e)?.[n];if(!i)return e;function s(e){let a=es(e),n=a.format("MMM D");return a.isToday()&&(n=t({id:"zWgbGg",defaultMessage:[{type:0,value:"Today"}]})),a.isYesterday()&&(n=t({id:"6dIxDP",defaultMessage:[{type:0,value:"Yesterday"}]})),a.isBefore(es(),"year")&&(n=a.format("MMM D, YYYY")),{messageType:"date",message:n}}return e.reduce((t,a,i)=>{if(0===i)t.push(s(a[n]||a.time),a);else{let r=e[i-1];es(a[n]).isAfter(r[n],"day")?t.push(s(a[n]||a.time),a):t.push(a)}return t},[])}function wb(e,t,a){let n=e.findIndex(e=>{let{messageType:t}=e;return t!==i.info});if(-1===n)return!1;let s=t.operType===em.edit;function r(e){return e.operType===em.revoke}function l(e){return e.messageType===i.text}function o(e){return!!e.commentTotal}function d(e){return!!oU(e.emojiVotes).length}if(a===n||s||!l(t)||r(t)||o(t)||d(t))return!0;let c=e[a-1];if(!l(c)||r(c)||o(c)||function(e){return!!e.isEditorOpen}(c)||d(c))return!0;let u=c.senderJid!==t.senderJid,m=oX(c.time,t.time)>0;return u||m}let wM=window.React.useCallback,wx=ex(function(e){let{className:t,message:a}=e,{channelJid:n,senderJid:i,time:s,id:r}=a,{$t:l}=oA(),o=lU(n,i),d=wM(()=>{yf({jid:o}),oz.dispatch(oH.jumpToMessage,{chatId:o,msgId:r,sendTime:s,mainMsgId:a.replyId})},[r,o,s,a.replyId]);return g.jsx("div",{className:f(t,"_buttonActions_kb9lt_1"),...oI.Main.msgJumpBtn,children:g.jsx(dj,{className:"_button_kb9lt_1",size:"small",title:l({id:"DHJw7T",defaultMessage:[{type:0,value:"Jump"}]}),onClick:d,children:l({id:"DHJw7T",defaultMessage:[{type:0,value:"Jump"}]})})})}),wC=ex(function(e){let{message:t,richTextRef:a,moreActions:n}=e;return(e=>{switch(e.messageType){case i.text:return g.jsx(jr,{message:e,ref:a,moreActionsRender:n});case i.image:return g.jsx(C1,{imageId:e.file.fileId,msgId:e.id});case i.giphy:return g.jsx(C1,{imageId:e.id,msgId:e.id});case i.file:return g.jsx(CQ,{message:e});case i.mix:return g.jsx(jd,{message:e,moreActionsRender:n,ref:a});case i.e2e:return g.jsx(Cw,{});case i.codeSnippet:return g.jsx(Cj,{message:e});case i.bot:return g.jsx(Cv,{message:e});case i.unknown:return g.jsx(jM,{});default:return null}})(t)}),wj={baseMessage:"_baseMessage_1hvjk_1",rightActions:"_rightActions_1hvjk_7",actions:"_actions_1hvjk_7",unreadTip:"_unreadTip_1hvjk_18",avatar:"_avatar_1hvjk_34",contentWrapper:"_contentWrapper_1hvjk_43",header:"_header_1hvjk_47",topDetail:"_topDetail_1hvjk_53",sender:"_sender_1hvjk_58",channelName:"_channelName_1hvjk_62",time:"_time_1hvjk_67",edited:"_edited_1hvjk_73",content:"_content_1hvjk_43",sideMessage:"_sideMessage_1hvjk_84",sideHeader:"_sideHeader_1hvjk_102",sideHeaderLeft:"_sideHeaderLeft_1hvjk_106",sideHeaderAvatar:"_sideHeaderAvatar_1hvjk_111",sideHeaderDesc:"_sideHeaderDesc_1hvjk_114",sideSender:"_sideSender_1hvjk_118",sideTime:"_sideTime_1hvjk_124",sideHeaderMoreActions:"_sideHeaderMoreActions_1hvjk_127",sideContent:"_sideContent_1hvjk_132",isPinned:"_isPinned_1hvjk_135",pinIcon:"_pinIcon_1hvjk_141"},wN=window.React.useCallback,ww=window.React.useRef,wI=ex(function(e){let{message:t,action:a,layout:n="normal",isUnreadTipVisible:s,...r}=e,{channelJid:l,channelName:o,time:d,id:c,messageType:u,isUnreadMsg:m}=t,p=u===i.bot,h=p?t.botTemplate.from:t.senderJid,{$t:f}=oA(),y=bA(h),v=p?t.botTemplate.name:lT(y||{name:t.senderName||""}),_=ww(null),b=ww(null),M=bt(),x=t.operType===em.edit,C=u===i.unknown,j=u===i.e2e,N=u===i.mix,w=u===i.text,{isPinned:I,pinner:T}=je({id:c}),E={...oI.Main.message,...sM.msgAttrs(c)},S=[{label:f({id:"4l6vz1",defaultMessage:[{type:0,value:"Copy"}]}),key:"copy",operate:()=>{jG(t,_)}}],k=oa(()=>p?t.botTemplate.name:rS(h)?f({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):rT(l)?v:"side"===n?v:"",[f,l,p,n,t,h,v]),A=l3(()=>rT(l)||rS(h)?o&&`(#${o})`:v,[l,o,h,v]),R=lU(l,h),L=wN(()=>{yf({jid:R})},[R]),O=oa(()=>g.jsx("span",{className:wj.rightActions,children:a?a(t,wj.actions):g.jsx(wx,{message:t,className:wj.actions})}),[a,t]);return"side"===n?g.jsxs("div",{tabIndex:0,className:wj.sideMessage,...oI.MoreActions.sideMessage,children:[g.jsxs("div",{className:wj.sideHeader,children:[g.jsxs("div",{className:wj.sideHeaderLeft,children:[g.jsx("div",{className:wj.sideHeaderAvatar,children:g.jsx(_L,{jid:h,image:y?.avatar??"",name:v??"",size:"sm"})}),g.jsxs("div",{className:wj.sideHeaderDesc,children:[g.jsx("div",{className:wj.sideSender,children:k}),g.jsx("div",{className:wj.sideTime,children:oK(d)})]})]}),g.jsx("div",{className:wj.sideHeaderMoreActions,children:O})]}),g.jsxs("div",{className:wj.sideContent,children:[g.jsx(_v,{items:S,disabled:C||j,children:g.jsx("div",{className:wj.content,children:g.jsx(wC,{message:t,richTextRef:_})})}),I&&g.jsxs("div",{className:wj.isPinned,children:[g.jsx(n5,{className:wj.pinIcon}),f({id:"1J+gut",defaultMessage:[{type:0,value:"Pinned by "},{type:1,value:"name"}]},{name:M({jid:T?.jid,name:T?.name})})]})]})]}):g.jsxs("div",{...r,...E,ref:b,className:wj.baseMessage,tabIndex:0,children:[s&&m&&g.jsx("div",{className:wj.unreadTip}),g.jsx("div",{className:wj.avatar,children:g.jsx(M5,{userJid:h||"",children:g.jsx(_L,{jid:h,image:y?.avatar??"",name:v??"",size:"lg"})})}),g.jsx("div",{className:wj.contentWrapper,children:g.jsx(_v,{items:S,disabled:C||j,children:g.jsxs("div",{children:[g.jsxs("div",{className:wj.header,children:[g.jsxs("span",{className:wj.topDetail,children:[g.jsx("span",{className:wj.sender,children:k}),A&&g.jsx("span",{tabIndex:0,role:"link",className:wj.channelName,onClick:L,children:A})]}),g.jsx("span",{className:wj.time,children:oK(d)}),x&&g.jsx("div",{className:wj.edited,children:f({id:"KIEDgv",defaultMessage:[{type:0,value:"(Edited)"}]})})]}),g.jsxs("div",{className:wj.content,children:[g.jsx(wC,{message:t,richTextRef:_,moreActions:O}),g.jsx("br",{}),!N&&!w&&O]})]})})})]})}),wT=ex(function(e){let{msgId:t,...a}=e,{message:n}=yU,i=n(t);return i?g.jsx(wI,{message:i,...a}):null}),wE=e_().schema(()=>({pmcGotoDetail:eb.object({jid:eb.string(),topic:eb.string()}).nullable()})).mutations((e,t)=>{let{recentChatStore:a}=t;return{openPmcGotoTip(t){t.jid&&a.chatId!==t.jid&&(e.pmcGotoDetail=t)},closePmcGotoTip(){e.pmcGotoDetail=null}}}).create({pmcGotoDetail:null},{recentChatStore:yh}),wS={popoverArrow:"_popoverArrow_1r8wj_1",popover:"_popover_1r8wj_1",popoverContent:"_popoverContent_1r8wj_10",title:"_title_1r8wj_17",closeBtn:"_closeBtn_1r8wj_23",text:"_text_1r8wj_26",bold:"_bold_1r8wj_30",buttonContainer:"_buttonContainer_1r8wj_33"},wk=window.React.useCallback,wA=ex(e=>{let{isShown:t}=e,{$t:a}=oA(),{onPmcTipsClose:n}=Mu(),{pmcGotoDetail:i,closePmcGotoTip:s}=wE,{setChatId:r,chatId:l}=yh,o=wk(()=>{i&&n({jid:i.jid}),s()},[i,n,s]);oe(()=>{i&&i.jid===l&&o()},[l,i,o]);let d=wk(()=>{i&&(r(i.jid),o())},[r,o,i]);if(!i||!t(i.jid))return g.jsx(g.Fragment,{});let c=g.jsx(g.Fragment,{children:g.jsxs("div",{className:wS.popoverContent,children:[g.jsxs("div",{className:wS.title,children:[a({id:"jPHQX9",defaultMessage:[{type:0,value:"Pick up where you left off"}]}),g.jsx(dj,{className:wS.closeBtn,icon:g.jsx(e8,{}),size:"small",type:"text",onClick:o})]}),g.jsx("div",{className:wS.text,children:a({id:"JZJkWy",defaultMessage:[{type:0,value:"Messages sent during "},{type:1,value:"meetingName"},{type:0,value:" will now appear under a group chat with the same name."}]},{meetingName:g.jsx("span",{className:wS.bold,children:i.topic})})}),g.jsx("div",{className:wS.buttonContainer,children:g.jsx(dj,{size:"small",type:"primary",onClick:d,children:a({id:"BHwMet",defaultMessage:[{type:0,value:"Go to chat"}]})})})]})});return g.jsx(cc,{className:wS.popover,arrowClassName:wS.popoverArrow,arrow:!0,open:!0,content:c,side:"right",sticky:"always",children:g.jsx("span",{className:wS.pmcGotoTip})})}),wR={headerHeading:"_headerHeading_xddg2_1",title:"_title_xddg2_6",titleMUC:"_titleMUC_xddg2_13",chatItemInnerUsername:"_chatItemInnerUsername_xddg2_17",hovered:"_hovered_xddg2_28",activated:"_activated_xddg2_34",mucNumStyle:"_mucNumStyle_xddg2_41"},wL=ex(function(e){let{className:t,channelJid:a,handleEdit:n,targetRef:i,isMainPanelHeader:s,activated:r,title:l,hovered:o}=e,{mucName:d,mucUserNum:c}=function(e,t,a){let{isMemberListLoaded:n,getMemberListValue:i,getMemberNumTotal:s,fetchMUCMembers:r}=bQ,[l,o]=bZ(""),[d,c]=bZ(0),u=i(t),m=s(t),p=n(t);return l2(()=>{p||(nv(window,"requestIdleCallback")?requestIdleCallback(()=>{r(t)}):setTimeout(()=>{r(t)}))},[t,p]),oh(e,e=>{if(u&&m){let[t,n]=function(e,t,a,n){let i=function(e){return e?{divGap:80,font:"bold 14px sans-serif"}:{divGap:84,font:"14px sans-serif"}}(n),[s,r]=function(e,t){let a=window.pwaChatConfig.jid,n=e.filter(e=>{let{jid:t}=e;return t!==a}).map(e=>e.name);return n.length>8?(t-=8,n=n.slice(0,8)):t=0,[n,t]}(t,a);e-=i.divGap;let l=oq(),o=function(e,t,a,n){if(o$(e.join(","),t.font,a)<=n)return e.length;let i=0,s=e.length-1;for(;i<s;){let r=Math.floor((i+s)/2);o$(e.slice(0,r+1).join(","),t.font,a)<=n?i=r+1:s=r}return i}(s,i,l,e),d=s.slice(0,o+1).join(", "),c=s.length-o-1+r;return[d,c<=0?0:c]}(e.width,u,m,a);o(t),c(n)}}),{mucName:l,mucUserNum:d}}(i,a,s);return g.jsxs("div",{className:f(t,wR.headerHeading),children:[s?g.jsx("span",{className:f(wR.title,wR.titleMUC),onClick:n,children:d||l}):g.jsx("span",{className:f(wR.chatItemInnerUsername,{[wR.activated]:r,[wR.hovered]:o}),title:d||l,children:d||l}),g.jsx("span",{className:f({[wR.mucNumStyle]:!s,[wR.activated]:r,[wR.hovered]:o}),children:0===c?null:` ,+${c}`})]})}),wO={menuAction:"_menuAction_11z0i_1"},wD=ex(function(e){let{jid:t,className:a,onOpenChange:n,...i}=e,{$t:s}=oA(),{starChat:r,unStarChat:l,blockUser:o,unblockUser:d,markChatReadStatus:c}=Mp(),{handleDeleteContact:u}=bI(),m=bA(t),p=ba.isBlocked(t),{timestamp:h}=yh.chatMap.get(t)||{},y=gq.totalUnreadCount(t),{isChatStarred:v}=yh,_=v(t),b=bc(t),M=rS(t),x=bO({jid:t,orgUnit:m?.orgUnit??""}),C=bk({jid:t,orgUnit:m?.orgUnit??""}),{phoneVisible:j,phoneNumber:N,startContactPhoneCall:w}=Mv(t),I=[{key:"MarkAsUnread",text:s({id:"Fpscrv",defaultMessage:[{type:0,value:"Mark as Unread"}]}),invisible:!(!y&&h),testKey:"markAsUnread",separator:!0,operate:()=>c({channelId:t,status:"unread"})},{key:"MarkAsRead",text:s({id:"CVph6v",defaultMessage:[{type:0,value:"Mark as Read"}]}),invisible:!y,testKey:"markAsRead",separator:!0,operate:()=>c({channelId:t,status:"read"})},{key:"PhoneCall",text:s({id:"Y9S8d5",defaultMessage:[{type:0,value:"Phone Call"}]}),invisible:M||!j||!N||b,testKey:"phoneCall",separator:!0,operate:w},{key:"Star",text:s(b?{id:"DoLG69",defaultMessage:[{type:0,value:"Star this App"}]}:{id:"tVDvqy",defaultMessage:[{type:0,value:"Star this Contact"}]}),invisible:_,testKey:"star",separator:!0,operate:()=>r({channelId:t})},{key:"UnStar",text:s(b?{id:"OWQ+Xk",defaultMessage:[{type:0,value:"Unstar this App"}]}:{id:"G4y4wM",defaultMessage:[{type:0,value:"Unstar this Contact"}]}),invisible:!_,testKey:"unStar",separator:!0,operate:()=>l({channelId:t})},{key:"BlockContact",text:s(b?{id:"NG5b6s",defaultMessage:[{type:0,value:"Block App"}]}:{id:"A4eK08",defaultMessage:[{type:0,value:"Block Contact"}]}),invisible:M||p,testKey:"blockContact",separator:!0,operate:()=>o({jid:t})},{key:"UnblockContact",text:s(b?{id:"n/lx+X",defaultMessage:[{type:0,value:"Unblock App"}]}:{id:"74ItpR",defaultMessage:[{type:0,value:"Unblock Contact"}]}),invisible:M||!p,testKey:"unBlockContact",separator:!0,operate:()=>d({jid:t})},{key:"DeleteContact",danger:!0,text:s({id:"62mqGj",defaultMessage:[{type:0,value:"Delete Contact"}]}),invisible:M||!x||!C||b,testKey:"deleteContact",operate:()=>u({jid:t,email:m?.email||"",name:lT(m??{})})}];return g.jsx(cQ,{side:"bottom",align:"start",options:I,onOpenChange:n,children:g.jsx(dj,{...i,className:f(wO.menuAction,a),tabIndex:0,"aria-label":s({id:"inS0m7",defaultMessage:[{type:0,value:"chat options, menu button"}]}),onKeyDown:lo(),size:"small",type:"text",icon:g.jsx(tC,{})})})}),wP=ex(function(e){let{chat:t,isOwner:a=!1,isAdmin:n=!1,isNoMeetingsLicenseTypeUser:i,isMeeting:s=!1,onOpenChange:r,className:l,...o}=e,{jid:d,type:c,timestamp:u}=t,{$t:m}=oA(),{notifyType:p,isMuted:h,setNotification:y,mute:v,unmute:_}=b1(d),{openMeetingModal:b,openAddMemberModal:M,openEditChannelModal:x,openDeleteChannelModal:C,markChatReadStatus:j,starChat:N,unStarChat:w}=Mp(),{isPMC:I,isSpotChannel:T,channelInfo:E}=gQ,S=E(d)?.name??"",{isChatStarred:k}=yh,A=k(d),R=gq.totalUnreadCount(d),L=o3()&&!i&&!I(d)&&!T(d),O=L&&!s,D=[{key:"CopyDeepLink",text:yn(c)?m({id:"7onTOt",defaultMessage:[{type:0,value:"Copy Link to Channel"}]}):m({id:"65z0kD",defaultMessage:[{type:0,value:"Copy Link to Chat"}]}),testKey:"copyDeepLinkChannel",separator:!0,operate:()=>{o2.info(m({id:"2yCGR2",defaultMessage:[{type:0,value:"Link copied to clipboard"}]})),rX.copyText(lY({sid:d}))}},{key:"InviteToMeeting",text:m({id:"Q72/t8",defaultMessage:[{type:0,value:"Invite to Meeting"}]}),invisible:!(L&&s),testKey:"inviteToMeeting",operate:()=>b({channelId:d,channelName:S,meetingType:i3.GROUP_CHAT,meetingWithVideo:!1})},{key:"MeetWithVideo",text:m({id:"YP+RMT",defaultMessage:[{type:0,value:"Meet with Video"}]}),invisible:!O,testKey:"meetWithVideo",operate:()=>b({channelId:d,channelName:S,meetingType:i3.GROUP_CHAT,meetingWithVideo:!0})},{key:"MeetWithoutVideo",text:m({id:"qEuFNV",defaultMessage:[{type:0,value:"Meet without Video"}]}),invisible:!O,testKey:"meetWithoutVideo",separator:!0,operate:()=>b({channelId:d,channelName:S,meetingType:i3.GROUP_CHAT,meetingWithVideo:!1})},{key:"MarkAsUnread",text:m({id:"Fpscrv",defaultMessage:[{type:0,value:"Mark as Unread"}]}),invisible:!(!R&&u),testKey:"markAsUnread",separator:!0,operate:()=>j({channelId:d,status:"unread"})},{key:"MarkAsRead",text:m({id:"CVph6v",defaultMessage:[{type:0,value:"Mark as Read"}]}),invisible:!R,testKey:"markAsRead",separator:!0,operate:()=>j({channelId:d,status:"read"})},{key:"AddMembers",text:m({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),testKey:"addMembers",operate:()=>M({channelId:d})},{key:"Star",text:ya(c)?m({id:"yGv4+p",defaultMessage:[{type:0,value:"Star this Chat"}]}):m({id:"ELpBFh",defaultMessage:[{type:0,value:"Star this Channel"}]}),invisible:A,testKey:"star",separator:!0,operate:()=>N({channelId:d})},{key:"UnStar",text:ya(c)?m({id:"+alAWX",defaultMessage:[{type:0,value:"Unstar this Chat"}]}):m({id:"6Rkob7",defaultMessage:[{type:0,value:"Unstar this Channel"}]}),invisible:!A,testKey:"unStar",separator:!0,operate:()=>w({channelId:d})},{key:"Notifications",text:m({id:"NAidKb",defaultMessage:[{type:0,value:"Notifications"}]}),children:[{key:"NotificationsAllMessages",text:m({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]}),subText:m({id:"XMhUcZ",defaultMessage:[{type:0,value:"Get notified for all message activity"}]}),groupTitle:m({id:"j7DZu/",defaultMessage:[{type:0,value:"Message Preferences"}]}),testKey:"notificationsAllMessages",checked:p===np.all,operate:()=>y(np.all)},{key:"NotificationsMentions",text:m({id:"DKAqfN",defaultMessage:[{type:0,value:"Mentions and Replies"}]}),subText:m({id:"lnaTlC",defaultMessage:[{type:0,value:"Includes group or personal mentions, and replies to you"}]}),testKey:"notificationsMentions",checked:p===np.mention,operate:()=>y(np.mention)},{key:"NotificationsOff",text:m({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]}),subText:m({id:"/GbGfr",defaultMessage:[{type:0,value:"Turn off chat notifications"}]}),testKey:"notificationsOff",checked:p===np.off,operate:()=>y(np.off)}]},{key:ya(c)?"MuteChat":"MuteChannel",text:ya(c)?m({id:"9NjGLp",defaultMessage:[{type:0,value:"Mute Chat"}]}):m({id:"DDNoEN",defaultMessage:[{type:0,value:"Mute Channel"}]}),testKey:ya(c)?"muteChat":"muteChannel",invisible:h,separator:!0,operate:v},{key:ya(c)?"UnmuteChat":"UnmuteChannel",text:ya(c)?m({id:"UVhV1I",defaultMessage:[{type:0,value:"Unmute Chat"}]}):m({id:"QoeyW3",defaultMessage:[{type:0,value:"Unmute Channel"}]}),testKey:ya(c)?"unmuteChat":"unmuteChannel",invisible:!h,separator:!0,operate:_}],P=[...D,{key:"EditChat",text:m({id:"HssoVa",defaultMessage:[{type:0,value:"Edit Chat"}]}),invisible:!a,testKey:"editChat",operate:()=>x({channelId:d,chatType:i1.MUC})},{key:"DeleteChat",danger:!0,text:m({id:"NMr04q",defaultMessage:[{type:0,value:"Delete Chat"}]}),invisible:!a,testKey:"deleteChat",operate:()=>C({channelId:d,channelName:S,chatType:i1.MUC})}],F=[...D,{key:"EditChannel",text:m({id:"62P16S",defaultMessage:[{type:0,value:"Edit Channel"}]}),invisible:!(a||n),testKey:"editChannel",operate:()=>x({channelId:d,chatType:i1.CHANNEL})},{key:"DeleteChannel",danger:!0,text:m({id:"dzosaH",defaultMessage:[{type:0,value:"Delete Channel"}]}),invisible:!a,testKey:"deleteChannel",operate:()=>C({channelId:d,channelName:S,chatType:i1.CHANNEL})}];return yt(c)&&!rS(d)?g.jsx(wD,{jid:d,className:l,onOpenChange:r,...o}):ya(c)||yn(c)?g.jsx(cQ,{side:"bottom",align:"start",options:ya(c)?P:F,onOpenChange:r,children:g.jsx(dj,{...o,className:f(wO.menuAction,l),tabIndex:0,"aria-label":yn(c)?m({id:"F96pYa",defaultMessage:[{type:0,value:"channel options, menu button"}]}):m({id:"inS0m7",defaultMessage:[{type:0,value:"chat options, menu button"}]}),onKeyDown:lo(),size:"small",type:"text",icon:g.jsx(tC,{})})}):null}),wF={chatItem:"_chatItem_qf4qt_1",chatItemInner:"_chatItemInner_qf4qt_4",visible:"_visible_qf4qt_38",chatItemInnerAction:"_chatItemInnerAction_qf4qt_44",chatUnread:"_chatUnread_qf4qt_44",chatMenuAction:"_chatMenuAction_qf4qt_47",chatItemInnerUsername:"_chatItemInnerUsername_qf4qt_67",chatItemInnerUser:"_chatItemInnerUser_qf4qt_67",chatItemInnerUserAvatar:"_chatItemInnerUserAvatar_qf4qt_80",chatItemInnerDotClose:"_chatItemInnerDotClose_qf4qt_97",activated:"_activated_qf4qt_146",deactivatedAvatarDark:"_deactivatedAvatarDark_qf4qt_181",deactivatedAvatarActive:"_deactivatedAvatarActive_qf4qt_186"},wB={simpleItem:"_simpleItem_1u1fs_1",chatAvatar:"_chatAvatar_1u1fs_15",chatName:"_chatName_1u1fs_24",chatNameInner:"_chatNameInner_1u1fs_31"},wU=window.React.useRef,wH=ex(function(e){let{jid:t,className:a,onClick:n,...i}=e,s=wU(null),{isNoTopic:r,sessionType:l,name:o}=b2(t),d=oa(()=>r?g.jsx(wL,{className:wB.chatNameInner,channelJid:t,isMainPanelHeader:!1,targetRef:s,title:o}):o,[r,o,t,s]),c=oa(()=>g.jsx(NL,{className:wB.chatAvatar,jid:t,chatType:l,size:"sm"}),[t,l]);return g.jsxs("div",{className:a,onClick:n,...i,children:[c,g.jsx("div",{ref:s,className:wB.chatName,children:d})]})});function wz(e){let{jid:t,className:a,onClick:n,...i}=e,{$t:s}=oA();if(!t)return null;let r={...ld(()=>n?.(t),!0),...i,className:f(a,wB.simpleItem)};return t===g8?g.jsxs("div",{...r,children:[g.jsx(NL,{className:wB.chatAvatar,chatType:i1.UNKNOWN,size:"sm"}),g.jsx("span",{className:wB.chatName,children:s({id:"UT7Nkj",defaultMessage:[{type:0,value:"New Chat"}]})})]}):sd.includes(t)?g.jsxs("div",{...r,children:[g.jsx(NL,{className:wB.chatAvatar,topType:t,size:"sm"}),g.jsx("span",{className:wB.chatName,children:wn(t)})]}):rT(t)?g.jsx(wH,{jid:t,...r}):g.jsx(CR,{className:r.className,onSelect:r.onClick,data:{jid:t,name:"",role:0,joinTime:null},showOps:!1,hidePopover:!0,ariaAttrs:i})}let wV=window.React.useRef,wG=window.React.useState,wq=ex(function(e){let{$t:t}=oA(),{chat:a,activated:n}=e,{presenceText:i=""}=bu(a.jid,!0),{jid:s,type:r}=a,{totalUnreadCount:l,mentioned:o}=gq,[d,c]=wG(!1),{isMuted:u}=b1(s),{removeChat:m}=yh,p=yt(r),{channelShowUnreadMessageCount:h,showAvatarForDirectChat:y,sidebarTheme:v}=g4.settings,_=yn(r)&&!h,{fetchProfileLazy:b,userInfo:M}=g2,{channelInfo:x}=gQ,{isNoMeetingsLicenseTypeUser:C}=up,{isMeeting:j}=vB;l2(()=>{p&&b(s)},[s,b,p]);let N=bL(s),w=oa(()=>yi(r)?t({id:"UT7Nkj",defaultMessage:[{type:0,value:"New Chat"}]}):yt(r)?lT(M(s)??{}):x(s)?.name??"",[t,r,M,x,s]),I=rS(s)?`${w} (${t({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`:w,T=ya(r)&&!!x(s)?.isNoTopic,E=wV(null);function S(e){e.stopPropagation(),m(a.jid)}function k(){yf({jid:s,type:r})}let A=v!==sr.LIGHT,R=f({[wF.deactivatedAvatarActive]:n&&N,[wF.deactivatedAvatarDark]:N&&A}),L=rS(s)?{"data-is-self":!0}:{},[O]=id(e=>g.jsxs("div",{...oI.Sidebar.chatItem(I,n),className:f(wF.chatItemInner,{[wF.visible]:d,[wF.activated]:n}),...L,...ld(k),...lc({isActive:n,label:lu([yn(r)?t({id:"KeO51o",defaultMessage:[{type:0,value:"Channel"}]}):t({id:"WTrOy3",defaultMessage:[{type:0,value:"Chat"}]}),I,p?i:""])}),children:[g.jsxs("div",{className:wF.chatItemInnerUser,ref:E,children:[g.jsx(M3,{popover:p,userJid:s??"",children:g.jsx(NL,{className:wF.chatItemInnerUserAvatar,jid:s,name:w,url:M(s)?.avatar??"",chatType:r,size:"sm",statusOnly:y?void 0:!e,statusLongConnection:!0,deactivatedAvatarClass:R,isMuted:u})}),T?g.jsx(wL,{channelJid:s,targetRef:E,isMainPanelHeader:!1,activated:n,title:I,hovered:e}):g.jsx("span",{className:wF.chatItemInnerUsername,title:I,children:I}),N&&g.jsx(_O,{activated:n})]}),g.jsx("div",{className:wF.chatItemInnerAction,children:e&&yi(r)?g.jsx(e8,{className:wF.chatItemInnerDotClose,onClick:S}):g.jsxs(g.Fragment,{children:[g.jsx(N1,{mentioned:o(s)}),g.jsx(N1,{className:wF.chatUnread,count:l(s),hideCount:_}),g.jsx(NW,{jid:s,hovered:e,children:e=>{let{isAdmin:t,isOwner:i}=e;return g.jsx(wP,{...oI.Sidebar.chatItemMoreAction(I,n),className:wF.chatMenuAction,chat:a,isAdmin:t,isOwner:i,isNoMeetingsLicenseTypeUser:C,isMeeting:j,onOpenChange:c})}})]})}),g.jsx(wA,{isShown:e=>s===e})]}));return g.jsx("div",{className:wF.chatItem,children:O})}),w$=function(e){let t=t=>{let{chatId:a,...n}=t,{chatMap:i}=yh,s=i.get(a);if(!s)return null;let r={...n,chat:s};return g.jsx(e,{...r})};return t.displayName=e.displayName,ex(t)}(wq),wK={navigation:"_navigation_t7wd6_1",navigateBtn:"_navigateBtn_t7wd6_4",historyBtn:"_historyBtn_t7wd6_14",activated:"_activated_t7wd6_18",historyList:"_historyList_t7wd6_25"},wJ=window.React.useState,wW=window.React.useCallback;function wY(e){let{data:t,disabled:a}=e,[n,i]=wJ(!1),{$t:s}=oA(),r=wW(e=>{yf({jid:e})},[]),l=oa(()=>{let e=[];for(let a=t.length-1;a>=0;a--)e.push(t[a]);return g.jsx(dE,{...oI.Navigation.historyList,dataList:e,keyedBy:e=>`history-${e}`,dataRender:(e,t)=>g.jsx(wz,{jid:e,...t,onClick:r})})},[t,r]);return g.jsx("div",{children:g.jsx(cc,{className:wK.historyList,trigger:"click",side:"right",align:"start",sideOffset:-28,alignOffset:28,arrow:!1,content:l,onOpenChange:i,children:g.jsx(dj,{...oI.Navigation.history,className:f(wK.navigateBtn,wK.historyBtn,{[wK.activated]:n}),icon:g.jsx(iu,{}),disabled:a,title:s({id:"D0nsK2",defaultMessage:[{type:0,value:"History"}]}),size:"small"})})})}let wX=ex(function(e){let{className:t}=e,{backwardEnabled:a,forwardEnabled:n,backward:i,forward:s,historyList:r,globalDisabled:l}=MI,{$t:o}=oA(),{isAppleOS:d}=oi();l2(()=>{let e=e=>{(d?e.metaKey:e.ctrlKey)&&("["===e.key?(e.preventDefault(),i()):"]"===e.key&&(e.preventDefault(),s()))};return window.addEventListener("keydown",e,!1),()=>{window.removeEventListener("keydown",e,!1)}},[d,i,s]);let c=oa(()=>g.jsx(dj,{...oI.Navigation.back,className:wK.navigateBtn,size:"small",title:`${o({id:"lrfaxd",defaultMessage:[{type:0,value:"Back in Chat"}]})}(${d?"\u2318":"Ctrl"}+[)`,disabled:!a,onClick:i,icon:g.jsx(ic,{"aria-hidden":"true"})}),[a,i,o,d]),u=oa(()=>g.jsx(dj,{...oI.Navigation.forward,className:wK.navigateBtn,size:"small",title:`${o({id:"lYHLlS",defaultMessage:[{type:0,value:"Forward in Chat"}]})}(${d?"\u2318":"Ctrl"}+])`,disabled:!n,onClick:s,icon:g.jsx(tU,{"aria-hidden":"true"})}),[n,s,o,d]),m=oa(()=>g.jsx(wY,{data:r,disabled:l}),[r,l]);return g.jsxs("div",{className:f(t,wK.navigation),...oI.Navigation.panel,children:[c,u,m]})});eb.object(gA);let wQ=e_().schema(()=>({dataClassificationMap:eb.map(eb.string(),eb.object(gB)),defaultDataClassification:eb.object(gB).optional()})).mutations(e=>({setDefaultDataClassification(t){e.defaultDataClassification=t},setDataClassificationMap(t){t.forEach(t=>{e.dataClassificationMap.set(t.id,t)})}})).effects((e,t)=>{let{sdk:a}=t;return{fetchClassificationList:t=>t.pipe(au(()=>!function(){return!!window.pwaChatConfig.isDataClassificationEnabled}()?K:a.query.fetchClassificationList().pipe(au(t=>{let a=t.find(e=>1===e.type);return q(e.setDataClassificationMap(t),e.setDefaultDataClassification(a))}))))}}),wZ=wQ.create({dataClassificationMap:new Map},{sdk:uW});wZ.fetchClassificationList();let w1={dataLabel:"_dataLabel_1257h_1"},w0=ex(function(e){let{classificationId:t}=e,{defaultDataClassification:a,dataClassificationMap:n}=wZ,i=n.get(t||"")||a;return i?g.jsx("div",{style:{backgroundColor:sp[i.color]},className:w1.dataLabel,"aria-label":`classification ${i.name}`,children:i.name}):g.jsx(g.Fragment,{})}),w2=e_().schema(()=>({})).mutations(()=>({})).effects((e,t)=>{let{sdk:a,recentChatStore:n}=t;return{createChannel:e=>e.pipe(au(e=>{let{onSuccess:t,onAction:n,onError:i,...s}=e;return n?.(),a.mutation.createChannel(s).pipe(J(e=>(i?.(e),K)),U(()=>t?.()),H())})),updateMUC:e=>e.pipe(au(e=>{let{onSuccess:t,onAction:n,onError:i,...s}=e;return n?.(),a.mutation.updateMUC(s).pipe(J(e=>(i?.(e),K)),U(()=>t?.()),H())})),updateChannel:e=>e.pipe(au(e=>{let{onSuccess:t,onAction:n,onError:i,...s}=e;return n?.(),a.mutation.updateChannel(s).pipe(J(e=>(i?.(e),K)),U(()=>t?.()),H())})),addMember:e=>e.pipe(au(e=>{let{onSuccess:t,onAction:n,onError:i,channelId:s,...r}=e;return n?.(),a.mutation.addMember({...r,id:s}).pipe(J(e=>(i?.(e),K)),U(()=>t?.()),H())})),removeMember:e=>e.pipe(au(e=>{let t,{channelId:n,data:i,onAction:s,onError:r,onSuccess:l}=e;if(s?.(),i.jid)t=a.mutation.removeMember({id:n,memberList:[i]});else{if(!i.email)return K;t=a.mutation.removeInvitation({session:n,emailList:[i.email]})}return t.pipe(J(e=>(r?.(e),K)),U(()=>l?.()),H())})),transferOwner:e=>e.pipe(au(e=>{let{channelId:t,data:n,onAction:i,onError:s,onSuccess:r}=e;return i?.(),a.mutation.transferOwner({channelId:t,jid:n.jid,displayName:n.name}).pipe(J(e=>(s?.(e),K)),U(()=>r?.()),H())})),assignAdmin:e=>e.pipe(au(e=>{let{channelId:t,data:n,action:i,onAction:s,onError:r,onSuccess:l}=e;return s?.(),a.mutation.assignAdmin({channelId:t,jid:n.jid,displayName:n.name,action:i}).pipe(J(e=>(r?.(e),K)),U(()=>l?.()),H())})),leaveChannel:e=>e.pipe(au(e=>{let{channelId:t,onAction:n,onError:i,onSuccess:s}=e;return n?.(),a.mutation.leaveChannel({id:t}).pipe(J(e=>(i?.(e),K)),U(()=>s?.()),H())})),leaveChat:e=>e.pipe(au(e=>{let{channelId:t,onAction:n,onError:i,onSuccess:s}=e;return n?.(),a.mutation.leaveChat({id:t}).pipe(J(e=>(i?.(e),K)),U(()=>s?.()),H())})),leaveChannelAndAssign:e=>e.pipe(au(e=>{let{channelId:t,data:n,onAction:i,onError:s,onSuccess:r}=e;return i?.(),a.mutation.leaveAndAssignChannel({channelId:t,jid:n.jid,displayName:n.name}).pipe(J(e=>(s?.(e),K)),U(()=>r?.()),H())})),leaveChatAndAssign:e=>e.pipe(au(e=>{let{channelId:t,data:n,onAction:i,onError:s,onSuccess:r}=e;return i?.(),a.mutation.leaveAndAssignChat({channelId:t,jid:n.jid,displayName:n.name}).pipe(J(e=>(s?.(e),K)),U(()=>r?.()),H())})),deleteChannel:e=>e.pipe(au(e=>{let{channelId:t,onSuccess:n,onAction:i,onError:s}=e;return i?.(),a.mutation.deleteChannel({id:t}).pipe(J(e=>(s?.(e),K)),U(()=>n?.()),H())})),deleteChat:e=>e.pipe(au(e=>{let{channelId:t,onAction:n,onError:i,onSuccess:s}=e;return n?.(),a.mutation.deleteMUC({id:t}).pipe(J(e=>(i?.(e),K)),U(()=>s?.()),H())})),joinChannel:e=>e.pipe(am(e=>{let{channelId:t,onSuccess:i,onAction:s,onError:r}=e;return s?.(),a.mutation.joinChannel(t).pipe(J(e=>(r?.(e),K)),U(()=>i?.()),a_(()=>q(n.setChatId(t))))})),addMioApp:e=>e.pipe(au(e=>{let{channelId:t,apps:n,onAction:i,onError:s,onSuccess:r}=e;return i?.(),a.mutation.addMioAppToChannel({channelJid:t,jids:n}).pipe(J(e=>(s?.(e),K)),U(()=>r?.()),H())})),removeMioApp:e=>e.pipe(au(e=>{let{channelId:t,apps:n,onAction:i,onError:s,onSuccess:r}=e;return i?.(),a.mutation.removeMioAppFromChannel({channelJid:t,jids:n}).pipe(J(e=>(s?.(e),K)),U(()=>r?.()),H())}))}}),w5=(()=>w2.create({},{sdk:uW,recentChatStore:yh}))();function w3(e){let{name:t,className:a}=e;return g.jsx(im,{name:t,children:e=>g.jsx("div",{className:f(a,"_formError_1edf5_1"),children:e})})}function w6(e){let{className:t,children:a,...n}=e;return g.jsx("label",{...n,className:f(t,"_formLabel_p86c5_1"),children:a})}let w4={formField:"_formField_1jyd1_1",subLabel:"_subLabel_1jyd1_8",descriptionLabel:"_descriptionLabel_1jyd1_12"};function w8(e){let{name:t,label:a,subLabel:n,description:i,style:s,className:r,labelClassName:l,subLabelClassName:o,children:d,suffix:c,...u}=e;return g.jsxs("fieldset",{style:s,className:f(r,w4.formField),...u,children:[a&&g.jsxs(w6,{htmlFor:t,className:l,children:[a,n&&g.jsx("span",{className:f(o,w4.subLabel),children:n}),c,i&&g.jsx("div",{className:f(o,w4.descriptionLabel),children:i})]}),d,g.jsx(w3,{name:t})]})}function w7(e){let{name:t,disabled:a,onChange:n,...i}=e;return g.jsx(ip,{name:t,children:e=>{let{field:{value:s},form:{setFieldValue:r,setFieldTouched:l}}=e;return g.jsx(cz,{name:t,checked:s,onChange:e=>{r(t,e),l(t,!0,!1),n&&n(e)},disabled:a,...i})}})}let w9={formCheckboxLabel:"_formCheckboxLabel_chrt9_1",formCheckboxFiled:"_formCheckboxFiled_chrt9_1",formCheckboxText:"_formCheckboxText_chrt9_6",formCheckboxSubText:"_formCheckboxSubText_chrt9_13"};function Ie(e){let{className:t,style:a,label:n="",suffix:i,text:s,subText:r,disabled:l,name:o,textClassName:d,labelText:c="",customAriaLabel:u,...m}=e;return g.jsx(w8,{className:t,style:a,name:o,label:n,suffix:i,children:g.jsx("div",{role:"group","aria-labelledby":"form-checkbox",children:g.jsxs("label",{className:w9.formCheckboxLabel,children:[g.jsxs("span",{className:w9.formCheckboxFiled,children:[g.jsx(w7,{...oI.Form.formField(o),name:o,disabled:l,...m}),g.jsx("span",{"aria-label":`${c}. ${u||("string"==typeof s?s:"")}`,className:f(w9.formCheckboxText,d),children:s})]}),r&&g.jsx("p",{className:f(w9.formCheckboxSubText,d),children:r})]})})})}function It(e){let{className:t,style:a,label:n,name:i,...s}=e,[,r,l]=ih(i),{value:o}=r,{setValue:d}=l;return g.jsx(w8,{className:t,style:a,name:i,label:n,children:g.jsx(cB,{className:"_datePicker_ve47x_1",date:o,setDate:d,...s})})}function Ia(e){let{label:t,subLabel:a,className:n,labelClassName:i,children:s,...r}=e,[l]=ih(r),{name:o}=r;return g.jsxs(w8,{name:o,label:t,subLabel:a,className:n,labelClassName:i,children:[g.jsx(ip,{...oI.Form.formField(o),className:"_formInput_1c1rm_1",id:o,...l,...r}),s]})}let In=window.React.forwardRef,Ii=window.React.useImperativeHandle;function Is(){return In(function(e,t){let a=function(e){let t=ig();return oe(()=>{e?.(t?.values)},[t?.values]),t}(e.onValuesChange);return Ii(t,()=>a,[a]),g.jsx(g.Fragment,{})})}function Ir(e){let{name:t,options:a,onChange:n,labelText:i="",...s}=e;return g.jsx(ip,{name:t,children:e=>{let{field:{value:r},form:{setFieldValue:l,setFieldTouched:o}}=e;return g.jsx(cq,{ariaLabel:i,options:a,value:r,onValueChange:e=>{l(t,e),o(t,!0,!1),n&&n(e)},...s})}})}function Il(e){let{className:t,style:a,label:n,options:i=[],disabled:s,name:r,textClassName:l,labelText:o="",suffix:d,...c}=e;return g.jsx(w8,{className:t,style:a,name:r,label:n,suffix:d,children:g.jsx("div",{role:"radiogroup","aria-labelledby":"form-radio-group",children:g.jsx(Ir,{labelText:o,name:r,options:i,disabled:s,textClassName:l,...c})})})}let Io={selectControl:"_selectControl_m0h03_1",selectMenu:"_selectMenu_m0h03_21",selectOption:"_selectOption_m0h03_29",optionDisabled:"_optionDisabled_m0h03_32",selectOptionName:"_selectOptionName_m0h03_35",selectOptionInner:"_selectOptionInner_m0h03_38",optionFocused:"_optionFocused_m0h03_44",description:"_description_m0h03_53",name:"_name_m0h03_63",chatAvatar:"_chatAvatar_m0h03_74",selectOptionLabel:"_selectOptionLabel_m0h03_87",selectOptionSubLabel:"_selectOptionSubLabel_m0h03_92",selectControlAddon:"_selectControlAddon_m0h03_96",selectControlIcon:"_selectControlIcon_m0h03_101",selectMultiValueLabel:"_selectMultiValueLabel_m0h03_106",selectMultiValueRemove:"_selectMultiValueRemove_m0h03_110",selectMultiValueRemoveTooltip:"_selectMultiValueRemoveTooltip_m0h03_117",selectGroupHeading:"_selectGroupHeading_m0h03_122",menu:"_menu_m0h03_129",clearAll:"_clearAll_m0h03_135"},Id=ex(function(e){let{innerProps:t,innerRef:a,data:n,isDisabled:i,isFocused:s}=e,{jid:r,label:l,status:o,avatar:d}=n,{$t:c}=oA(),u=bA(r),m=bO(u),p=ba.isBlocked(r);return g.jsx("div",{...oI.Form.selectOption(l),...t,ref:a,className:f(t.className,Io.selectOption,{[Io.optionDisabled]:i||p,[Io.optionFocused]:s&&!p}),children:g.jsxs("div",{className:Io.selectOptionInner,children:[g.jsx(NL,{className:Io.chatAvatar,name:l,url:d??u?.avatar,jid:r,chatType:i1.CHAT,status:o,size:"sm"}),g.jsxs("span",{className:Io.selectOptionName,children:[g.jsx("span",{className:Io.selectOptionLabel,children:l}),(()=>p?g.jsx("span",{className:Io.selectOptionSubLabel,children:c({id:"IQReLq",defaultMessage:[{type:0,value:"(Blocked)"}]})}):i?g.jsx("span",{className:Io.selectOptionSubLabel,children:c({id:"kcBzu2",defaultMessage:[{type:0,value:"(Added)"}]})}):void 0)(),m&&g.jsx(_D,{})]})]})})}),Ic=ex(function(e){let{innerProps:t,innerRef:a,data:n,isDisabled:i,isFocused:s}=e,{name:r}=n,{$t:l}=oA(),o=la(r);return g.jsx("div",{...oI.Form.selectOption(r),...t,ref:a,className:f(t.className,Io.selectOption,{[Io.optionDisabled]:i,[Io.optionFocused]:s}),children:g.jsxs("div",{className:Io.selectOptionInner,children:[g.jsx("span",{className:Io.name,children:r}),g.jsx("span",{className:Io.description,children:l(o?{id:"AQZ63N",defaultMessage:[{type:0,value:"- Add Via Email"}]}:{id:"Zl18cO",defaultMessage:[{type:0,value:"- Type a valid email address to continue"}]})})]})})}),Iu=ex(function(e){let{innerProps:t,innerRef:a,data:n,isDisabled:i,isFocused:s}=e,{label:r,onClick:l}=n;return g.jsx("div",{...oI.Form.selectOption(r),...t,onClick:()=>{l?.(n)},ref:a,className:f(t.className,Io.selectOption,{[Io.optionDisabled]:i,[Io.optionFocused]:s}),children:g.jsxs("div",{className:Io.selectOptionInner,children:[g.jsx(NL,{className:Io.chatAvatar,name:r,chatType:i1.MUC,size:"sm"}),g.jsx("span",{className:Io.selectOptionName,children:g.jsx("span",{className:Io.selectOptionLabel,children:r})})]})})}),Im=ex(function(e){let{data:t}=e;return t.optionDataType===lP.external?g.jsx(Ic,{...e}):t.isMUC?g.jsx(Iu,{...e}):g.jsx(Id,{...e})}),Ip=window.React.useState,Ih=window.React.useCallback;function If(e,t){let[a,n]=Ip(""),i=Ih((e,t)=>{("input-change"===t.action||"set-value"===t.action)&&n(e)},[]),s=Ih(()=>{e.current&&e.current.onInputChange(a,{action:"input-change",prevInputValue:a})},[e,a]),r=Ih(()=>{n("")},[]);return[{inputValue:t?a:void 0,onInputChange:t?i:void 0,onFocus:t?s:void 0},{clearInputValue:r}]}let Ig=window.React.useCallback,Iy=window.React.useRef,Iv=window.React.forwardRef,I_=window.React.useImperativeHandle,Ib={Control:function(e){let{children:t,...a}=e;return g.jsxs(iy.Control,{...a,className:f(a.className,Io.selectControl),children:[g.jsx("span",{className:Io.selectControlAddon,children:g.jsx(eO,{className:Io.selectControlIcon})}),t]})},Option:Im,MultiValueLabel:function(e){let{innerProps:t,data:a}=e,{$t:n}=oA(),{label:i,optionDataType:s}=a,r=s===lP.external;return t.style=t.css,g.jsx("div",{...t,children:g.jsxs("span",{className:Io.selectMultiValueLabel,children:[i,r&&` (${n({id:"QG6+rR",defaultMessage:[{type:0,value:"External"}]})})`]})})},MultiValueRemove:function(e){let{innerProps:t,data:a}=e,{$t:n}=oA(),{label:i}=a,s="string"==typeof i?n({id:"T0e6Lh",defaultMessage:[{type:0,value:"Remove "},{type:1,value:"name"}]},{name:i}):"";return t.style=t.css,g.jsx(dA,{content:g.jsx("span",{className:Io.selectMultiValueRemoveTooltip,children:n({id:"rbrahO",defaultMessage:[{type:0,value:"Close"}]})}),arrowVisible:!0,side:"top",children:g.jsx("div",{...t,className:f(t.className,Io.selectMultiValueRemove),"aria-label":s,role:"button",children:g.jsx(e8,{})})})},ClearIndicator:function(e){let{innerProps:t,clearValue:a}=e,{$t:n}=oA();return g.jsx("span",{...t,className:f(Io.selectControlAddon,Io.clearAll),"aria-label":n({id:"FatRiL",defaultMessage:[{type:0,value:"Remove All Members"}]}),"aria-hidden":!1,...ld(a),children:g.jsx(e8,{className:Io.selectControlIcon})})},NoOptionsMessage:()=>g.jsx(g.Fragment,{}),DropdownIndicator:null,GroupHeading:function(e){let{children:t}=e;return g.jsx("div",{className:Io.selectGroupHeading,children:t})},Menu:function(e){let{children:t,...a}=e;return Array.isArray(e.options)&&!e.options.length?null:g.jsx(iy.Menu,{...a,className:Io.menu,children:g.jsx(e4,{loading:e.isLoading,children:g.jsx("div",{className:Io.selectMenu,children:t})})})}},IM=e=>({guidance:t=>{let{isSearchable:a,isMulti:n,isDisabled:i,tabSelectsValue:s,context:r}=t;switch(r){case"menu":return`Use Up and Down to choose options${i?"":", press Enter to select the currently focused option"}${e?"":", press Escape to exit the menu"}${s?", press Tab to select the option and exit the menu":""}.`;case"input":return`${t["aria-label"]||"Select"} is focused ${a?",type to refine list":""}, press Down to open the menu, ${n?" press left to focus selected values":""}`;case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}}});function Ix(e){let{className:t,label:a,subLabel:n,options:i=[],remainInputValue:s=!0,onInputChange:r,...l}=e,{name:o,placeholder:d}=l,c=Iy(null),[u,m]=If(c,s),[,p,h]=ih(o),{value:f}=p,{setValue:y}=h;return g.jsx(w8,{className:t,name:o,label:a,subLabel:n,...oI.Form.formField(o),children:g.jsx(i_,{isMulti:!0,classNamePrefix:"multi-select",inputId:o,name:o,placeholder:d,components:Ib,options:i,value:f,menuShouldScrollIntoView:!0,onChange:(e,t)=>{y(e),s&&"clear"===t.action&&m.clearInputValue()},...u,ref:c,onInputChange:(e,t)=>{u.onInputChange?.(e,t),"input-change"===t.action&&r?.(e)}})})}let IC={label:"name",value:"jid"},Ij=Iv(function(e,t){let{className:a,labelClassName:n,selectClassName:i,label:s,subLabel:r,description:l,defaultOptions:o=[],groupLabel:d,menuIsOpen:c,onValueChange:u,loadOptionsPromise:m,isOptionDisabled:p,filterData:f,optionKeys:y,components:v={},wait:_=800,styles:b,remainInputValue:M=!0,onInputChange:x,isLoadInitialOptions:C,isDisableEscapeAria:j,...N}=e,{name:w,placeholder:I}=N,T=Iy(null),[E,S]=If(T,M),[,k,A]=ih(w),R=Iy(""),{value:L}=k,{setValue:O}=A;I_(t,()=>T.current,[T]);let D=Ig(e=>{let{label:t,value:a}=y??IC;return e?.map(e=>e.optionDataType===lP.external?e:{...e,label:e?.[t],value:e?.[a]})||[]},[y]),P=Ig((e,t)=>{R.current=e,m?.(e).then(a=>{if(R.current!==e)return;let{result:n,hideGroupName:i=!1}=f?f(a,e):{result:a};if(n.length){let e=D(n);d&&!i?t([{options:e,label:d}]):t(e)}else t([])})},[f,d,m,D]),F=Q(P),B=l3(()=>tr((e,t)=>F.current(e,t),_),[_]),U=l3(()=>{let e=c?h(Ib,"Menu"):Ib;return{...e,...v}},[v,c]),H={...b,multiValueRemove:(e,t)=>({...e,backgroundColor:"transparent",border:t.isFocused?"1px solid #0e72ed":"1px solid transparent"})};return g.jsx(w8,{className:a,labelClassName:n,name:w,label:s,subLabel:r,description:l,...oI.Form.formField(w),children:g.jsx(iv,{defaultOptions:!!C||D(o),inputId:w,isMulti:!0,menuIsOpen:c,className:i,classNamePrefix:"multi-select",name:w,styles:H,placeholder:I,components:U,cacheOptions:!0,loadOptions:B,isOptionDisabled:(e,t)=>!!e.isDisabled||!!p?.(e,t),value:L,onChange:(e,t)=>{O(e),u?.(e),M&&"clear"===t.action&&S.clearInputValue()},onKeyDown:e=>{T.current?.state.focusedValue&&[sN.enter,sN.space].includes(e.key)?(T.current.removeValue(T.current?.state.focusedValue),e.preventDefault()):T.current?.state.focusedOption?.onClick&&[sN.enter,sN.tab].includes(e.key)&&(T.current?.state.focusedOption?.onClick(T.current?.state.focusedOption),e.preventDefault())},...E,ref:T,onInputChange:(e,t)=>{if(E.onInputChange?.(e,t),"input-change"===t.action)return x?.(e)},tabSelectsValue:!1,ariaLiveMessages:IM(!!j)})})}),IN={noPaddingTopSpacing:"_noPaddingTopSpacing_soe2r_11"};function Iw(e){let{values:{permissionType:t,members:a},setFieldValue:n}=ig(),{$t:i}=oA(),{onInputChange:s,...r}=e;l2(()=>{t!==se.DESIGNEES&&n("designees",void 0)},[t,n]);let l=a?.filter(e=>!rS(e.jid)&&![i1.MUC,i1.CHANNEL].includes(e.type))||[];return g.jsx(g.Fragment,{children:g.jsxs("span",{children:[g.jsx(Il,{...r}),t===se.DESIGNEES&&g.jsx(Ix,{className:IN.noPaddingTopSpacing,name:"designees",options:l,placeholder:i({id:"6qrFl8",defaultMessage:[{type:0,value:"Add specific people"}]}),remainInputValue:!0,onInputChange:s})]})})}let II={formPrivacy:"_formPrivacy_ydamp_1",noPaddingTopSpacing:"_noPaddingTopSpacing_ydamp_5"},IT=window.React.useRef;function IE(e){let{initialValue:t,text:a,...n}=e,{disabled:i}=n,{values:{canExternalAdd:s,privacyType:r},setFieldValue:l}=ig(),o=IT(!1),{$t:d}=oA();l2(()=>{s?t&&!o.current?(o.current=!0,l("privacyType",t)):l("privacyType",i9.ALL):l("privacyType",void 0)},[t,s]);let c=l3(()=>{if(!i)return a;switch(r){case i9.ADMINS:return d({id:"5gtB5e",defaultMessage:[{type:0,value:"External users can only be added by an owner or admins"}]});case i9.MEMBERS:return d({id:"6KvOS7",defaultMessage:[{type:0,value:"You can only add users in the channel owner's organization"}]});case i9.ALL:default:return a}},[r,i,a,d]);return g.jsxs(g.Fragment,{children:[g.jsx(Ie,{...n,text:c}),s&&!i&&g.jsx("div",{className:II.formPrivacy,children:g.jsx(Il,{className:II.noPaddingTopSpacing,name:"privacyType",options:[{label:d({id:"hJ2GFq",defaultMessage:[{type:0,value:"By all channel members"}]}),value:i9.ALL,name:"externalByAll"},{label:d({id:"8GJhry",defaultMessage:[{type:0,value:"By members in your organization"}]}),value:i9.MEMBERS,name:"externalByMembers"},{label:d({id:"zrmV+V",defaultMessage:[{type:0,value:"By channel owner and admins"}]}),value:i9.ADMINS,name:"externalByAdmins"}]})})]})}let IS={select:"_select_1tuqr_1",option:"_option_1tuqr_21",focused:"_focused_1tuqr_24",selected:"_selected_1tuqr_30",defaultLabel:"_defaultLabel_1tuqr_33",subLabel:"_subLabel_1tuqr_34",labelWrapper:"_labelWrapper_1tuqr_40",groupSeparator:"_groupSeparator_1tuqr_66",checkedIndicator:"_checkedIndicator_1tuqr_73"},Ik=window.React,IA=ex(function(e){let{data:t}=e,{value:a,label:n}=t;return a?g.jsx(w0,{classificationId:a}):g.jsx("div",{className:IS.defaultLabel,children:n})}),IR=e=>{let{data:t,innerRef:a,innerProps:n,isSelected:i,isFocused:s}=e,{value:r,label:l,subLabel:o}=t;return g.jsxs("div",{ref:a,...n,className:f(IS.option,{[IS.focused]:s,[IS.selected]:i}),children:[g.jsxs("div",{className:f(IS.labelWrapper),children:[r?g.jsx(w0,{classificationId:r}):g.jsx("div",{className:IS.defaultLabel,children:l}),i&&g.jsx(tH,{className:IS.checkedIndicator})]}),o&&g.jsx("div",{className:IS.subLabel,children:o})]})},IL=e=>{let{$t:t}=oA(),a=Ik.Children.toArray(e.children);return g.jsxs(iy.MenuList,{...e,children:[a[0],g.jsx("div",{className:IS.groupSeparator,children:t({id:"4wpUNc",defaultMessage:[{type:0,value:"Or"}]})}),a[1]]})},IO=ex(e=>{let{$t:t}=oA(),{name:a}=e,[,n]=ih(a),{value:i}=n,{defaultDataClassification:s,dataClassificationMap:r}=wZ,l=Array.from(r.values()),o={value:void 0,label:s?.name??"",subLabel:t({id:"mpL6hg",defaultMessage:[{type:0,value:"Use the classification label set by the account admin as the default. If the admin sets another label as the default, changes will be reflected in the classification of this channel."}]})},d=l.map(e=>{let{id:t,name:a,color:n,description:i}=e;return{value:t,label:a,subLabel:i,color:void 0!==n?sp[n]:void 0}}),c=[{options:[o]},{label:t({id:"198Skw",defaultMessage:[{type:0,value:"Customization"}]}),options:d}],u=d.find(e=>e.value===i)||o;return g.jsx(w8,{name:"classification",label:"Classification",children:g.jsx(ip,{as:"select",name:a,children:e=>{let{form:{setFieldValue:t,setFieldTouched:n}}=e;return g.jsx(i_,{className:IS.select,classNamePrefix:"classification-select",closeMenuOnSelect:!0,placeholder:null,isSearchable:!1,options:c,name:a,value:u,isMulti:!1,inputId:a,components:{SingleValue:IA,Option:IR,IndicatorSeparator:null,MenuList:IL},onChange:e=>{if(!e)return;let i=e.value;t(a,i),n(a,!0,!1)}})}})})}),ID=ex(function(e){let{innerProps:t,innerRef:a,data:n,isDisabled:i,isFocused:s}=e,{label:r,type:l,isPublic:o}=n;return g.jsx("div",{...oI.Form.selectOption(r),...t,ref:a,className:f(t.className,"_selectOption_1wm1u_22",{_optionDisabled_1wm1u_25:i,_optionFocused_1wm1u_37:s}),children:g.jsxs("div",{className:"_selectOptionInner_1wm1u_31",children:[g.jsx(NL,{className:"_chatAvatar_1wm1u_67",name:r,chatType:l,chatIsPublic:o,size:"sm"}),g.jsx("span",{className:"_selectOptionName_1wm1u_28",children:g.jsx("span",{className:"_selectOptionLabel_1wm1u_80",children:r})})]})})}),IP=ex(function(e){let{data:t}=e;return t.optionDataType===lP.external?g.jsx(Ic,{...e}):t.type===i1.CHAT?g.jsx(Id,{...e}):g.jsx(ID,{...e})}),IF=window.React.useCallback;function IB(e){let{isUserJoined:t,...a}=e,n=async e=>{if(e?.length<3)return[];let t=await uv.query.searchChannelAndUser({keyword:e,accountId:vB.accountId}).catch(()=>[]);return r(t.map(e=>e.type===az.chat?e.data.type===i5.CHANNEL?null:{type:i1.CHAT,jid:e.data.jid,displayName:e.data.displayName,avatar:e.data.picUrl}:{type:rD(e.data.option)?i1.MUC:i1.CHANNEL,jid:e.data.channelId,displayName:e.data.name,isPublic:function(e){return!!(+e&c.kMUCFlag_Public)}(e.data.option)}))},i=IF(e=>{let{type:a,jid:n}=e;return a===i1.CHAT&&!!t?.(n)},[t]);return g.jsx(Ij,{optionKeys:{label:"displayName",value:"jid"},loadOptionsPromise:n,isOptionDisabled:i,components:{Option:IP},...a})}function IU(e){let{isUserJoined:t,...a}=e,n=IF(e=>{let{jid:a}=e;return!!t?.(a)},[t]);return g.jsx(Ij,{optionKeys:{label:"displayName",value:"jid"},loadOptionsPromise:u_,isOptionDisabled:n,...a})}let IH=window.React.useState,Iz=window.React.useCallback,IV=window.React.useRef,IG=ex(function(e){let{$t:t}=oA(),{label:a,subLabel:n,className:i,labelClassName:s,channelJid:r,overlayContainer:l,addedMember:o,...d}=e,{name:c}=d,[,u,m]=ih(c),p=IV(null),{value:h}=u,{setValue:y}=m,[v,_]=IH(()=>{let{addList:e,removeList:t}=h;return[...e,...t].reduce((e,t)=>({...e,[t]:1}),{})}),[b,M]=IH("all"),[x,C]=IH(""),{loading:j,includeAllData:N}=b6(r||"",x),w=Iz(e=>{let t=Object.entries(e).filter(e=>{let[,t]=e;return!!t}).map(e=>{let[t]=e;return t}),a=t.filter(e=>!o.includes(e)),n=t.filter(e=>o.includes(e));return{addList:a,removeList:n}},[o]),I=Iz(e=>{_(t=>{let a=!!t[e],n={...t,[e]:a?0:1};return y(w(n)),n})},[y,w,_]),T=Iz(e=>!!v[e],[v]),E=oa(()=>{let e="all"===b?N.filter(e=>e.jid):N.filter(e=>o.includes(e.jid));return g.jsx(nG,{height:240,width:"100%",itemSize:32,itemCount:e.length,children:a=>{let{style:n,index:i}=a,s=e[i],d=s.jid,c=o.includes(s.jid),u=c?!T(d):T(d);return g.jsx(CR,{className:"_userItem_q69c0_15",style:n,size:"large",data:s,portalContainer:l,channelId:r,showOps:!1,ariaAttrs:{tabIndex:"0"},onSelect:()=>{I(d),p.current?.focus()},prefixRenderer:()=>g.jsx("div",{className:"_checked_q69c0_18",children:u&&g.jsx(tx,{})}),displayNameRenderer:e=>g.jsxs("span",{className:f({_isBold_q69c0_28:u}),children:[e," ",c&&t({id:"HGXYAd",defaultMessage:[{type:0,value:"(added)"}]})]})},d)}})},[N,l,r,o,b,I,T,t]),S=[{key:"ChooseFromAllMembers",text:t({id:"w8E6Ro",defaultMessage:[{type:0,value:"All Channel Members"}]}),testKey:"chooseFromAllMembers",operate(){M("all")}},{key:"ChooseFromAddedMembers",text:t({id:"5+nsky",defaultMessage:[{type:0,value:"Added Channel Members"}]}),testKey:"chooseFromAddedMembers",operate(){M("added")}}];return g.jsxs(w8,{name:c,label:a,subLabel:n,className:i,labelClassName:s,children:[g.jsx(cQ,{side:"bottom",align:"start",options:S,children:g.jsxs(dj,{size:"small",type:"text",onKeyDown:lo(),className:"_selectOption_q69c0_32",children:["all"===b?t({id:"w8E6Ro",defaultMessage:[{type:0,value:"All Channel Members"}]}):t({id:"5+nsky",defaultMessage:[{type:0,value:"Added Channel Members"}]}),g.jsx(ib,{className:"_downArrow_q69c0_38","aria-hidden":!0})]})}),g.jsxs("div",{className:"_memberViewer_q69c0_1",...oI.Mention.channelMemberSelector,children:[g.jsx("div",{className:"_searchMember_q69c0_9",children:g.jsx(d$,{ref:p,className:"_searchInput_q69c0_5",placeholder:t({id:"9Obw6C",defaultMessage:[{type:0,value:"Filter"}]}),onChange:tr(e=>{C(e.target.value)},300),allowClear:!1})}),g.jsx(e4,{loading:j,children:g.jsx("div",{className:"_mentionListContainer_q69c0_12",children:E})})]})]})});function Iq(){return g.jsx("button",{className:"_formSubmit_90s07_1",type:"submit",children:"Submit"})}function I$(e){let{className:t,style:a,label:n,name:i,...s}=e,[,r,l]=ih(i),{value:o}=r,{setValue:d}=l;return g.jsx(w8,{className:t,style:a,name:i,label:n,children:g.jsx(cU,{className:"_timePicker_veh7m_1",time:o,setTime:d,...s})})}var IK=(e=>(e.SUBJECT="subject",e.OPTION="option",e.ANNOUNCER="announcer",e.CLASSIFICATION="classification",e))(IK||{});function IJ(e,t){let{channelName:a,channelType:n,canExternalAdd:i,privacyType:s,historyMessagesVisible:r,invitePermission:l,permissionType:o,classification:d}=e,c=[{name:IK.SUBJECT,value:iM(t?.channelName)===iM(a)},{name:IK.OPTION,value:nK({channelType:t?.channelType,canExternalAdd:t?.canExternalAdd,privacyType:t?.privacyType,historyMessagesVisible:t?.historyMessagesVisible,invitePermission:t?.invitePermission,permissionType:t?.permissionType},{channelType:n,canExternalAdd:i,privacyType:s,historyMessagesVisible:r,invitePermission:l,permissionType:o})},{name:IK.CLASSIFICATION,value:nK({classification:t?.classification},{classification:d})}];return c.reduce((e,t)=>t.value?e:[...e,t.name],[])}function IW(e){let{channelName:t,channelType:a,canExternalAdd:n,privacyType:i,permissionType:s,designees:r,historyMessagesVisible:l,invitePermission:o,classification:d}=e;return{subject:iM(t),isPublic:a===i8.PUBLIC,canExternalAdd:n??!1,isYourOrg:!!n&&i===i9.MEMBERS,historyMessagesVisible:l??!1,adminOnly:s===se.ADMINISTRATOR,adminAndSpecial:s===se.DESIGNEES,managerList:(r||[]).map(e=>e.jid),isAdminAddMemberOnly:o===i7.ADMIN,isAdminAddOutsideOnly:!!n&&i===i9.ADMINS,classification:d}}let IY={chatName:"_chatName_14tj6_1",nameText:"_nameText_14tj6_7",search:"_search_14tj6_14",memberList:"_memberList_14tj6_19",footer:"_footer_14tj6_28",action:"_action_14tj6_36",footerBtns:"_footerBtns_14tj6_41",memberSelect:"_memberSelect_14tj6_45",info:"_info_14tj6_58",close:"_close_14tj6_66",noPaddingTopSpacing:"_noPaddingTopSpacing_14tj6_73",noPaddingBottomSpacing:"_noPaddingBottomSpacing_14tj6_77",channelItem:"_channelItem_14tj6_81",disabled:"_disabled_14tj6_88",channelInfo:"_channelInfo_14tj6_88",chatAvatar:"_chatAvatar_14tj6_94",channelName:"_channelName_14tj6_108",highlight:"_highlight_14tj6_113",channelMember:"_channelMember_14tj6_119",channelAction:"_channelAction_14tj6_122",block:"_block_14tj6_130",blockTitle:"_blockTitle_14tj6_134",members:"_members_14tj6_140",tail:"_tail_14tj6_146",messageList:"_messageList_14tj6_156",dateIndicator:"_dateIndicator_14tj6_164",tooltip:"_tooltip_14tj6_172",tooltipArrow:"_tooltipArrow_14tj6_178",memberCount:"_memberCount_14tj6_182",tips:"_tips_14tj6_187",contactInvitation:"_contactInvitation_14tj6_193",paperPlane:"_paperPlane_14tj6_204",text:"_text_14tj6_208",invitationDesc:"_invitationDesc_14tj6_211",invitationName:"_invitationName_14tj6_214",channelForm:"_channelForm_14tj6_219",suffixIcon:"_suffixIcon_14tj6_219",suffixContent:"_suffixContent_14tj6_222",advancedHeader:"_advancedHeader_14tj6_226",advancedContent:"_advancedContent_14tj6_240",small:"_small_14tj6_247",textTips:"_textTips_14tj6_258",preferencesTips:"_preferencesTips_14tj6_263",preferencesText:"_preferencesText_14tj6_266",preferences:"_preferences_14tj6_263",preferencesList:"_preferencesList_14tj6_273",preferencesItem:"_preferencesItem_14tj6_279",divider:"_divider_14tj6_287",preferencesHeader:"_preferencesHeader_14tj6_297",preferencesName:"_preferencesName_14tj6_301",preferencesRadioGroup:"_preferencesRadioGroup_14tj6_307",preferencesRadioOption:"_preferencesRadioOption_14tj6_312",codeSnippet:"_codeSnippet_14tj6_319",wrapForm:"_wrapForm_14tj6_319",mentionGroupDialog:"_mentionGroupDialog_14tj6_324",descriptionTitle:"_descriptionTitle_14tj6_324",descriptionDetail:"_descriptionDetail_14tj6_329",descriptionText:"_descriptionText_14tj6_335",isEmpty:"_isEmpty_14tj6_340",memberViewer:"_memberViewer_14tj6_343",searchInput:"_searchInput_14tj6_347",searchMember:"_searchMember_14tj6_351",mentionListContainer:"_mentionListContainer_14tj6_354"},IX=window.React.useRef,IQ=window.React.useState,IZ=window.React.useCallback,I1=Is(),I0=e=>({members:[],channelName:e?.subject??"",canExternalAdd:e?.canExternalAdd??!1,privacyType:e?.canExternalAdd?e.isYourOrg?i9.MEMBERS:e.isAdminAddOutsideOnly?i9.ADMINS:i9.ALL:void 0,historyMessagesVisible:e?.historyMessagesVisible??!1}),I2=ex(function(e){let{onClose:t,channelId:a}=e,{$t:n}=oA(),{addMember:i}=w5,[s,r]=IQ(!1),l=Mi(a),o=Ms(a),d=IX(null),[c,u]=IQ(!1),[m,p]=IQ(!1),{loading:h,data:f}=_4(a),{loading:y,data:v}=function(e){let[t,a]=_8([]),[n,i]=_8(!1),s=_7(e=>{i(!0),uv.query.fetchMembers({channelJid:e,size:9999,pureRequest:!0}).then(e=>{a(e.data)}).catch(ec).finally(()=>i(!1))},[]);return l2(()=>{e&&s(e)},[e]),{data:t,loading:n}}(a),{isPublic:_,sessionType:b,fromChannel:M,fromChat:x,subject:C,isMeetChat:j,accountId:N}=f||{},w=function(e){if(!e)return!1;let{currentUser:t}=g2,a=t.orgUnit||"";return a?.split(";").includes(e)}(N),[I,T]=IQ(I0(f));l2(()=>{let e=I0(f);nK(I,e)||(T(e),d?.current?.setValues(e))},[f]);let E=l3(()=>{switch(b){case i1.MUC:return j?g.jsx(is,{className:"icon-team"}):g.jsx(nJ,{className:"icon-team"});case i1.CHANNEL:return _?g.jsx(eU,{className:"icon-number-italic"}):g.jsx(nW,{className:"icon-lock-locked"});default:return null}},[_,b,j]),S=IZ(e=>{let{canExternalAdd:t,privacyType:a}=e,n=b===i1.CHANNEL;if(!n)return!0;if(!t)return!1;switch(a){case i9.ALL:return!0;case i9.ADMINS:return o;case i9.MEMBERS:return w;default:return!1}},[b,o,w]),k=IZ(e=>v.some(t=>t.jid===e),[v]),A=IZ(e=>{u(!!e.members?.length),r(S(e))},[S,u]),R={channelJid:a,className:IY.memberSelect,label:n({id:"iD7585",defaultMessage:[{type:0,value:"Members to Add"}]}),name:"members",placeholder:n({id:"AX3V9N",defaultMessage:[{type:0,value:"Enter at least 3 characters to search..."}]}),menuIsOpen:!0,remainInputValue:!1,filterData:(e,t)=>{void 0===t&&(t="");let n=lB({disableExternal:!s,disableFromEmail:!s,disableSelf:!0})(e,t);return o&&(n.result=n.result.filter(e=>e.jid!==a)),n},isUserJoined:k};return g.jsx(dB,{title:n({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),okDisable:!c,okText:n({id:"2/2yg+",defaultMessage:[{type:0,value:"Add"}]}),onOk:()=>{if(!a)return;let e=d?.current?.values;if(e){let{members:s=[],historyMessagesVisible:r,canExternalAdd:l,privacyType:o,channelName:d}=e;p(!0);let{memberList:c,emailList:u,channelList:m}=lF(s);i({channelId:a,memberList:c,emailList:u,channelList:m,canExternalAdd:l,isYourOrg:!!l&&o===i9.MEMBERS,isAdminAddOutsideOnly:!!l&&o===i9.ADMINS,historyMessagesVisible:r,isPublic:_,isMeetChat:j,subject:d,updateItem:IJ(e,I),fromChannel:M,fromChat:x,onError:()=>{p(!1),o2.error(n({id:"hRZY5F",defaultMessage:[{type:0,value:"Add members failed"}]}),n({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))},onSuccess:t})}},loading:h||y||m,onCancel:t,children:g.jsxs("div",{children:[g.jsxs("div",{className:IY.chatName,children:[E,g.jsx("span",{className:IY.nameText,children:C})]}),g.jsx(ix,{initialValues:I,onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[o?g.jsx(IB,{...R}):g.jsx(IU,{...R}),b===i1.CHANNEL&&g.jsx(IE,{className:IY.noPaddingBottomSpacing,label:n({id:"ZdMdwG",defaultMessage:[{type:0,value:"Advanced Permissions"}]}),name:"canExternalAdd",initialValue:I?.privacyType,disabled:!l,text:n({id:"t0l+Qx",defaultMessage:[{type:0,value:"External users can be added"}]})}),g.jsx(Ie,{className:b===i1.CHANNEL?IY.noPaddingTopSpacing:"",label:b===i1.MUC?n({id:"ZdMdwG",defaultMessage:[{type:0,value:"Advanced Permissions"}]}):void 0,name:"historyMessagesVisible",disabled:!l,text:n({id:"2fQg2w",defaultMessage:[{type:0,value:"New members will see previous messages and files"}]})}),g.jsx(I1,{ref:d,onValuesChange:A})]})})]})})}),I5=window.React.useState,I3=ex(function(e){let{onClose:t,channelId:a,jid:n,name:i,revoke:s}=e,{$t:r}=oA(),[l,o]=I5(!1);return g.jsx(dB,{title:s?r({id:"IXKBiJ",defaultMessage:[{type:0,value:"Unassign as Admin"}]}):r({id:"JLHEZ9",defaultMessage:[{type:0,value:"Assign as Admin"}]}),okText:s?r({id:"nrumgB",defaultMessage:[{type:0,value:"Unassign"}]}):r({id:"guunZt",defaultMessage:[{type:0,value:"Assign"}]}),onOk:()=>{a&&n&&i&&(o(!0),w5.assignAdmin({data:{jid:n,name:i},action:s?sc.UNASSIGN:sc.ASSIGN,channelId:a,onSuccess:t,onError:()=>{o(!1),o2.error(s?r({id:"7ft7Ra",defaultMessage:[{type:0,value:"Unassign as admin failed"}]}):r({id:"tL2VIN",defaultMessage:[{type:0,value:"Assign as admin failed"}]}),r({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}}))},onCancel:t,loading:l,children:g.jsx("div",{children:s?r({id:"Hl+niX",defaultMessage:[{type:1,value:"name"},{type:0,value:" will become a regular member. They will not be able to assign other channel admins, edit the channel, or manage posting permissions."}]},{name:i}):r({id:"oQbsse",defaultMessage:[{type:1,value:"name"},{type:0,value:" will become a channel admin. Channel admins share most permissions with the owner. Admins cannot delete the channel, edit the channel type and privacy, or remove or reassign the owner."}]},{name:i})})})}),I6=window.React.useCallback,I4=window.React.useRef,I8=window.React.useState,I7=Is(),I9=ex(function(e){let{onClose:t}=e,{$t:a}=oA(),{createChannel:n}=w5,{groupChannels:i}=gQ,s=I4(null),[r,l]=I8(!1),[o,d]=I8(!1),[c,u]=I8(!1),{defaultDataClassification:m}=wZ,p=i(i1.CHANNEL),f=I6(e=>{let t=iM(e.channelName);l(!!t),u(!!e.canExternalAdd)},[]);return g.jsx(dB,{title:a({id:"tUk+KR",defaultMessage:[{type:0,value:"Create a Channel"}]}),okText:a({id:"CuNepY",defaultMessage:[{type:0,value:"Create Channel"}]}),onOk:()=>{let{dirty:e,isValid:i,values:r}=s?.current||{};if(!e||!i||!r)return;let{members:l=[]}=r,o=h(IW(r),"historyMessagesVisible"),c=o.managerList?.filter(e=>l?.some(t=>t.jid===e));d(!0);let{memberList:u,emailList:m,channelList:p}=lF(l),f={...o,managerList:c,fromChannel:!0,fromChat:!0,addMemberList:u,addEmailList:m,channelList:p,onSuccess:t,onError:()=>{d(!1),o2.error(a({id:"6PndwU",defaultMessage:[{type:0,value:"Create channel failed"}]}),a({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}};n(f)},onCancel:t,okDisable:!r,cancelDisable:o,loading:o,testKey:"createChannel",children:g.jsx("div",{className:IY.channelForm,children:g.jsx(ix,{initialValues:{channelName:"",channelType:i8.PRIVATE,canExternalAdd:!1,privacyType:void 0,permissionType:se.ALL,designees:void 0,historyMessagesVisible:!1,invitePermission:i7.ALL},validationSchema:ij({channelName:iN().required(a({id:"V1HL2h",defaultMessage:[{type:0,value:"Channel Name is required."}]})).test("duplicate-name",a({id:"hlV2d+",defaultMessage:[{type:0,value:"This name is already in use. Please choose another name."}]}),e=>!p.some(t=>iM(t.name)===iM(e))),channelType:iN().required(a({id:"QnpYpc",defaultMessage:[{type:0,value:"Channel Type is required."}]}))}),onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{label:a({id:"hh0xW7",defaultMessage:[{type:0,value:"Channel Name"}]}),name:"channelName",type:"text",maxLength:256,placeholder:a({id:"YrWE3b",defaultMessage:[{type:0,value:"e.g. "},{type:1,value:"name"}]},{name:"Happy Crew"})}),m&&g.jsx(IO,{name:"classification"}),g.jsx(Il,{label:a({id:"CX7ghM",defaultMessage:[{type:0,value:"Channel Type"}]}),name:"channelType",ariaLabel:a({id:"CX7ghM",defaultMessage:[{type:0,value:"Channel Type"}]}),options:[{label:a({id:"SIsXyi",defaultMessage:[{type:0,value:"Private (Invited members only)"}]}),value:i8.PRIVATE,name:"channelPrivate"},{label:a({id:"41Qtkj",defaultMessage:[{type:0,value:"Public (Anyone in your organization can join)"}]}),value:i8.PUBLIC,name:"channelPublic"}]}),g.jsx(IB,{label:a({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),subLabel:a({id:"nA4XGc",defaultMessage:[{type:0,value:"(Optional)"}]}),name:"members",placeholder:a({id:"AX3V9N",defaultMessage:[{type:0,value:"Enter at least 3 characters to search..."}]}),filterData:lB({disableExternal:!c,disableFromEmail:!c,disableSelf:!0})}),g.jsx(dK,{isSolitary:!1,defaultActiveKey:[],children:g.jsxs(dK.Item,{eventKey:"advanced_permissions",children:[g.jsx(dK.Header,{...oI.Channel.advancedPermHeader,className:IY.advancedHeader,children:a({id:"ZdMdwG",defaultMessage:[{type:0,value:"Advanced Permissions"}]})}),g.jsx(dK.Body,{...oI.Channel.advancedPermContent,children:g.jsxs("div",{className:IY.advancedContent,children:[g.jsx(Il,{className:IY.noPaddingTopSpacing,label:a({id:"i3/W7p",defaultMessage:[{type:0,value:"Who can add members"}]}),name:"invitePermission",ariaLabel:a({id:"i3/W7p",defaultMessage:[{type:0,value:"Who can add members"}]}),options:[{label:a({id:"InDYN+",defaultMessage:[{type:0,value:"All channel members"}]}),value:i7.ALL,name:"inviteByAll"},{label:a({id:"HCJZnE",defaultMessage:[{type:0,value:"Channel owner and admins only"}]}),value:i7.ADMIN,name:"inviteByAdmins"}]}),g.jsx(IE,{name:"canExternalAdd",label:a({id:"hnGd5f",defaultMessage:[{type:0,value:"Members from outside of the organization"}]}),ariaLabel:a({id:"+y7Np0",defaultMessage:[{type:0,value:"Members from outside of the organization, external users can be added"}]}),text:a({id:"t0l+Qx",defaultMessage:[{type:0,value:"External users can be added"}]})}),g.jsx(Iw,{className:IY.noPaddingBottomSpacing,label:a({id:"zXQVDr",defaultMessage:[{type:0,value:"Who can send messages"}]}),name:"permissionType",ariaLabel:a({id:"u03anP",defaultMessage:[{type:0,value:"Who can send message"}]}),options:[{label:a({id:"2XDuH4",defaultMessage:[{type:0,value:"Everyone"}]}),value:se.ALL,name:"postByAll"},{label:a({id:"EL0XlA",defaultMessage:[{type:0,value:"Owner and admins Only"}]}),value:se.ADMINISTRATOR,name:"postByAdmins"},{label:a({id:"dMemF9",defaultMessage:[{type:0,value:"Owner, admins, plus specific people"}]}),value:se.DESIGNEES,name:"postByDesignees"}]})]})})]})}),g.jsx(I7,{ref:s,onValuesChange:f})]})})})})}),Te=window.React.useState,Tt=ex(function(e){let{onClose:t,channelId:a,channelName:n,chatType:i}=e,{$t:s}=oA(),{deleteChannel:r,deleteChat:l}=w5,[o,d]=Te(!1),c=()=>d(!0),u=e=>()=>{if(e){o2.error(s({id:"yHAPCp",defaultMessage:[{type:0,value:"Delete channel failed"}]}),s({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}));return}o2.error(s({id:"dta79u",defaultMessage:[{type:0,value:"Delete chat failed"}]}),s({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))};return g.jsx(dB,{title:s({id:"XNFeUK",defaultMessage:[{type:0,value:'Delete "'},{type:1,value:"name"},{type:0,value:'"'}]},{name:n}),onCancel:t,onOk:()=>{a&&i&&(i===i1.CHANNEL?r({channelId:a,onSuccess:t,onAction:c,onError:u(!0)}):l({channelId:a,onSuccess:t,onAction:c,onError:u(!1)}))},okDanger:!0,okText:i===i1.CHANNEL?s({id:"dzosaH",defaultMessage:[{type:0,value:"Delete Channel"}]}):s({id:"NMr04q",defaultMessage:[{type:0,value:"Delete Chat"}]}),okDisable:o,loading:o,testKey:"deleteChannel",children:i===i1.CHANNEL?s({id:"sDCraU",defaultMessage:[{type:0,value:"You are permanently removing all messages, files, and other related information in this channel. This action cannot be undone."}]}):s({id:"1GkN+G",defaultMessage:[{type:0,value:"You are permanently removing all messages, files, and other related information in this chat. This action cannot be undone."}]})})}),Ta=window.React.useCallback,Tn=window.React.useRef,Ti=window.React.useState,Ts=()=>{let{$t:e}=oA();return g.jsx(dA,{className:IY.suffixContent,content:e({id:"P5DNY4",defaultMessage:[{type:0,value:"Only the channel owner can change this setting."}]}),arrowVisible:!0,children:g.jsx(iw,{className:IY.suffixIcon})})},Tr=e=>({channelName:e?.subject||"",channelType:e?.isPublic?i8.PUBLIC:i8.PRIVATE,canExternalAdd:e?.canExternalAdd,privacyType:e?.canExternalAdd?e.isYourOrg?i9.MEMBERS:e.isAdminAddOutsideOnly?i9.ADMINS:i9.ALL:void 0,permissionType:e?.adminAndSpecial?se.DESIGNEES:e?.adminOnly?se.ADMINISTRATOR:se.ALL,historyMessagesVisible:e?.historyMessagesVisible,invitePermission:e?.isAdminAddMemberOnly?i7.ADMIN:i7.ALL,classification:e?.classification}),Tl=(e,t)=>e.length!==t.length||!!t.length&&t.some(t=>!e.some(e=>t.jid===e.jid)),To=Is(),Td=ex(function(e){let{onClose:t,channelId:a}=e,{$t:n}=oA(),{updateChannel:i}=w5,{groupChannels:s}=gQ,r=Tn(null),[l,o]=Ti(!1),[d,c]=Ti(!1),u=Mi(a||""),[m,p]=Ti(""),h=s(i1.CHANNEL).filter(e=>e.jid!==a),{loading:f,data:y}=_4(a),[v,_]=Ti(Tr(y)),{data:b}=b6(a||"",m||"1"),M=v.permissionType===se.DESIGNEES,{data:x}=be(a||"",i4.ANNOUNCER,M),{defaultDataClassification:C,dataClassificationMap:j}=wZ;l2(()=>{x.length&&r?.current?.setFieldValue("designees",x.map(e=>({...e,label:e.name,value:e.jid})))},[x]),l2(()=>{r?.current?.setFieldValue("members",b.map(e=>({...e,label:e.name,value:e.jid})))},[b]),l2(()=>{let e=Tr(y);nK(v,e)||(_(e),r?.current?.setValues(e))},[y]);let N=Ta(e=>{let t=iM(e.channelName),a=!!t&&(IJ(e,v).length>0||Tl(x,e.designees||[]));o(a)},[v,x]),w=Ta(()=>c(!0),[]);return g.jsx(dB,{title:n({id:"62P16S",defaultMessage:[{type:0,value:"Edit Channel"}]}),okText:n({id:"3VI9mt",defaultMessage:[{type:0,value:"Save Changes"}]}),onOk:()=>{if(!a)return;let{dirty:e,isValid:s,values:l}=r?.current||{};if(!e||!s||!l)return;let o=IJ(l,v),d=Tl(x,l.designees||[]);d&&!o.length&&o.push(IK.ANNOUNCER);let c={...IW(l),updateItem:o,channelId:a,id:a,onSuccess:t,onAction:w,onError:()=>{o2.error(n({id:"KYb822",defaultMessage:[{type:0,value:"Update channel failed"}]}),n({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))},hasExternalUser:y?.hasExternalUser};i(c)},onCancel:t,okDisable:!l,cancelDisable:d||f,loading:d||f,testKey:"editChannel",children:g.jsx("div",{className:IY.channelForm,children:g.jsx(ix,{initialValues:{channelName:"",channelType:i8.PRIVATE,canExternalAdd:!1,privacyType:void 0,permissionType:se.ALL,designees:void 0,historyMessagesVisible:!1,invitePermission:i7.ALL,classification:y?.classification},validationSchema:ij({channelName:iN().required(n({id:"V1HL2h",defaultMessage:[{type:0,value:"Channel Name is required."}]})).test("duplicate-name",n({id:"hlV2d+",defaultMessage:[{type:0,value:"This name is already in use. Please choose another name."}]}),e=>!h.some(t=>iM(t.name)===iM(e))),channelType:iN().required(n({id:"QnpYpc",defaultMessage:[{type:0,value:"Channel Type is required."}]})),classification:iN().optional().test("deleted-classification",n({id:"B2Ooti",defaultMessage:[{type:0,value:"Your selected classification label has been deleted. Please select a new one."}]}),e=>!e||!!j.get(e))}),onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{label:n({id:"hh0xW7",defaultMessage:[{type:0,value:"Channel Name"}]}),name:"channelName",type:"text",maxLength:256,placeholder:n({id:"YrWE3b",defaultMessage:[{type:0,value:"e.g. "},{type:1,value:"name"}]},{name:"Happy Crew"})}),u&&C&&g.jsx(IO,{name:"classification"}),g.jsx(Il,{label:n({id:"CX7ghM",defaultMessage:[{type:0,value:"Channel Type"}]}),name:"channelType",disabled:!u,suffix:!u&&g.jsx(Ts,{}),ariaLabel:n({id:"CX7ghM",defaultMessage:[{type:0,value:"Channel Type"}]}),options:[{label:n({id:"SIsXyi",defaultMessage:[{type:0,value:"Private (Invited members only)"}]}),value:i8.PRIVATE,name:"channelPrivate"},{label:n({id:"41Qtkj",defaultMessage:[{type:0,value:"Public (Anyone in your organization can join)"}]}),value:i8.PUBLIC,name:"channelPublic"}]}),g.jsx(Ie,{name:"historyMessagesVisible",label:n({id:"67FXTk",defaultMessage:[{type:0,value:"Message and File History"}]}),disabled:!u,ariaLabel:n({id:"aJkIm1",defaultMessage:[{type:0,value:"Message and file history, new members will see previous messages and files"}]}),text:n({id:"2fQg2w",defaultMessage:[{type:0,value:"New members will see previous messages and files"}]})}),g.jsx(dK,{isSolitary:!1,defaultActiveKey:[],children:g.jsxs(dK.Item,{eventKey:"advanced_permissions",children:[g.jsx(dK.Header,{...oI.Channel.advancedPermHeader,className:IY.advancedHeader,children:n({id:"ZdMdwG",defaultMessage:[{type:0,value:"Advanced Permissions"}]})}),g.jsx(dK.Body,{...oI.Channel.advancedPermContent,children:g.jsxs("div",{className:IY.advancedContent,children:[g.jsx(Il,{className:IY.noPaddingTopSpacing,label:n({id:"i3/W7p",defaultMessage:[{type:0,value:"Who can add members"}]}),name:"invitePermission",disabled:!u,suffix:!u&&g.jsx(Ts,{}),ariaLabel:n({id:"i3/W7p",defaultMessage:[{type:0,value:"Who can add members"}]}),options:[{label:n({id:"InDYN+",defaultMessage:[{type:0,value:"All channel members"}]}),value:i7.ALL,name:"inviteByAll"},{label:n({id:"HCJZnE",defaultMessage:[{type:0,value:"Channel owner and admins only"}]}),value:i7.ADMIN,name:"inviteByAdmins"}]}),g.jsx(IE,{name:"canExternalAdd",label:n({id:"hnGd5f",defaultMessage:[{type:0,value:"Members from outside of the organization"}]}),disabled:!u,suffix:!u&&g.jsx(Ts,{}),ariaLabel:n({id:"+y7Np0",defaultMessage:[{type:0,value:"Members from outside of the organization, external users can be added"}]}),initialValue:v?.privacyType,text:n({id:"t0l+Qx",defaultMessage:[{type:0,value:"External users can be added"}]})}),g.jsx(Iw,{className:IY.noPaddingBottomSpacing,label:n({id:"zXQVDr",defaultMessage:[{type:0,value:"Who can send messages"}]}),name:"permissionType",ariaLabel:n({id:"zXQVDr",defaultMessage:[{type:0,value:"Who can send messages"}]}),onInputChange:e=>{p(e)},options:[{label:n({id:"2XDuH4",defaultMessage:[{type:0,value:"Everyone"}]}),value:se.ALL,name:"postByAll"},{label:n({id:"EL0XlA",defaultMessage:[{type:0,value:"Owner and admins Only"}]}),value:se.ADMINISTRATOR,name:"postByAdmins"},{label:n({id:"dMemF9",defaultMessage:[{type:0,value:"Owner, admins, plus specific people"}]}),value:se.DESIGNEES,name:"postByDesignees"}]})]})})]})}),g.jsx(To,{ref:r,onValuesChange:N})]})})})})}),Tc=window.React.useRef,Tu=window.React.useState,Tm=window.React.useCallback,Tp=e=>({channelName:e?.isNoTopic?"":e?.subject||"",canExternalAdd:e?.canExternalAdd,permissionType:e?.adminAndSpecial?se.DESIGNEES:e?.adminOnly?se.ADMINISTRATOR:se.ALL,historyMessagesVisible:e?.historyMessagesVisible,classification:e?.classification}),Th=(e,t)=>e.length!==t.length||!!t.length&&t.some(t=>!e.some(e=>t.jid===e.jid)),Tf=Is();function Tg(e){let{onClose:t,channelId:a}=e,{$t:n}=oA(),{updateMUC:i}=w5,s=Tc(null),{loading:r,data:l}=_4(a),o=l?.isNoTopic?"":l?.subject||"",[d,c]=Tu(!1);return l2(()=>{s?.current?.setValues({channelName:o})},[o]),g.jsx(dB,{title:n({id:"HssoVa",defaultMessage:[{type:0,value:"Edit Chat"}]}),okText:n({id:"3VI9mt",defaultMessage:[{type:0,value:"Save Changes"}]}),loading:r,onOk:()=>{if(!a)return;let{values:e}=s?.current||{};if(!e)return;let{channelName:n}=e;i({channelId:a,id:a,subject:iM(n),updateItem:["subject"],onSuccess:t})},onCancel:t,okDisable:!d,children:g.jsx(ix,{innerRef:s,initialValues:{channelName:""},onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{label:n({id:"UdtpV7",defaultMessage:[{type:0,value:"Topic"}]}),name:"channelName",type:"text",placeholder:n({id:"nA4XGc",defaultMessage:[{type:0,value:"(Optional)"}]})}),g.jsx(Tf,{ref:s,onValuesChange:e=>{let t=iM(e.channelName);c(t!==o)}})]})})})}function Ty(e){let{onClose:t,channelId:a}=e,{$t:n}=oA(),{updateMUC:i}=w5,s=Tc(null),{loading:r,data:l}=_4(a),o=!!l?.isMeetChat,[d,c]=Tu(!1),[u,m]=Tu(!1),[p,y]=Tu(Tp(l)),[v,_]=Tu(""),{defaultDataClassification:b,dataClassificationMap:M}=wZ,{data:x}=b6(a||"",v||"1"),C=p.permissionType===se.DESIGNEES,{data:j}=be(a||"",i4.ANNOUNCER,C);l2(()=>{j.length&&s?.current?.setFieldValue("designees",j.map(e=>({...e,label:e.name,value:e.jid})))},[j]),l2(()=>{s?.current?.setFieldValue("members",x.map(e=>({...e,label:e.name,value:e.jid})))},[x]),l2(()=>{let e=Tp(l);nK(p,e)||(y(e),s?.current?.setValues(e))},[l]);let N=Tm(()=>m(!0),[]);return g.jsx(dB,{title:n({id:"HssoVa",defaultMessage:[{type:0,value:"Edit Chat"}]}),okText:n({id:"3VI9mt",defaultMessage:[{type:0,value:"Save Changes"}]}),loading:u||r,onOk:()=>{if(!a)return;let{values:e}=s?.current||{};if(!e)return;let r=IJ(e,p),d=Th(j,e.designees||[]);d&&!r.length&&r.push(IK.ANNOUNCER);let c=h(IW(e),"isPublic","isAdminAddMemberOnly","isYourOrg");i({...c,hasExternalUser:l?.hasExternalUser,updateItem:r,channelId:a,id:a,isMeetChat:o,onSuccess:t,onAction:N,onError:()=>{o2.error(n({id:"GPha1Y",defaultMessage:[{type:0,value:"Update chat failed"}]}),n({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}})},onCancel:t,cancelDisable:u||r,okDisable:!d,children:g.jsx("div",{className:f(IY.channelForm,IY.small),children:g.jsx(ix,{innerRef:s,initialValues:p,onSubmit:ec,validationSchema:ij({classification:iN().optional().test("deleted-classification",n({id:"B2Ooti",defaultMessage:[{type:0,value:"Your selected classification label has been deleted. Please select a new one."}]}),e=>!e||!!M.get(e))}),children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{disabled:o,label:n({id:"UdtpV7",defaultMessage:[{type:0,value:"Topic"}]}),name:"channelName",type:"text",maxLength:256,placeholder:n({id:"nA4XGc",defaultMessage:[{type:0,value:"(Optional)"}]}),children:o&&g.jsx("span",{className:IY.textTips,children:n({id:"/4cXQt",defaultMessage:[{type:0,value:"Please edit your event or calendar invite to change the topic"}]})})}),b&&g.jsx(IO,{name:"classification"}),g.jsx(Ie,{name:"historyMessagesVisible","aria-label":n({id:"aJkIm1",defaultMessage:[{type:0,value:"Message and file history, new members will see previous messages and files"}]}),label:n({id:"67FXTk",defaultMessage:[{type:0,value:"Message and File History"}]}),text:n({id:"2fQg2w",defaultMessage:[{type:0,value:"New members will see previous messages and files"}]})}),g.jsx(dK,{isSolitary:!1,defaultActiveKey:[],children:g.jsxs(dK.Item,{eventKey:"advanced_permissions",children:[g.jsx(dK.Header,{className:IY.advancedHeader,...oI.Channel.advancedPermHeader,children:n({id:"ZdMdwG",defaultMessage:[{type:0,value:"Advanced Permissions"}]})}),g.jsx(dK.Body,{...oI.Channel.advancedPermContent,children:g.jsxs("div",{className:IY.advancedContent,children:[!!o&&g.jsx(Ie,{name:"canExternalAdd",label:n({id:"hnGd5f",defaultMessage:[{type:0,value:"Members from outside of the organization"}]}),"aria-label":n({id:"+y7Np0",defaultMessage:[{type:0,value:"Members from outside of the organization, external users can be added"}]}),text:n({id:"t0l+Qx",defaultMessage:[{type:0,value:"External users can be added"}]})}),!o&&g.jsx(Iw,{className:IY.noPaddingBottomSpacing,label:n({id:"zXQVDr",defaultMessage:[{type:0,value:"Who can send messages"}]}),name:"permissionType",ariaLabel:n({id:"zXQVDr",defaultMessage:[{type:0,value:"Who can send messages"}]}),onInputChange:e=>{_(e)},options:[{label:n({id:"2XDuH4",defaultMessage:[{type:0,value:"Everyone"}]}),value:se.ALL,name:"postByAll"},{label:n({id:"RUPRkB",defaultMessage:[{type:0,value:"Owner Only"}]}),value:se.ADMINISTRATOR,name:"postByAdmins"},{label:n({id:"DzwOiZ",defaultMessage:[{type:0,value:"Owner, plus specific people"}]}),value:se.DESIGNEES,name:"postByDesignees"}]})]})})]})}),g.jsx(Tf,{ref:s,onValuesChange:e=>{let t=IJ(e,p).length>0||Th(j,e.designees||[]);c(t)}})]})})})})}let Tv=ex(function(e){let{channelId:t}=e,a=Mi(t);return a?g.jsx(Ty,{...e}):g.jsx(Tg,{...e})}),T_=ex(function(e){let{chatType:t}=e;return t?t===i1.CHANNEL?g.jsx(Td,{...e}):g.jsx(Tv,{...e}):null}),Tb=window.React.useCallback,TM=ex(function(e){let{onClose:t,chatType:a,channelId:n,channelName:i}=e,{$t:s}=oA(),{leaveChannel:r,leaveChat:l}=w5,o=Mi(n),d=Tb(()=>{n&&a&&(a===i1.CHANNEL?r({channelId:n,onSuccess:t}):l({channelId:n,onSuccess:t}))},[n,a,r,l,t]),c=Tb(()=>{bf.open({type:st.TRANSFER,options:{channelId:n,chatType:a,isLeave:!0}})},[n,a]),u=Tb(()=>{bf.open({type:st.DELETE_CHANNEL,options:{channelId:n,chatType:a,channelName:i}})},[n,a,i]),m=s({id:"zjbpsT",defaultMessage:[{type:0,value:'Exit "'},{type:1,value:"name"},{type:0,value:'"'}]},{name:i}),p=l3(()=>o&&a===i1.CHANNEL?s({id:"yg/6ND",defaultMessage:[{type:0,value:"You are the owner of this channel. Delete the channel for all or assign a new owner before leaving to keep the channel for existing members."}]}):o&&a===i1.MUC?s({id:"O3+NaW",defaultMessage:[{type:0,value:"You are the owner of this chat. Delete the chat for all or assign a new owner before leaving to keep the chat for existing members."}]}):a===i1.CHANNEL?s({id:"Dqtll9",defaultMessage:[{type:0,value:"If you leave this channel, you will lose access to all messages and all members will be notified. To rejoin this channel, you will need to be re-added."}]}):s({id:"YGxuh0",defaultMessage:[{type:0,value:"If you leave this chat, you will lose access to all messages and all members will be notified. To rejoin this chat, you will need to be re-added."}]}),[o,a,s]),h=l3(()=>{let e=g.jsx(dj,{...oI.Modal.modalCancelBtn,onClick:t,children:s({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})});return o?g.jsxs("div",{className:IY.footer,children:[g.jsxs("div",{className:IY.footerBtns,children:[e,g.jsx(dj,{...oI.Modal.modalConfirmBtn,type:"primary",onClick:c,children:s({id:"o1qkhE",defaultMessage:[{type:0,value:"Assign New Owner"}]})})]}),g.jsx(dj,{...oI.Modal.modalExtraDeleteBtn,type:"text",className:IY.action,onClick:u,children:a===i1.CHANNEL?s({id:"dzosaH",defaultMessage:[{type:0,value:"Delete Channel"}]}):s({id:"NMr04q",defaultMessage:[{type:0,value:"Delete Chat"}]})})]}):g.jsx("div",{className:IY.footer,children:g.jsxs("div",{className:IY.footerBtns,children:[e,g.jsx(dj,{...oI.Modal.modalConfirmBtn,type:"primary",onClick:d,children:a===i1.CHANNEL?s({id:"zp3bBg",defaultMessage:[{type:0,value:"Leave Channel"}]}):s({id:"bNGm7v",defaultMessage:[{type:0,value:"Leave Chat"}]})})]})})},[o,a,d,c,u,t,s]);return g.jsx(dB,{title:m,footer:h,children:p})}),Tx=window.React.useState,TC=ex(function(e){let{onClose:t,overlayContainer:a,channelId:n,channelName:i,chatType:s,memberCount:r}=e,{$t:l}=oA(),o=Mn(n),[d,c]=Tx(""),{loading:u,includeAllData:m}=b6(n||"",d),p=l3(()=>g.jsx(nG,{height:288,width:"100%",itemSize:32,itemCount:m.length,children:e=>{let{style:i,index:r}=e,l=m[r];return l.jid?g.jsx(CR,{style:i,size:"large",data:l,myRole:o,onAction:t,portalContainer:a,channelId:n,chatType:s},l.jid):g.jsx(CR,{style:i,size:"large",data:l,myRole:o,channelId:n,chatType:s,onAction:t,portalContainer:a,isPending:!0},l.name)}}),[m,o,n,s,a,t]);return g.jsx(dB,{title:l({id:"9LCuda",defaultMessage:[{type:1,value:"count"},{type:0,value:" members in "},{type:1,value:"name"}]},{name:i,count:r||0}),footer:null,closable:!0,onCancel:t,children:g.jsxs("div",{children:[g.jsx("div",{className:IY.search,...oI.Modal.modalMemberSearchInput,children:g.jsx(d$,{placeholder:l({id:"AX3V9N",defaultMessage:[{type:0,value:"Enter at least 3 characters to search..."}]}),onChange:tr(e=>{c(e.target.value)},300),allowClear:!1})}),g.jsx(e4,{loading:u,children:g.jsx("div",{className:IY.memberList,...oI.Modal.modalMemberSearchList,children:p})})]})})}),Tj=window.React.useState,TN=ex(function(e){let{onClose:t,jid:a,email:n,name:i,chatType:s,channelId:r,isApp:l}=e,{$t:o}=oA(),{removeMember:d,removeMioApp:c}=w5,[u,m]=Tj(!1);return g.jsx(dB,{title:o({id:"T0e6Lh",defaultMessage:[{type:0,value:"Remove "},{type:1,value:"name"}]},{name:i}),onCancel:t,onOk:()=>{r&&((m(!0),l)?!a||c({channelId:r,apps:[a],onSuccess:t,onError:()=>{m(!1),o2.error(o({id:"AiEmyz",defaultMessage:[{type:0,value:"Remove app failed"}]}),o({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}}):d({data:{jid:a||"",displayName:i||"",email:n},channelId:r,onSuccess(){!a&&n&&oz.dispatch(oH.removeInvitation,{sessionId:r,emailList:[n]}),t()},onError:()=>{m(!1),o2.error(o({id:"T4H4lC",defaultMessage:[{type:0,value:"Remove member failed"}]}),o({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}}))},okDanger:!0,loading:u,children:s===i1.CHANNEL?o({id:"PCZm0o",defaultMessage:[{type:1,value:"name"},{type:0,value:" will no longer have access to the chat messages and files."}]},{name:i}):o({id:"V8bQBZ",defaultMessage:[{type:1,value:"name"},{type:0,value:" will no longer have access to the channel messages and files."}]},{name:i})})}),Tw=window.React.useCallback,TI=ex(function(e){let{onClose:t,onAction:a,jid:n,email:i}=e,s=Tw(e=>{t?.(),a?.(e)},[a,t]);return(l2(()=>{n&&g2.fetchProfile(n)},[n]),n||i)?g.jsxs("div",{className:IY.info,children:[g.jsx("span",{className:IY.close,...ld(t),children:g.jsx(e8,{})}),n?g.jsx(MZ,{jid:n,onAction:s}):g.jsx(M1,{userName:i||""})]}):null}),TT=ex(function(e){let{onClose:t,channelId:a,channelName:n,meetingType:i,meetingWithVideo:s}=e,{$t:r}=oA(),{startMeeting:l}=Mu();return g.jsx(dB,{title:r({id:"f6JWCh",defaultMessage:[{type:0,value:"Group Meeting"}]}),onCancel:t,onOk:()=>{aJ(a)||aJ(n)||aJ(i)||aJ(s)||(l([{jid:a,name:n,type:i,withVideo:s}]),t())},cancelText:r({id:"oUWADl",defaultMessage:[{type:0,value:"No"}]}),okText:r({id:"a5msuh",defaultMessage:[{type:0,value:"Yes"}]}),children:r({id:"Pi0wWq",defaultMessage:[{type:0,value:"You are about to start a meeting and invite all members of this group to join. Are you sure?"}]})})}),TE=window.React.useState,TS=window.React.useCallback,Tk=ex(e=>{let{data:t,style:a,keyword:n,onAction:i}=e,{$t:s}=oA(),{isJoined:r}=gQ,{name:l,isPublic:o,memberCount:d,admin:c,channelId:u}=t,{displayname:m}=c?.[0]||{},p=r(u),h=TS(()=>{w5.joinChannel({channelId:u,onSuccess:()=>{bf.close(),i?.({jid:u})}})},[u,i]),y=TS(()=>{bf.open({type:st.PREVIEW_CHANNEL,options:{channelId:u,channelName:l,onAction:i}})},[u,l,i]),[v]=id(e=>g.jsxs("div",{...oI.JoinChannel.joinChannelItem(l),style:a,className:f(IY.channelItem,{[IY.disabled]:p}),children:[g.jsx(NL,{className:IY.chatAvatar,chatType:i1.CHANNEL,chatIsPublic:o}),g.jsxs("div",{className:IY.channelInfo,children:[g.jsxs("span",{className:IY.channelName,children:[g.jsx(iI,{highlightClassName:IY.highlight,textToHighlight:l,searchWords:[n||""]}),p&&`(${s({id:"l8wanU",defaultMessage:[{type:0,value:"Joined"}]})})`]}),g.jsxs("span",{children:[g.jsx("span",{className:IY.channelMember,children:s({id:"StUScz",defaultMessage:[{type:1,value:"count"},{type:0,value:" members"}]},{count:d})}),!!m&&` \xb7 ${m}(${s({id:"zINlao",defaultMessage:[{type:0,value:"Owner"}]})})`]})]}),!p&&e&&g.jsxs("div",{className:IY.channelAction,children:[g.jsx(dj,{...oI.JoinChannel.previewBtn,onClick:y,size:"small",children:s({id:"TJo5E6",defaultMessage:[{type:0,value:"Preview"}]})}),g.jsx(dj,{...oI.JoinChannel.joinBtn,onClick:h,type:"primary",size:"small",children:s({id:"P6PLpi",defaultMessage:[{type:0,value:"Join"}]})})]})]}));return v}),TA=ex(e=>{let{onClose:t}=e,{$t:a}=oA(),{accountId:n}=vB,[i,s]=TE(""),[r,l]=TE([]),[o,d]=TE(!1),c=e=>{d(!0);let{value:t}=e.target;uv.query.fetchSearchChannels({keyword:t,accountId:n,matchType:et.CHANNEL_NAME,matchRange:ea.ALL,channelType:en.PUBLIC_NORMAL}).then(e=>{s(t),l(e?.data?.data||[])}).finally(()=>d(!1))};return l2(()=>{c({target:{value:""}})},[]),g.jsxs(dB,{title:a({id:"bvchtt",defaultMessage:[{type:0,value:"Join a Channel"}]}),footer:g.jsx("div",{className:IY.footer,children:g.jsx(dj,{onClick:t,children:a({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})})}),children:[g.jsx("div",{className:IY.search,children:g.jsx(d$,{...oI.JoinChannel.searchInput,placeholder:a({id:"0HBlkO",defaultMessage:[{type:0,value:"Search channels"}]}),onChange:tr(c,300),allowClear:!1})}),g.jsx("div",{className:IY.memberList,children:g.jsx(e4,{loading:o,children:g.jsx(nG,{height:288,width:"100%",itemSize:50,itemCount:r.length,children:e=>{let{style:t,index:a}=e;return g.jsx(Tk,{data:r[a],style:t,keyword:i},r[a].channelId)}})})})]})}),TR=window.React.useState,TL=window.React.useCallback,TO=ex(e=>{let{data:{displayName:t,jid:a,role:n}}=e,{$t:i}=oA(),{avatar:s,name:r=t,nickname:l,firstname:o,lastname:d}=bA(a)||{},c=lT({nickname:l,firstname:o,lastname:d,name:r}),u=rk(n)?`(${i({id:"zINlao",defaultMessage:[{type:0,value:"Owner"}]})})`:"";return g.jsx(dA,{className:IY.tooltip,arrowClassName:IY.tooltipArrow,content:`${c}${u}`,side:"top",arrowVisible:!0,children:g.jsx("span",{children:g.jsx(_L,{size:"sm",jid:a,name:r,image:s})})})}),TD=ex(e=>{let{channelId:t,channelName:a,onClose:n,onAction:i}=e,{$t:s}=oA(),[r,l]=TR(!1),[o,d]=TR(""),[c,u]=TR(a||""),[m,p]=TR([]),[h,f]=TR(0),[y,v]=TR(!1),[_,b]=TR([]),[M,x]=TR(!1),[C,j]=TR(!1),N=TL(e=>{l(!0),uv.query.fetchChannelPreviewInfo({channelId:e,count:5}).then(e=>{d(e?.desc||""),x(!!e?.historyMessagesVisible),p(e?.members?.sort((e,t)=>e.role-t.role)||[]),f(e?.memberCount||0),u(e?.name||"")}).finally(()=>{l(!1)})},[]),w=TL(e=>{M&&(v(!0),uv.query.fetchHistoryLatestMainMsg({limit:15,chatId:e}).then(e=>{b(w_(e?.reverse().map(e=>({...e,fontStyle:e.fontStyte})),s))}).finally(()=>{v(!1)}))},[s,M]),I=TL(()=>{t&&(j(!0),w5.joinChannel({channelId:t,onSuccess:()=>{n?.(),t&&i?.({jid:t})},onError:()=>{j(!1),o2.error(s({id:"C9/cKs",defaultMessage:[{type:0,value:"Join channel failed"}]}),s({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}}))},[t,i,n,s]);l2(()=>{t&&N(t)},[t,N]),l2(()=>{t&&M&&w(t)},[t,M,w]);let T=h-m.length;return g.jsxs(dB,{title:`# ${c}`,loading:C,footer:g.jsx("div",{className:IY.footer,children:g.jsxs("div",{className:IY.footerBtns,children:[g.jsx(dj,{...oI.Modal.modalCancelBtn,onClick:n,children:s({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})}),g.jsx(dj,{...oI.Modal.modalConfirmBtn,type:"primary",onClick:I,children:s({id:"t+Wf41",defaultMessage:[{type:0,value:"Join Channel"}]})})]})}),children:[g.jsx(e4,{loading:r,children:g.jsxs("div",{children:[o&&g.jsxs("div",{className:IY.block,children:[g.jsx("div",{className:IY.blockTitle,children:s({id:"KO3ctu",defaultMessage:[{type:0,value:"Channel Info"}]})}),g.jsx("div",{children:o})]}),g.jsxs("div",{className:IY.block,children:[g.jsx("div",{className:IY.blockTitle,children:s({id:"StUScz",defaultMessage:[{type:1,value:"count"},{type:0,value:" members"}]},{count:m.length})}),g.jsxs("div",{className:IY.members,children:[m.map(e=>g.jsx(TO,{data:e},e.jid)),T>0&&g.jsxs("span",{className:IY.tail,children:["+",T]})]})]})]})}),g.jsxs("div",{className:IY.block,children:[g.jsx("div",{className:IY.blockTitle,children:s({id:"dLNQmi",defaultMessage:[{type:0,value:"Recent Messages"}]})}),g.jsx(e4,{loading:y,children:M?_.length?g.jsx("div",{...oI.Modal.modalMessageRecentList,className:IY.messageList,role:"list",children:_.map(e=>"date"===e.messageType?g.jsx("div",{className:IY.dateIndicator,children:e.message},e.message):g.jsx(Ni,{message:e},e.id))}):g.jsx("div",{children:s({id:"XT+BIH",defaultMessage:[{type:0,value:"No recent messages found"}]})}):g.jsx("div",{children:s({id:"K3szlM",defaultMessage:[{type:0,value:"New members do not have access to view previous messages and files in this channel."}]})})})]})]})}),TP=window.React.useState,TF=window.React.useCallback,TB=window.React.useRef,TU=ex(function(e){let{onClose:t,overlayContainer:a,channelId:n,chatType:i,isLeave:s=!1}=e,{transferOwner:r,leaveChannelAndAssign:l,leaveChatAndAssign:o}=w5,{$t:d}=oA(),c=TB(null),[u,m]=TP(""),[p,h]=TP(""),{loading:f,data:y}=b6(n||"",u),v=l3(()=>y.filter(e=>{let{jid:t,role:a}=e;return!rS(t)&&!rL(a)}),[y]),_=l3(()=>v.map(e=>e.jid),[v]);l2(()=>{if(!p||!_.length)return;let e=_.indexOf(p);c.current?.scrollToItem(e,"smart")},[p,_]);let b=TF(e=>{m(e.target.value),h("")},[m,h]),M=TF(e=>{_.length&&h(t=>{let a=_.indexOf(t)+e;return a<0?aQ(_):_[a%_.length]})},[_,h]),x=TF(e=>{switch(e.key){case sN.up:M(-1);break;case sN.down:M(1)}},[M]),C=l3(()=>g.jsx(nG,{ref:c,height:288,width:"100%",itemSize:32,itemCount:v.length,children:e=>{let{style:t,index:n}=e;return g.jsx(CR,{size:"large",style:t,data:v[n],showOps:!1,isSelected:p===v[n].jid,onSelect:h,portalContainer:a,ariaAttrs:{role:"option","aria-selected":String(p===v[n].jid),"aria-setsize":String(v.length),"aria-posinset":String(n+1),id:`transfer-member-${v[n].jid}`}},v[n].jid)}}),[v,p,h,a]);return g.jsx(dB,{title:d({id:"o1qkhE",defaultMessage:[{type:0,value:"Assign New Owner"}]}),okText:d({id:"guunZt",defaultMessage:[{type:0,value:"Assign"}]}),onOk:()=>{if(!n)return;let e=v.find(e=>{let{jid:t}=e;return t===p});if(e){if(s){i===i1.CHANNEL?l({channelId:n,data:e,onSuccess:t}):o({channelId:n,data:e,onSuccess:t});return}r({channelId:n,data:e,onSuccess:t})}},okDisable:!p,onCancel:t,loading:f,children:g.jsxs("div",{children:[!s&&g.jsx("span",{className:IY.tips,children:d(i===i1.MUC?{id:"YPvM0Y",defaultMessage:[{type:0,value:"The chat can have one owner. After assigning a new owner, you will become a regular chat member."}]}:{id:"uL9eVK",defaultMessage:[{type:0,value:"The channel can have one owner. After assigning a new owner, you will become a regular channel member."}]})}),g.jsx("div",{className:IY.search,...oI.Modal.modalMemberSearchInput,children:g.jsx(d$,{placeholder:d({id:"AX3V9N",defaultMessage:[{type:0,value:"Enter at least 3 characters to search..."}]}),onChange:b,allowClear:!1})}),g.jsx("div",{...oI.Modal.modalMemberSearchList,className:IY.memberList,tabIndex:0,role:"listbox","aria-activedescendant":`transfer-member-${p}`,onKeyDown:x,children:C})]})})}),TH=window.React.useRef,Tz=window.React.useState,TV=ex(function(e){let{onClose:t,channelId:a}=e,{$t:n}=oA(),i=TH(null),[s,r]=Tz(!1),l=g2.userInfo(a),o={label:l?.name,value:l?.jid,jid:l?.jid,displayName:l?.name},{startMUC:d}=gK,c=e=>{r(e?.length>1)},u=e=>a?u_(e):Promise.resolve([]);return g.jsx(dB,{title:n({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),okDisable:!s,okText:n({id:"2/2yg+",defaultMessage:[{type:0,value:"Add"}]}),onOk:()=>{let e=i?.current?.values;if(e){let{members:t=[],channelName:a}=e,{memberList:n,emailList:i}=lF(t);d({info:{subject:a,addMemberList:n,addEmailList:i,fromChannel:!1,fromChat:!0}}),bf.close()}},onCancel:t,children:g.jsx("div",{children:g.jsx(ix,{innerRef:i,initialValues:{members:[o],channelName:""},onSubmit:ec,children:e=>g.jsx(iC,{translate:"yes",children:g.jsx(Ij,{className:IY.memberSelect,label:e.values.members&&e.values.members.length>0?n({id:"N9Od+f",defaultMessage:[{type:0,value:"Members to Add "},{type:8,value:"span",children:[{type:0,value:"("},{type:1,value:"count"},{type:0,value:" Total)"}]}]},{count:e.values.members.length,span:e=>g.jsx("span",{className:IY.memberCount,children:e})}):n({id:"iD7585",defaultMessage:[{type:0,value:"Members to Add"}]}),name:"members",placeholder:n({id:"AX3V9N",defaultMessage:[{type:0,value:"Enter at least 3 characters to search..."}]}),menuIsOpen:!0,optionKeys:{label:"displayName",value:"jid"},onValueChange:c,loadOptionsPromise:u,remainInputValue:!1,filterData:lB({disableExternal:!1,disableFromEmail:!1,disableSelf:!0})})})})})})}),TG=window.React.useState,Tq=ex(function(e){let{titleText:t,messageText:a,confirmButtonText:n,isConfirmButtonDanger:i=!1,confirmCallback:s,onClose:r}=e,[l,o]=TG(!1),d=()=>{o(!1),r()};return g.jsx(dB,{title:t,onCancel:r,onOk:()=>{o(!0),s?s(d):d()},okDanger:i,okText:n,loading:l,children:g.jsx("span",{id:dF,children:a})})}),T$=""+new URL("images/send-request-success.jpg",t.meta.url).href,TK=ex(function(e){let{onClose:t,name:a}=e,{$t:n}=oA();return g.jsxs("div",{className:IY.contactInvitation,children:[g.jsx(wu,{className:IY.paperPlane,src:T$}),g.jsxs("div",{id:dP,className:IY.text,children:[g.jsx("div",{className:IY.invitationDesc,children:n({id:"TCV84X",defaultMessage:[{type:0,value:"An invitation has been sent to"}]})}),g.jsx("div",{...oI.ContactRequests.inviteSuccessUserName,className:IY.invitationName,children:a})]}),g.jsx(dj,{...oI.Modal.modalConfirmBtn,type:"primary",onClick:t,children:n({id:"kAEQyV",defaultMessage:[{type:0,value:"OK"}]})})]})}),TJ=window.React.useState,TW=window.React.useRef,TY=Is(),TX=ex(function(e){let{data:t,form:a,userNotifyType:n,style:i}=e,{$t:s}=oA(),r=function(e){return e.replace(/\./g,"-")}(t.jid);return nl(()=>{a?.setFieldValue(r,t.notifyType??n)}),g.jsxs("div",{style:i,className:IY.preferencesItem,children:[g.jsx("div",{className:IY.preferencesName,children:t.name}),g.jsx(Ir,{className:IY.preferencesRadioGroup,labelClassName:IY.preferencesRadioOption,orientation:"horizontal",showLabel:!1,name:r,options:[{label:s({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]}),value:np.all},{label:s({id:"DKAqfN",defaultMessage:[{type:0,value:"Mentions and Replies"}]}),value:np.mention},{label:s({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]}),value:np.off}]})]})}),TQ=function(e){let{style:t}=e;return g.jsx("div",{style:t,className:f(IY.preferencesItem,IY.divider)})},TZ=ex(e=>{let{onClose:t}=e,{$t:a}=oA(),[n,i]=TJ(""),{NOTIFY_TYPE_MAP:s,notificationsMap:r,userNotifyType:l,exceptPreferencesChannels:o,includePreferencesChannels:d,filterPreferencesChannels:c}=bY(),u=TW(null),{setChannelNotify:m}=bW,p=e=>{let t=Object.entries(e).map(e=>{let[t,a]=e;return{channelJid:function(e){return e.replace(/-/g,".")}(t),type:a}}),a=t.filter(e=>{let t=r.get(e.channelJid)?.type;return aJ(t)&&e.type!==l}),n=t.filter(e=>{let t=r.get(e.channelJid)?.type;return!aJ(t)&&e.type!==t});return{addedValues:a,updatedValues:n}},h=()=>Array.from(r.values()).map(e=>({channelJid:e.jid,type:e.type})),y=c(o,n),v=c(d,n),_=y.length>0&&v.length>0?[...y,null,...v]:v;return g.jsxs(dB,{title:a({id:"aZAgcu",defaultMessage:[{type:0,value:"Manage Group Chats and Channels"}]}),footer:g.jsxs("div",{className:IY.footer,children:[g.jsxs("span",{className:IY.footerBtns,children:[g.jsx(dj,{onClick:t,children:a({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})}),g.jsx(dj,{className:IY.confirmBtn,type:"primary",onClick:()=>{let e=u?.current?.values;if(!e)return;let{addedValues:a,updatedValues:n}=p(e);m({notifyChannels:a,action:ny.add}),m({notifyChannels:n,action:ny.update}),t()},children:a({id:"jvo0vs",defaultMessage:[{type:0,value:"Save"}]})})]}),g.jsx(dj,{onClick:()=>{m({notifyChannels:h(),action:ny.remove}),t()},children:a({id:"jm/spn",defaultMessage:[{type:0,value:"Reset"}]})})]}),children:[g.jsxs("p",{className:IY.preferencesTips,children:[a({id:"E80nT7",defaultMessage:[{type:0,value:"You have set notifications for"}]}),"\xa0",g.jsxs("strong",{className:IY.preferencesText,children:[s[l].label,"."]}),"\xa0",a({id:"9GMiGf",defaultMessage:[{type:0,value:"You can choose different notification options for specific group chats and channels."}]})]}),g.jsx("div",{className:IY.search,children:g.jsx(d$,{placeholder:a({id:"U0zSIz",defaultMessage:[{type:0,value:"Search group chats and channels"}]}),onChange:e=>{i(e.target.value)},allowClear:!1})}),g.jsx(ix,{initialValues:{},onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsxs("div",{className:IY.preferences,children:[g.jsxs("div",{className:f(IY.preferencesItem,IY.preferencesHeader),children:[g.jsx("div",{className:IY.preferencesName,children:a({id:"HAlOn1",defaultMessage:[{type:0,value:"Name"}]})}),g.jsxs("div",{className:IY.preferencesRadioGroup,children:[g.jsx("span",{className:IY.preferencesRadioOption,children:a({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]})}),g.jsx("span",{className:IY.preferencesRadioOption,children:a({id:"DKAqfN",defaultMessage:[{type:0,value:"Mentions and Replies"}]})}),g.jsx("span",{className:IY.preferencesRadioOption,children:a({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]})})]})]}),g.jsx(nG,{className:IY.preferencesList,height:288,width:"100%",itemSize:32,itemCount:_.length,children:e=>{let{style:t,index:a}=e;return null===_[a]?g.jsx(TQ,{style:t},a):g.jsx(TX,{style:t,form:u.current,data:_[a],userNotifyType:l},_[a]?.jid)}})]}),g.jsx(TY,{ref:u})]})})]})}),T1=window.React.useState,T0=ex(function(e){let{onClose:t,fileId:a}=e,{$t:n}=oA(),{getCodeSnippetState:i}=yw,[s,r]=T1(!0),{fileName:l}=i(a||""),o=l?.replace(/\.zip$/,"")||"";return g.jsxs(dB,{className:IY.codeSnippet,title:o,onCancel:t,onOk:t,okText:n({id:"JXdbo8",defaultMessage:[{type:0,value:"Done"}]}),hideCancel:!0,testKey:"viewCodeSnippet",width:"600px",children:[g.jsx(Cx,{height:"360px",fileId:a||"",isNoWrap:!s}),g.jsx(ix,{initialValues:{isWrap:s},onSubmit:ec,children:g.jsx(iC,{translate:"yes",className:IY.wrapForm,children:g.jsx(Ie,{name:"isWrap",text:n({id:"r7kiOG",defaultMessage:[{type:0,value:"Wrap"}]}),checked:s,onChange:r})})})]})}),T2=window.React.useRef,T5=window.React.useState,T3=Is(),T6=ex(function(e){let{onClose:t,channelId:a=""}=e,{$t:n}=oA(),{createMentionGroup:i,mentionList:s}=yE,r=T2(null),[l,o]=T5(!1),[d,c]=T5(!1);return g.jsx(dB,{title:n({id:"t2DWvy",defaultMessage:[{type:0,value:"Add Mention Group"}]}),okText:n({id:"2/2yg+",defaultMessage:[{type:0,value:"Add"}]}),onOk:()=>{let{dirty:e,isValid:s,values:l}=r?.current||{};if(!e||!s||!l)return;let{name:o,description:d,memberList:u}=l;c(!0),i({channelJid:a,name:o,description:d,memberList:u.map(e=>{let{jid:t}=e;return t}),onAction:e=>{c(!1),e?t():o2.error(n({id:"xE24nJ",defaultMessage:[{type:0,value:"Add mention group failed"}]}),n({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}})},okDisable:!l,closable:!0,onCancel:t,loading:d,children:g.jsx(ix,{innerRef:r,initialValues:{name:"",description:"",memberList:[]},onSubmit:ec,validationSchema:ij({name:iN().test("duplicate-name",n({id:"ZU6KYk",defaultMessage:[{type:0,value:"This name is already used in this channel. Please choose another name."}]}),e=>!s(a).some(t=>iM(t.name)===iM(e)))}),children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{label:n({id:"+jLnah",defaultMessage:[{type:0,value:"Mention Group Name"}]}),name:"name",type:"text",required:!0,maxLength:39}),g.jsx(Ia,{label:n({id:"scHCPY",defaultMessage:[{type:0,value:"Description(optional)"}]}),name:"description",type:"text",maxLength:500}),g.jsx(Ij,{className:IY.memberSelect,label:n({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),name:"memberList",placeholder:n({id:"0qphDz",defaultMessage:[{type:0,value:"Search people"}]}),optionKeys:{label:"name",value:"jid"},isDisableEscapeAria:!0,menuIsOpen:!0,isLoadInitialOptions:!0,loadOptionsPromise:e=>(function(e){let{keyword:t,channelJid:a,page:n,size:i}=e;return new Promise(e=>{uv.query.searchChannelMembers({userName:t,groupId:a,page:n||0,size:i||200}).then(t=>{t?.data?.data?.length?e(t.data.data):e([])}).catch(()=>{e([])})})})({channelJid:a,keyword:e}),remainInputValue:!1,filterData:lB({disableFromEmail:!0})}),g.jsx(T3,{ref:r,onValuesChange:e=>{o(!!iM(e.name))}})]})})})}),T4=window.React.useRef,T8=window.React.useState,T7=Is(),T9=ex(function(e){let{onClose:t,mentionJid:a,overlayContainer:n}=e,{$t:i}=oA(),{mentionGroupDetail:s,mentionMembers:r,updateMentionGroup:l,mentionList:o}=yE,d=T4(null),[c,u]=T8(!1),[m,p]=T8(!1),h=a?s(a):null;if(oe(()=>{d?.current?.setValues({name:h?.name||"",description:h?.description||"",member:{addList:[],removeList:[]}})},[h]),!a||!h)return null;let f=r(a);return g.jsx(dB,{title:`@${h.name}(${f.length})`,okText:i({id:"BWpuKl",defaultMessage:[{type:0,value:"Update"}]}),onOk:()=>{let{dirty:e,isValid:n,values:s}=d?.current||{};if(!e||!n||!s)return;let{name:r,description:o,member:c}=s;p(!0);let u={};r!==h.name&&(u={...u,name:r}),o!==h.description&&(u={...u,description:o}),c.addList.length&&(u={...u,addList:c.addList}),c.removeList.length&&(u={...u,removeList:c.removeList}),l({jid:a,...u,onAction:e=>{p(!1),e?t():o2.error(i({id:"DtnEHn",defaultMessage:[{type:0,value:"Update mention group failed"}]}),i({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))}})},okDisable:!c,closable:!0,onCancel:t,loading:m,children:g.jsx(ix,{innerRef:d,initialValues:{name:"",description:"",member:{addList:[],removeList:[]}},onSubmit:ec,validationSchema:ij({name:iN().test("duplicate-name",i({id:"ZU6KYk",defaultMessage:[{type:0,value:"This name is already used in this channel. Please choose another name."}]}),e=>{let{channelJid:t,jid:a}=h;return!o(t).some(t=>t.jid!==a&&iM(t.name)===iM(e))})}),children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{label:i({id:"+jLnah",defaultMessage:[{type:0,value:"Mention Group Name"}]}),name:"name",type:"text",required:!0,maxLength:39}),g.jsx(Ia,{label:i({id:"scHCPY",defaultMessage:[{type:0,value:"Description(optional)"}]}),name:"description",type:"text",maxLength:500}),g.jsx(IG,{name:"member",channelJid:h.channelJid,overlayContainer:n,addedMember:f}),g.jsx(T7,{ref:d,onValuesChange:e=>{u(!!iM(e.name)&&(iM(e.name)!==h.name||iM(e.description)!==h.description||!!e.member.addList.length||!!e.member.removeList.length))}})]})})})}),Ee=window.React.useState,Et=window.React.useCallback,Ea=ex(function(e){let{onClose:t,mentionJid:a="",overlayContainer:n}=e,{$t:i}=oA(),{mentionGroupDetail:s,mentionMembers:r,mentionMemberDetail:l,joinToMentionGroup:o,leaveMentionGroup:d}=yE,{userJid:c}=vB,u=s(a),m=u?.channelJid,[p,h]=Ee(""),{loading:y,includeAllData:v}=b6(m||"",p),_=Et(e=>{h(e.target.value)},[h]),b=r(a),M=l(a)?.haveMore===!1,x=b.includes(c),C=oa(()=>{let e=v.filter(e=>b.includes(e.jid));return g.jsx(nG,{height:240,width:"100%",itemSize:32,itemCount:e.length,children:a=>{let{style:i,index:s}=a,r=e[s];return g.jsx(CR,{style:i,size:"large",data:r,onAction:t,portalContainer:n,channelId:m,showOps:!1,ariaAttrs:{tabIndex:"0"}},r.jid)}})},[v,n,m,b,t]),j=l3(()=>tr(_,300),[_]);return a&&u?g.jsx(dB,{title:`@${u.name}(${b.length})`,footer:null,closable:!0,onCancel:t,children:g.jsxs("div",{className:IY.mentionGroupDialog,children:[g.jsx("div",{className:IY.descriptionTitle,children:i({id:"Q8Qw5B",defaultMessage:[{type:0,value:"Description"}]})}),g.jsxs("div",{className:IY.descriptionDetail,children:[u.description?g.jsx("div",{className:IY.descriptionText,children:u.description}):g.jsx("div",{className:f(IY.descriptionText,IY.isEmpty),children:i({id:"5lVaeB",defaultMessage:[{type:0,value:"No description"}]})}),M&&(x?g.jsx(dj,{size:"middle",type:"primary",onClick:()=>{d(a)},children:i({id:"fnihsY",defaultMessage:[{type:0,value:"Leave"}]})}):g.jsx(dj,{size:"middle",type:"primary",onClick:()=>{o(a)},children:i({id:"P6PLpi",defaultMessage:[{type:0,value:"Join"}]})}))]}),g.jsxs("div",{className:IY.memberViewer,children:[g.jsx("div",{className:IY.searchMember,children:g.jsx(d$,{className:IY.searchInput,placeholder:i({id:"9Obw6C",defaultMessage:[{type:0,value:"Filter"}]}),onChange:j,allowClear:!1})}),g.jsx(e4,{loading:y,children:g.jsx("div",{className:IY.mentionListContainer,children:C})})]})]})}):null}),En=window.React.useRef,Ei=window.React.useState,Es=window.React.useCallback,Er=Is(),El=ex(function(e){let{onClose:t,channelId:a}=e,{$t:n}=oA(),{addMioApp:i}=w5,s=En(null),[r,l]=Ei(!1),[o,d]=Ei(!1),{loading:c,data:u}=_4(a),{loading:m,data:p}=be(a,i4.ADDON),{isPublic:h,sessionType:f,subject:y,isMeetChat:v}=u||{},_=l3(()=>{switch(f){case i1.MUC:return v?g.jsx(is,{className:"icon-team"}):g.jsx(nJ,{className:"icon-team"});case i1.CHANNEL:return h?g.jsx(eU,{className:"icon-number-italic"}):g.jsx(nW,{className:"icon-lock-locked"});default:return null}},[h,f,v]),b=Es(e=>{l(!!e.apps?.length)},[l]),M=async e=>{if(e?.length<3)return[];let{data:t=[]}=await uv.query.fetchMioAppList({keyword:e}).catch(()=>({data:[]}));return t},x=Es(e=>{let{jid:t}=e;return p.some(e=>e.jid===t)},[p]);return g.jsx(dB,{title:n({id:"ldPSzY",defaultMessage:[{type:0,value:"Add Apps"}]}),okDisable:!r,okText:n({id:"2/2yg+",defaultMessage:[{type:0,value:"Add"}]}),onOk:()=>{if(!a)return;let e=s?.current?.values;if(e){let{apps:s=[]}=e;d(!0),i({channelId:a,apps:s.map(e=>e.jid),onError:()=>{d(!1),o2.error(n({id:"m3Ho9a",defaultMessage:[{type:0,value:"Add apps failed"}]}),n({id:"bPzVII",defaultMessage:[{type:0,value:"please try again later"}]}))},onSuccess:t})}},loading:c||m||o,onCancel:t,children:g.jsxs("div",{children:[g.jsxs("div",{className:IY.chatName,children:[_,g.jsx("span",{className:IY.nameText,children:y})]}),g.jsx(ix,{initialValues:{apps:[]},onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ij,{className:IY.memberSelect,name:"apps",placeholder:n({id:"AX3V9N",defaultMessage:[{type:0,value:"Enter at least 3 characters to search..."}]}),menuIsOpen:!0,optionKeys:{label:"name",value:"jid"},loadOptionsPromise:M,isOptionDisabled:x,remainInputValue:!0}),g.jsx(Ie,{disabled:!0,name:"privacy",checked:!0,label:n({id:"cXBJ7U",defaultMessage:[{type:0,value:"Privacy"}]}),text:n({id:"GZdoyg",defaultMessage:[{type:0,value:"Only the channel owner can add or remove apps"}]})}),g.jsx(Er,{ref:s,onValuesChange:b})]})})]})})}),Eo=Object.freeze(Object.defineProperty({__proto__:null,AddAppDialog:El,AddDialog:I2,AddDialogP2P:TV,AddMentionGroupDialog:T6,AssignDialog:I3,CodeSnippetDialog:T0,ContactInvitationDialog:TK,CreateDialog:I9,DeleteDialog:Tt,EditDialog:T_,EditMentionGroupDialog:T9,JoinDialog:TA,LeaveDialog:TM,MeetingDialog:TT,MembersDialog:TC,MessageBoxDialog:Tq,MessagePreferencesDialog:TZ,PreviewDialog:TD,PreviewMentionGroupDialog:Ea,ProfileDialog:TI,RemoveDialog:TN,TransferDialog:TU},Symbol.toStringTag,{value:"Module"})),Ed=window.PWAModal.Modal,Ec=window.React.useState,Eu=ex(function(){let{visible:e,type:t,options:a,close:n}=bf,[i,s]=Ec(),[r,l]=Ec(),[o,d]=Ec();return g.jsx(Ed,{overlayRef:e=>s(e),contentRef:e=>l(e),isOpen:e,isDraggable:!1,needBackdrop:!0,centered:!0,shouldFocusAfterRender:!1,onAfterOpen:()=>{setTimeout(()=>{d(document.activeElement),r?.focus()},10)},onAfterClose:()=>{o?.focus()},shouldCloseOnEsc:!0,onRequestClose:n,aria:{labelledby:dP,describedby:dF},children:(()=>{if(!e||!t)return g.jsx(g.Fragment,{});let s=Eo[t];return g.jsx(s,{onClose:n,overlayContainer:i,...x(a)})})()})}),Em={selectOption:"_selectOption_1n76o_1",selectOptionName:"_selectOptionName_1n76o_4",selectOptionDetail:"_selectOptionDetail_1n76o_4",optionDisabled:"_optionDisabled_1n76o_7",closeBtn:"_closeBtn_1n76o_10",selectOptionInner:"_selectOptionInner_1n76o_17",chatAvatar:"_chatAvatar_1n76o_30",selectOptionLabel:"_selectOptionLabel_1n76o_49"},Ep=ex(function(e){let{innerProps:t,data:a}=e,{jid:n,label:i,status:s,avatar:r,type:l,isPublic:o}=a,{$t:d}=oA(),c=bA(n),{getFolderByMember:u,removeFolderEditMember:m,currentFolder:p}=bN,{isChatStarred:h}=yh,y=u(n),v=(e=>{if(!p)return!1;let t=p.toDelete?.has(e.jid),a=!!p.members.find(t=>t.objid===e.jid);return a&&!t})(a),_=h(n);return g.jsx("div",{...t,className:f(t.className,Em.selectOption,{[Em.optionDisabled]:v}),children:g.jsxs("div",{className:Em.selectOptionInner,children:[g.jsx(NL,{className:Em.chatAvatar,name:i,url:r??c?.avatar,jid:n,chatType:l,chatIsPublic:o,status:s,size:"sm"}),g.jsxs("span",{className:Em.selectOptionName,onClick:e=>{v&&e.stopPropagation()},children:[g.jsxs("span",{className:Em.selectOptionLabel,children:[i," ",v?d({id:"kcBzu2",defaultMessage:[{type:0,value:"(Added)"}]}):""]}),v&&g.jsx(ae,{className:Em.closeBtn,onClick:()=>m(n)}),!v&&!!y&&g.jsxs("span",{className:Em.selectOptionDetail,children:[g.jsx(iT,{})," ",y.name]}),!v&&_&&g.jsxs("span",{className:Em.selectOptionDetail,children:[g.jsx(iE,{})," ",d({id:"V7cUPv",defaultMessage:[{type:0,value:"Starred"}]})]})]})]})})}),Eh=window.React.forwardRef,Ef=window.React.useRef,Eg=window.React.useImperativeHandle,Ey=Is(),Ev=ex(Eh((e,t)=>{let{onValidating:a,channelId:n}=e,{createFolder:i,updateFolder:s,folderList:r,currentFolder:l,lastFolder:o,isEdit:d,getFolderByMember:c,addMembersToFolder:u,deleteMemberFromFolder:m}=bN,p=Mg(),{$t:h}=oA(),f=Ef(null),y=l3(()=>p.filter(e=>{let{jid:t}=e;return rO(t)}),[p]),v=e=>{let t=e?.filter(e=>!rS(e.jid)&&e.name)||[];if(!l)return{result:t};{let e=t?.filter(e=>c(e.jid)?.folderID===l?.folderID),a=t?.filter(e=>c(e.jid)?.folderID!==l?.folderID);return{result:[...e,...a]}}};return Eg(t,()=>({submitForm:()=>{f.current?.submitForm()}}),[]),l2(()=>{let e=p.find(e=>e.jid===n);f.current?.setValues({folderName:l?.name||"",members:d||!e?[]:[{...e,label:e.name,value:e.jid}]})},[d,n]),g.jsx("div",{children:g.jsx(ix,{initialValues:{folderName:l?.name||"",members:[]},validationSchema:ij({folderName:iN().required(h({id:"loAJze",defaultMessage:[{type:0,value:"Folder Name is required."}]})).test("duplicate-name",h({id:"hlV2d+",defaultMessage:[{type:0,value:"This name is already in use. Please choose another name."}]}),e=>{let t=d?r.filter(e=>e.folderID!==l?.folderID):r;return!t.some(t=>iM(t.name)===iM(e))})}),onSubmit:e=>{if(d&&l){s([{folderID:l.folderID,index:l.index,name:e.folderName}]);let t=new Set([...l.toDelete||[]]),a=[];e.members.forEach(e=>{if(t.has(e.jid))return t.delete(e.jid);a.push(e)}),m({folderId:l.folderID,sessionIds:[...t]}),u({folderID:l.folderID,sessionIds:a.map(e=>e.jid)})}else i({info:{name:e.folderName,index:(Number(o?.index)||0)+1},membersAdded:e.members.map((e,t)=>({index:t+"",sessionId:e.jid}))})},children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Ia,{label:h({id:"LyxC1q",defaultMessage:[{type:0,value:"Folder Name"}]}),name:"folderName",type:"text",placeholder:h({id:"YrWE3b",defaultMessage:[{type:0,value:"e.g. "},{type:1,value:"name"}]},{name:"Project Cloud"})}),g.jsx(Ij,{defaultOptions:v(y).result,label:h({id:"4COADa",defaultMessage:[{type:0,value:"Add Contacts, Chats, or Channels"}]}),description:h({id:"k/qhF8",defaultMessage:[{type:0,value:"If you select a chat or channel that is Starred or in another folder, it will move to this folder."}]}),name:"members",loadOptionsPromise:e=>Promise.all([uv.query.fetchSearch(al.CONTACT,{sourceType:4,keyword:e}),uv.query.fetchSearch(al.CHANNEL,{...oT,keyword:e})]).then(e=>{let t=e[0]?.data?.data||[],a=e[1]?.data?.data||[];return[...t.map(e=>(function(e){let{jid:t,displayName:a}=e;return{jid:t,name:a,type:i1.CHAT,timestamp:0}})(e)),...a.map(e=>(function(e){let{channelId:t,name:a,option:n,isPublic:i}=e;return{jid:t,name:a,type:rP(n)?i1.CHANNEL:i1.MUC,isPublic:i,timestamp:0}})(e))]}),optionKeys:{label:"name",value:"jid"},placeholder:h({id:"M+uAST",defaultMessage:[{type:0,value:"Name or channel"}]}),filterData:v,components:{Option:Ep}}),g.jsx(Iq,{}),g.jsx(Ey,{ref:f,onValuesChange:e=>{let t=!0;e.members.length||d||iM(e.folderName)!==iM(l?.name)||(t=!1),a?.(t)}})]})})})})),E_=window.React.useRef,Eb=window.React.useState;function EM(e){let{isEdit:t,channelId:a,isSubmitting:n,visible:i,onClose:s}=e,[r,l]=Eb(!1),o=E_(null),{$t:d}=oA();return g.jsx(xb,{visible:i,width:560,title:d(t?{id:"UqTTsg",defaultMessage:[{type:0,value:"Edit Folder"}]}:{id:"yFvSRv",defaultMessage:[{type:0,value:"Create a Folder"}]}),noSpacing:!1,onCancel:s,onOk:()=>{o.current?.submitForm?.()},okText:d(t?{id:"3VI9mt",defaultMessage:[{type:0,value:"Save Changes"}]}:{id:"2kWVwo",defaultMessage:[{type:0,value:"Create Folder"}]}),okDisable:!r||n,cancelDisable:n,loading:n,children:g.jsx(Ev,{ref:o,isEdit:t,channelId:a,onAfterSubmit:()=>{s?.()},onValidating:e=>l(e)})})}let Ex=ex(function(e){let{visible:t,isSubmitting:a,onClose:n}=e,{$t:i}=oA(),{currentFolder:s,deleteFolder:r}=bN;return g.jsx(xb,{visible:t,title:i({id:"/m4OG6",defaultMessage:[{type:0,value:"Delete Folder"}]}),noSpacing:!1,okText:i({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),onCancel:n,onOk:()=>{r(s?.folderID||"")},okDisable:a,okDanger:!0,loading:a,children:g.jsx("p",{children:i({id:"JS4K3K",defaultMessage:[{type:0,value:"Chats and channels in "},{type:1,value:"folderName"},{type:0,value:" will move to the default section(s). All chat history will still be available."}]},{folderName:g.jsx("strong",{children:s?.name})})})})}),EC=ex(function(){let{modalVisible:e,deleteChannelVisible:t,isEdit:a,channelId:n,isSubmitting:i,closeModal:s}=bN;return g.jsxs(g.Fragment,{children:[g.jsx(EM,{visible:e,isEdit:a,channelId:n,isSubmitting:i,onClose:s}),g.jsx(Ex,{visible:t,isSubmitting:i,onClose:s})]})});var Ej=(e=>(e.xmppConnected="xmppConnected",e.firstGetUnread="firstGetUnread",e.loadMainPanel="loadMainPanel",e.loadChatMsgs="loadChatMsgs",e.loadMoreMsgs="loadMoreMsgs",e.loadChatSidebar="loadChatSidebar",e.loadBookmarks="loadBookmarks",e.loadMentions="loadMentions",e.loadReminders="loadReminders",e.loadContactRequests="loadContactRequests",e))(Ej||{});let EN=!1,Ew=()=>{l2(()=>{let e=uW.connected$.subscribe(()=>{fS.logMeasure(Ej.xmppConnected,fk.XMPP_CONNECTED)}),t=uW.unreadChannel$.subscribe(()=>{EN||(fS.logMeasure(Ej.firstGetUnread,fk.GET_UNREAD),EN=!0)});return()=>{e.unsubscribe(),t.unsubscribe()}},[])},EI=window.React.useCallback,ET=window.pwaChatConfig.integrationDomain,EE=window.pwaChatConfig.jid,ES=ex(()=>{let{replyCloudFileMessage:e,sendCloudFileMessage:t}=y9(),{cloudStorage:a,stopFileSharing:n}=CT,i=`${ET}/storage/${a}/${EE}/connect?action=chooser&parent=${window.location.host}&from=pwa_team_chat`,s=EI(a=>{if(a.origin!==ET||a.data?.type!=="ZOOM_CHOOSER_RESULT"||!a.data?.result)return;let{replyId:i}=CT,s=rJ(a.data?.result?.wd,null);if(!s)return;let{fileSize:r,fileId:l,fileName:o,type:d,previewPath:c,previewUrl:u,cnonce:m}=s;if(m!==EE)return;let p=Number(r),h={fileName:o,fileSize:p,thirdPartyInfo:{id:l,previewLink:u,previewPath:c,fileName:o,fileSize:p,thirdPartyFileType:sy.None,integrationType:rM[d]}};i?e({...h,replyId:i}):t(h),n()},[n,e,t]);return l2(()=>(a?window.addEventListener("message",s):window.removeEventListener("message",s),()=>{window.removeEventListener("message",s)}),[a,s]),g.jsxs(xb,{visible:!!a,closable:!0,footer:g.jsx(g.Fragment,{}),className:"_modal_gzdcw_1",onCancel:n,shouldCloseOnEsc:!0,children:[g.jsx(dj,{...oI.Modal.modalCloseBtn,size:"small",type:"text",className:"_modalClose_gzdcw_8",icon:g.jsx(e8,{}),onClick:e=>{e.stopPropagation(),n()}}),g.jsx("iframe",{src:i,title:"third-party-file-iframe",name:"third-party-file-iframe",tabIndex:0})]})}),Ek=window.React.useCallback,EA=window.React.useRef,ER=[sn.BOOKMARKS,sn.CONTACT,sn.FILES,sn.MENTION,sn.REMINDERS],EL=!1,EO=()=>{let{localMessages:e,mode:t,fetched:a,previousLoading:n,nextLoading:i}=y9(),{firstChatId:s}=yh,r=e.length>0&&"normal"===t&&!a,l=EA(null),o=EA(null),d=EA(null),c=Ek(e=>{if(!(!s||ER.includes(s))&&!EL){let t=o3()?fk.PLATFORM_WC:fk.PLATFORM_CHAT;fS.logMeasure(Ej.loadMainPanel,[fk.LOAD_MESSAGES,t,e]),EL=!0}},[s]),u=Ek(e=>{l.current&&(fS.logMeasure(Ej.loadChatMsgs,{start:l.current,tags:[fk.LOAD_CHAT_MSGS,e]}),l.current=null)},[]),m=Ek(e=>{fS.logMeasure(Ej.loadMoreMsgs,{start:e,tags:[fk.LOAD_MORE_MSGS]})},[]);l2(()=>{l.current=fS.now()},[]),l2(()=>{r&&(c(fk.BY_LOCAL),u(fk.BY_LOCAL))},[r,c,u]),l2(()=>{a&&(c(fk.BY_ONLINE),u(fk.BY_ONLINE))},[a,c,u]),l2(()=>{n?o.current=fS.now():o.current&&(m(o.current),o.current=null)},[m,n]),l2(()=>{i?d.current=fS.now():d.current&&(m(d.current),d.current=null)},[m,i])},ED={buttonActions:"_buttonActions_14jt3_1",visible:"_visible_14jt3_7",button:"_button_14jt3_1",bookmarkIcon:"_bookmarkIcon_14jt3_16"},EP=window.React.useCallback,EF=window.React.useState,EB=ex(function(e){let{className:t,dropdown:a=!1,bookmarkMessage:n}=e,{channelJid:i,senderJid:s,time:r,id:l}=n,{$t:o}=oA(),{removeBookmark:d}=_w(n),[c,u]=EF(!1),m=lU(i,s),p=EP(()=>{yf({jid:m}),oz.dispatch(oH.jumpToMessage,{chatId:m,msgId:l,sendTime:r,mainMsgId:n.replyId})},[l,m,r,n.replyId]),h=l3(()=>({extraData:null,dropDownOptions:[[{key:"JumpToMessage",text:o({id:"LltPkP",defaultMessage:[{type:0,value:"Jump to Message"}]}),testKey:"jumpToMessage"},{key:"RemoveBookmark",text:o({id:"RokVj/",defaultMessage:[{type:0,value:"Remove Bookmark"}]}),testKey:"removeBookmark"}]],onDropDownAction:e=>{let{eventKey:t}=e;switch(t){case"JumpToMessage":p();break;case"RemoveBookmark":d()}}}),[o,p,d]);return g.jsxs("div",{tabIndex:-1,className:f(t,ED.buttonActions,{[ED.visible]:c}),children:[g.jsx(dj,{...oI.Bookmarks.removeBtn(l),className:ED.button,icon:g.jsx(ie,{className:ED.bookmarkIcon}),size:"small","aria-label":o({id:"RokVj/",defaultMessage:[{type:0,value:"Remove Bookmark"}]}),onClick:d}),a?g.jsx(NJ,{...h,sideOffset:4,onOpenChange:u,children:g.jsx(dj,{className:ED.button,icon:g.jsx(nt,{}),size:"small","aria-label":o({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]})})}):g.jsx(dj,{...oI.Bookmarks.jumpBtn(l),className:ED.button,size:"small","aria-label":o({id:"LltPkP",defaultMessage:[{type:0,value:"Jump to Message"}]}),onClick:p,children:o({id:"DHJw7T",defaultMessage:[{type:0,value:"Jump"}]})})]})});function EU(){let{$t:e}=oA();return g.jsxs("div",{className:"_bookmarksEmpty_1k9d0_1",children:[g.jsx("p",{className:"_bookmarksTips_1k9d0_8",children:e({id:"enmjHL",defaultMessage:[{type:0,value:"Give important messages a Bookmark"}]})}),g.jsx("p",{className:"_bookmarksSubTip_1k9d0_12",children:e({id:"iji5gq",defaultMessage:[{type:0,value:"This will help you remember to follow up later."}]})})]})}let EH=ex(function(){let{sortedBookmarksMessages:e,fetchMessageByBookmark:t,loading:a}=_j,n=0===e.length&&!a,i=sM.scrollAttrs("bookmarks"),s=e.map(e=>e.id);return nl(()=>{t()}),g.jsx(_Z,{messageIds:s,children:g.jsx("div",{...i,className:"_bookmarksMessages_1gmym_1",role:"list",children:n?g.jsx(EU,{}):g.jsx(e4,{loading:a,children:g.jsx(g.Fragment,{children:e.map(e=>g.jsx(wT,{msgId:e.id,action:(e,t)=>g.jsx(EB,{className:t,bookmarkMessage:e})},e.id))})})})})});function Ez(){return g.jsx("div",{...oI.Bookmarks.bookmarksPanel,className:"_bookmarksPanel_1m7ym_1",children:g.jsx(EH,{})})}let EV={placeholder:"_placeholder_1gtt7_1",bookmark:"_bookmark_1gtt7_7"},EG=ex(function(){let{$t:e}=oA(),{channelJid:t}=vo(),{loading:a,bookmarksMessages:n}=function(e){let{fetchBookmarkMessageByChatId:t,bookmarksMessagesMap:a,bookmarksMessagesLoadingMap:n}=_j,i=a.has(e);return l2(()=>{e&&!i&&t(e)},[i,t,e]),{loading:n.get(e)??!1,bookmarksMessages:a.get(e)??[]}}(t),i=!a&&!n.length,s=n.map(e=>e.id);return i?g.jsx("div",{className:EV.placeholder,children:e({id:"60FuDl",defaultMessage:[{type:0,value:"Bookmarked messages will appear here as you bookmark"}]})}):g.jsx(_Z,{messageIds:s,children:g.jsx(e4,{loading:a,children:g.jsx("div",{className:EV.bookmark,children:n.map(e=>g.jsx(wT,{action:(e,t)=>g.jsx(EB,{className:t,bookmarkMessage:e,dropdown:!0}),msgId:e.id,layout:"side"},e.id))})})})}),Eq=ex(function(e){let{getNewSearchValue:t,updateSearchFilter:a,fetchFiles:n}=vV,{activeTitle:i,setActiveTitle:s}=e,{$t:r}=oA(),l=vB.userJid,o=[{key:"my",text:r({id:"AjhJXS",defaultMessage:[{type:0,value:"My Files"}]})},{key:"all",text:r({id:"5IiYyq",defaultMessage:[{type:0,value:"All Files"}]})}];return g.jsx("div",{...oI.Main.panelHeader,tabIndex:-1,className:"_filesHeader_14g6m_1",children:g.jsx(cK,{options:o,activeKey:i,onChange:e=>{s(e);let i={searchKey:sX.SendByJid,optionValue:"my"===e?l:""};a(i);let r=t(i);r&&n(r)}})})}),E$={filesFilter:"_filesFilter_oa91z_1",filesFilterTitle:"_filesFilterTitle_oa91z_4",filesFilterOption:"_filesFilterOption_oa91z_30",filesFilterLabel:"_filesFilterLabel_oa91z_33",filesFilterDropDown:"_filesFilterDropDown_oa91z_41",filesFilterValue:"_filesFilterValue_oa91z_44",filterChatItemInner:"_filterChatItemInner_oa91z_73",filterChatItemInnerUser:"_filterChatItemInnerUser_oa91z_93",filterChatItemInnerUserAvatar:"_filterChatItemInnerUserAvatar_oa91z_106",filterChatItemInnerUsername:"_filterChatItemInnerUsername_oa91z_113"},EK=ex(function(e){let{jid:t}=e,{name:a,sessionType:n}=b2(t);return g.jsx("div",{className:E$.filterChatItemInner,children:g.jsxs("div",{className:E$.filterChatItemInnerUser,children:[g.jsx(NL,{className:E$.filterChatItemInnerUserAvatar,jid:t,name:a,chatType:n,size:"sm",statusLongConnection:!0}),g.jsx("span",{className:E$.filterChatItemInnerUsername,title:a,children:a})]})})}),EJ=ex(function(e){let{name:t,type:a,topType:n}=e;return g.jsx("div",{className:E$.filterChatItemInner,children:g.jsxs("div",{className:E$.filterChatItemInnerUser,children:[g.jsx(NL,{className:E$.filterChatItemInnerUserAvatar,name:t,chatType:a,topType:n,size:"sm",statusLongConnection:!0}),g.jsx("span",{className:E$.filterChatItemInnerUsername,title:t,children:t})]})})}),EW=ex(function(e){let{jid:t}=e,{$t:a}=oA(),n=bA(t);if(!n)return g.jsx(g.Fragment,{});let{avatar:i,name:s}=n,r=rS(t)?a({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):lT(n);return g.jsx("div",{className:E$.filterChatItemInner,children:g.jsxs("div",{className:E$.filterChatItemInnerUser,children:[g.jsx(NL,{className:E$.filterChatItemInnerUserAvatar,jid:t,name:s,url:i||"",chatType:i1.CHAT,size:"sm",statusLongConnection:!0}),g.jsx("span",{className:E$.filterChatItemInnerUsername,title:r,children:r})]})})}),EY=window.React.useCallback,EX=window.React.useState,EQ=ex(function(){let{$t:e}=oA(),[t,a]=EX(!1),[n,i]=EX(""),s=Mg(),{getNewSearchValue:r,filesSearchFilterValues:l,updateSearchFilter:o,fetchFiles:d}=vV,c=l?.groupJid,u=EY(e=>{a(e),e&&i("")},[]),m=EY(e=>{i(e.target.value)},[i]),p=EY(t=>{if(!t||"All"===t)return e({id:"zQvVDJ",defaultMessage:[{type:0,value:"All"}]});if("BookMarks"===t)return e({id:"DD/fEh",defaultMessage:[{type:0,value:"Bookmarked Messages"}]});{let e=s.find(e=>e.jid===t);return e?.name}},[s,e]),h=EY(e=>{let t=s.filter(e=>!sd.includes(e.jid));return e.length>2&&(t=t.filter(t=>t.name?.toLowerCase().includes(e.toLowerCase()))),t},[s]),f=l3(()=>({onSearchChange:m,extraData:null,open:t,onOpenChange:u,dropDownOptions:[[{key:"All",text:e({id:"zQvVDJ",defaultMessage:[{type:0,value:"All"}]}),hasCheckMark:!c,hasElement:!0,element:g.jsx(EJ,{name:"All",type:i1.UNKNOWN})},{key:"BookMarks",text:e({id:"DD/fEh",defaultMessage:[{type:0,value:"Bookmarked Messages"}]}),hasCheckMark:"BookMarks"===c,hasElement:!0,element:g.jsx(EJ,{name:"Bookmarked Messages",topType:si.BOOKMARKS})},...h(n).map(e=>{let t=e?.name;return{key:e.jid||"",text:t,hasCheckMark:c===e?.jid,hasElement:!0,element:rT(e.jid)?g.jsx(EK,{jid:e.jid}):g.jsx(EW,{jid:e.jid})}})]],onDropDownAction:e=>{let{eventKey:t}=e,a={searchKey:sX.GroupJid,optionValue:"All"===t?"":t},n={searchKey:sX.SendByJid,optionValue:""};o(a),o(n);let i=r(a);i&&d(i)}}),[e,c,t,n,m,h,u,o,r,d]),y=p(c);return g.jsx("div",{className:"_dropdownWrapper_iyqqk_1",children:g.jsx(NJ,{...f,classNames:"_searchInDropDown_iyqqk_30",children:g.jsxs("button",{className:"_filesFilterValue_iyqqk_1",children:[g.jsx("span",{children:y}),g.jsx(tC,{})]})})})}),EZ={dropdownWrapper:"_dropdownWrapper_1kx6v_1",filesFilterValue:"_filesFilterValue_1kx6v_1",disabled:"_disabled_1kx6v_29",sendByDropDown:"_sendByDropDown_1kx6v_36"},E1=window.React.useCallback,E0=window.React.useState,E2=ex(function(e){let{activeTitle:t}=e,{$t:a}=oA(),{getNewSearchValue:n,filesSearchFilterValues:i,updateSearchFilter:s,fetchFiles:r}=vV,l=vB.userJid,o=Mg(),d=lT(g2.currentUser),c=i?.groupJid,u=i?.sendByJid,[m,p]=E0(!1),[h,y]=E0(""),{data:v}=b6(c||"",h.length>2?h:""),_=v.filter(e=>e.jid!==l),b=E1(e=>{p(e),e&&y("")},[]),M=E1(e=>{y(e.target.value)},[]),x=E1(e=>{let t=[];if(c&&"BookMarks"!==c){let e=o.find(e=>e.jid===c);if(!e)return[];if(!yt(e.type))return _;t=rS(e.jid)?[]:[e]}else t=o.filter(e=>yt(e.type)&&!sd.includes(e.jid)&&!rS(e.jid));return e.length>2&&t.filter(t=>t.name?.toLowerCase().includes(e.toLowerCase())),t},[c,o,_]),C=oa(()=>({onSearchChange:M,extraData:null,open:m,onOpenChange:b,dropDownOptions:[[{key:"AnyOne",text:a({id:"y9JFEm",defaultMessage:[{type:0,value:"Any One"}]}),hasCheckMark:!u,hasElement:!0,element:g.jsx(EJ,{name:"Any One",topType:si.ANYONE})},{key:l,text:d||"",hasCheckMark:rS(u),hidden:h.length>2&&!d?.toLowerCase().includes(h.toLowerCase()),hasElement:!0,element:g.jsx(EW,{jid:l})},...x(h).map(e=>{let t=e?.name;return{key:e.jid||"",text:t,hasCheckMark:u===e?.jid,hasElement:!0,element:rT(e.jid)?g.jsx(EK,{jid:e.jid}):g.jsx(EW,{jid:e?.jid})}})]],onDropDownAction:e=>{let{eventKey:t}=e,a={searchKey:sX.SendByJid,optionValue:"AnyOne"===t?"":t};s(a);let i=n(a);i&&r(i)}}),[a,u,h,m,l,d,M,x,b,s,n,r]),j=((e,t)=>{if(!e||"AnyOne"===e)return a({id:"y9JFEm",defaultMessage:[{type:0,value:"Any One"}]});if(rS(e))return d;let n=t.find(t=>t.jid===e);return n?.name||""})(u,x(h));return"my"===t?g.jsx("div",{className:EZ.dropdownWrapper,children:g.jsxs("div",{className:f(EZ.filesFilterValue,EZ.disabled),children:[g.jsx("span",{children:a({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})}),g.jsx(tC,{})]})}):g.jsx("div",{className:EZ.dropdownWrapper,children:g.jsx(NJ,{...C,classNames:EZ.sendByDropDown,children:g.jsxs("button",{className:EZ.filesFilterValue,children:[g.jsx("span",{children:j}),g.jsx(tC,{})]})})})}),E5=window.React.useCallback,E3=ex(function(e){let{filterClose:t,activeTitle:a}=e,{$t:n}=oA(),{getNewSearchValue:i,filesSearchFilterValues:s,updateSearchFilter:r,fetchFiles:l}=vV,o=s?.sortType,d=s?.fileType,c=s?.fileTime,u=E5(e=>{let t=rN[e];r(t);let a=i(t);a&&l(a)},[r,i,l]),m=l3(()=>({extraData:null,dropDownOptions:[[{key:"MostRelevant",text:n({id:"jlFlXc",defaultMessage:[{type:0,value:"Most Relevant"}]}),hasCheckMark:o===iX.SORTTYPE_SCORE},{key:"MostRecent",text:n({id:"RTkF4y",defaultMessage:[{type:0,value:"Most Recent"}]}),hasCheckMark:o===iX.SORTTYPE_TIMESTAMP}]],onDropDownAction:e=>{let{eventKey:t}=e;u(t)}}),[n,o,u]),p=l3(()=>({extraData:null,dropDownOptions:[[{key:"AllFiles",text:n({id:"5IiYyq",defaultMessage:[{type:0,value:"All Files"}]}),hasCheckMark:d===iQ.ALL},{key:"Images",text:n({id:"Fip4H8",defaultMessage:[{type:0,value:"Images"}]}),hasCheckMark:d===iQ.IMAGES},{key:"Videos",text:n({id:"4XfMux",defaultMessage:[{type:0,value:"Videos"}]}),hasCheckMark:d===iQ.VIDEOS},{key:"Documents",text:n({id:"vBlT6y",defaultMessage:[{type:0,value:"Documents"}]}),hasCheckMark:d===iQ.DOCUMENTS},{key:"Presentations",text:n({id:"kXo2i+",defaultMessage:[{type:0,value:"Presentations"}]}),hasCheckMark:d===iQ.PRESENTATIONS},{key:"Spreadsheets",text:n({id:"fd/DO3",defaultMessage:[{type:0,value:"Spreadsheets"}]}),hasCheckMark:d===iQ.SPREADSHEETS},{key:"OtherFileTypes",text:n({id:"8N/ba1",defaultMessage:[{type:0,value:"Other File Types"}]}),hasCheckMark:d===iQ.OTHER}]],onDropDownAction:e=>{let{eventKey:t}=e;u(t)}}),[n,d,u]),h=l3(()=>({extraData:null,dropDownOptions:[[{key:"AnyTime",text:n({id:"HXZ5wy",defaultMessage:[{type:0,value:"Any Time"}]}),hasCheckMark:c===sQ.Any},{key:"Today",text:n({id:"zWgbGg",defaultMessage:[{type:0,value:"Today"}]}),hasCheckMark:c===sQ.Today},{key:"Yesterday",text:n({id:"6dIxDP",defaultMessage:[{type:0,value:"Yesterday"}]}),hasCheckMark:c===sQ.Yesterday},{key:"Last7Days",text:n({id:"ZtU8Lq",defaultMessage:[{type:0,value:"Last "},{type:1,value:"count"},{type:0,value:" Days"}]},{count:7}),hasCheckMark:c===sQ.Last7Days},{key:"Last30Days",text:n({id:"ZtU8Lq",defaultMessage:[{type:0,value:"Last "},{type:1,value:"count"},{type:0,value:" Days"}]},{count:30}),hasCheckMark:c===sQ.Last30Days}]],onDropDownAction:e=>{let{eventKey:t}=e;u(t)}}),[n,c,u]),y=(e,t)=>{let a=e.find(e=>e.value===t);return a?a.text:e[0].text},v=y(oP,o),_=y(oF,d),b=y(oB,c);return g.jsxs("div",{className:E$.filesFilter,children:[g.jsxs("button",{className:E$.filesFilterTitle,onClick:t,children:[n({id:"zSOvI0",defaultMessage:[{type:0,value:"Filters"}]}),g.jsx(tU,{})]}),g.jsxs("div",{className:E$.filesFilterOption,children:[g.jsx("div",{className:E$.filesFilterLabel,children:n({id:"+1jf7+",defaultMessage:[{type:0,value:"Ordered by:"}]})}),g.jsx("div",{className:E$.filesFilterDropDown,children:g.jsx(NJ,{...m,children:g.jsxs("button",{className:E$.filesFilterValue,children:[v,g.jsx(tC,{})]})})})]}),g.jsxs("div",{className:E$.filesFilterOption,children:[g.jsx("div",{className:E$.filesFilterLabel,children:n({id:"uS4sop",defaultMessage:[{type:0,value:"Type:"}]})}),g.jsx("div",{className:E$.filesFilterDropDown,children:g.jsx(NJ,{...p,children:g.jsxs("button",{className:E$.filesFilterValue,children:[_,g.jsx(tC,{})]})})})]}),g.jsxs("div",{className:E$.filesFilterOption,children:[g.jsx("div",{className:E$.filesFilterLabel,children:n({id:"HOXklg",defaultMessage:[{type:0,value:"Search in:"}]})}),g.jsx("div",{className:f(E$.filesFilterDropDown),children:g.jsx(EQ,{})})]}),g.jsxs("div",{className:E$.filesFilterOption,children:[g.jsx("div",{className:E$.filesFilterLabel,children:n({id:"qK0d/P",defaultMessage:[{type:0,value:"Sent by:"}]})}),g.jsx("div",{className:E$.filesFilterDropDown,children:g.jsx(E2,{activeTitle:a})})]}),g.jsxs("div",{className:E$.filesFilterOption,children:[g.jsx("div",{className:E$.filesFilterLabel,children:n({id:"g6yc6F",defaultMessage:[{type:0,value:"When:"}]})}),g.jsx("div",{className:E$.filesFilterDropDown,children:g.jsx(NJ,{...h,children:g.jsxs("button",{className:E$.filesFilterValue,children:[b,g.jsx(tC,{})]})})})]})]})}),E6=""+new URL("images/files-empty.jpg",t.meta.url).href,E4=ex(function(){let{$t:e}=oA();return g.jsxs("div",{className:"_filesEmpty_1kdn3_1",children:[g.jsx("div",{className:"_filesImg_1kdn3_8",children:g.jsx(wu,{src:E6})}),g.jsx("div",{className:"_filesTitle_1kdn3_12",children:e({id:"2wmJcD",defaultMessage:[{type:0,value:"Files are empty now"}]})}),g.jsx("div",{className:"_filesText_1kdn3_17",children:e({id:"Yvj2rL",defaultMessage:[{type:0,value:"When you send files like screenshots or PDFs, they'll be listed here"}]})})]})}),E8=ex(function(e){let{fileId:t,fileName:a,children:n}=e,{getImageState:i}=yw,s=i(t),r=s.message,{targetRef:l}=function(e){let{fileId:t,fileName:a,isHQ:n}=e,i=Ml(null),s=Ml(),r=Mr(()=>i.current,[]),l=Mr(()=>{let e=i.current,t=e?.closest('[role="list"]');return t||document.body},[]),o=function(e){let{fileId:t,fileName:a,isHQ:n}=e,{fetchMsgFile:i}=yw,s=Mr(()=>{i({type:yv.image,fileId:t,fileName:a,isHQ:n})},[t,i,a,n]);return s}({fileId:t,fileName:a,isHQ:n}),d=Mr(()=>{s.current?.(),o()},[o]);return s.current=oo({getBoundary:l,onIntersect:d,getTarget:r}),{targetRef:i,handleLoad:o}}({fileId:t,fileName:a});return g.jsx(g.Fragment,{children:n(r,l)})}),E7=window.React.useCallback;function E9(){let{getStorageValue:e,setStorageValue:t,removeStorageValue:a}=l1(rQ.searchedKeywords,[]),n=e(),{recentSearches:i,showRecentSearches:s,setRecentSearches:r}=_l,l=E7(e=>{let a=e?.trim();if(!a)return;let n=aP([a,...i]).slice(0,30);t(n),r(n)},[i,r,t]),o=E7(e=>{let a=i.filter(t=>t!==e);t(a),r(a)},[i,r,t]),d=E7(()=>{a(),r([])},[a,r]);return nl(()=>{r(n)}),{list:s,push:l,remove:o,removeAll:d}}let Se=window.React.useState,St=window.React.useCallback;function Sa(){let[e,t]=Se(!1),{setDropdownVisible:a}=_u,n=St(e=>{a(e),t(e)},[a]);return l2(()=>()=>{n(!1)},[n]),[e,n]}let Sn="search-portal";function Si(){return window.document.body.querySelector(`#${Sn}`)}function Ss(){return g.jsx("div",{id:Sn})}function Sr(){let[e,t]=Sa(),a=Si();return[{portalContainer:a,onDropDownOpenChange:t},e]}function Sl(e){let{className:t,keyword:a,content:n,findChunks:i}=e;return g.jsx(iI,{...oI.Search.highlightItem,className:f(t,"_text_1d8yr_1"),highlightClassName:"_highlight_1d8yr_14",searchWords:[a],autoEscape:!0,textToHighlight:n,findChunks:i})}let So=ex(function(e){let{text:t}=e,{searchKey:a}=_u;return g.jsx(iI,{...oI.Search.highlightItem,highlightClassName:"_highlight_11rc7_1",searchWords:[a],autoEscape:!0,textToHighlight:String(t),title:t})}),Sd={filesItem:"_filesItem_jjwzn_1",visible:"_visible_jjwzn_10",actions:"_actions_jjwzn_13",cancelButton:"_cancelButton_jjwzn_16",filesDetail:"_filesDetail_jjwzn_19",filesDetailBottom:"_filesDetailBottom_jjwzn_19",filesSharedIn:"_filesSharedIn_jjwzn_19",imageItem:"_imageItem_jjwzn_22",filesThumbnail:"_filesThumbnail_jjwzn_31",filesIcon:"_filesIcon_jjwzn_40",fileInfo:"_fileInfo_jjwzn_66",filesName:"_filesName_jjwzn_71",filesTime:"_filesTime_jjwzn_82",filesSize:"_filesSize_jjwzn_94",filesDownloadProgress:"_filesDownloadProgress_jjwzn_122",progress:"_progress_jjwzn_129",innerProgress:"_innerProgress_jjwzn_136",imageActions:"_imageActions_jjwzn_166",sharedInPosition:"_sharedInPosition_jjwzn_171"},{getFileIcon:Sc,getExtension:Su}=rj;function Sm(e){let{fileId:t,fileName:a}=e,n=Sc(Su(a));return g.jsx(E8,{fileId:t,fileName:a,children:(e,t)=>e?g.jsx("div",{className:Sd.filesThumbnail,style:{backgroundImage:`url(${e})`}}):g.jsx("div",{ref:t,children:g.jsx(n,{className:Sd.filesIcon})})})}let Sp=ex(function(e){let{shared:t,onOpenChange:a}=e,{$t:n}=oA(),i=Mf(r(t?.map(e=>e.shareeJid))),s=oa(()=>t.reduce((e,t)=>{let{shareeJid:a}=t;if(!a)return e;{let t=i[a]||"";return[...e,{jid:a,name:t}]}},[]),[t,i]),l=s.length,o=oa(()=>({extraData:null,onOpenChange:a,align:"end",title:n({id:"gKIoHe",defaultMessage:[{type:0,value:"Shared in "},{type:1,value:"sharedInListLength"},{type:0,value:" chat"}]},{sharedInListLength:l}),classNames:Sd.sharedInPosition,dropDownOptions:s.map(e=>{let{name:t,jid:a}=e;return[{key:a,text:t,operate(){a&&yf({jid:a})}}]})}),[n,a,s,l]);return g.jsx(NJ,{...o,children:g.jsxs(dj,{className:Sd.filesSharedIn,onClick:e=>{e.stopPropagation()},children:[n({id:"BeGTP6",defaultMessage:[{type:0,value:"Shared in"}]}),g.jsx(tC,{})]})})}),Sh=window.React.useCallback,{getExtension:Sf,getFileIcon:Sg,modifySize:Sy,isImageFile:Sv}=rj,S_=ex(function(e){let{$t:t}=oA(),[a,n]=Sa(),{data:i,layout:s="normal",keyword:r="",onFileClick:l,tabIndex:o=0,ariaProps:d,actions:c,moreDetail:u,isShowSharedIn:m}=e,{ownerJid:p,name:h="",length:y,createdTime:v,fileId:_,shared:b}=i,M=Sv(Sf(h)),C=Sg(Sf(h)),j=bA(p),N=j?.nickname||"",w=rS(p)?t({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):N,I=oa(()=>x(i.highlight)||[],[i.highlight]),T=Sh(()=>Array.isArray(I)&&I.length?I?.[0]?.highlightPosition.map(e=>({start:e?.startPosition??0,end:e?.endPosition??0}))??[]:[],[I]);return g.jsxs("div",{tabIndex:o,className:f(Sd.filesItem,{[Sd.visible]:a}),onClick:l,...d,children:[M&&_?g.jsx(Sm,{fileId:_,fileName:h}):g.jsx(C,{className:Sd.filesIcon}),g.jsxs("div",{className:Sd.filesDetail,children:[g.jsxs("div",{className:Sd.fileInfo,children:[g.jsx(Sl,{className:Sd.filesName,keyword:r,content:h,findChunks:T}),g.jsxs("div",{className:Sd.filesTime,children:[w,",",oK(v??0)]}),g.jsxs("div",{className:Sd.filesDetailBottom,children:[g.jsx("div",{className:Sd.filesSize,children:Sy(y??0)}),m&&"normal"===s&&b&&g.jsx(Sp,{shared:b,onOpenChange:n}),u]})]}),g.jsx(Nq,{className:Sd.actions,actions:c,size:"normal"===s?"lg":"md",onDropDownOpenChange:n})]})]})}),Sb=window.React.useCallback,{getExtension:SM,isImageFile:Sx}=rj,SC=ex(function(e){let{$t:t}=oA(),[a,n]=Sa(),{data:i,layout:s="normal",keyword:r="",tabIndex:l=0,ariaProps:o,isShowSharedIn:d=!0}=e,{getFileState:c,setFileState:u,disposeFile:m,downloadFilesFile:p}=yw,{name:h="",file:y,fileId:v,channelTypes:_}=i,b=_?.[0]?.name,M=["box","sharepoint"].includes(b),x=c(v||""),C=Sx(SM(h)),j=()=>{if(x.status===i6.downloading)return;let e=x.fileUrl;if(e&&h){lR(e,h);return}v&&h&&p({fileId:v,fileName:h})},N=Sb(()=>{y?.file instanceof File&&rX.copyFile(y.file)},[y?.file]),w=x.status!==i6.downloading?[{type:NG.NORMAL,key:"chat",icon:g.jsx(a7,{}),invisible:M,operate:j},{type:NG.DROPDOWN,key:"more",icon:g.jsx(nt,{"aria-label":t({id:"Ntr8Pk",defaultMessage:[{type:0,value:"More Option"}]})}),options:[{key:"OpenFile",text:t({id:"5q3qC0",defaultMessage:[{type:0,value:"Download"}]}),invisible:M,operate:j},{key:"CopyFile",text:t({id:"4l6vz1",defaultMessage:[{type:0,value:"Copy"}]}),disabled:!(y?.file instanceof File),operate:N}]}]:[];if("imageOnly"===s)return C&&v?g.jsx(E8,{fileId:v,fileName:h,children:(e,t)=>g.jsx("div",{ref:t,children:g.jsx(e4,{loading:!e,children:g.jsx("div",{tabIndex:0,className:f(Sd.filesItem,Sd.imageItem,{[Sd.visible]:a}),style:{backgroundImage:`url(${e})`},children:g.jsx(Nq,{className:f(Sd.actions,Sd.imageActions),actions:w,size:"md",onDropDownOpenChange:n})})})})}):null;let I=g.jsx("div",{className:Sd.filesDownloadProgress,children:x.status===i6.downloading&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:Sd.progress,children:g.jsx("div",{style:{width:`${x.progress??0}%`},className:Sd.innerProgress})}),g.jsx(dj,{className:Sd.cancelButton,onClick:e=>{e?.stopPropagation(),m(v||""),x.status===i6.downloading&&v&&u({fileId:v,state:{status:i6.notDownload}})},children:t({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})})]})});return g.jsx(S_,{data:i,actions:w,layout:s,keyword:r,tabIndex:l,onFileClick:j,ariaProps:o,moreDetail:I,isShowSharedIn:d})}),Sj={filesList:"_filesList_1yk67_1",loading:"_loading_1yk67_11",filesListWrapper:"_filesListWrapper_1yk67_17"},SN=ex(function(){let{files:e,loading:t,filesSearchFilterValues:a,getNewSearchValue:n,fetchFiles:i}=vV;return(l2(()=>{let e=n();e&&i(e)},[]),t||e.length)?g.jsx("div",{tabIndex:0,className:f(Sj.filesList,{[Sj.loading]:t}),children:g.jsx(e4,{className:Sj.loading,loading:t,children:!t&&g.jsx("div",{className:Sj.filesListWrapper,role:"list",children:e.map(e=>g.jsx(SC,{data:e,keyword:a?.keyword},e.fileId))})})}):g.jsx(E4,{})}),Sw={filesPanel:"_filesPanel_90wob_1",filesLeftContent:"_filesLeftContent_90wob_6",filesTopMenu:"_filesTopMenu_90wob_11",searchInput:"_searchInput_90wob_14",filesTopFilter:"_filesTopFilter_90wob_20",filesRightContent:"_filesRightContent_90wob_47"},SI=window.React.useRef,ST=ex(function(e){let{activeTitle:t}=e,{getNewSearchValue:a,updateSearchFilter:n,fetchFiles:i}=vV,s=SI(null),[r,l,o]=om(!0),{$t:d}=oA(),c=l3(()=>tr(e=>{let t={searchKey:sX.KeyWord,optionValue:e};n(t);let s=a(t);s&&i(s)},300),[i,a,n]);return g.jsxs("div",{className:Sw.filesPanel,children:[g.jsxs("div",{className:Sw.filesLeftContent,children:[g.jsxs("div",{className:Sw.filesTopMenu,children:[g.jsx(d$,{ref:s,autoFocus:!0,closable:!1,onChange:e=>{c(e.target.value)},onClear:()=>c(""),maxLength:256,className:Sw.searchInput}),!r&&g.jsxs("button",{className:Sw.filesTopFilter,onClick:()=>{l()},children:[g.jsx(ic,{}),d({id:"zSOvI0",defaultMessage:[{type:0,value:"Filters"}]})]})]}),g.jsx(SN,{})]}),r&&g.jsx("div",{className:Sw.filesRightContent,children:g.jsx(E3,{filterClose:o,activeTitle:t})})]})}),SE={filesListWrapper:"_filesListWrapper_1lg9x_1",imageViewer:"_imageViewer_1lg9x_8",image:"_image_1lg9x_8",placeHolder:"_placeHolder_1lg9x_22",modal:"_modal_1lg9x_31",closeBtn:"_closeBtn_1lg9x_34",header:"_header_1lg9x_41",title:"_title_1lg9x_45",noHeader:"_noHeader_1lg9x_51"},SS=ex(function(e){let{visible:t,onClose:a,fileType:n,store:i,modalHeader:s,modalContent:r,modalSearch:l,isLoading:o}=e,{$t:d}=oA(),{channelJid:c}=vo(),u=Mf([c]),m=vG(c,i.filesSearchFilterValues?.channelType),p=m?.channelType?.includes(iZ.ZOOM_FILES),h=u[c];return g.jsxs(xb,{footer:null,visible:t,onCancel:a,closable:!1,width:560,className:SE.modal,children:[g.jsx(dj,{...oI.Modal.modalCloseBtn,onClick:a,icon:g.jsx(e8,{}),className:SE.closeBtn}),s,g.jsx("h2",{className:f(SE.title,{[SE.noHeader]:!p}),children:d({id:"CqCTgR",defaultMessage:[{type:0,value:"All "},{type:1,value:"fileType"},{type:0,value:" shared in "},{type:1,value:"displayName"}]},{fileType:n.toLowerCase(),displayName:h})}),l,g.jsx(e4,{loading:o,children:g.jsx("div",{className:f(SE.filesListWrapper,{[SE.imageViewer]:!1}),role:"list",children:r})})]})}),Sk=ex(function(e){let{$t:t}=oA(),{activeTitle:a,setActiveTitle:n}=e,{getNewSearchValue:i,updateSearchFilter:s,fetchFiles:r,resetFileSearchFilter:l}=vZ(),o=[{key:iQ.IMAGES,text:t({id:"Fip4H8",defaultMessage:[{type:0,value:"Images"}]})},{key:iQ.VIDEOS,text:t({id:"4XfMux",defaultMessage:[{type:0,value:"Videos"}]})},{key:iQ.ALL,text:t({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]})}];return g.jsx(cK,{options:o,activeKey:a,onChange:e=>{n(e),l();let t={searchKey:sX.FileType,optionValue:e};s(t);let a=i(t);a&&r(a)}})}),SA={modal:"_modal_1xaw1_1",loading:"_loading_1xaw1_14"},SR=window.React.useState,SL=ex(function(e){let{data:t,children:a,...n}=e,i=t.name,s=bO(t);return g.jsx(Ib.MultiValueLabel,{data:{...t,label:i,isExternal:s},...n,children:a})}),SO={...Ib,Option:e=>g.jsx("div",{...e.innerProps,ref:e.innerRef,children:g.jsx(CR,{data:e.data,showOps:!1})}),MultiValueLabel:SL},SD=ex(function(e){let{isVisible:t,onClose:a,onSearchBySenderJid:n}=e,{$t:i}=oA(),{channelJid:s}=vo(),{data:r,loading:l}=b6(s,""),[o,d]=SR([]);return g.jsx(xb,{visible:t,title:i({id:"OGJa3m",defaultMessage:[{type:0,value:"Sent by"}]}),width:560,okDisable:0===o.length,className:SA.modal,onCancel:a,onOk:()=>{n(o[0].jid),a()},children:l?g.jsx(e4,{loading:l,className:SA.loading}):g.jsx(i_,{isMulti:!0,classNamePrefix:"multi-select",closeMenuOnSelect:!1,value:o,menuIsOpen:!0,hideSelectedOptions:!0,isSearchable:!0,placeholder:i({id:"cr83G4",defaultMessage:[{type:0,value:"Search by name"}]}),onChange:e=>{d(e.slice(-1))},isClearable:!1,options:r,components:SO,backspaceRemovesValue:!0,getOptionValue:e=>e.jid,getOptionLabel:e=>e.name,maxMenuHeight:228})})}),SP=window.React.useCallback,SF=ex(function(e){let{activeTitle:t,fileStore:a,placeholder:n}=e,{getNewSearchValue:i,fetchFiles:s,updateSearchFilter:r,filesSearchFilterValues:l,resetFileSearchFilter:o}=a,{$t:d}=oA(),[c,u,m]=om(!1),{channelJid:p}=vo(),h=Mh(p),f=vG(p,l?.channelType),y=l?.sortType,v=l?.fileType,_=l?.fileTime,b=l?.sendByJid,M=y===f?.sortType&&_===f?.fileTime&&b===f?.sendByJid&&(!t||v===t),x=t===iQ.ALL&&l?.channelType?.includes(iZ.ZOOM_FILES),C=SP(e=>{"ResetFilter"===e.key&&o();let a="ResetFilter"!==e.key?rN[e.key]:{searchKey:sX.FileType,optionValue:t};r(a);let n=i(a);n&&s(n)},[t,r,i,s,o]),j=[{key:"ResetFilter",text:d({id:"jZ0o74",defaultMessage:[{type:0,value:"Reset filters"}]}),operate:C,invisible:M,primary:!0},{key:"OrderedBy",text:d({id:"sRXlP+",defaultMessage:[{type:0,value:"Ordered By"}]}),separator:!0,children:[{key:"MostRecent",text:d({id:"RTkF4y",defaultMessage:[{type:0,value:"Most Recent"}]}),checked:y===iX.SORTTYPE_TIMESTAMP,operate:C},{key:"MostRelevant",text:d({id:"jlFlXc",defaultMessage:[{type:0,value:"Most Relevant"}]}),checked:y===iX.SORTTYPE_SCORE,operate:C}]},{key:"FileType",text:d({id:"M3q6mL",defaultMessage:[{type:0,value:"File Type"}]}),invisible:!x,children:[{key:"AllFiles",text:d({id:"5IiYyq",defaultMessage:[{type:0,value:"All Files"}]}),checked:v===iQ.ALL,operate:C},{key:"Images",text:d({id:"Fip4H8",defaultMessage:[{type:0,value:"Images"}]}),checked:v===iQ.IMAGES,operate:C},{key:"Videos",text:d({id:"4XfMux",defaultMessage:[{type:0,value:"Videos"}]}),checked:v===iQ.VIDEOS,operate:C},{key:"Documents",text:d({id:"vBlT6y",defaultMessage:[{type:0,value:"Documents"}]}),checked:v===iQ.DOCUMENTS,operate:C},{key:"Presentations",text:d({id:"kXo2i+",defaultMessage:[{type:0,value:"Presentations"}]}),checked:v===iQ.PRESENTATIONS,operate:C},{key:"Spreadsheets",text:d({id:"fd/DO3",defaultMessage:[{type:0,value:"Spreadsheets"}]}),checked:v===iQ.SPREADSHEETS,operate:C},{key:"OtherFileTypes",text:d({id:"8N/ba1",defaultMessage:[{type:0,value:"Other File Types"}]}),checked:v===iQ.OTHER,operate:C}]},{key:"When",text:d({id:"McnLsx",defaultMessage:[{type:0,value:"When"}]}),children:[{key:"AnyTime",text:d({id:"HXZ5wy",defaultMessage:[{type:0,value:"Any Time"}]}),checked:_===sQ.Any,operate:C},{key:"Today",text:d({id:"zWgbGg",defaultMessage:[{type:0,value:"Today"}]}),checked:_===sQ.Today,operate:C},{key:"Yesterday",text:d({id:"6dIxDP",defaultMessage:[{type:0,value:"Yesterday"}]}),checked:_===sQ.Yesterday,operate:C},{key:"Last7Days",text:d({id:"jnzQzj",defaultMessage:[{type:0,value:"Last 7 Days"}]}),checked:_===sQ.Last7Days,operate:C},{key:"Last30Days",text:d({id:"brX8Pt",defaultMessage:[{type:0,value:"Last 30 Days"}]}),checked:_===sQ.Last30Days,operate:C}]},{key:"SentBy",text:d({id:"7LrJzm",defaultMessage:[{type:0,value:"Sent By"}]}),operate:u,invisible:h===i1.CHAT}];return g.jsxs("div",{className:"_searchWrapper_87c39_1",children:[g.jsx(d$,{className:"_search_87c39_1",placeholder:n,onChange:tr(e=>{let t=e?.target?.value||"",a={searchKey:sX.KeyWord,optionValue:t};r(a);let n=i(a);n&&s(n)},300),allowClear:!1,bordered:!0}),g.jsx(cQ,{options:j,side:"bottom",align:"start",className:"_dropDown_87c39_31",children:g.jsx(dj,{className:"_filterBtn_87c39_14","aria-label":d({id:"psXgrr",defaultMessage:[{type:0,value:"file filter"}]}),size:"small",icon:g.jsx(iS,{className:"_filterIcon_87c39_26"})})}),g.jsx(SD,{isVisible:c,onClose:m,onSearchBySenderJid:e=>{let t={searchKey:sX.SendByJid,optionValue:e};r(t);let a=i(t);a&&s(a)}})]})}),SB=window.React.useState,SU=ex(function(e){let{visible:t,onClose:a}=e,n=vZ(),{files:i,loading:s,getNewSearchValue:r,fetchFiles:l,resetFileSearchFilter:o,filesSearchFilterValues:d,updateSearchFilter:c}=n,{$t:u}=oA(),[m,p]=SB(iQ.ALL),{channelJid:h}=vo(),f=Mh(h),y={[iQ.IMAGES]:u({id:"Fip4H8",defaultMessage:[{type:0,value:"Images"}]}),[iQ.VIDEOS]:u({id:"4XfMux",defaultMessage:[{type:0,value:"Videos"}]}),[iQ.ALL]:u({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]})},{getExtension:v,isImageFile:_}=rj,b=y[m],M=f===i1.CHANNEL?u({id:"rFxi1+",defaultMessage:[{type:0,value:"channel"}]}):u({id:"S5RsEf",defaultMessage:[{type:0,value:"chat"}]});oe(()=>{if(!t)return;let e=d?.channelType,a={searchKey:sX.ChannelType,optionValue:e};c(a);let n=r(a);n&&l(n)},[l,d?.channelType,r,c,t]);let x=g.jsx("div",{className:SE.header,children:g.jsx(Sk,{activeTitle:m,setActiveTitle:p})}),C=g.jsx(SF,{activeTitle:m,fileStore:n,placeholder:u({id:"8xPuGU",defaultMessage:[{type:0,value:"Search files"}]})}),j=(()=>s?null:0===i.length?g.jsx("div",{className:SE.placeHolder,children:u({id:"t5bHvo",defaultMessage:[{type:1,value:"fileType"},{type:0,value:" shared in this "},{type:1,value:"chatType"},{type:0,value:" will display here"}]},{fileType:b,chatType:M})}):m===iQ.IMAGES?g.jsx("div",{className:SE.imageViewer,children:i.filter(e=>{let{name:t}=e;return _(v(t))}).map(e=>g.jsx("div",{className:SE.image,children:g.jsx(SC,{data:e,layout:"imageOnly"},e.fileId)},e.fileId))}):i.map(e=>g.jsx(SC,{data:e,keyword:d?.keyword,isShowSharedIn:!1},e.fileId)))();return g.jsx(SS,{isLoading:s,visible:t,onClose:()=>{o(),p(iQ.ALL),a()},store:n,fileType:b,modalHeader:x,modalContent:j,modalSearch:C})}),SH={placeholder:"_placeholder_11n6t_1",loading:"_loading_11n6t_11",viewAll:"_viewAll_11n6t_15"},Sz=ex(function(){let{moreActionsFileList:e,fetchMoreActionFiles:t,isMoreActionFilesFetched:a}=vZ(),{$t:n}=oA(),i=e.length>10,{channelJid:s}=vo(),r=Mh(s),l=n(r===i1.CHANNEL?{id:"rFxi1+",defaultMessage:[{type:0,value:"channel"}]}:{id:"S5RsEf",defaultMessage:[{type:0,value:"chat"}]}),[o,d,c]=om(!1);return(l2(()=>{a||t()},[t,a]),a)?0===e.length?g.jsx("div",{className:SH.placeholder,children:n({id:"I1zF5M",defaultMessage:[{type:0,value:"Files shared in this "},{type:1,value:"chatType"},{type:0,value:" will display here"}]},{chatType:l})}):g.jsxs("div",{children:[g.jsx(dE,{dataList:ik(e,10),keyedBy:e=>e.fileId||"",dataRender:(e,t)=>g.jsx(SC,{layout:"side",data:e,ariaProps:t})}),i&&g.jsxs(g.Fragment,{children:[g.jsx(dj,{className:SH.viewAll,onClick:d,type:"ghost",children:n({id:"O3Es8W",defaultMessage:[{type:0,value:"View All Files"}]})}),g.jsx(SU,{visible:o,onClose:c})]})]}):g.jsx(e4,{loading:!0,className:SH.loading})}),SV=v$.effects((e,t)=>{let{sdk:a}=t;return{onMessage:()=>aB(a.message$,oz.updateLatestMessage$).pipe(a_(e=>ap(e)),eg(t=>t.channelJid===e.channelJid),a_(t=>{if(!t?.allFiles)return K;let a=t.allFiles.filter(e=>rh(e.fileType)).map(e=>({...e,length:e.size,name:rv(e.fileName),ownerJid:t.senderJid??void 0,createdTime:t.time,channelTypes:[{name:sf.Whiteboard}]}));return 0===a.length?K:q(e.setMoreActionsFiles([...a,...e.moreActionsFileList]))}))}}),SG=e=>SV.create(vq(e,[iZ.WHITEBOARD,iZ.NEW_WHITEBOARD]),{sdk:uW,download:lR}),Sq=window.React.createContext,S$=window.React.useContext,SK=Sq(null),SJ=SK.Provider;function SW(e){let{channelJid:t,children:a}=e,n=l3(()=>lN(SG)(t),[t]);return g.jsx(SJ,{value:n,children:a})}function SY(){return S$(SK)}let SX=ex(function(e){let{$t:t}=oA(),{data:a,tabIndex:n,ariaProps:i}=e,{fileId:s,location:r}=a,l=()=>{},o=[{type:NG.DROPDOWN,key:"more",icon:g.jsx(nt,{"aria-label":t({id:"Ntr8Pk",defaultMessage:[{type:0,value:"More Option"}]})}),options:[{key:"Open",text:t({id:"JfG49w",defaultMessage:[{type:0,value:"Open"}]}),invisible:!0,operate:l},{key:"CopyLink",text:t({id:"u5aHb4",defaultMessage:[{type:0,value:"Copy Link"}]}),operate:()=>{rX.copyText(r)}}]}];return s?g.jsx(S_,{layout:"side",data:a,actions:o,tabIndex:n,onFileClick:l,ariaProps:i,isShowSharedIn:!1}):null}),SQ=ex(function(e){let{visible:t,onClose:a}=e,n=SY(),{files:i,loading:s,getNewSearchValue:r,fetchFiles:l,resetFileSearchFilter:o,filesSearchFilterValues:d,updateSearchFilter:c}=n,{$t:u}=oA(),{channelJid:m}=vo(),p=Mh(m);oe(()=>{if(!t)return;let e=d?.channelType,a={searchKey:sX.ChannelType,optionValue:e};c(a);let n=r(a);n&&l(n)},[l,d?.channelType,r,c,t]);let h=g.jsx(SF,{fileStore:n,placeholder:u({id:"2hM34a",defaultMessage:[{type:0,value:"Search whiteboards"}]})}),f=(()=>s?null:0===i.length?g.jsx("div",{className:SE.placeHolder,children:p===i1.CHANNEL?u({id:"Zsqk+p",defaultMessage:[{type:0,value:"Whiteboards shared in this channel will display here"}]}):u({id:"wZ0n9U",defaultMessage:[{type:0,value:"Whiteboards shared in this chat will display here"}]})}):i.map(e=>g.jsx(SX,{data:e,keyword:d?.keyword},e.fileId)))();return g.jsx(SS,{isLoading:s,visible:t,onClose:()=>{o(),a()},store:n,fileType:u({id:"v2046d",defaultMessage:[{type:0,value:"whiteboard"}]}),modalContent:f,modalSearch:h})}),SZ={placeholder:"_placeholder_1rdwb_1",loading:"_loading_1rdwb_7",viewAll:"_viewAll_1rdwb_11"},S1=ex(function(){let{moreActionsFileList:e,fetchMoreActionFiles:t,isMoreActionFilesFetched:a}=SY(),{$t:n}=oA(),{channelJid:i}=vo(),s=Mh(i),r=e.length>10,[l,o,d]=om(!1);return(l2(()=>{a||t()},[t,a]),a)?0===e.length?g.jsx("div",{className:SZ.placeholder,children:n(s===i1.CHANNEL?{id:"Zsqk+p",defaultMessage:[{type:0,value:"Whiteboards shared in this channel will display here"}]}:{id:"wZ0n9U",defaultMessage:[{type:0,value:"Whiteboards shared in this chat will display here"}]})}):g.jsxs("div",{children:[g.jsx(dE,{dataList:ik(e,10),keyedBy:e=>e.fileId||"",dataRender:(e,t)=>g.jsx(SX,{layout:"side",data:e,ariaProps:t})}),r&&g.jsxs(g.Fragment,{children:[g.jsx(dj,{className:SZ.viewAll,onClick:o,type:"ghost",children:n({id:"qCn/j6",defaultMessage:[{type:0,value:"View All whiteboards"}]})}),g.jsx(SQ,{visible:l,onClose:d})]})]}):g.jsx(e4,{loading:!0,className:SZ.loading})}),S0=ex(function(){let{$t:e}=oA(),{channelJid:t}=vo();return g.jsx("div",{className:"_addMembers_o0f1y_1",children:g.jsxs(dj,{...oI.MoreActions.addMembersBtn,type:"text",className:"_addMembersBtn_o0f1y_8",onClick:lo(()=>{bf.open({type:st.ADD_MEMBER_P2P,options:{channelId:t}})}),children:[g.jsx(iA,{className:"icon-add-members"}),e({id:"sM+dVU",defaultMessage:[{type:0,value:"Add members..."}]})]})})}),S2={text:"_text_1mzbe_1",html:"_html_1mzbe_5",editBtn:"_editBtn_1mzbe_8",input:"_input_1mzbe_18",btns:"_btns_1mzbe_30"},S5=window.React.useCallback,S3=window.React.useState,S6=window.React.useRef;function S4(e){let{className:t,placeholder:a,text:n,maxLength:i=500,rows:s=4,onChange:r}=e,{$t:l}=oA(),[o,d]=S3(n),[c,u]=S3(!1),m=S6(null);l2(()=>{d(n)},[n]),l2(()=>{if(c){let e=m.current?.value?.length??0;m.current?.setSelectionRange(e,e),m.current?.focus()}},[c]);let p=iM(o)===n,h=S5(()=>{u(!1),d(n)},[n]),y=S5(e=>{d(e.target.value)},[]);return c?g.jsxs("div",{className:f(t,S2.text),...oI.Main.editableTextBlock,children:[g.jsx("textarea",{className:S2.input,ref:m,placeholder:a,maxLength:i,rows:s,value:o,onChange:y}),g.jsxs("div",{className:S2.btns,children:[g.jsx(dj,{size:"small",disabled:p,onClick:()=>{u(!1),r(iM(o))},...oI.Main.editableTextSaveBtn,children:l({id:"jvo0vs",defaultMessage:[{type:0,value:"Save"}]})}),g.jsx(dj,{size:"small",onClick:h,children:l({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})})]})]}):g.jsxs("div",{className:f(t,S2.text),...oI.Main.editableTextBlock,children:[g.jsx("span",{className:S2.html,...oI.Main.editableTextContent,children:lk(o)}),g.jsx(dj,{...oI.Main.editableTextEditBtn,type:"text",className:S2.editBtn,onClick:()=>u(!0),children:o?l({id:"wEQDC6",defaultMessage:[{type:0,value:"Edit"}]}):a})]})}let S8={desc:"_desc_1rm5k_1",html:"_html_1rm5k_9",loading:"_loading_1rm5k_13"},S7=window.React.useCallback,S9=ex(function(){let{$t:e}=oA(),{desc:t,descLoading:a,descLoaded:n,channelJid:i,updateDesc:s,getDesc:r}=vo(),l=Mh(i),o=Ms(i);l2(()=>{n||r()},[n,r]);let d=S7(e=>{s(e)},[s]);if(a)return g.jsx(e4,{loading:!0,className:S8.loading});if(!o)return g.jsx("div",{className:S8.desc,...oI.MoreActions.descContent,children:t?g.jsx("span",{className:S8.html,children:lk(t)}):e({id:"rnWxU7",defaultMessage:[{type:0,value:"No description is added"}]})});let c=e(l===i1.CHANNEL?{id:"bH8bCc",defaultMessage:[{type:0,value:"Add a channel description"}]}:{id:"bNFW1P",defaultMessage:[{type:0,value:"Add a chat description"}]});return g.jsx("div",{className:S8.desc,...oI.MoreActions.descContent,children:g.jsx(S4,{placeholder:c,text:t||"",onChange:d})})}),ke={addBtn:"_addBtn_17s7m_1",disabled:"_disabled_17s7m_4",tooltip:"_tooltip_17s7m_11"},kt=window.React.useCallback;function ka(e){let{disabled:t,channelJid:a,isAppEnabled:n}=e,{$t:i}=oA(),s=kt(()=>{bf.open({type:st.ADD_MEMBER,options:{channelId:a}})},[a]),r=kt(()=>{bf.open({type:st.ADD_APP,options:{channelId:a}})},[a]);if(t)return g.jsx(dA,{className:ke.tooltip,arrowVisible:!0,content:i({id:"/YKwJR",defaultMessage:[{type:0,value:"Adding members is restricted to channel owner or admins"}]}),children:g.jsx("span",{...oI.MoreActions.addMembersIcon,className:f(ke.addBtn,ke.disabled),children:g.jsx(iR,{"aria-hidden":"true"})})});if(n){let e=[{key:"AddMember",text:i({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),testKey:"addMembers",operate:s},{key:"AddApp",text:i({id:"ldPSzY",defaultMessage:[{type:0,value:"Add Apps"}]}),testKey:"addApps",operate:r}];return g.jsx(cQ,{side:"bottom",align:"start",options:e,children:g.jsx(dj,{...oI.MoreActions.addMembersIcon,className:f(ke.menuAction),onKeyDown:lo(),size:"small",type:"text",icon:g.jsx(iR,{"aria-hidden":"true"})})})}return g.jsx(dj,{...oI.MoreActions.addMembersIcon,className:ke.addBtn,size:"small",onKeyDown:lo(),onClick:lo(s),"aria-label":i({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),type:"text",icon:g.jsx(iR,{"aria-hidden":"true"})})}let kn={leave:"_leave_1ta77_1",icon:"_icon_1ta77_17"},ki=ex(function(){let{$t:e}=oA(),{channelJid:t}=vo(),a=Mh(t),n=b2(t),i=Mi(t),s=!!n?.isMeetChat,r=!!n?.isSpotChannel;return a===i1.CHAT||i&&s?null:g.jsxs("button",{className:kn.leave,onClick:()=>bf.open({type:st.LEAVE_CHANNEL,options:{channelId:t,channelName:n?.name,chatType:n?.sessionType}}),...oI.MoreActions.optionBtn("leave"),children:[g.jsx(iL,{"aria-hidden":"true",className:kn.icon}),e(r?{id:"cqGHim",defaultMessage:[{type:0,value:"Leave Huddle Channel"}]}:a===i1.CHANNEL?{id:"zp3bBg",defaultMessage:[{type:0,value:"Leave Channel"}]}:{id:"bNGm7v",defaultMessage:[{type:0,value:"Leave Chat"}]})]})}),ks={members:"_members_qs18h_1",viewAll:"_viewAll_qs18h_5",memberLoading:"_memberLoading_qs18h_18"},kr=window.React.useCallback,kl=ex(function(){let{$t:e}=oA(),{channelJid:t}=vo(),{name:a,sessionType:n}=b2(t),{memberCount:i,showViewMore:s,previewList:r,memberLoading:l}=Mx(t),o=Mn(t),d=kr(()=>{bf.open({type:st.VIEW_MEMBERS,options:{channelId:t,channelName:a,chatType:n,memberCount:i}})},[t,a,n,i]),c=oa(()=>l?g.jsx("div",{className:ks.memberLoading,children:g.jsx(e4,{loading:!0})}):r.map(e=>e.jid?g.jsx(CR,{data:e,myRole:o,hideBadgeOnHover:!0,channelId:t,chatType:n},e.jid):g.jsx(CR,{data:e,myRole:o,hideBadgeOnHover:!0,channelId:t,chatType:n,isPending:!0},e.name)),[r,l,o,t,n]);return g.jsxs("div",{className:ks.members,children:[c,s&&g.jsx(dj,{type:"ghost",className:ks.viewAll,onClick:d,...oI.MoreActions.viewAllMembersBtn,children:e({id:"Tl3qR8",defaultMessage:[{type:0,value:"View All "},{type:1,value:"count"},{type:0,value:" Members"}]},{count:i})})]})}),ko=ex(function(){let{$t:e}=oA(),{channelJid:t}=vo(),{notifyType:a,isMuted:n,setNotification:i,mute:s,unmute:r}=b1(t),l=Mh(t),o=e(l===i1.MUC?n?{id:"UVhV1I",defaultMessage:[{type:0,value:"Unmute Chat"}]}:{id:"9NjGLp",defaultMessage:[{type:0,value:"Mute Chat"}]}:n?{id:"QoeyW3",defaultMessage:[{type:0,value:"Unmute Channel"}]}:{id:"DDNoEN",defaultMessage:[{type:0,value:"Mute Channel"}]});return g.jsx(ix,{initialValues:{},onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsx(Il,{name:"notifyType",options:[{label:e({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]}),subLabel:e({id:"XMhUcZ",defaultMessage:[{type:0,value:"Get notified for all message activity"}]}),value:np.all},{label:e({id:"DKAqfN",defaultMessage:[{type:0,value:"Mentions and Replies"}]}),subLabel:e({id:"lnaTlC",defaultMessage:[{type:0,value:"Includes group or personal mentions, and replies to you"}]}),value:np.mention},{label:e({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]}),subLabel:e({id:"/GbGfr",defaultMessage:[{type:0,value:"Turn off chat notifications"}]}),value:np.off}],onChange:e=>{i(e)},value:a}),g.jsx(Ie,{className:"_notificationsMuteField_g1d1h_1",name:"mute",text:o,onChange:e=>{e?s():r()},checked:n})]})})}),kd={option:"_option_s49dv_1",danger:"_danger_s49dv_18"},kc=window.React.createElement,ku=ex(function(){let{$t:e}=oA(),{channelJid:t}=vo(),{sessionType:a,name:n,isMeetChat:i}=b2(t),s=Mn(t),r=rk(s),l=rR(s),o=a===i1.CHANNEL,d=[{taKey:"edit",name:e(o?{id:"62P16S",defaultMessage:[{type:0,value:"Edit Channel"}]}:{id:"HssoVa",defaultMessage:[{type:0,value:"Edit Chat"}]}),onClick:()=>{t&&a&&bf.open({type:st.EDIT_CHANNEL,options:{channelId:t,chatType:a}})},hidden:!l||!r&&!o},{taKey:"transfer",name:e({id:"o1qkhE",defaultMessage:[{type:0,value:"Assign New Owner"}]}),onClick:()=>{t&&a&&bf.open({type:st.TRANSFER,options:{channelId:t,chatType:a}})},hidden:!r||!!i},{taKey:"delete",name:e(o?{id:"dzosaH",defaultMessage:[{type:0,value:"Delete Channel"}]}:{id:"NMr04q",defaultMessage:[{type:0,value:"Delete Chat"}]}),danger:!0,onClick:()=>{t&&a&&bf.open({type:st.DELETE_CHANNEL,options:{channelId:t,channelName:n,chatType:a}})},hidden:!r}];return g.jsx(g.Fragment,{children:d.map(e=>e.hidden?null:kc("button",{...oI.MoreActions.optionBtn(e.taKey),className:f(kd.option,{[kd.danger]:e.danger}),key:e.name,onClick:e.onClick},e.name))})}),km={buttonActions:"_buttonActions_58hn4_1",visible:"_visible_58hn4_7",button:"_button_58hn4_1",pinIcon:"_pinIcon_58hn4_16"},kp=window.React.useCallback,kh=window.React.useState,kf=ex(function(e){let{className:t,pinnedMsg:a}=e,{channelJid:n,senderJid:i,time:s,id:r}=a,{isPinned:l}=je({id:r}),{onPin:o,onUnpin:d,onRemoveFromPinList:c}=j$(a),{$t:u}=oA(),[m,p]=kh(!1),h=lU(n,i),y=kp(()=>{oz.dispatch(oH.jumpToMessage,{chatId:h,msgId:r,sendTime:s,mainMsgId:a.replyId})},[r,h,s,a.replyId]),v=b5(n),_=jc(),b=l3(()=>({extraData:null,dropDownOptions:[[{key:"JumpToMessage",text:u({id:"LltPkP",defaultMessage:[{type:0,value:"Jump to Message"}]}),testKey:"jumpToMessage"},{key:"Pin",text:u({id:"Rklgbn",defaultMessage:[{type:0,value:"Pin for Everyone"}]}),testKey:"pin",hidden:l||!v||!_},{key:"Unpin",text:u({id:"ooSyC0",defaultMessage:[{type:0,value:"Unpin for Everyone"}]}),testKey:"unpin",hidden:!l||!v||!_},{key:"RemoveFromPinHistory",text:u({id:"sXTwBM",defaultMessage:[{type:0,value:"Remove from History"}]}),testKey:"removeFromPinHistory",hidden:!v||!_}]],onDropDownAction:e=>{let{eventKey:t}=e;switch(t){case"JumpToMessage":y();break;case"Pin":o();break;case"Unpin":d();break;case"RemoveFromPinHistory":c()}}}),[u,y,l,o,d,c,v,_]);return g.jsxs("div",{tabIndex:-1,className:f(t,km.buttonActions,{[km.visible]:m}),children:[l&&g.jsx(dj,{...oI.Bookmarks.removeBtn(r),className:km.button,icon:g.jsx(n5,{className:km.pinIcon}),size:"small",title:u({id:"ooSyC0",defaultMessage:[{type:0,value:"Unpin for Everyone"}]}),onClick:d}),g.jsx(NJ,{...b,sideOffset:4,onOpenChange:p,children:g.jsx(dj,{className:km.button,icon:g.jsx(nt,{}),size:"small","aria-label":u({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]})})})]})}),kg={placeholder:"_placeholder_tplon_1",pin:"_pin_tplon_7",loading:"_loading_tplon_11"},ky=ex(function(){let{$t:e}=oA(),{pinMsgIdList:t,fetchPinList:a,isPinListFetched:n}=vv(),i=!yU.messages(t).length;return(l2(()=>{n||a()},[n,a]),n)?i?g.jsx("div",{className:kg.placeholder,children:e({id:"BgEth/",defaultMessage:[{type:0,value:"Pinned messages will appear here as you pin."}]})}):g.jsx(_Z,{messageIds:t,children:g.jsx("div",{className:kg.pin,children:t?.map(e=>g.jsx(wT,{action:(e,t)=>g.jsx(kf,{className:t,pinnedMsg:e}),msgId:e,layout:"side"},e))})}):g.jsx(e4,{loading:!0,className:kg.loading})}),kv={mentionList:"_mentionList_1w2bx_1",empty:"_empty_1w2bx_7",mentionListItem:"_mentionListItem_1w2bx_15",isSelected:"_isSelected_1w2bx_32",moreBtn:"_moreBtn_1w2bx_32",groupDetail:"_groupDetail_1w2bx_35",groupName:"_groupName_1w2bx_39",addBtn:"_addBtn_1w2bx_57"},k_=window.React.useState,kb=ex(function(e){let{ariaProps:t,mentionDetail:a}=e,{$t:n}=oA(),[i,s]=k_(!1),{channelJid:r}=vo(),{userJid:l}=vB,{name:o,jid:d}=a,{deleteMentionGroup:c,joinToMentionGroup:u,leaveMentionGroup:m}=yE,p=Mj(d),h=p?.length||0,y=Ms(r),v=p?.includes(l),_=()=>{bf.open({type:y?st.EDIT_MENTION_GROUP:st.PREVIEW_MENTION_GROUP,options:{mentionJid:d}})},b=[{key:"ViewAndEditMentionGroup",text:n({id:"cIg0bZ",defaultMessage:[{type:0,value:"View/Edit Mention Group"}]}),invisible:!y,testKey:"viewAndEditMentionGroup",operate(){_()}},{key:"ViewMentionGroup",text:n({id:"XmRx0P",defaultMessage:[{type:0,value:"View Mention Group"}]}),invisible:y,testKey:"viewMentionGroup",operate(){_()}},{key:"JoinMentionGroup",text:n({id:"P6PLpi",defaultMessage:[{type:0,value:"Join"}]}),invisible:v,testKey:"joinMentionGroup",operate(){u(d)}},{key:"LeaveMentionGroup",text:n({id:"fnihsY",defaultMessage:[{type:0,value:"Leave"}]}),invisible:!v,testKey:"leaveMentionGroup",operate(){m(d)}},{key:"DeleteMentionGroup",text:n({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),invisible:!y,testKey:"deleteMentionGroup",operate(){bf.open({type:st.MESSAGE_BOX,options:{titleText:n({id:"wYwkNY",defaultMessage:[{type:0,value:"Delete @"},{type:1,value:"groupName"}]},{groupName:o}),messageText:n({id:"IEIpQH",defaultMessage:[{type:0,value:"The mention group @"},{type:1,value:"groupName"},{type:0,value:" will be deleted from this channel. Channel membership will not be affected."}]},{groupName:o}),confirmButtonText:n({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),isConfirmButtonDanger:!0,confirmCallback:e=>{c({jid:d,onAction:e})}}})}}];return g.jsxs("div",{...oI.MoreActions.mentionGroupItem(o||""),"data-is-in":v,...ld(_),className:f(kv.mentionListItem,{[kv.isSelected]:i}),"aria-label":`@${o}(${h}), button`,...t,children:[g.jsx(MF,{members:p,children:g.jsxs("span",{role:"button",className:kv.groupDetail,children:[g.jsxs("span",{className:kv.groupName,children:["@",o]}),g.jsx("span",{className:kv.groupNum,children:`(${h})`})]})}),g.jsx(cQ,{side:"bottom",align:"start",options:b,onOpenChange:e=>{if(e)return s(e);requestAnimationFrame(()=>{requestAnimationFrame(()=>s(e))})},children:g.jsx("div",{...oI.Mention.mentionGroupItemMoreBtn,role:"button","aria-label":n({id:"WKusUQ",defaultMessage:[{type:0,value:"More options for "},{type:1,value:"mention"}]},{mention:`@${o}(${h})`}),onKeyDown:lo(),tabIndex:0,className:kv.moreBtn,children:g.jsx(nV,{})})})]})}),kM=ex(function(){let{$t:e}=oA(),{mentionList:t}=yE,{channelJid:a}=vo(),n=oa(()=>ep(t(a),"name"),[t,a]);return n.length?g.jsx(dE,{className:kv.mentionList,dataList:n,keyedBy:e=>{let{jid:t}=e;return t},dataRender:(e,t)=>g.jsx(kb,{mentionDetail:e,ariaProps:t})}):g.jsx("span",{className:kv.empty,children:e({id:"5/eCjc",defaultMessage:[{type:0,value:"Mention groups available for use in this channel will appear here. Only the channel owner and admins can create mention groups. All members can add or remove themselves."}]})})}),kx=window.React.useCallback,kC=ex(function(e){let{disabled:t}=e,{$t:a}=oA(),{channelJid:n}=vo(),{mentionList:i}=yE,s=i(n).length>=10,r=kx(()=>{bf.open({type:st.ADD_MENTION_GROUP,options:{channelId:n}})},[n]);return t?null:g.jsx(dj,{...oI.MoreActions.addMentionGroupBtn,className:kv.addBtn,size:"small",title:s?a({id:"0PGili",defaultMessage:[{type:0,value:"Maximum of 10 mention groups are allowed per channel."}]}):void 0,disabled:s,onKeyDown:lo(),onClick:lo(r),"aria-label":a({id:"t2DWvy",defaultMessage:[{type:0,value:"Add Mention Group"}]}),type:"text",icon:g.jsx(iR,{})})}),kj={moreActions:"_moreActions_wavgt_1",header:"_header_wavgt_14",title:"_title_wavgt_22",close:"_close_wavgt_30",summary:"_summary_wavgt_34",profile:"_profile_wavgt_43",profileBlank:"_profileBlank_wavgt_47",optionHeader:"_optionHeader_wavgt_51",optionContent:"_optionContent_wavgt_56"},kN=window.React.useCallback,kw=window.React.useRef,kI=ex(function(){let{$t:e}=oA(),t=v3(),{channelJid:a,visible:n,setChannelActionsVisible:i,activeAccordionKeysSet:s,setActiveAccordionKeysSet:r}=vo(),{memberCount:l}=Mx(a),o=Mh(a),{isAdminAddMemberOnly:d,isSpotChannel:c}=b2(a),u=bA(a),m=kw(null),p=bL(a),h=rS(a),y=h?lT(u??{}):"",v=!!d&&!rR(t),_=rk(t)&&!!window.pwaChatConfig?.isEnabledAddChatBot&&!!window.pwaChatConfig?.appAllowMap?.MIO;l2(()=>{n&&m.current?.focus()},[n]);let b=kN(e=>e?.phones?ab(aO(e.phones,"label"),"value"):{},[]),M=l3(()=>g.jsxs(dK.Item,{eventKey:i2.MENTION_GROUPS,children:[g.jsxs(dK.Header,{className:kj.optionHeader,children:[g.jsx("div",{className:kj.summary,...oI.MoreActions.mentionGroupsHeader,children:e({id:"aq1eUN",defaultMessage:[{type:0,value:"MENTION GROUPS"}]})}),g.jsx(kC,{disabled:!rR(t)})]}),g.jsx(dK.Body,{className:kj.optionContent,...oI.MoreActions.mentionGroupsContent,children:g.jsx(kM,{})})]}),[e,t]),x=l3(()=>g.jsxs(dK.Item,{eventKey:i2.FILES,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsx("div",{className:kj.summary,...oI.MoreActions.filesHeader,children:e({id:"IMPKb5",defaultMessage:[{type:0,value:"FILES"}]})})}),g.jsx(vQ,{channelJid:a,children:g.jsx(dK.Body,{className:kj.optionContent,...oI.MoreActions.filesContent,children:g.jsx(Sz,{})})})]}),[e,a]),C=l3(()=>g.jsxs(dK.Item,{eventKey:i2.WHITEBOARD,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsx("div",{className:kj.summary,...oI.MoreActions.filesHeader,children:e({id:"O+nc4I",defaultMessage:[{type:0,value:"WHITEBOARDS"}]})})}),g.jsx(SW,{channelJid:a,children:g.jsx(dK.Body,{className:kj.optionContent,...oI.MoreActions.filesContent,children:g.jsx(S1,{})})})]}),[e,a]),j=l3(()=>g.jsxs(dK.Item,{eventKey:i2.PIN_HISTORY,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsx("div",{className:kj.summary,...oI.MoreActions.pinHistoryHeader,children:e({id:"5Iph/P",defaultMessage:[{type:0,value:"PIN HISTORY"}]})})}),g.jsx(dK.Body,{className:kj.optionContent,...oI.MoreActions.pinHistoryListContent,children:g.jsx(ky,{})})]}),[e]),N=l3(()=>g.jsxs(dK.Item,{eventKey:i2.BOOKMARK,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsx("div",{className:kj.summary,children:e({id:"3izXOl",defaultMessage:[{type:0,value:"BOOKMARK MESSAGES"}]})})}),g.jsx(dK.Body,{className:kj.optionContent,children:g.jsx(EG,{})})]}),[e]),w=l3(()=>g.jsxs(dK.Item,{eventKey:i2.NOTIFICATIONS,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsx("div",{className:kj.summary,children:e({id:"NAidKb",defaultMessage:[{type:0,value:"Notifications"}]})})}),g.jsx(dK.Body,{className:kj.optionContent,children:g.jsx(ko,{})})]}),[e]),I=kN(()=>g.jsxs(dK,{isSolitary:!1,children:[x,C,N]}),[x,C,N]),T=kN(()=>{let{jobInfo:t,contactInfo:a,email:n}=u??{};return g.jsxs(dK,{isSolitary:!1,defaultActiveKey:[i2.PROFILE_INFO],children:[g.jsxs(dK.Item,{eventKey:i2.PROFILE_INFO,children:[g.jsx(dK.Header,{className:kj.optionHeader,...oI.MoreActions.profileHeader,children:g.jsx("div",{className:kj.summary,children:e({id:"bGoTjv",defaultMessage:[{type:0,value:"PROFILE INFO"}]})})}),g.jsx(dK.Body,{...oI.MoreActions.profileContent,children:g.jsx("div",{className:kj.profile,children:p?g.jsx("div",{className:kj.profileBlank}):g.jsx(MY,{allowCopy:!1,data:{jobInfo:t,contactInfo:a,email:n,contacts:b(a)}})})})]}),x,C,N]})},[u,p,e,x,C,N,b]),E=kN(()=>g.jsxs(dK,{isSolitary:!1,activeKey:Array.from(s),setActiveKey:r,children:[g.jsxs(dK.Item,{eventKey:i2.MEMBER_LIST,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsxs("div",{className:kj.summary,...oI.MoreActions.memberListHeader,children:[e({id:"StUScz",defaultMessage:[{type:1,value:"count"},{type:0,value:" members"}]},{count:l}),g.jsx(ka,{channelJid:a,disabled:v,isAppEnabled:_})]})}),g.jsx(dK.Body,{className:kj.optionContent,...oI.MoreActions.memberListContent,children:g.jsx(kl,{})})]}),yn(o)&&M,x,C,j,N,w,g.jsxs(dK.Item,{eventKey:i2.MORE_OPTIONS,children:[g.jsx(dK.Header,{className:kj.optionHeader,children:g.jsx("div",{className:kj.summary,...oI.MoreActions.optionsHeader,children:e({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]})})}),g.jsx(dK.Body,{className:kj.optionContent,...oI.MoreActions.optionsContent,children:g.jsx(ku,{})})]})]}),[s,r,e,o,l,a,v,_,x,M,C,j,N,w]),S=oa(()=>o?h?I():yt(o)?T():E():null,[o,T,E,I,h]),k=oa(()=>{switch(!0){case c:return e({id:"CzZZcD",defaultMessage:[{type:0,value:"Explore This Huddle Channel"}]});case yn(o):return e({id:"t5NUwj",defaultMessage:[{type:0,value:"Explore This Channel"}]});case h:return`${y} (${e({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`;default:return e({id:"Yp5tZM",defaultMessage:[{type:0,value:"Explore This Chat"}]})}},[c,o,h,y,e]);return n?g.jsxs("div",{...oI.MoreActions.panel,ref:m,tabIndex:-1,onKeyDown:ll([sN.esc],()=>{m.current?.parentElement?.focus(),i(!1)},!0),className:f(kj.moreActions,sl.LIGHT),children:[g.jsxs("div",{className:kj.header,children:[g.jsx("div",{className:kj.title,children:k}),g.jsx(dj,{...oI.MoreActions.closeBtn,className:kj.close,type:"text",size:"small",onClick:()=>i(!1),icon:g.jsx(e8,{})})]}),!yt(o)&&g.jsx(S9,{}),yt(o)&&!h&&!p&&g.jsx(S0,{}),S,g.jsx(ki,{})]}):null}),kT={disablePlaceholder:"_disablePlaceholder_1r1qq_1",setting:"_setting_1r1qq_6"},kE="disabled-editor",kS=ex(function(e){let{isDeactivated:t,isPostMessageEnabled:a,displayName:n,isBlocked:i,isCanChatPMC:s,isUniversalChannel:r}=e,{$t:l}=oA(),{handleAddContact:o}=bI(),{chatId:d}=yh,c=bA(d??"");switch(!0){case t:return g.jsx("p",{className:kT.disablePlaceholder,children:l({id:"SDiNkq",defaultMessage:[{type:1,value:"name"},{type:0,value:"'s account has been deactivated by their account admin."}]},{name:n})});case!a&&r:return g.jsx("p",{className:kT.disablePlaceholder,children:l({id:"ZfWfbw",defaultMessage:[{type:0,value:"You need a Mio license to send messages in this channel"}]})});case!a:return g.jsx("p",{className:kT.disablePlaceholder,...oI.Main.disablePostChatBox,children:l({id:"NLQM3O",defaultMessage:[{type:0,value:"There are restricted settings on who can send messages here"}]})});case i:return g.jsx("p",{className:kT.disablePlaceholder,id:kE,...oI.Main.disablePostChatBox,children:l({id:"j3bYc7",defaultMessage:[{type:0,value:"You have already blocked "},{type:1,value:"name"},{type:0,value:" and cannot send or receive messages from that person. You can unblock "},{type:1,value:"name"},{type:0,value:" from "},{type:8,value:"button",children:[{type:0,value:"Setting"}]}]},{name:n,button:e=>g.jsx(dj,{className:kT.setting,onClick:g4.openModal,tabIndex:0,"aria-describedby":kE,children:e})})});case!s:return g.jsx("p",{className:kT.disablePlaceholder,...oI.Main.disablePostChatBox,children:l({id:"bLdPCh",defaultMessage:[{type:0,value:"Chat turned off by host"}]})});default:return g.jsxs("p",{className:kT.disablePlaceholder,children:[l({id:"hYS0nf",defaultMessage:[{type:0,value:"Add "},{type:1,value:"name"},{type:0,value:" to your contacts to send a message."}]},{name:n}),g.jsx(dj,{size:"small",type:"link",onClick:()=>{c&&o({jid:c.jid,name:n,email:c.email})},children:l({id:"h/XIMH",defaultMessage:[{type:0,value:"Add Contact"}]})})]})}}),kk={noteTag:"_noteTag_1mn72_1",noteMessage:"_noteMessage_1mn72_12"},kA=ex(function(e){let{jid:t,displayName:a}=e,{data:n}=g2,i=t?n.get(t):null,s=i?i.signature:null,r=oQ(s);if(!r)return null;let l=a?`${a}: ${r}`:r;return g.jsx("div",{className:kk.noteTag,children:g.jsx("div",{title:l,className:kk.noteMessage,children:l})})}),kR=ex(function(e){let{jid:t,className:a,...n}=e,i=Mh(t),{$t:s}=oA(),{notifyType:r,isMuted:l,setNotification:o,mute:d,unmute:c}=b1(t),{openAddMemberModal:u,openAddMemberP2PModal:m}=Mp(),{toggleVisible:p}=vo(),h=bL(t),y=bc(t),{isChatStarred:v,unStar:_}=yh,{folderCreate:b,getFolderByMember:M,folders:x,deleteMemberFromFolder:C,moveToFolder:j}=bN,N=ya(i),w=yn(i),I=yt(i),T=M(t),E=()=>{T&&C({folderId:T.folderID,sessionIds:[t]})},S=e=>{e&&(v(t)&&_({jid:t}),j({folderID:e,sessionId:t}))},k=e=>({key:"MoveToFolder",text:s({id:"xFit4n",defaultMessage:[{type:0,value:"Move to Folder"}]}),separator:e,testKey:"moveToFolder",children:[...x.map((e,t)=>({key:`folder-${e.folderID}`,text:e.name,testKey:"moveToFolderItem",checked:e.folderID===T?.folderID,disabled:e.folderID===T?.folderID,separator:t===x.length-1,operate:()=>S(e.folderID)})),{key:"RemoveFromFolder",text:s({id:"i2UE0P",defaultMessage:[{type:0,value:"Remove from Folder"}]}),testKey:"removeFolder",operate:E,invisible:!T},{key:"CreateNewFolder",text:s({id:"yFvSRv",defaultMessage:[{type:0,value:"Create a Folder"}]}),testKey:"createFolder",operate:()=>b(t)}]}),A=[{key:"AboutChannel",text:N?s({id:"LKh/Dj",defaultMessage:[{type:0,value:"About Chat"}]}):s({id:"i8hAeq",defaultMessage:[{type:0,value:"About Channel"}]}),testKey:"aboutChannel",operate:p},{key:"CopyDeepLink",text:N?s({id:"65z0kD",defaultMessage:[{type:0,value:"Copy Link to Chat"}]}):s({id:"7onTOt",defaultMessage:[{type:0,value:"Copy Link to Channel"}]}),testKey:"copyDeepLinkChannel",separator:!0,operate:()=>{o2.info(s({id:"2yCGR2",defaultMessage:[{type:0,value:"Link copied to clipboard"}]})),rX.copyText(lY({sid:t}))}},k(!0),{key:"AddMembers",text:s({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),testKey:"addMembers",operate:()=>u({channelId:t})},{key:"Notifications",text:s({id:"NAidKb",defaultMessage:[{type:0,value:"Notifications"}]}),children:[{key:"NotificationsAllMessages",text:s({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]}),subText:s({id:"XMhUcZ",defaultMessage:[{type:0,value:"Get notified for all message activity"}]}),groupTitle:s({id:"j7DZu/",defaultMessage:[{type:0,value:"Message Preferences"}]}),testKey:"notificationsAllMessages",checked:r===np.all,operate:()=>o(np.all)},{key:"NotificationsMentions",text:s({id:"DKAqfN",defaultMessage:[{type:0,value:"Mentions and Replies"}]}),subText:s({id:"lnaTlC",defaultMessage:[{type:0,value:"Includes group or personal mentions, and replies to you"}]}),testKey:"notificationsMentions",checked:r===np.mention,operate:()=>o(np.mention)},{key:"NotificationsOff",text:s({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]}),subText:s({id:"/GbGfr",defaultMessage:[{type:0,value:"Turn off chat notifications"}]}),testKey:"notificationsOff",checked:r===np.off,operate:()=>o(np.off)}]},{key:N?"MuteChat":"MuteChannel",text:N?s({id:"9NjGLp",defaultMessage:[{type:0,value:"Mute Chat"}]}):s({id:"DDNoEN",defaultMessage:[{type:0,value:"Mute Channel"}]}),testKey:N?"muteChat":"muteChannel",invisible:l,separator:!0,operate:d},{key:N?"UnmuteChat":"UnmuteChannel",text:N?s({id:"UVhV1I",defaultMessage:[{type:0,value:"Unmute Chat"}]}):s({id:"QoeyW3",defaultMessage:[{type:0,value:"Unmute Channel"}]}),testKey:N?"unmuteChat":"unmuteChannel",invisible:!l,separator:!0,operate:c}],R=[{key:"AboutChannel",text:s({id:"LKh/Dj",defaultMessage:[{type:0,value:"About Chat"}]}),testKey:"aboutChannel",operate:p,separator:!0,invisible:y},{key:"AddMembers",text:s({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),testKey:"addMembers",invisible:h,operate:()=>m({channelId:t})},k()];return g.jsx(cQ,{className:"_dropdown_skyz3_13",side:"bottom",align:"start",options:I?R:A,children:g.jsx(dj,{...oI.Main.moreActionsMenuBtn,...n,className:f("_menuAction_skyz3_1",a),tabIndex:0,"aria-label":w?s({id:"F96pYa",defaultMessage:[{type:0,value:"channel options, menu button"}]}):s({id:"inS0m7",defaultMessage:[{type:0,value:"chat options, menu button"}]}),onKeyDown:lo(),size:"small",type:"text",icon:g.jsx(nt,{})})})}),kL=ex(function(e){let{jid:t}=e,{$t:a}=oA(),{memberCount:n}=Mx(t),{visible:i,setChannelActionsVisible:s,activeAccordionKeysSet:r,setActiveAccordionKeysSet:l}=vo(),o=a({id:"WHayAZ",defaultMessage:[{type:0,value:"Member list"}]});return g.jsx(dj,{...oI.Main.memberListIcon,className:"_memberListBtn_177h0_1","aria-label":o,title:o,icon:g.jsx(eP,{}),type:"text",size:"small",onClick:lN(()=>{i?r.has(i2.MEMBER_LIST)?s(!1):l([...r,i2.MEMBER_LIST]):(r.has(i2.MEMBER_LIST)||l([...r,i2.MEMBER_LIST]),s(!0))}),children:n})}),kO={meetingInvitationAction:"_meetingInvitationAction_hgman_1",meetingInvitationOptions:"_meetingInvitationOptions_hgman_5"},kD=e=>{let{jid:t,name:a,chatType:n,isMeeting:i=!1}=e,[s,,,r]=om(!0),{$t:l}=oA(),{startMeeting:o}=Mu(),d=()=>{t&&a&&(yt(n)?o([{jid:t,name:a,type:i3.CHAT,withVideo:s}]):bf.open({type:st.MEETING,options:{channelId:t,channelName:a,meetingType:i3.GROUP_CHAT,meetingWithVideo:s}}))},c=l3(()=>({extraData:"",dropDownOptions:[[{key:"MeetWithVideo",text:l({id:"YP+RMT",defaultMessage:[{type:0,value:"Meet with Video"}]}),noHoverChange:!0,hasCheckBox:!0,checkBoxValue:s}]],onDropDownAction:e=>{let{eventKey:t}=e;"MeetWithVideo"===t&&r()}}),[l,s,r]);return g.jsxs("div",{className:kO.meetingInvitationAction,children:[g.jsx(dj,{className:kO.meetingInvitationButton,icon:s?g.jsx(nj,{}):g.jsx(iO,{}),type:"text",size:"small",onClick:()=>d()}),!i&&g.jsx(NJ,{...c,children:g.jsx("span",{className:f(kO.meetingInvitationOptions),tabIndex:0,children:g.jsx(tC,{"aria-label":l({id:"HXHGv+",defaultMessage:[{type:0,value:"more options for meeting, menu button, subMenu"}]}),tabIndex:0})})})]})},kP={header:"_header_fsyuy_1",titleContent:"_titleContent_fsyuy_9",btnGroup:"_btnGroup_fsyuy_13",headerBtn:"_headerBtn_fsyuy_19"},kF=ex(function(e){let{jid:t,title:a}=e,{$t:n}=oA(),i=bL(t),{isMeetChat:s}=b2(t),{isNoMeetingsLicenseTypeUser:r}=up,{isMeeting:l}=vB,{isMicro:o}=Mu(),d=Mh(t),c=bc(t),{phoneVisible:u,phoneNumber:m,startContactPhoneCall:p}=Mv(t),h=o&&!r&&!s&&!c,f=yt(d);return g.jsxs(g.Fragment,{children:[!rS(t)&&!i&&g.jsxs(g.Fragment,{children:[!f&&g.jsx(kL,{jid:t}),h&&g.jsx(kD,{jid:t,name:a??"",chatType:d,isMeeting:l,isNoMeetingsLicenseTypeUser:r}),!!m&&u&&g.jsx(dj,{icon:g.jsx(iD,{}),type:"text",size:"small","aria-label":n({id:"Y9S8d5",defaultMessage:[{type:0,value:"Phone Call"}]}),onClick:p,className:kP.headerBtn})]}),g.jsx(kR,{jid:t})]})}),kB={starBtn:"_starBtn_1cj7y_1",starredIcon:"_starredIcon_1cj7y_5"},kU=window.React.useCallback,kH=ex(function(e){let{jid:t}=e,{$t:a}=oA(),{star:n,unStar:i,isChatStarred:s}=yh,r=s(t),l=Mh(t),o=kU(e=>{e.stopPropagation(),r?i({jid:t}):n({jid:t})},[t,r,n,i]),d=l3(()=>yt(l)?r?a({id:"RtXVCq",defaultMessage:[{type:0,value:"Unstar Contact"}]}):a({id:"L0h7DM",defaultMessage:[{type:0,value:"Star Contact"}]}):r?a({id:"s2tirm",defaultMessage:[{type:0,value:"Unstar Channel"}]}):a({id:"HZlpPr",defaultMessage:[{type:0,value:"Star Channel"}]}),[l,r,a]);return g.jsx(dj,{className:kB.starBtn,icon:r?g.jsx(iP,{className:kB.starredIcon}):g.jsx(iF,{}),"aria-label":d,title:d,type:"text",size:"small",onClick:o})}),kz={popover:"_popover_8dimd_1",popoverArrow:"_popoverArrow_8dimd_5",popoverContent:"_popoverContent_8dimd_10",popoverLine:"_popoverLine_8dimd_17",newTip:"_newTip_8dimd_23",popoverTitle:"_popoverTitle_8dimd_35",popoverText:"_popoverText_8dimd_42",popoverButtonWrapper:"_popoverButtonWrapper_8dimd_50",link:"_link_8dimd_55",popoverButton:"_popoverButton_8dimd_50",title:"_title_8dimd_76",divider:"_divider_8dimd_80",pmcTime:"_pmcTime_8dimd_84",meetingInfo:"_meetingInfo_8dimd_88",meetingInfoContent:"_meetingInfoContent_8dimd_95",meetingInfoTopic:"_meetingInfoTopic_8dimd_99",meetingDetail:"_meetingDetail_8dimd_106",pmcButton:"_pmcButton_8dimd_115"},kV={headerTitle:"_headerTitle_1rka9_1",starAndTitle:"_starAndTitle_1rka9_7",chatInfo:"_chatInfo_1rka9_11",presence:"_presence_1rka9_22",infoSuffix:"_infoSuffix_1rka9_31",topic:"_topic_1rka9_36",title:"_title_1rka9_51",titleMUC:"_titleMUC_1rka9_59",iconBell:"_iconBell_1rka9_62",editBtn:"_editBtn_1rka9_67",hidden:"_hidden_1rka9_95"},kG=window.React.useState,kq=ex(e=>{let{jid:t,titleClassName:a,btnGroupClassName:n}=e,{toggleVisible:i}=vo(),{name:s,classification:r}=b2(t),{isMuted:l}=b1(t),{storagePMCTips:o,setStoragePMCTips:d}=function(){let{getStorageValue:e,setStorageValue:t}=l1(rQ.showPMCTips,!1),a=e(),n=b0(e=>{t(e)},[t]);return{storagePMCTips:a,setStoragePMCTips:n}}(),{getMeetingDetail:c}=MA,[u,m]=kG(!1),{$t:p}=oA(),{isMicro:h,joinMeeting:y}=Mu(),{isMeeting:v}=vB;!function(e){let{isMicro:t,requestPmcInfo:a}=Mu(),{channelMap:n}=MA,{info:i}=b2(e);oe(()=>{if(t&&e&&i){let t=n.has(e),s=i.PMC?.meetingNumber;!t&&s&&a({channelList:[{channelId:e,meetingNumber:s}]})}},[t,e,i,a,n])}(t);let _=e=>{h&&e&&y({meetingNumber:e.meetingNumber.toString(),meetingParams:e.password?{pwd:e.password}:{}})};l2(()=>{o?m(!1):(d(!0),m(!0))},[t]);let b=c(t),M=rS(b?.hostId),x=g.jsx(g.Fragment,{children:g.jsxs("div",{className:kz.popoverContent,children:[g.jsxs("div",{className:kz.popoverLine,children:[g.jsx("div",{className:kz.newTip,children:p({id:"5Jcaq4",defaultMessage:[{type:0,value:"NEW"}]})}),g.jsx("div",{className:kz.popoverTitle,children:p({id:"ZGhNF/",defaultMessage:[{type:0,value:"One place for all your meeting chats"}]})})]}),g.jsx("div",{className:kz.popoverText,children:p({id:"6O8jeF",defaultMessage:[{type:0,value:"This continuous meeting chat keeps track of the conversation in Team Chat. See what happened before, during, and after the meeting, even if you didn't attend."}]})}),g.jsxs("div",{className:kz.popoverButtonWrapper,children:[g.jsx("a",{href:"https://zoom.us/user/client/learnMore?flag=pmc",className:kz.link,target:"_blank",rel:"noreferrer",children:p({id:"7DIW6+",defaultMessage:[{type:0,value:"Learn More"}]})}),g.jsx(dj,{className:kz.popoverButton,size:"small",onClick:()=>{m(!1)},children:p({id:"kHSplm",defaultMessage:[{type:0,value:"Got it"}]})})]})]})});return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:a,children:g.jsxs("div",{className:kV.headerTitle,onClick:i,children:[g.jsxs("div",{className:kV.starAndTitle,children:[g.jsx(kH,{jid:t}),g.jsxs("div",{className:kV.topic,tabIndex:0,children:[g.jsx(cc,{className:kz.popover,arrowClassName:kz.popoverArrow,arrow:!0,open:u,content:x,align:"start",alignOffset:-24,children:g.jsx("span",{className:kz.title,children:s})}),g.jsx(w0,{classificationId:r}),l&&g.jsx(il,{className:kV.iconBell})]})]}),!!b&&g.jsx("div",{className:kV.chatInfo,children:M?g.jsxs("div",{className:kz.pmcTime,children:[oW(1e3*b.startTime),g.jsx("span",{className:kz.divider,children:"|"}),oJ(1e3*b.startTime)," -",oJ(1e3*b.startTime+6e4*b.duration)]}):g.jsx(cc,{className:kz.popover,content:g.jsxs("div",{className:f(kz.popoverContent,kz.meetingInfo),children:[g.jsxs("div",{className:kz.meetingInfoContent,children:[g.jsxs("div",{children:[oW(1e3*b.startTime),g.jsx("br",{}),oJ(1e3*b.startTime)," -",oJ(1e3*b.startTime+6e4*b.duration)]}),g.jsx("div",{className:kz.meetingInfoTopic,children:b.topic})]}),g.jsx(dj,{type:"primary",size:"small",disabled:v,onClick:()=>_(b),children:p({id:"P6PLpi",defaultMessage:[{type:0,value:"Join"}]})})]}),align:"start",trigger:"click",children:g.jsx("span",{className:kz.meetingDetail,onClick:lo(),children:p({id:"KUrVdx",defaultMessage:[{type:0,value:"Meeting details"}]})})})})]})}),g.jsxs("div",{className:n,children:[g.jsx(kL,{jid:t}),M&&g.jsx(dj,{className:kz.pmcButton,disabled:v,size:"small",onClick:()=>_(b),children:p({id:"mOFG3K",defaultMessage:[{type:0,value:"Start"}]})}),g.jsx(kR,{jid:t})]})]})}),k$=window.React.useRef,kK=window.React.useCallback,kJ=ex(function(e){let{jid:t}=e,{toggleVisible:a}=vo(),{classification:n,name:i}=b2(t),{isMuted:s}=b1(t);return g.jsxs("div",{className:kV.headerTitle,onClick:a,children:[g.jsxs("div",{className:kV.starAndTitle,children:[g.jsx(kH,{jid:t}),g.jsxs("div",{className:kV.topic,tabIndex:0,children:[g.jsx("span",{className:kV.title,children:i}),g.jsx(w0,{classificationId:n}),s&&g.jsx(il,{className:kV.iconBell})]})]}),g.jsx("div",{className:kV.chatInfo})]})}),kW=ex(function(e){let{jid:t}=e,{$t:a}=oA(),{toggleVisible:n}=vo(),i=bA(t),s=lT(i??{}),r=bO(i),l=bL(t),o=bc(t),d=rS(t)?`${s} (${a({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`:s;return g.jsxs("div",{className:kV.headerTitle,onClick:()=>{o||n()},children:[g.jsxs("div",{className:kV.starAndTitle,children:[!rS(t)&&g.jsx(kH,{jid:t}),g.jsxs("div",{className:kV.topic,tabIndex:0,children:[g.jsx("span",{className:kV.title,children:d}),l&&g.jsx(_O,{}),r&&!l&&g.jsx(_D,{})]})]}),g.jsxs("div",{className:kV.chatInfo,children:[g.jsx(MW,{className:kV.presence,jid:t}),!o&&g.jsx(tU,{className:kV.infoSuffix})]})]})}),kY=ex(function(e){let{jid:t,hovered:a}=e,{$t:n}=oA(),{toggleVisible:i}=vo(),{classification:s,isNoTopic:r,name:l}=b2(t),o=k$(null),{isMuted:d}=b1(t),c=kK(e=>{e.stopPropagation(),bf.open({type:st.EDIT_CHANNEL,options:{channelId:t,chatType:i1.MUC}})},[t]);return g.jsxs("div",{className:kV.headerTitle,onClick:i,children:[g.jsxs("div",{className:kV.starAndTitle,children:[g.jsx(kH,{jid:t}),g.jsxs("div",{className:kV.topic,ref:o,tabIndex:0,children:[r?g.jsx(wL,{channelJid:t,targetRef:o,isMainPanelHeader:!0,handleEdit:c,title:l}):g.jsx("span",{className:f(kV.title,kV.titleMUC),onClick:c,children:l}),g.jsx(iB,{className:f(kV.editBtn,{[kV.hidden]:!a}),"aria-label":n({id:"71UONS",defaultMessage:[{type:0,value:"edit chat, button"}]}),...ld(c),tabIndex:a?"0":"-1","aria-hidden":!a}),g.jsx(w0,{classificationId:s}),d&&g.jsx(il,{className:kV.iconBell})]})]}),g.jsx("div",{className:kV.chatInfo})]})}),kX=ex(function(e){let{jid:t,hovered:a}=e,n=Mh(t);return yt(n)?g.jsx(kW,{jid:t}):ya(n)?g.jsx(kY,{jid:t,hovered:a}):g.jsx(kJ,{jid:t})}),kQ=ex(function(e){let{jid:t,title:a,avatar:n}=e,{isPMC:i}=gQ,s=Mh(t),r=yt(s),{toggleVisible:l}=vo(),[o]=id(e=>g.jsxs("div",{className:f(kP.header,sl.LIGHT),children:[g.jsx(M3,{popover:r,userJid:t??"",children:g.jsx("div",{onClick:l,children:g.jsx(NL,{className:kP.headerAvatar,jid:t,name:a,url:n||"",chatType:s,hideStatus:!0,size:"md"})})}),i(t)?g.jsx(kq,{jid:t,titleClassName:kP.titleContent,btnGroupClassName:kP.btnGroup}):g.jsxs(g.Fragment,{children:[g.jsx("div",{className:kP.titleContent,children:g.jsx(kX,{jid:t,hovered:e})}),g.jsx("div",{className:kP.btnGroup,children:g.jsx(kF,{jid:t,title:a})})]})]}));return o}),kZ=ex(function(){let{$t:e}=oA(),{confirmModal:t,closeConfirm:a}=vv(),n={[vd.REPLACE]:{title:e({id:"q7CXYS",defaultMessage:[{type:0,value:"Replace Current Pin"}]}),okText:e({id:"Hvp+/6",defaultMessage:[{type:0,value:"Replace"}]}),content:e({id:"+penOq",defaultMessage:[{type:0,value:"A message is already pinned to the chat. Are you sure you want to replace it?"}]})},[vd.UNPIN]:{title:e({id:"ooSyC0",defaultMessage:[{type:0,value:"Unpin for Everyone"}]}),okText:e({id:"opNVQC",defaultMessage:[{type:0,value:"Unpin"}]}),content:e({id:"I5d891",defaultMessage:[{type:0,value:"Are you sure you want to unpin this message? Members will still be able to view it in the Pin History."}]})},[vd.REMOVE]:{title:e({id:"sXTwBM",defaultMessage:[{type:0,value:"Remove from History"}]}),okText:e({id:"G/yZLu",defaultMessage:[{type:0,value:"Remove"}]}),content:e({id:"7qbx/Q",defaultMessage:[{type:0,value:"This will remove the message from the Pin History for everyone. Are you sure to remove?"}]})},[vd.UNPIN_REMOVE]:{title:e({id:"sXTwBM",defaultMessage:[{type:0,value:"Remove from History"}]}),okText:e({id:"G/yZLu",defaultMessage:[{type:0,value:"Remove"}]}),content:e({id:"qFSIL3",defaultMessage:[{type:0,value:"You will unpin this message and remove it from pin history for everyone. Are you sure to remove?"}]})}},i={title:"",okText:"",content:""};return t&&(i=n[t.type]),g.jsx(xb,{visible:!!t,title:i.title,noSpacing:!1,okText:i.okText,onCancel:a,onOk:()=>{t?.onConfirm()},children:i.content})}),k1={pinTag:"_pinTag_gc46m_1",pinIcon:"_pinIcon_gc46m_16",pinMessage:"_pinMessage_gc46m_23",filePin:"_filePin_gc46m_31",pinText:"_pinText_gc46m_36",filePinIcon:"_filePinIcon_gc46m_42",fileIcon:"_fileIcon_gc46m_54",moreOption:"_moreOption_gc46m_64",isShow:"_isShow_gc46m_74",imTopPinEmoji:"_imTopPinEmoji_gc46m_93"},k0=window.React.useState,{getExtension:k2,getFileIcon:k5}=rj,k3="labelTextId";function k6(){let{$t:e}=oA();return g.jsx("div",{children:e({id:"XeIT3L",defaultMessage:[{type:0,value:"Unsupported type of message"}]})})}function k4(){let{$t:e}=oA();return g.jsx("div",{children:e({id:"vH6W0k",defaultMessage:[{type:0,value:"To view this message, please use your ACE-enabled client"}]})})}let k8=ex(function(e){let{$t:t}=oA(),{getCodeSnippetState:a}=yw,{codeSnippet:n,fileName:i}=a(e.fileId);if(!n)return g.jsx("div",{children:t({id:"WHLNBM",defaultMessage:[{type:0,value:"This is a pinned message"}]})});let s=n.code.split("\n").filter(e=>e);return g.jsxs("div",{children:[g.jsx("div",{children:i.split(".")[0]}),g.jsx("div",{children:s[0]||""})]})});function k7(e){let{pinText:t,pinIcon:a}=e;if(!t&&!a)return g.jsx(k6,{});let n="string"==typeof t?g.jsx(Ae,{className:k1.pinText,textHtml:t}):g.jsx("span",{className:k1.pinText,children:t});return a?g.jsxs("div",{className:k1.filePin,children:[a&&g.jsx("div",{"aria-hidden":!0,className:k1.filePinIcon,children:a}),n]}):n}function k9(e){let{fileUrl:t,fileName:a}=e,n=k5(k2(a));return a?g.jsx(n,{className:k1.fileIcon}):t?g.jsx("img",{src:t}):void 0}function Ae(e){return g.jsx("span",{className:e.className,dangerouslySetInnerHTML:{__html:e.textHtml||""}})}let At=ex(function(){let{$t:e}=oA(),[t,a]=k0(!1),{topPin:n,setHiddenPin:s,channelJid:r}=vv(),{onUnpin:l}=j$(),o=eC(),{viewPinList:d}=vo(),c=n?.pinner,u=c?lT(c):"",m=(e=>{if(!o)return lL(e).replace(o9,`<span class="${k1.imTopPinEmoji}">$&</span>`);{let{emojiCodeSet:t,emojiSet:a}=nQ.resourceSet;if(t&&a)return lL(e).replace(o9,function(e){return`<img class="${k1.imTopPinEmoji}" data-emoji='${e}' src='${a[t[e]]}'/>`})}})(n?.msg||""),p=[{label:e({id:"FK/h7H",defaultMessage:[{type:0,value:"Hide Pin"}]}),key:"Hide",operate:()=>{n?.pinTimestamp&&s(n?.pinTimestamp)}},{label:e({id:"ooSyC0",defaultMessage:[{type:0,value:"Unpin for Everyone"}]}),key:"Unpin",operate:l},{label:e({id:"UoTp1W",defaultMessage:[{type:0,value:"View Pin History"}]}),key:"ViewPinHistory",operate:d}],h=l3(()=>sM.create(r),[r]);return l2(()=>(h.adjustPosition(60),()=>{h.adjustPosition(-60)}),[h]),g.jsxs("div",{...oI.Main.pinTag,className:k1.pinTag,title:e({id:"LltPkP",defaultMessage:[{type:0,value:"Jump to Message"}]}),"aria-labelledby":k3,...ld(()=>{n&&oz.dispatch(oH.jumpToMessage,{chatId:n.channelJid,msgId:n.msgId,sendTime:n.msgTimestamp,mainMsgId:n.mainMsgId})}),children:[g.jsx(n5,{className:k1.pinIcon}),g.jsxs("div",{className:k1.pinMessage,id:k3,children:[(()=>{switch(n?.msgType){case i.text:return g.jsx(k7,{pinText:m});case i.image:case i.screenshot:return g.jsx(k7,{pinText:n.file?.fileName,pinIcon:k9({fileUrl:n.file?.fileUrl})});case i.dropbox:case i.box:case i.microsoftSharePoint:case i.googleDrive:case i.microsoftOneDrive:return g.jsx(k7,{pinText:n.thirdStorageInfo?.fileName,pinIcon:k9({fileName:n.thirdStorageInfo?.fileName})});case i.file:return g.jsx(k7,{pinText:n.file?.fileName,pinIcon:k9({fileName:n.file?.fileName})});case i.mix:{let{failureBody:t,allFiles:a,msg:i}=n,s=lE({failureBody:t,message:i||""}),{pinText:r,pinIcon:l}=function(t){let{allFiles:a=[],isTextEmpty:n,textHtml:i}=t,s=a?.find(e=>{let{fileType:t}=e;return rf(t)}),r=a?.find(e=>{let{fileType:t}=e;return rp(t)}),l=s?.fileName||r?.fileName;return{pinText:function(){return n?1===a.length?l:a.length>1?e({id:"nu1MAs",defaultMessage:[{type:1,value:"fileName"},{type:0,value:" & others"}]},{fileName:l}):void 0:g.jsx(Ae,{textHtml:i})}(),pinIcon:k9({fileUrl:r?.fileUrl,fileName:s?.fileName})}}({textHtml:m,allFiles:a,isTextEmpty:s});return g.jsx(k7,{pinText:r,pinIcon:l})}case i.e2e:return g.jsx(k4,{});case i.codeSnippet:return g.jsx(k8,{fileId:n.file?.fileId||""});default:return g.jsx(k6,{})}})(),g.jsx("span",{"aria-label":e({id:"nlQ8in",defaultMessage:[{type:0,value:"pinned by "},{type:1,value:"pinner"}]},{pinner:u})})]}),g.jsx("div",{className:f(k1.moreOption,{[k1.isShow]:t}),children:g.jsx(_g,{items:p,onOpenChange:a,children:g.jsx("button",{className:k1.button,"aria-label":e({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]}),children:g.jsx(nt,{})})})})]})}),Aa=""+new URL("images/pmc-empty.png",t.meta.url).href;function An(){let{$t:e}=oA();return g.jsxs("div",{className:"_empty_1wct1_1",children:[g.jsx(wu,{src:Aa}),g.jsx("div",{className:"_title_1wct1_8",children:e({id:"Es9TaS",defaultMessage:[{type:0,value:"You're starting a new continuous meeting chat"}]})}),g.jsx("div",{className:"_description_1wct1_12",children:e({id:"MrJ2yB",defaultMessage:[{type:0,value:"Begin chatting below"}]})})]})}let Ai={chatPanel:"_chatPanel_1p4lr_1",visible:"_visible_1p4lr_8",chatContent:"_chatContent_1p4lr_11",chatHeader:"_chatHeader_1p4lr_19",messageList:"_messageList_1p4lr_24",unreadTip:"_unreadTip_1p4lr_29",pinTag:"_pinTag_1p4lr_35",editor:"_editor_1p4lr_39",uneditable:"_uneditable_1p4lr_45"},As=window.React.useRef,Ar=window.React.useCallback,Al=ex(function(e){let{jid:t}=e,{$t:a}=oA(),n=As(null),{smartCompose:s,smartComposeAnchor:r}=Nb({editorRef:n,alignOffset:16,sessionId:t}),l=bE(),{sendMessage:o,mode:d}=y9(),{topPin:c,hiddenPin:u}=vv(),{chatId:m,chatMap:p}=yh,{name:h,isUniversalChannel:y}=b2(t),{isBlocked:v}=ba,{setCloudStorage:_}=CT,b=MC(t),M=uu(),x=m===t,C=function(e){let{$t:t}=oA(),{isMeetChat:a,info:n,isCache:s}=b2(e),r=!!n?.PMC?.meetingNumber;return l2(()=>{if(a&&!s){let a=t({id:"c2Z++F",defaultMessage:[{type:0,value:"This is a continuous meeting chat"}]});r||(a=t({id:"wI8r4u",defaultMessage:[{type:0,value:"This is no longer a continuous meeting chat"}]})),oz.dispatch(oH.appendInfoMessage,function(e){let{type:t,channelJid:a,channelName:n="",desc:s="",operateType:r=em.new,buddyList:l=[],emailList:o=[],message:d}=e;return{id:sW(),channelJid:a,messageType:i.info,time:Date.now(),senderJid:null,senderName:null,message:d||"",messageXmlStr:"",operType:r,actionInfo:{type:t,buddyList:l,emailList:o,room:{jid:a,name:n,desc:s,option:0,diff:""}}}}({type:"",channelJid:e,message:a}))}},[e,t,a,s,r]),!!a}(t||""),j=jc(),N=bL(t),w=bA(t),I=b5(t),T=bk(w),E=yt(p.get(t)?.type),S=v(t),k=!!c&&u!==c.pinTimestamp&&"transient"!==d,A=bH(t),R=MP(t),L=Ar(()=>{de.setLastActiveEditor(n),de.setDefaultEditor(n)},[]);l2(()=>{let e=oz.pendingMessage$.pipe(iU(100)).subscribe(e=>{e.chatId===t&&n?.current?.insertContent(e.content)});return()=>{e.unsubscribe()}},[t]),l2(()=>{x&&n?.current?.focus()},[x]),EO();let O=E?lT(w??{}):h,D=rS(t)?a({id:"fz4CpL",defaultMessage:[{type:0,value:"What\u2019s on your mind"}]}):a({id:"tQSuqN",defaultMessage:[{type:0,value:"Message "},{type:1,value:"name"}]},{name:O}),P=!(!E||T)||N||!I||S||!j,F=sM.activeAttrs(x),B=Ar(e=>{o({content:e,isExternal:b})},[o,b]);return g.jsxs("main",{...x?oI.Main.activePanel:{},...F,className:f(Ai.chatPanel,{[Ai.visible]:x}),tabIndex:-1,children:[g.jsxs("div",{className:Ai.chatContent,children:[g.jsx("div",{className:Ai.chatHeader,children:g.jsx(kQ,{jid:t,title:O,avatar:w?.avatar})}),g.jsx("div",{className:Ai.pinTag,children:k&&g.jsx(At,{})}),g.jsxs("div",{className:Ai.messageList,role:"list",children:[g.jsx(wv,{emptyPlaceholder:C&&g.jsx(An,{})}),g.jsx(NA,{className:Ai.unreadTip})]}),!rS(t)&&g.jsx(kA,{jid:t,displayName:O}),r,g.jsx("div",{className:f(Ai.editor,{[Ai.uneditable]:P}),children:P?!E||w?g.jsx(kS,{isDeactivated:N,isPostMessageEnabled:I,isBlocked:S,isCanChatPMC:j,displayName:O,isUniversalChannel:y}):null:g.jsx(ui,{innerRef:n,disabled:!m,onWarning:l,onSend:B,onMentionSearch:A,onSlashSearch:R,onFocus:L,mentionSuggestionRender:CP,slashSuggestionRender:CH,placeholder:D,disabledFeatures:M,contentCheck:CE,handleCloud:_,giphyConfig:uY,appButtons:s})})]}),g.jsx(NU,{type:NO.MoreActions,children:g.jsx(kI,{})}),g.jsx(kZ,{}),x&&g.jsx(ES,{})]})}),Ao=ex(e=>{let t=Mn(e.jid);return g.jsx(v5,{value:t,children:g.jsx(Al,{...e})})}),Ad=""+new URL("images/paper-empty.png",t.meta.url).href;function Ac(){let{$t:e}=oA();return g.jsxs("div",{...oI.Main.messageLoaded,className:"_selfChatPlaceholder_l2g0m_1",children:[g.jsx("div",{className:"_placeholderImage_l2g0m_8",children:g.jsx(wu,{src:Ad})}),g.jsx("div",{className:"_placeholderTitle_l2g0m_14",children:e({id:"5T3YIL",defaultMessage:[{type:0,value:"This is your personal space"}]})}),g.jsx("div",{className:"_placeholderText_l2g0m_19",children:e({id:"HGWc92",defaultMessage:[{type:0,value:"Collect ideas, draft messages, or save files and links"}]})})]})}let Au=window.React.useCallback,Am=window.React.useRef,Ap=ex(function(e){let{jid:t}=e,{$t:a}=oA(),n=Am(null),i=bE(),{sendMessage:s}=y9(),{chatId:r}=yh,{setCloudStorage:l}=CT,{smartCompose:o,smartComposeAnchor:d}=Nb({editorRef:n,alignOffset:16,sessionId:t}),c=uu(),u=bH(t),m=MP(t),p=r===t,{currentUser:h}=g2,y=lT(h),v=a({id:"oD7VsQ",defaultMessage:[{type:0,value:"What's on your mind"}]}),_=Au(()=>{de.setLastActiveEditor(n),de.setDefaultEditor(n)},[]);l2(()=>{p&&n?.current?.focus()},[p]),EO();let b=sM.activeAttrs(p),M=Au(e=>{s({content:e,isExternal:!1})},[s]);return g.jsxs("div",{...p?oI.Main.activePanel:{},...b,className:f("_notesPanel_1b15c_1",{_visible_1b15c_7:p}),tabIndex:-1,children:[g.jsxs("div",{className:"_notesContent_1b15c_10",children:[g.jsx("div",{className:"_notesHeader_1b15c_18",children:g.jsx(kQ,{jid:t,avatar:h.avatar,title:y})}),g.jsxs("div",{className:"_messageList_1b15c_23",role:"list",children:[g.jsx(wv,{emptyPlaceholder:g.jsx(Ac,{})}),g.jsx(NA,{className:"_unreadTip_1b15c_28"})]}),d,g.jsx("div",{className:"_editor_1b15c_34",children:g.jsx(ui,{innerRef:n,onWarning:i,onSend:M,onMentionSearch:u,onSlashSearch:m,onFocus:_,mentionSuggestionRender:CP,slashSuggestionRender:CH,placeholder:v,disabledFeatures:c,contentCheck:CE,giphyConfig:uY,handleCloud:l,appButtons:o})})]}),g.jsx(NU,{type:NO.MoreActions,children:g.jsx(kI,{})}),p&&g.jsx(ES,{})]})}),Ah=ex(function(){let e=vB.userJid;return g.jsx(y7,{channelJid:e,children:g.jsx(vl,{channelJid:e,children:g.jsx(vy,{channelJid:e,children:g.jsx(Ap,{jid:e})})})})}),Af=window.React.useState,Ag=ex(function(){let{chatId:e}=yh,{filesSearchFilterValues:t}=vV,a=vB.userJid,n=t?.sendByJid===a?"my":"all",[i,s]=Af(n);return g.jsxs(NY,{visible:rz(e),children:[g.jsx(Eq,{activeTitle:i,setActiveTitle:s}),g.jsx(ST,{activeTitle:i})]})}),Ay=window.React.useRef,Av=window.React.useRef,{TagSelect:A_}=cE;function Ab(e){let{type:t,initialValue:a,onChange:n}=e,i=a??vL,s=Av(i),[r]=Sr(),l=e=>t=>{let a={...s.current,[e]:t};s.current=a,n?.(a)};return g.jsxs("div",{className:f("_searchFilter_oah3d_1",{_hidden_oah3d_4:"Messages"!==t&&"Files"!==t}),children:[g.jsx(cE,{options:vS,defaultValue:i?.[vT.Type],onChange:l(vT.Type),...r}),g.jsx(A_,{hidden:"Messages"!==t,checked:i?.[vT.AtMe],onChange:(e=>t=>{let a={...s.current,[e]:t};s.current=a,n?.(a)})(vT.AtMe),children:"@me"}),"Files"===t&&g.jsxs(g.Fragment,{children:[g.jsx(cE,{options:vk,defaultValue:i?.[vT.FileType],onChange:l(vT.FileType),...r}),g.jsx(cE,{options:vA,defaultValue:i?.[vT.FileTime],onChange:l(vT.FileTime),...r})]})]})}let AM={wrapper:"_wrapper_muwjn_1",searchTitle:"_searchTitle_muwjn_7",title:"_title_muwjn_16",action:"_action_muwjn_20",content:"_content_muwjn_23"},Ax=e=>{let{visible:t=!0,title:a,action:n,children:i}=e;return t?g.jsxs("div",{className:AM.wrapper,children:[g.jsxs("p",{className:AM.searchTitle,children:[g.jsx("span",{className:AM.title,children:a}),g.jsx("span",{className:AM.action,children:n})]}),g.jsxs("div",{className:AM.content,children:[" ",i]})]}):null},AC=window.React.useCallback;function Aj(e){let{name:t,onRemove:a,onClick:n}=e,{$t:i}=oA(),s=AC(()=>{n?.(t)},[t,n]),r=AC(e=>{e.stopPropagation(),a?.(t)},[t,a]);return g.jsxs("div",{className:"_item_1p0np_1","aria-label":i({id:"yTTI/k",defaultMessage:[{type:0,value:"Recent Searches "},{type:1,value:"name"}]},{name:t}),...ld(s),children:[g.jsx(eO,{}),g.jsx("div",{className:"_left_1p0np_14",children:g.jsx("span",{className:"_name_1p0np_20",children:t})}),g.jsx(dj,{type:"text",size:"small","aria-label":i({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]}),className:"_close_1p0np_26",icon:g.jsx(e8,{}),onKeyDown:ll([sN.enter],r),onClick:r})]})}let AN=window.React.useCallback,Aw=ex(function(){let{setSearchKey:e}=_u,{list:t,remove:a,removeAll:n}=E9(),{$t:i}=oA(),s=AN(t=>{e({searchKey:t,updateInputValue:!0})},[e]);return g.jsx(Ax,{title:i({id:"UE9zNR",defaultMessage:[{type:0,value:"Recent Searches"}]}),action:g.jsx(dj,{type:"text",size:"small",onClick:n,className:"_searchClearAllBtn_jppik_5",children:g.jsx("span",{className:"_action_jppik_1",children:i({id:"cqlObT",defaultMessage:[{type:0,value:"Clear All"}]})})}),children:t.map(e=>g.jsx(Aj,{name:e,onRemove:a,onClick:s},e))})}),AI=ex(function(e){let{type:t,data:a}=e,{channelId:n,name:i,isPublic:s}=a,{$t:r}=oA(),{isMicro:l,gotoChat:o}=Mu(),[d,c]=Sr(),{openMeetingModal:u,openAddMemberModal:m,openEditChannelModal:p,openDeleteChannelModal:h,starChat:y,unStarChat:v}=Mp(),{notifyType:_,setNotification:b}=b1(n),{isNoMeetingsLicenseTypeUser:M}=up,{isMeeting:x}=vB,C=yh.isChatStarred(n),j=!!(n&&i),N=l&&!M,w=N&&x,I=N&&!x,T=()=>{o({jid:n,type:t})},E=(e,a)=>[{...oI.Search.searchOperateChat,type:NG.NORMAL,key:"chat",icon:g.jsx(ez,{}),operate:T},{...oI.Search.searchOperateMeeting,type:NG.NORMAL,key:"video",icon:g.jsx(nI,{}),invisible:!N,disabled:!j,operate:()=>u({channelId:n,channelName:i,meetingType:i3.GROUP_CHAT,meetingWithVideo:!1})},{type:NG.DROPDOWN,key:"more",icon:g.jsx(nt,{}),options:[{key:"CopyDeepLink",text:r({id:"7onTOt",defaultMessage:[{type:0,value:"Copy Link to Channel"}]}),testKey:"copyDeepLinkChannel",separator:!0,operate:()=>{o2.info(r({id:"2yCGR2",defaultMessage:[{type:0,value:"Link copied to clipboard"}]})),rX.copyText(lY({sid:n}))}},{key:"InviteToMeeting",text:r({id:"Q72/t8",defaultMessage:[{type:0,value:"Invite to Meeting"}]}),invisible:!w,disabled:!j,testKey:"inviteToMeeting",operate:()=>u({channelId:n,channelName:i,meetingType:i3.GROUP_CHAT,meetingWithVideo:!1})},{key:"MeetWithVideo",text:r({id:"YP+RMT",defaultMessage:[{type:0,value:"Meet with Video"}]}),invisible:!I,disabled:!j,testKey:"meetWithVideo",operate:()=>u({channelId:n,channelName:i,meetingType:i3.GROUP_CHAT,meetingWithVideo:!0})},{key:"MeetWithoutVideo",text:r({id:"qEuFNV",defaultMessage:[{type:0,value:"Meet without Video"}]}),invisible:!I,testKey:"meetWithoutVideo",separator:!0,operate:()=>u({channelId:n,channelName:i,meetingType:i3.GROUP_CHAT,meetingWithVideo:!1})},{key:"AddMembers",text:r({id:"BcSdw3",defaultMessage:[{type:0,value:"Add Members"}]}),testKey:"addMembers",operate:()=>m({channelId:n})},{key:"Star",text:ya(t)?r({id:"yGv4+p",defaultMessage:[{type:0,value:"Star this Chat"}]}):r({id:"ELpBFh",defaultMessage:[{type:0,value:"Star this Channel"}]}),invisible:C,testKey:"star",separator:!0,operate:()=>y({channelId:n})},{key:"UnStar",text:ya(t)?r({id:"+alAWX",defaultMessage:[{type:0,value:"Unstar this Chat"}]}):r({id:"6Rkob7",defaultMessage:[{type:0,value:"Unstar this Channel"}]}),invisible:!C,testKey:"unStar",separator:!0,operate:()=>v({channelId:n})},{key:"Notifications",text:r({id:"NAidKb",defaultMessage:[{type:0,value:"Notifications"}]}),separator:!0,children:[{key:"NotificationsAllMessages",text:r({id:"/cdBwf",defaultMessage:[{type:0,value:"All Messages"}]}),subText:r({id:"XMhUcZ",defaultMessage:[{type:0,value:"Get notified for all message activity"}]}),groupTitle:r({id:"j7DZu/",defaultMessage:[{type:0,value:"Message Preferences"}]}),testKey:"notificationsAllMessages",checked:_===np.all,operate:()=>b(np.all)},{key:"NotificationsMentions",text:r({id:"DKAqfN",defaultMessage:[{type:0,value:"Mentions and Replies"}]}),subText:r({id:"lnaTlC",defaultMessage:[{type:0,value:"Includes group or personal mentions, and replies to you"}]}),testKey:"notificationsMentions",checked:_===np.mention,operate:()=>b(np.mention)},{key:"NotificationsOff",text:r({id:"OvzONl",defaultMessage:[{type:0,value:"Off"}]}),subText:r({id:"/GbGfr",defaultMessage:[{type:0,value:"Turn off chat notifications"}]}),testKey:"notificationsOff",checked:_===np.off,operate:()=>b(np.off)}]},{key:"EditChat",text:r({id:"HssoVa",defaultMessage:[{type:0,value:"Edit Chat"}]}),invisible:!(e&&ya(t)),testKey:"editChat",operate:()=>p({channelId:n,chatType:i1.MUC})},{key:"DeleteChat",danger:!0,text:r({id:"NMr04q",defaultMessage:[{type:0,value:"Delete Chat"}]}),invisible:!(e&&ya(t)),testKey:"deleteChat",operate:()=>h({channelId:n,channelName:i,chatType:i1.MUC})},{key:"EditChannel",text:r({id:"62P16S",defaultMessage:[{type:0,value:"Edit Channel"}]}),invisible:!((e||a)&&yn(t)),testKey:"editChannel",operate:()=>p({channelId:n,chatType:i1.CHANNEL})},{key:"DeleteChannel",danger:!0,text:r({id:"dzosaH",defaultMessage:[{type:0,value:"Delete Channel"}]}),invisible:!(e&&yn(t)),testKey:"deleteChannel",operate:()=>h({channelId:n,channelName:i,chatType:i1.CHANNEL})}]}],[S]=id(e=>g.jsxs("div",{...oI.Search.searchItem,"aria-label":r({id:"XzkGJs",defaultMessage:[{type:0,value:"go to channel "},{type:1,value:"name"}]},{name:i}),className:f("_item_1wd55_1",{_visible_1wd55_7:c}),onClick:T,tabIndex:0,children:[g.jsx(NL,{className:"_avatar_1wd55_10",jid:n,name:i,chatType:t,chatIsPublic:s}),g.jsx("div",{className:"_left_1wd55_22",children:g.jsx("span",{className:"_name_1wd55_28",children:g.jsx(So,{text:i??""})})}),g.jsx(NW,{jid:n,hovered:e,children:e=>{let{isAdmin:t,isOwner:a}=e;return g.jsx(Nq,{className:"_actions_1wd55_13",actions:E(a,t),size:"lg",...d})}})]}));return S}),AT={item:"_item_19g8i_1",visible:"_visible_19g8i_7",actions:"_actions_19g8i_10",left:"_left_19g8i_13",name:"_name_19g8i_19"},AE=window.React.useCallback,AS=ex(function(e){let{data:t}=e,{jid:a,displayName:n,firstName:i,lastName:s,snsEmail:r,type:l}=t,{phoneVisible:o,phoneNumber:d,startContactPhoneCall:c}=Mv(a),{isNoMeetingsLicenseTypeUser:u}=up,{isMeeting:m}=vB,{isChatStarred:p}=yh,h=p(a),y=bc(a),{$t:v}=oA(),{isMicro:_,gotoChat:b,startMeeting:M}=Mu(),x=bA(a),C=bO(x),[j,N]=Sr(),{openProfileModal:w,starChat:I,unStarChat:T,blockUser:E,unblockUser:S}=Mp(),{isBlocked:k}=ba,A=k(a),R=lT({nickname:n,firstname:i,lastname:s,email:r}),L=rS(a)?`(${v({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`:"",O=Si(),D=!!(a&&R),P=_&&!u&&!y,F=P&&!m,B=!!d,U=2===l,H=bk(x),{handleDeleteContact:z,handleAddContact:V}=bI(),G=AE(()=>{U||b({jid:a,type:i1.CHAT})},[b,U,a]),q=AE((e,t)=>{D&&M([{jid:e.jid,name:R,type:i3.CHAT,withVideo:t}])},[R,D,M]),$=AE(()=>{V({jid:a,email:r,name:R})},[V,R,r,a]),K=[{...oI.Search.searchOperateAddContact,type:NG.NORMAL,key:"addContact",icon:g.jsx(nw,{}),invisible:H,operate:$},{...oI.Search.searchOperateChat,type:NG.NORMAL,key:"chat",icon:g.jsx(ez,{}),invisible:U||!H,operate:G},{...oI.Search.searchOperateMeeting,type:NG.NORMAL,key:"video",icon:g.jsx(nI,{}),invisible:!P||!H,disabled:!D,operate:()=>{q(t,!1)}},{type:NG.NORMAL,key:"phone",icon:g.jsx(nT,{}),invisible:!o||!H,disabled:!B,operate:c},{...oI.Search.searchOperateMoreOptions,type:NG.DROPDOWN,key:"more",icon:g.jsx(nt,{}),options:[{key:"CopyDeepLink",text:v({id:"65z0kD",defaultMessage:[{type:0,value:"Copy Link to Chat"}]}),testKey:"copyDeepLinkChannel",separator:!0,invisible:y,operate:()=>{o2.info(v({id:"2yCGR2",defaultMessage:[{type:0,value:"Link copied to clipboard"}]})),rX.copyText(lY({sid:t.jid}))}},{key:"InviteToMeeting",text:v({id:"Q72/t8",defaultMessage:[{type:0,value:"Invite to Meeting"}]}),invisible:!(P&&m),disabled:!D,testKey:"inviteToMeeting",operate:()=>{q(t,!1)}},{key:"MeetWithVideo",text:v({id:"YP+RMT",defaultMessage:[{type:0,value:"Meet with Video"}]}),invisible:!F,disabled:!D,operate:()=>{q(t,!0)}},{key:"MeetWithoutVideo",text:v({id:"qEuFNV",defaultMessage:[{type:0,value:"Meet without Video"}]}),invisible:!F,disabled:!D,separator:!o,operate:()=>{q(t,!0)}},{key:"PhoneCall",text:v({id:"Y9S8d5",defaultMessage:[{type:0,value:"Phone Call"}]}),invisible:!o,disabled:!B,separator:!0,operate:c},{key:"ViewProfile",text:v({id:"Jkxa7F",defaultMessage:[{type:0,value:"View Profile"}]}),operate:()=>w({jid:t.jid}),invisible:y},{key:"Star",text:y?v({id:"DoLG69",defaultMessage:[{type:0,value:"Star this App"}]}):v({id:"tVDvqy",defaultMessage:[{type:0,value:"Star this Contact"}]}),invisible:h,testKey:"star",separator:!0,operate:()=>I({channelId:t.jid})},{key:"UnStar",text:y?v({id:"OWQ+Xk",defaultMessage:[{type:0,value:"Unstar this App"}]}):v({id:"G4y4wM",defaultMessage:[{type:0,value:"Unstar this Contact"}]}),invisible:!h,testKey:"unStar",separator:!0,operate:()=>T({channelId:t.jid})},{key:"Block",text:y?v({id:"NG5b6s",defaultMessage:[{type:0,value:"Block App"}]}):v({id:"A4eK08",defaultMessage:[{type:0,value:"Block Contact"}]}),invisible:A,separator:!0,operate:()=>E({jid:t.jid})},{key:"Unblock",text:y?v({id:"n/lx+X",defaultMessage:[{type:0,value:"Unblock App"}]}):v({id:"74ItpR",defaultMessage:[{type:0,value:"Unblock Contact"}]}),invisible:!A,separator:!0,operate:()=>S({jid:t.jid})},{key:"DeleteContact",text:v({id:"62mqGj",defaultMessage:[{type:0,value:"Delete Contact"}]}),danger:!0,invisible:!C||!H,testKey:"deleteContact",operate:()=>z({jid:t.jid,email:t.snsEmail,name:R})}]}];return g.jsxs("div",{...rS(a)?{}:oI.Search.searchItem,"aria-label":v({id:"ZvYv6n",defaultMessage:[{type:0,value:"go to chat "},{type:1,value:"name"}]},{name:R}),className:f(AT.item,{[AT.visible]:N}),onClick:G,tabIndex:0,children:[g.jsx(M5,{userJid:a,portalContainer:O,onAction:G,children:g.jsx(NL,{jid:a,name:R,chatType:i1.CHAT,url:x?.avatar??"",zoomRoom:U})}),g.jsxs("div",{className:AT.left,children:[g.jsxs("span",{className:AT.name,children:[g.jsx(So,{text:R}),L]}),g.jsx(_B,{userJid:a})]}),!rS(a)&&g.jsx(Nq,{className:AT.actions,actions:K,size:"lg",...j})]})}),Ak={searchIn:"_searchIn_2u4s0_1",searchInIcon:"_searchInIcon_2u4s0_9",searchInName:"_searchInName_2u4s0_26"},AA=window.React.useCallback,AR={Contacts:g.jsx(eF,{}),Channels:g.jsx(eU,{}),Messages:g.jsx(ez,{}),Files:g.jsx(eG,{})};function AL(e){let{className:t,type:a,num:n,onClick:i}=e,{$t:s}=oA(),r=l3(()=>AR[a],[a]),l=l3(()=>{switch(a){case"Contacts":case"Channels":return s({id:"ELA7XS",defaultMessage:[{type:0,value:"View all "},{type:1,value:"num"},{type:0,value:" "},{type:1,value:"type"}]},{num:n,type:a.toLocaleLowerCase()});case"Messages":case"Files":return`${a} (${n})`;default:return""}},[s,n,a]),o=AA(()=>{i?.(a)},[i,a]);return n?g.jsxs("div",{"aria-label":l,className:f(t,Ak.searchIn),...ld(o),children:[g.jsx("div",{className:Ak.searchInIcon,children:r}),g.jsx("span",{className:Ak.searchInName,children:l})]}):null}let AO={allList:"_allList_4me3v_1",loading:"_loading_4me3v_10"},AD=window.React.useCallback,AP=ex(function(){let{$t:e}=oA(),{searchKey:t,switchTag:a}=_u,{contacts:n,mucs:i,channels:s,messages:r,files:l,loading:o}=_r,d=n.length+i.length,c=l3(()=>r.length+l.length>0,[l.length,r.length]),u=l3(()=>n.length+i.length+s.length+r.length+l.length===0,[s.length,n.length,l.length,r.length,i.length]),m=AD(e=>{a({tag:e})},[a]);return t?g.jsx("div",{className:f(AO.allList,{[AO.loading]:o}),children:g.jsx(e4,{className:AO.loading,loading:o,children:u?g.jsx(Ax,{visible:!o,title:e({id:"k8bltk",defaultMessage:[{type:0,value:"No Results"}]})}):g.jsxs("div",{children:[!!d&&g.jsxs(Ax,{title:e({id:"4S241U",defaultMessage:[{type:0,value:"Contacts"}]}),children:[n.slice(0,4).map(e=>g.jsx(AS,{data:e},e.jid)),4>n.length&&g.jsx(g.Fragment,{children:i.slice(0,4-n.length).map(e=>g.jsx(AI,{type:i1.MUC,data:e},e.channelId))}),d>4&&g.jsx(AL,{type:"Contacts",num:d,onClick:m})]}),!!s.length&&g.jsxs(Ax,{title:e({id:"LUrJwE",defaultMessage:[{type:0,value:"Channels"}]}),children:[s.slice(0,4).map(e=>g.jsx(AI,{type:i1.CHANNEL,data:e},e.channelId)),s.length>4&&g.jsx(AL,{type:"Channels",num:s.length,onClick:m})]}),c&&g.jsxs(Ax,{title:e({id:"/mWjn2",defaultMessage:[{type:0,value:"Search in"}]}),children:[g.jsx(AL,{type:"Messages",num:r.length,onClick:m}),g.jsx(AL,{type:"Files",num:l.length,onClick:m})]})]})})}):g.jsx(Aw,{})}),AF={empty:"_empty_6p2ib_1",searchKey:"_searchKey_6p2ib_12"},AB=""+new URL("images/search-empty.png",t.meta.url).href;function AU(){let{$t:e}=oA();return g.jsxs("div",{...oI.Search.searchEmpty,className:"_empty_xqxqy_1",children:[g.jsx(wu,{className:"_icon_xqxqy_13",src:AB}),g.jsx("span",{className:"_text_xqxqy_16",children:e({id:"6XmRxJ",defaultMessage:[{type:0,value:"Use keywords or filters to search messages"}]})})]})}function AH(e){let{type:t,searchKey:a}=e,{$t:n}=oA(),i=l3(()=>{switch(t){case"TopResults":default:return null;case"Contacts":return g.jsxs(g.Fragment,{children:[n({id:"9xYPFu",defaultMessage:[{type:0,value:"No contacts found matching"}]}),":",g.jsx("b",{className:AF.searchKey,children:a})]});case"Channels":return g.jsxs(g.Fragment,{children:[n({id:"u47BQg",defaultMessage:[{type:0,value:"No channels found matching"}]}),":",g.jsx("b",{className:AF.searchKey,children:a})]});case"Messages":return g.jsx(g.Fragment,{children:n({id:"QXtNTS",defaultMessage:[{type:0,value:"No messages found matching the criteria"}]})});case"Files":return g.jsx(g.Fragment,{children:n({id:"iHEcP+",defaultMessage:[{type:0,value:"No files found matching the criteria"}]})})}},[n,a,t]);return g.jsx("div",{...oI.Search.searchEmpty,className:AF.empty,children:i})}let Az={channelList:"_channelList_r5rfj_1",loading:"_loading_r5rfj_10",small:"_small_r5rfj_16"},AV=window.React.useCallback,AG=ex(function(){let{$t:e}=oA(),{gotoChat:t}=Mu(),{searchKey:a}=_u,{channels:n,loading:i,publicChannels:s}=v7,{isJoined:r}=gQ,l=s?.filter(e=>{let{channelId:t}=e;return!r(t)}),o=AV(e=>{let{jid:a}=e;t({jid:a,channelChanged:!0})},[t]);return g.jsx("div",{className:f(Az.channelList,{[Az.loading]:i}),children:g.jsx(e4,{className:f(Az.loading,{[Az.small]:!!l.length}),loading:i,children:g.jsxs(g.Fragment,{children:[g.jsx(Ax,{visible:!i,title:e({id:"oYKR++",defaultMessage:[{type:1,value:"num"},{type:0,value:" Results"}]},{num:n.length}),children:n.length?g.jsx("div",{children:n.map(e=>g.jsx(AI,{type:i1.CHANNEL,data:e},e.channelId))}):!i&&g.jsx(AH,{type:"Channels",searchKey:a})}),g.jsx(Ax,{visible:!!l?.length,title:e({id:"F3FhOe",defaultMessage:[{type:0,value:"Public Channels You Can Join"}]}),children:l.map(e=>g.jsx(Tk,{data:e,keyword:a,onAction:o},e.channelId))})]})})})}),Aq={contactList:"_contactList_127du_1",loading:"_loading_127du_10"},A$=ex(function(){let{$t:e}=oA(),{searchKey:t}=_u,{contacts:a,mucs:n,loading:i}=_e,s=a.length+n.length;return g.jsx("div",{className:f(Aq.contactList,{[Aq.loading]:i}),children:g.jsx(e4,{className:Aq.loading,loading:i,children:g.jsx(Ax,{visible:!i,title:e({id:"oYKR++",defaultMessage:[{type:1,value:"num"},{type:0,value:" Results"}]},{num:s}),children:s?g.jsxs("div",{children:[a.map(e=>g.jsx(AS,{data:e},e.jid)),n.map(e=>g.jsx(AI,{type:i1.MUC,data:e},e.channelId))]}):!i&&g.jsx(AH,{type:"Contacts",searchKey:t})})})})}),AK={item:"_item_193ml_1",visible:"_visible_193ml_8",actions:"_actions_193ml_11",fileDetail:"_fileDetail_193ml_14",fileBottom:"_fileBottom_193ml_14",fileSharedIn:"_fileSharedIn_193ml_14",filesThumbnail:"_filesThumbnail_193ml_17",fileIcon:"_fileIcon_193ml_26",fileName:"_fileName_193ml_40",fileTime:"_fileTime_193ml_49",fileSize:"_fileSize_193ml_60",progress:"_progress_193ml_72",progressBar:"_progressBar_193ml_78",innerProgress:"_innerProgress_193ml_84",cancelButton:"_cancelButton_193ml_91"},AJ=window.React.useCallback,{getExtension:AW,getFileIcon:AY,modifySize:AX,isImageFile:AQ}=rj,AZ=ex(function(e){let{$t:t}=oA(),[a,n]=Sr(),{searchKey:i}=_u,{getFileState:s,setFileState:l,disposeFile:o,downloadFilesFile:d}=yw,{data:c}=e,{ownerJid:u,name:m="",length:p,createdTime:h,file:y,fileId:v,shared:_}=c,b=s(v||""),M=Mf(r(_?.map(e=>e.shareeJid))),C=AY(AW(m)),j=bA(u),N=j?.nickname??"",w=rS(u)?t({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):N,I=AQ(AW(m)),{gotoChat:T}=Mu(),E=oa(()=>x(c.highlight)||[],[c.highlight]),S=oa(()=>_?.filter(e=>!!e.shareeJid).map(e=>({...x(e),sharedName:M[e.shareeJid]}))??[],[M,_]),k=AJ(()=>Array.isArray(E)&&E.length?E?.[0]?.highlightPosition.map(e=>({start:e?.startPosition??0,end:e?.endPosition??0}))??[]:[],[E]),A=AJ(()=>{if(b.status===i6.downloading)return;let e=b.fileUrl;if(e&&m){lR(e,m);return}v&&m&&d({fileId:v,fileName:m})},[b.status,b.fileUrl,m,v,d]),R=AJ(e=>{e?.stopPropagation(),v&&(o(v),b.status===i6.downloading&&v&&l({fileId:v,state:{status:i6.notDownload,progress:0}}))},[o,v,b.status,l]),L=AJ(()=>{y?.file instanceof File&&rX.copyFile(y.file)},[y?.file]),O=[{...oI.Search.searchOperateDownload,type:NG.NORMAL,key:"chat",icon:g.jsx(a7,{}),invisible:b.status===i6.downloading,operate:A},{type:NG.DROPDOWN,key:"more",icon:g.jsx(nt,{}),options:[{key:"OpenFile",text:t({id:"5q3qC0",defaultMessage:[{type:0,value:"Download"}]}),invisible:b.status===i6.downloading,operate:A},{key:"CopyFile",text:t({id:"4l6vz1",defaultMessage:[{type:0,value:"Copy"}]}),disabled:!(y?.file instanceof File),operate:L}]}],D=oa(()=>[{key:"title",text:S.length>0?t({id:"BeGTP6",defaultMessage:[{type:0,value:"Shared in"}]}):t({id:"FVnCUA",defaultMessage:[{type:0,value:"Shared without channels"}]}),disabled:!0,separator:S.length>0},...S.map(e=>({key:e.shareeJid??"",text:`${e.sharedName}
        ${rS(e.shareeJid)?`(${t({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`:""}`,operate:e=>{T({jid:e.key})}}))],[t,T,S]);return g.jsxs("div",{...oI.Search.searchItem,className:f(AK.item,{[AK.visible]:n}),tabIndex:0,onClick:A,children:[I&&v?g.jsx(E8,{fileId:v,fileName:m,children:(e,t)=>e?g.jsx("div",{className:AK.filesThumbnail,style:{backgroundImage:`url(${e})`}}):g.jsx("div",{ref:t,children:g.jsx(C,{className:AK.fileIcon})})}):g.jsx(C,{className:AK.fileIcon}),g.jsxs("div",{className:AK.fileDetail,children:[g.jsx(Sl,{className:AK.fileName,keyword:i,content:m,findChunks:k}),g.jsxs("div",{className:AK.fileTime,children:[w,", ",oK(h??0)]}),g.jsxs("div",{className:AK.fileBottom,children:[g.jsx("span",{className:AK.fileSize,children:AX(p??0)}),g.jsx(cQ,{side:"bottom",align:"end",className:AK.dropdownPopover,options:D,portalContainer:a.portalContainer,onOpenChange:a.onDropDownOpenChange,children:g.jsxs("button",{className:AK.fileSharedIn,onClick:e=>e.stopPropagation(),children:[t({id:"BeGTP6",defaultMessage:[{type:0,value:"Shared in"}]}),g.jsx(tC,{})]})}),b.status===i6.downloading&&g.jsxs("div",{...oI.Search.searchItemDownloadProcess,className:AK.progress,children:[g.jsx("div",{className:AK.progressBar,children:g.jsx("div",{style:{width:`${b.progress??0}%`},className:AK.innerProgress})}),g.jsx(dj,{className:AK.cancelButton,size:"small",onClick:R,children:t({id:"47FYwb",defaultMessage:[{type:0,value:"Cancel"}]})})]})]}),g.jsx(Nq,{className:AK.actions,actions:O,size:"lg",...a})]})]})}),A1={fileList:"_fileList_1x0h2_1",loading:"_loading_1x0h2_11"},A0=ex(function(){let{$t:e}=oA(),{searchKey:t}=_u,{files:a,loading:n}=_a;return g.jsx("div",{className:f(A1.fileList,{[A1.loading]:n}),role:"list",children:g.jsx(e4,{className:A1.loading,loading:n,children:g.jsx(Ax,{visible:!n,title:e({id:"oYKR++",defaultMessage:[{type:1,value:"num"},{type:0,value:" Results"}]},{num:a.length}),children:a.length?g.jsx("div",{children:a.map(e=>g.jsx(AZ,{data:e},e.fileId))}):!n&&g.jsx(AH,{type:"Files",searchKey:t})})})})}),A2={message:"_message_1wd22_1",responder:"_responder_1wd22_6",avatar:"_avatar_1wd22_9",name:"_name_1wd22_12",brief:"_brief_1wd22_17",title:"_title_1wd22_20",posted:"_posted_1wd22_28",time:"_time_1wd22_31"},A5=window.React.useCallback,A3=ex(function(e){let{responder:t,message:a}=e,{content:n,senderJid:i,senderName:s,sendTime:r,keyword:l,chatType:o,detail:d}=a,{$t:c}=oA(),u=bA(i),m=oa(()=>x(a.highlightPosition)||[],[a.highlightPosition]),p=A5(()=>m.map(e=>({start:e.startPosition??0,end:e.endPosition??0})),[m]),h=rS(i)?rS(o?.receiverJid)?`${s}(${c({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]})})`:c({id:"kJ5W29",defaultMessage:[{type:0,value:"You"}]}):s;return g.jsxs("div",{className:f(A2.message,{[A2.responder]:t}),tabIndex:0,children:[g.jsx(NL,{className:A2.avatar,jid:i,name:s??"",url:u?.avatar??"",chatType:i1.CHAT,size:t?"sm":"md"}),g.jsxs("div",{className:A2.brief,children:[g.jsxs("p",{className:A2.title,children:[g.jsx("b",{className:A2.name,children:h}),o?.chatType===_i.GROUP_CHAT&&g.jsxs("span",{className:A2.posted,children:[c({id:"19BOio",defaultMessage:[{type:0,value:"posted in"}]})," ",g.jsx("b",{className:A2.name,children:d?.name??""})]}),g.jsx("span",{className:A2.time,children:oK(r)})]}),g.jsx(Sl,{keyword:l,content:n,findChunks:p})]})]})});function A6(e){let{message:t,replies:a=[]}=e;return g.jsxs("div",{children:[g.jsx(A3,{message:t}),a.map(e=>g.jsx(A3,{responder:!0,message:e},e.msgId))]})}let A4=window.React.useState,A8=ex(function(e){let[t]=A4(!1),{gotoChat:a}=Mu(),{$t:n}=oA(),{data:i}=e,s=Si(),r=[{...oI.Search.searchOperateJump,type:NG.NORMAL,key:"jump",icon:g.jsx(g.Fragment,{children:n({id:"DHJw7T",defaultMessage:[{type:0,value:"Jump"}]})}),disabled:!(i.chatType?.chatType===_i.P2P_CHAT||i.chatType?.chatType===_i.GROUP_CHAT),operate:()=>{let{chatType:e,msgId:t,sendTime:n,senderJid:s}=i,r=lU(e?.receiverJid??"",s);a({jid:r}),oz.dispatch(oH.jumpToMessage,{chatId:r,msgId:t,sendTime:n,mainMsgId:i.parentId})}}],l=g.jsxs("div",{...oI.Search.searchItem,className:f("_item_wdm6m_1",{_expanded_wdm6m_8:t}),children:[t?g.jsx(A6,{message:i,replies:[]}):g.jsx(A3,{message:i}),g.jsx(Nq,{className:"_actions_wdm6m_15",actions:r,size:"lg",portalContainer:s})]});return l}),A7={messageList:"_messageList_rgjm3_1",loading:"_loading_rgjm3_11"},A9=window.React.useRef,Re=window.React.useCallback,Rt=ex(function(){let{$t:e}=oA(),t=A9(null),{searchKey:a,filterValues:n}=_u,{messages:i,loading:s,hasMore:r,pageNum:l,nextLoading:o,fetchNextMessages:d}=_s,c=Re(()=>t.current,[]),u=Re(()=>{let e={keyword:a,..._n,...n,pageNum:l+1};d(e)},[d,n,l,a]);return a?g.jsx("div",{ref:t,className:f(A7.messageList,{[A7.loading]:s}),children:g.jsx(e4,{className:A7.loading,loading:s,children:g.jsxs(Ax,{visible:!s,title:e({id:"oYKR++",defaultMessage:[{type:1,value:"num"},{type:0,value:" Results"}]},{num:i.length}),children:[i.length?g.jsx("div",{children:i.map(e=>g.jsx(A8,{data:e},e.msgId))}):!s&&g.jsx(AH,{type:"Messages",searchKey:a}),r&&g.jsx(Nd,{loading:o,loadingTip:e({id:"u4fWT3",defaultMessage:[{type:0,value:"Searching all messages"}]}),onLoad:u,getBoundary:c})]})})}):g.jsx(AU,{})});function Ra(e){let{type:t}=e,a=l3(()=>{switch(t){case"TopResults":return g.jsx(AP,{});case"Contacts":return g.jsx(A$,{});case"Channels":return g.jsx(AG,{});case"Messages":return g.jsx(Rt,{});case"Files":return g.jsx(A0,{});default:return null}},[t]);return a}function Rn(e){let{style:t,onTrigger:a}=e,{$t:n}=oA(),{isAppleOS:i}=oi();return l2(()=>{let e=e=>{(i?e.metaKey:e.ctrlKey)&&"F"===e.key.toUpperCase()&&(e.preventDefault(),a?.())};return window.addEventListener("keydown",e,!1),()=>{window.removeEventListener("keydown",e,!1)}},[i,a]),g.jsxs("button",{...oI.Search.openSearch,"aria-label":n(i?{id:"mE/aYF",defaultMessage:[{type:0,value:"Search \u2318 + F"}]}:{id:"Dp7b2N",defaultMessage:[{type:0,value:"Search Ctrl+F"}]}),style:t,className:"_searchTrigger_1glh3_1",onClick:a,children:[g.jsxs("div",{className:"_searchTriggerPlaceholder_1glh3_19",children:[g.jsx(eO,{}),g.jsx("span",{className:"_searchTriggerText_1glh3_26",children:n({id:"xmcVZ0",defaultMessage:[{type:0,value:"Search"}]})})]}),g.jsx("span",{children:i?"\u2318F":"Ctrl+F"})]})}let Ri=window.React.useRef,Rs=window.React.useCallback,Rr={TopResults:0,Contacts:-1,Channels:-1,Messages:0,Files:-1},Rl=ex(()=>{let{visible:e,dropdownVisible:t,setVisible:a,searchKey:n,setSearchFilterValues:i,searchFilterValues:s,setSearchKey:r,tag:l,setTag:o}=_u,d=Ri(null),{push:c}=E9();os(_u,"setSearchKey",e=>{e.updateInputValue&&d.current?.setValue(e.searchKey)});let u=Rs(()=>{let e=d.current?.getValue()?.trim();c(e)},[c]),m=Rs(()=>{a(!0)},[a]),p=Rs(()=>{u(),a(!1)},[u,a]),h=oa(()=>e=>{let{searchKey:t,tag:a,filterValues:n}=e,i=t.trim();if(i.length<=Rr[a])return;let r=n??s;switch(a){case"TopResults":_r.fetchAll({keyword:i,...r});break;case"Contacts":_e.fetchContacts({keyword:i,...v9});break;case"Channels":{let e={keyword:i,...oT,accountId:window.pwaChatConfig?.accountId};v7.fetchChannels(e);break}case"Messages":{let e={keyword:i,..._n,...vP("Messages",r)};_s.fetchMessages(e);break}case"Files":{let e={keyword:i,..._t,...vP("Files",r)};_a.fetchFiles(e)}}},[s]),y=Rs(e=>{o(e),h({searchKey:n,tag:e})},[h,n,o]),v=Rs(e=>{let t=e?.target?.value;r({searchKey:t}),h({searchKey:t,tag:l})},[h,r,l]),_=Rs(()=>{u(),r({searchKey:""}),h({searchKey:"",tag:l})},[h,u,r,l]),b=Rs(e=>{i(e),h({searchKey:n,tag:l,filterValues:e})},[h,n,i,l]);return l2(()=>(e&&y(_c),()=>{r({searchKey:""}),i(void 0)}),[e]),g.jsxs(g.Fragment,{children:[g.jsx(Rn,{onTrigger:m}),g.jsxs(xb,{footer:null,visible:e,onCancel:()=>{t||p()},className:f("_searchModal_1rx1f_1","_padding_1rx1f_7",{_noPointer_1rx1f_10:t}),children:[g.jsx(d$,{ref:d,autoFocus:!0,closable:!0,onClose:p,onClear:_,onChange:tr(v,800),maxLength:256}),g.jsxs(NU,{type:NO.Search,children:[g.jsx(dS,{value:l,onChange:y}),g.jsx(Ab,{type:l,onChange:b}),g.jsx(Ra,{type:l})]}),g.jsx(Ss,{})]})]})});function Ro(e){let{isMicro:t}=e;return g.jsxs("div",{className:f("_header_d5yd3_1",{_micro_d5yd3_11:!!t}),children:[g.jsx(wX,{className:"_navigate_d5yd3_6"}),g.jsx(Rl,{})]})}let Rd=ex(function(){return g.jsx(oD,{children:g.jsx(Ro,{isMicro:!0})})});function Rc(){return g.jsx(Rd,{})}let Ru={wrapper:"_wrapper_12vix_1",userList:"_userList_12vix_17",user:"_user_12vix_17",selected:"_selected_12vix_38",noUsersText:"_noUsersText_12vix_41"},Rm=window.React.useState,Rp=ex(function(e){let{user:t,isSelected:a}=e,n=bA(t.jid),i=bO(n),{$t:s}=oA();return g.jsx("div",{className:f(Ru.user,{[Ru.selected]:a}),"data-id":t.jid,tabIndex:-1,children:`${t.name} ${i?s({id:"ECUwIO",defaultMessage:[{type:0,value:"(External)"}]}):""}`})}),Rh=ex(function(){let{$t:e}=oA(),{users:t,unblock:a,loading:n}=ba,[i,s]=Rm([]);return g.jsxs(xb,{visible:ba.modalVisible,width:560,camelTitle:!0,title:e({id:"skNNbV",defaultMessage:[{type:0,value:"Blocked users"}]}),okText:e({id:"nDejmx",defaultMessage:[{type:0,value:"Unblock"}]}),onCancel:()=>{ba.closeModal(),s([])},onOk:()=>{a(i)},children:[g.jsx("p",{children:e({id:"DTlmm7",defaultMessage:[{type:0,value:"Select users below to unblock:"}]})}),g.jsx("div",{className:Ru.wrapper,...oI.Modal.modalBlockedUserList,tabIndex:0===t.length?-1:0,"aria-roledescription":"list","aria-label":e({id:"skNNbV",defaultMessage:[{type:0,value:"Blocked users"}]}),children:g.jsx(e4,{loading:n,children:0===t.length?g.jsx("div",{className:Ru.noUsersText,tabIndex:0,children:e({id:"ARn5lI",defaultMessage:[{type:0,value:"You have no blocked users yet..."}]})}):g.jsx(c2,{selectionMode:"multiple",onSelectionChange:e=>{s([...e])},className:Ru.userList,children:t.map(e=>g.jsx(iH,{textValue:e.jid,children:g.jsx(Rp,{user:e,isSelected:i.includes(e.jid)})},e.jid))})})})]})});function Rf(e){let{name:t,options:a,isDisabled:n=!1}=e,i=a.filter(e=>e.value===g4.settings[t]);return g.jsx(w8,{name:t,children:g.jsx(ip,{as:"select",name:t,children:e=>{let{form:{setFieldValue:s,setFieldTouched:r}}=e;return g.jsx(i_,{className:"_container_altdl_1",classNamePrefix:"select",name:t,options:a,defaultValue:i,onChange:e=>{if(!e)return;let a=e.value;s(t,a),r(t,!0,!1)},isDisabled:n,isSearchable:!1,blurInputOnSelect:!0,menuShouldScrollIntoView:!0})}})})}let Rg={settingForm:"_settingForm_cko3w_1",lightThemeCircle:"_lightThemeCircle_cko3w_5",defaultThemeCircle:"_defaultThemeCircle_cko3w_15",checkGroupItem:"_checkGroupItem_cko3w_25",option:"_option_cko3w_28",active:"_active_cko3w_31",unreadStyle:"_unreadStyle_cko3w_42",settingBtn:"_settingBtn_cko3w_45",topTitle:"_topTitle_cko3w_62",secondTitle:"_secondTitle_cko3w_68",thirdTitle:"_thirdTitle_cko3w_74",formItem:"_formItem_cko3w_79",preferencesExcept:"_preferencesExcept_cko3w_83",formSubItem:"_formSubItem_cko3w_91"};function Ry(e){let{options:t,label:a,subLabel:n,className:i,textClassName:s}=e;return g.jsxs("div",{children:[a&&g.jsx("h5",{className:Rg.secondTitle,children:a}),n&&g.jsx("p",{className:Rg.thirdTitle,children:n}),t.map((e,t)=>g.jsxs("div",{className:Rg.formSubItem,children:[g.jsx(Ie,{labelText:0===t?a:"",name:e.name,text:e.text,customAriaLabel:e.customAriaLabel,className:i,textClassName:s}),e.dropdown]},e.name))]})}function Rv(e){let{className:t,style:a,label:n,options:i=[],name:s,onChange:r,id:l,labelText:o=""}=e;return g.jsx(w8,{className:t,style:a,name:s,label:n,children:g.jsx("div",{role:"group","aria-labelledby":"form-radio-group",children:g.jsx(ip,{name:s,children:e=>{let{field:{value:t},form:{setFieldValue:a,setFieldTouched:n}}=e;return g.jsx("div",{children:g.jsx(ca,{id:l,value:t,onChange:e=>{a(s,e),n(s,!0,!1),r&&r(e)},children:i.map((e,t)=>g.jsx(cn,{value:e.value,className:"_themeRadioBtn_vh04e_1",children:g.jsx("div",{"aria-label":0===t?`${o}. ${e.label}`:e.label,className:e.btnClassName,...oI.Form.formField(e.value)})},e.value))})})}})})})}let R_=Is(),Rb=ex(function(e){let{className:t}=e,{$t:a}=oA(),{setSettings:n,settings:i}=g4,{userNotifyType:s,userNotifyPermission:r,setUserNotify:l,setUserNotifyPermission:o}=bW,{NOTIFY_TYPE_MAP:d,exceptPreferencesChannels:c}=bY(),u=[{value:sr.LIGHT,btnClassName:f(Rg.lightThemeCircle,{[Rg.active]:i.sidebarTheme===sr.LIGHT}),label:a({id:"zI2M57",defaultMessage:[{type:0,value:"white"}]})},{value:sr.DEFAULT,btnClassName:f(Rg.defaultThemeCircle,{[Rg.active]:i.sidebarTheme===sr.DEFAULT}),label:a({id:"lH1qcH",defaultMessage:[{type:0,value:"gray"}]})}],m=[{value:"2",label:a({id:"ngdXDd",defaultMessage:[{type:1,value:"count"},{type:0,value:" minutes"}]},{count:2})},{value:"5",label:a({id:"ngdXDd",defaultMessage:[{type:1,value:"count"},{type:0,value:" minutes"}]},{count:5})},{value:"10",label:a({id:"ngdXDd",defaultMessage:[{type:1,value:"count"},{type:0,value:" minutes"}]},{count:10})},{value:"15",label:a({id:"ngdXDd",defaultMessage:[{type:1,value:"count"},{type:0,value:" minutes"}]},{count:15})},{value:"30",label:a({id:"ngdXDd",defaultMessage:[{type:1,value:"count"},{type:0,value:" minutes"}]},{count:30})},{value:"60",label:a({id:"ngdXDd",defaultMessage:[{type:1,value:"count"},{type:0,value:" minutes"}]},{count:60})}],p=l3(()=>0===c.length?a({id:"I8SKh5",defaultMessage:[{type:0,value:"Manage group chats and channels..."}]}):1===c.length?a({id:"I8yNko",defaultMessage:[{type:0,value:"1 channel..."}]}):a({id:"uVoHHn",defaultMessage:[{type:1,value:"count"},{type:0,value:" channels..."}]},{count:c.length}),[a,c.length]);return g.jsxs("div",{className:f(Rg.settingForm,t),children:[g.jsx(ix,{initialValues:i,onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsx("h4",{className:Rg.topTitle,children:a({id:"kHoYtZ",defaultMessage:[{type:0,value:"Left Sidebar"}]})}),g.jsx(Ry,{className:Rg.checkGroupItem,textClassName:Rg.option,label:a({id:"nQT/oq",defaultMessage:[{type:0,value:"Show at the top of my sidebar"}]}),subLabel:a({id:"lak70D",defaultMessage:[{type:0,value:'Any items you don\'t select will show in the "More" menu in the sidebar.'}]}),options:[{text:a({id:"+oCyqh",defaultMessage:[{type:0,value:"Contact Requests"}]}),name:"contactRequests"},{text:a({id:"nGBrvw",defaultMessage:[{type:0,value:"Bookmarks"}]}),name:"bookmarks"},{text:a({id:"+vBFap",defaultMessage:[{type:0,value:"Reminders"}]}),name:"reminders"},{text:a({id:"m4vqJl",defaultMessage:[{type:0,value:"Files"}]}),name:"files"}]}),g.jsx(Ry,{className:Rg.checkGroupItem,textClassName:Rg.option,label:a({id:"xXCSX7",defaultMessage:[{type:0,value:"Customize the behavior of my sidebar"}]}),options:[{text:a({id:"GHhc4i",defaultMessage:[{type:0,value:"Only allow one section opened at a time"}]}),name:"oneSectionAllowed"},{text:a({id:"W1qXzu",defaultMessage:[{type:0,value:"Organize by section"}]}),name:"separateChatAndChannel"},{text:a({id:"udUfGo",defaultMessage:[{type:0,value:"Show profile pictures next to direct message chats"}]}),name:"showAvatarForDirectChat"}]}),g.jsx("h5",{className:Rg.secondTitle,children:a({id:"dJjs0t",defaultMessage:[{type:0,value:"Customize the look of my sidebar"}]})}),g.jsx(Rv,{labelText:a({id:"dJjs0t",defaultMessage:[{type:0,value:"Customize the look of my sidebar"}]}),id:"sidebarTheme",className:f(Rg.checkGroupItem,Rg.formItem),name:"sidebarTheme",options:u}),g.jsx("h4",{className:Rg.topTitle,children:a({id:"2RRZnP",defaultMessage:[{type:0,value:"Other Settings"}]})}),g.jsx(Ry,{className:Rg.checkGroupItem,textClassName:Rg.option,options:[{text:a({id:"pYfCiu",defaultMessage:[{type:0,value:"Show link preview"}]}),name:"showLinkPreview"},{text:a({id:"Qdm/Mq",defaultMessage:[{type:0,value:'Change my status to "Away" when I am inactive for'}]}),name:"statusToAwait",dropdown:g.jsx(Rf,{options:m,name:"idleTime",isDisabled:!i.statusToAwait})}]}),g.jsxs("div",{className:Rg.formItem,children:[a({id:"skNNbV",defaultMessage:[{type:0,value:"Blocked users"}]}),g.jsx(dj,{...oI.Form.formButton("blocked_users"),onClick:ba.openModal,size:"small",className:Rg.settingBtn,children:a({id:"F759Ny",defaultMessage:[{type:0,value:"Manage block users"}]})})]}),g.jsx(Ry,{className:Rg.checkGroupItem,textClassName:Rg.option,label:a({id:"WG6nvJ",defaultMessage:[{type:0,value:"Unread Messages"}]}),options:[{text:a({id:"+0iDPO",defaultMessage:[{type:0,value:"Keep all unread messages on top in chat and channel lists"}]}),name:"unreadMessagesOnTop"},{text:a({id:"7HwgC3",defaultMessage:[{type:0,value:"Show unread message count ("},{type:1,value:"num"},{type:0,value:") for channels"}]},{num:g.jsx(N1,{count:1,className:Rg.unreadStyle})}),name:"channelShowUnreadMessageCount",customAriaLabel:a({id:"KW+y0m",defaultMessage:[{type:0,value:"Show unread message count for channels"}]})},{text:a({id:"9fAV2d",defaultMessage:[{type:0,value:"Move messages with new replies to the bottom of the chat"}]}),name:"newRepliesAtBottomOfChat"}]}),g.jsx("p",{className:Rg.thirdTitle,children:a({id:"JH8pnp",defaultMessage:[{type:0,value:"When viewing unread messages in a channel:"}]})}),g.jsx(Il,{className:Rg.checkGroupItem,textClassName:Rg.option,name:"channelUnreadStart",labelText:a({id:"JH8pnp",defaultMessage:[{type:0,value:"When viewing unread messages in a channel:"}]}),options:[{label:a({id:"/8mHXj",defaultMessage:[{type:0,value:"Start at the first unread"}]}),value:so.FIRST,name:"startAtTheFirstUnread"},{label:a({id:"rNU0eq",defaultMessage:[{type:0,value:"Start at the latest unread"}]}),value:so.LAST,name:"startAtTheLatest"}]}),g.jsx("h4",{className:Rg.topTitle,children:a({id:"NAidKb",defaultMessage:[{type:0,value:"Notifications"}]})}),g.jsx(Ie,{className:f(Rg.checkGroupItem,Rg.formItem),textClassName:Rg.option,name:"notifySubscribe",text:a({id:"IXF/1b",defaultMessage:[{type:0,value:"Turn on notifications"}]}),subText:a({id:"7vTTkx",defaultMessage:[{type:0,value:"Make sure operating system-level notifications are turned on"}]}),checked:"granted"===r,onChange:()=>{ub(e=>{o(e),"granted"===e?o2.success(a({id:"NZ+xlw",defaultMessage:[{type:0,value:"Notification has been enabled."}]})):"denied"===e&&o2.warning(a({id:"iHFiod",defaultMessage:[{type:0,value:"You've blocked notifications in your browser. Please open your browser preferences to change that."}]}))})}}),g.jsx("h5",{className:Rg.secondTitle,children:a({id:"j7DZu/",defaultMessage:[{type:0,value:"Message Preferences"}]})}),g.jsx(Il,{className:Rg.checkGroupItem,textClassName:Rg.option,name:"notifyType",labelText:a({id:"j7DZu/",defaultMessage:[{type:0,value:"Message Preferences"}]}),value:s,onChange:l,options:[d[np.all],d[np.mention],d[np.off]]}),g.jsxs("div",{className:Rg.preferencesExcept,children:[g.jsxs("label",{children:[a({id:"K8Swnn",defaultMessage:[{type:0,value:"Except"}]}),":"]}),g.jsx(dj,{size:"small",onClick:()=>{bf.open({type:st.MESSAGE_PREFERENCES})},children:p})]}),g.jsx(R_,{onValuesChange:e=>{n(h(e,"notifySubscribe","notifyType"))}})]})}),g.jsx(Rh,{})]})});function RM(e){let{visible:t,onClose:a}=e,{$t:n}=oA();return g.jsx(xb,{visible:t,width:560,title:n({id:"D3idYv",defaultMessage:[{type:0,value:"Settings"}]}),onCancel:a,closable:!0,footer:g.jsx(g.Fragment,{}),className:"_settingModal_1kgrb_1",children:g.jsx(Rb,{className:"_form_1kgrb_4"})})}let Rx=ex(function(){let{modalVisible:e,closeModal:t}=g4;return g.jsx(RM,{visible:e,onClose:t})}),RC=ex(function(){return g.jsx(oD,{children:g.jsx(Rb,{})})});function Rj(){return g.jsx(RC,{})}function RN(){return!function(e){let{createMicroSearch:t,createMicroSet:a}=e,n=Ay(null),i=Ay(null);l2(()=>{if(o3())return window.microApp.addDataListener(e,!0),o6({type:uf.CHAT_APP_READY}),()=>window.microApp.removeDataListener(e);function e(e){try{switch(e.type){case"SEARCH_MOUNT_DOM":!function(e){try{if(!e){console.error("Received data from MicroApp does not exist `chatSearchContainer`");return}n.current=e,window.ReactDOM.render(t(),e)}catch(e){console.error("Failed to mount search component",e)}}(e.data?.chatSearchContainer??window.document.body.querySelector("chatSearchRoot"));break;case"ROUTE_TO_CHAT_ITEM":yf({jid:e.data.jid});break;case"CAN_START_PHONE_CALL":up.setCanStartPhoneCall(!0);break;case"MEETING_STATUS":vB.setMeeting(!!e.data.status);break;case"CHANNEL_MEETING_RES":MA.setMeetings(e.data);break;case"RENDER_SETTING":e.data?.container&&function(e){try{if(!e){console.error("Received data from MicroApp does not exist `chatSetContainer`");return}i.current=e,window.ReactDOM.render(a(),e)}catch(e){console.error("Failed to mount set component",e)}}(e.data?.container);break;case"CHANNEL_MEETING_TIPS":e.data?wE.openPmcGotoTip(e.data):wE.closePmcGotoTip()}}catch(e){console.error("Micro DataListener Error",e)}}},[]),l2(()=>{if(o3())return window.addEventListener("unmount",e),()=>{window.removeEventListener("unmount",e)};function e(){(function(){try{_u.closeModal(),n.current&&window.ReactDOM.unmountComponentAtNode(n.current)}catch(e){console.error("Failed to unmount search component",e)}})(),function(){try{i.current&&window.ReactDOM.unmountComponentAtNode(i.current)}catch(e){console.error("Failed to unmount set component",e)}}()}},[]),l2(()=>{o3()&&(window,document,document.body,window.window,window.document,window.document.body,window.rawWindow,window.rawDocument)},[])}({createMicroSearch:Rc,createMicroSet:Rj}),g.jsx(g.Fragment,{})}let Rw=""+new URL("images/chat-empty.png",t.meta.url).href;function RI(e){let{attrs:t}=e,{$t:a}=oA();return g.jsx("div",{className:"_empty_1eqf3_1",...t,children:g.jsxs("div",{className:"_text_1eqf3_7",children:[g.jsx(wu,{src:Rw}),g.jsx("br",{}),g.jsx("br",{}),g.jsx("br",{}),a({id:"oLH/iT",defaultMessage:[{type:0,value:"You're starting a new conversation."}]}),g.jsx("br",{}),a({id:"PvcjMW",defaultMessage:[{type:0,value:"Begin chatting below."}]})]})})}let RT={header:"_header_1jcux_1",newChatForm:"_newChatForm_1jcux_11",chatMembers:"_chatMembers_1jcux_15",chatName:"_chatName_1jcux_16",chatLabel:"_chatLabel_1jcux_22",chatMemberSelect:"_chatMemberSelect_1jcux_26",close:"_close_1jcux_43"},RE=window.React.useRef,RS=window.React.useState,Rk=window.React.forwardRef,RA=window.React.useImperativeHandle,RR=window.React.useCallback,RL=Rk(function(e,t){let{jid:a,onChange:n}=e,{$t:i}=oA(),s=RE(null),r=RE(null),[l,o]=RS(!1),[d,c]=RS([]),[u,m]=RS(""),{userJid:p}=vB;RA(t,()=>({getData:()=>s.current?.values})),l2(()=>{r?.current?.onInputChange?.("",{action:"input-change",prevInputValue:""}),r?.current?.onMenuOpen?.()},[d]);let h=RR(e=>{if(e===d.join(",")){let e=[p,...d].map(e=>e.split("@")[0]);return uv.query.fetchMUCByIds(e).then(e=>e?.length?e.map(e=>({jid:e.channelId,displayName:e.channelName,isMUC:!0,onClick:e=>{let{jid:t}=e;yf({jid:t,type:i1.MUC})}})):[{isMUC:!0}]).catch(()=>[{isMUC:!0}])}return uv.query.fetchSearch(al.CONTACT,{keyword:e,sourceType:4}).then(e=>e?.data?.data||[]).catch(()=>[])},[d,p]),f=RR(e=>{if(!e&&d.length>1&&d.length<9)return m(i({id:"y1gsRW",defaultMessage:[{type:0,value:"Existing Chats"}]})),d.join(",");m(i({id:"yaMHMB",defaultMessage:[{type:0,value:"Results"}]}))},[d,i]),{Option:y,MultiValueLabel:v,MultiValueRemove:_,DropdownIndicator:b,GroupHeading:M,Menu:x}=Ib;return g.jsxs("div",{className:RT.header,children:[g.jsx(ix,{innerRef:s,initialValues:{members:[],channelName:""},onSubmit:ec,children:g.jsxs(iC,{className:RT.newChatForm,translate:"yes",children:[g.jsx(Ij,{ref:r,className:RT.chatMembers,labelClassName:RT.chatLabel,selectClassName:RT.chatMemberSelect,name:"members",label:i({id:"Seu2ON",defaultMessage:[{type:0,value:"To:"}]}),groupLabel:u,placeholder:i({id:"i3HT2U",defaultMessage:[{type:0,value:"Name or email address"}]}),components:{Option:y,MultiValueLabel:v,MultiValueRemove:_,DropdownIndicator:b,GroupHeading:M,ClearIndicator:()=>g.jsx(g.Fragment,{}),Menu:x},optionKeys:{label:"displayName",value:"jid"},onValueChange:e=>{o(e.length>1),n?.(e),c(e.map(e=>e.jid))},loadOptionsPromise:h,filterData:lB({disableExternal:!1,disableFromEmail:!1,disableSelf:!0}),styles:{menu:e=>{let t=document.querySelector(".multi-select__input-container")?.offsetLeft||0,a=document.querySelector(".multi-select__control")?.clientWidth||0,n=Math.max(Math.min(t,a-300),0);return{...e,left:n,width:300,borderRadius:"8px"}}},onInputChange:f}),l&&g.jsx(Ia,{className:RT.chatName,labelClassName:RT.chatLabel,label:i({id:"gd5RKp",defaultMessage:[{type:0,value:"Topic:"}]}),name:"channelName",placeholder:i({id:"nA4XGc",defaultMessage:[{type:0,value:"(Optional)"}]}),autoComplete:"off"})]})}),g.jsx(ae,{...oI.NewChat.close,className:RT.close,onClick:()=>{yh.removeChat(a)}})]})});function RO(){return g.jsx(wv,{emptyPlaceholder:g.jsx(RI,{attrs:oI.Main.messageLoaded})})}let RD=window.React.useRef,RP=ex(function(e){let{jid:t}=e,a=RD(null),{$t:n}=oA(),{chatId:i}=yh,{setCloudStorage:s}=CT,{chatId:r,setChatId:l,startMUCWithMessage:o,startP2PWithMessage:d}=gK,c=uu();l2(()=>()=>{l(null)},[]);let u=bz(),m=async(e,t)=>{let n=a.current?.getData()?.members;if(n?.length&&n.length>=2&&t===ev.MEMBER){let a=n.filter(t=>t.displayName?.includes(e)).map(e=>({id:e.jid,label:e.displayName,prefix:t,mentionType:aw.user}));return a}return t===ev.CHANNEL?u(e,t,!0,"newchat"):[]},p=l3(()=>r?g.jsx(y7,{channelJid:r,destroyOnUnmount:!1,children:g.jsx(vy,{channelJid:r,children:g.jsx(RO,{})})}):g.jsx(RI,{}),[r]),h=i===t,y=sM.activeAttrs(h);return g.jsx("main",{...h?oI.Main.activePanel:{},...y,className:f(Ai.chatPanel,{[Ai.visible]:h}),children:g.jsxs("div",{className:Ai.chatContent,...oI.NewChat.content,children:[g.jsx("div",{className:Ai.chatHeader,children:g.jsx(RL,{ref:a,jid:t,onChange:e=>{1===e.length&&e[0].jid?(l(e[0].jid),yy.changeChannel(e[0].jid)):l(null)}})}),p,g.jsx("div",{className:Ai.editor,children:g.jsx(ui,{onSend:e=>{let t=a.current?.getData();if(!t)return;let{members:n=[],channelName:i}=t;if(1===n.length&&n[0].jid){d({jid:n[0].jid,message:e});return}let s=n.filter(e=>e.jid).map(e=>({jid:e.jid,displayName:e.displayName})),r=n.filter(e=>!e.jid).map(e=>e.value);o({info:{subject:i,addMemberList:s,addEmailList:r,fromChannel:!1,fromChat:!0},message:e})},onMentionSearch:m,mentionSuggestionRender:CP,slashSuggestionRender:CH,placeholder:n({id:"wXisYF",defaultMessage:[{type:0,value:"Message ..."}]}),disabledFeatures:c,contentCheck:e=>{let t=a.current?.getData(),{members:i}=t||{};return i?.length?CE(e):(o2.warning(n({id:"UdLO8S",defaultMessage:[{type:0,value:"Please enter at least one recipient"}]})),Promise.resolve(!1))},giphyConfig:uY,handleCloud:s})})]})})}),RF=window.React.useCallback,RB=window.React.useRef,RU=()=>{let{fetched:e}=N4,t=RB(0);l2(()=>{t.current=fS.now()},[]);let a=RF(()=>{fS.logMeasure(Ej.loadMentions,{start:t.current,tags:[fk.LOAD_MENTIONS]})},[]);l2(()=>{e&&a()},[e,a])},RH={mentionsMessages:"_mentionsMessages_sd1sd_1",loadingMentionsPanel:"_loadingMentionsPanel_sd1sd_8",loadingTip:"_loadingTip_sd1sd_14"},Rz=window.React.createElement,RV=window.React.useCallback,RG=window.React.useRef,Rq=ex(function(){let{loading:e,pageNum:t,hasMore:a,scopeType:n,previousLoading:i,sortedMentionsMessages:s,fetchPreviousMentionMessages:r}=N4,l=sM.scrollAttrs("mentions"),{$t:o}=oA(),d=RG(null),c=RV(()=>d.current,[]),u=vB.userJid,m=RV(()=>{r({atJid:[u],keyword:"",pageNum:t+1,pageSize:20,sortType:1,scope:n})},[r,t,n,u]),{chatId:p}=yh,{fetchMentionMessages:h}=N4,f=s.map(e=>e.id);return(l2(()=>{p===sn.MENTION&&1===t&&1===n&&h(N5)},[p,t,n,h]),e)?g.jsx("div",{className:RH.loadingMentionsPanel,children:g.jsx("div",{className:RH.loadingTip,children:o({id:"jWWSn1",defaultMessage:[{type:0,value:"Messages will appear here every time you are mentioned"}]})})}):g.jsx(_Z,{messageIds:f,children:g.jsxs("div",{...l,ref:d,className:RH.mentionsMessages,role:"list",children:[a&&g.jsx(Nd,{loading:i,onLoad:m,getBoundary:c}),s.map(e=>Rz(wT,{...oI.Mention.mentionMsg,key:e.id,msgId:e.id,isUnreadTipVisible:!0}))]})})}),R$=ex(function(){return g.jsx("div",{className:"_mentionMessagesWrapper_1yi0p_1",children:g.jsx(Rq,{})})}),RK=ex(function(){let{chatId:e}=yh,{$t:t}=oA();return RU(),g.jsxs(NY,{visible:rF(e),children:[g.jsx(NX,{title:t({id:"d7LCRi",defaultMessage:[{type:0,value:"Mentions"}]})}),g.jsx(R$,{})]})}),RJ=window.React.useCallback,RW=window.React.useRef,RY=()=>{let{fetched:e}=yV,t=RW(0);l2(()=>{t.current=fS.now()},[]);let a=RJ(()=>{fS.logMeasure(Ej.loadReminders,{start:t.current,tags:[fk.LOAD_REMINDERS]})},[]);l2(()=>{e&&a()},[e,a])},RX=window.React.createElement,RQ=window.React.useState,RZ=function(e){let{options:t,defaultVal:a,onChange:n}=e,[i,s]=RQ(a),r=e=>{s(e),n(e)};return g.jsx(g.Fragment,{children:t.map(e=>{let{title:t,value:a}=e;return RX(dj,{...oI.Reminders.filterBtn(t),key:a,className:"_filterBarItem_248jl_1",size:"small",shape:"round",type:a===i?"primary":"default",onClick:()=>r(a)},t)})})};function R1(e){let{mainText:t}=e,{$t:a}=oA();return g.jsxs("div",{className:"_reminderEmpty_8f6ri_1",children:[g.jsx("p",{className:"_reminderTips_8f6ri_8",children:t}),g.jsx("p",{className:"_reminderSubTip_8f6ri_12",children:a({id:"1r/PdV",defaultMessage:[{type:0,value:"Set a reminder for a message in a chat or channel to take care of it later"}]})})]})}let R0=e=>{let{expireT:t}=e,{$t:a}=oA(),{nowTime:n}=yV,i=t<n;return{isPast:i,timeTipText:function(){let e=Math.abs(t-n);if(e>864e5){let e=es(t).format("MMMM D, YYYY"),n=es(t).add(59,"second").format("HH:mm");return i?a({id:"3vaxXa",defaultMessage:[{type:0,value:"You were reminded on "},{type:1,value:"date"},{type:0,value:" at "},{type:1,value:"time"}]},{date:e,time:n}):a({id:"PdPplV",defaultMessage:[{type:0,value:"You will receive a reminder on "},{type:1,value:"date"},{type:0,value:" at "},{type:1,value:"time"}]},{date:e,time:n})}if(e>36e5){let t=Math.floor(e/36e5);return 1===t?i?a({id:"nLcczt",defaultMessage:[{type:0,value:"You were reminded 1 hour ago"}]}):a({id:"Q9g6Ml",defaultMessage:[{type:0,value:"You will receive a reminder in 1 hour"}]}):i?a({id:"Oe+utR",defaultMessage:[{type:0,value:"You were reminded "},{type:1,value:"count"},{type:0,value:" hours ago"}]},{count:t}):a({id:"Fztel+",defaultMessage:[{type:0,value:"You will receive a reminder in "},{type:1,value:"count"},{type:0,value:" hours"}]},{count:t})}let s=Math.floor(e/6e4);return s<1?i?a({id:"KdwVs1",defaultMessage:[{type:0,value:"Here is your reminder!"}]}):a({id:"0dFEyb",defaultMessage:[{type:0,value:"You will receive a reminder in 1 minute"}]}):1===s?i?a({id:"YVrS+8",defaultMessage:[{type:0,value:"You were reminded 1 minute ago"}]}):a({id:"0dFEyb",defaultMessage:[{type:0,value:"You will receive a reminder in 1 minute"}]}):i?a({id:"n4HKB/",defaultMessage:[{type:0,value:"You were reminded "},{type:1,value:"count"},{type:0,value:" minutes ago"}]},{count:s}):a({id:"gzI2JN",defaultMessage:[{type:0,value:"You will receive a reminder in "},{type:1,value:"count"},{type:0,value:" minutes"}]},{count:s})}()}},R2={remindersOperate:"_remindersOperate_17efl_1",titleText:"_titleText_17efl_10",operateGroup:"_operateGroup_17efl_17",operateButton:"_operateButton_17efl_20",note:"_note_17efl_31",isPast:"_isPast_17efl_37"},R5=ex(function(e){let{reminderDetail:t}=e,{closeReminder:a}=yV,{note:n,msgId:i}=t,{$t:s}=oA(),{isPast:r,timeTipText:l}=R0(t),o=jV(yU.message(i),r),d=e=>{a({params:{session:t.sessionId,svrTime:t.timestamp},ifShowToast:e})};return g.jsxs("div",{...oI.Reminders.reminderOperate,className:f(R2.remindersOperate,{[R2.isPast]:r}),children:[g.jsx("div",{className:R2.titleText,title:l,children:l}),!!n&&g.jsx("div",{className:R2.note,children:n}),g.jsx("div",{className:R2.operateGroup,children:r?g.jsxs(g.Fragment,{children:[g.jsx(NJ,{extraData:null,dropDownOptions:o,children:g.jsxs(dj,{...oI.Reminders.reminderOperateBtn("reschedule"),size:"small",className:R2.operateButton,children:[s({id:"RH5nkn",defaultMessage:[{type:0,value:"Reschedule"}]}),g.jsx(tC,{})]})}),g.jsx(dj,{...oI.Reminders.reminderOperateBtn("done"),size:"small",className:R2.operateButton,onClick:()=>d(!1),children:s({id:"JXdbo8",defaultMessage:[{type:0,value:"Done"}]})})]}):g.jsxs(g.Fragment,{children:[g.jsx(dj,{...oI.Reminders.reminderOperateBtn("cancel"),size:"small",className:R2.operateButton,onClick:()=>d(!0),children:s({id:"C2223g",defaultMessage:[{type:0,value:"Cancel Reminder"}]})}),g.jsx(NJ,{extraData:null,dropDownOptions:o,children:g.jsxs(dj,{...oI.Reminders.reminderOperateBtn("edit"),size:"small",className:R2.operateButton,children:[s({id:"wEQDC6",defaultMessage:[{type:0,value:"Edit"}]}),g.jsx(tC,{})]})})]})})]})}),R3={reminderMessages:"_reminderMessages_81gw3_1",isLoading:"_isLoading_81gw3_9",headerFilter:"_headerFilter_81gw3_12",container:"_container_81gw3_16"},R6=window.React.Fragment,R4=window.React.useState,R8=window.React.useRef,R7=ex(function(){let{reminderList:e,loading:t,fetchAllMessageByBookmark:a,getIsExpired:n,sortedReminderList:i,readReminder:s}=yV,{chatId:r}=yh,l=R8(null),[o,d]=R4(!1),{$t:c}=oA(),[u,m]=R4("all"),p=l3(()=>[{title:c({id:"zQvVDJ",defaultMessage:[{type:0,value:"All"}]}),value:"all"},{title:c({id:"6/aEFZ",defaultMessage:[{type:0,value:"Upcoming"}]}),value:"upcoming"},{title:c({id:"M0vCGv",defaultMessage:[{type:0,value:"Overdue"}]}),value:"overdue"}],[c]),h=sM.scrollAttrs("reminders");oe(()=>{e.length&&r===sn.REMINDERS&&!o&&(a(),d(!0)),r===sn.REMINDERS&&s()},[e,r,a,o,s]),l2(()=>(r!==sn.REMINDERS||l.current?r!==sn.REMINDERS&&l.current&&(clearInterval(l.current),l.current=null):l.current=setInterval(()=>{yV.setNowTime()},1e3),()=>{l.current&&(clearInterval(l.current),l.current=null)}),[r]);let f=oa(()=>i.filter(e=>{switch(u){case"upcoming":return!n(e);case"overdue":return n(e);default:return!0}}),[i,u,n]),y=l3(()=>{switch(u){case"upcoming":return c({id:"DRVucU",defaultMessage:[{type:0,value:"You have no upcoming reminders."}]});case"overdue":return c({id:"KlYTb6",defaultMessage:[{type:0,value:"You have no past reminders."}]});default:return c({id:"XvMmZ9",defaultMessage:[{type:0,value:"You have no reminders."}]})}},[u,c]),v=f.filter(e=>{let t=yU.message(e.msgId);return!!t}).map(e=>e.msgId),_=!f.length&&!t,b=oa(()=>_?g.jsx(R1,{mainText:y}):t?g.jsx(e4,{className:R3.isLoading,loading:!0}):g.jsx(g.Fragment,{children:f.map(e=>{let t=yU.message(e.msgId);return t?g.jsxs(R6,{children:[g.jsx(wT,{...oI.Reminders.reminderMsg,msgId:e.msgId}),g.jsx(R5,{reminderDetail:e})]},e.msgId):null})}),[_,t,y,f]);return g.jsxs("div",{className:R3.reminderMessages,children:[g.jsx("div",{className:R3.headerFilter,children:g.jsx(RZ,{options:p,defaultVal:u,onChange:e=>m(e)})}),g.jsx(_Z,{messageIds:v,children:g.jsx("div",{...h,className:R3.container,role:"list",children:b})})]})}),R9=ex(function(){return g.jsx("div",{className:"_reminderMessagesWrapper_1qmco_1",children:g.jsx(R7,{})})}),Le={timeRow:"_timeRow_xj2k4_1",halfLine:"_halfLine_xj2k4_5"},Lt=window.React.forwardRef,La=window.React.useRef,Ln=window.React.useImperativeHandle,Li=window.React.useCallback,Ls=Is(),Lr=ex(Lt(function(e,t){let{setReminder:a,currentEditingMessage:n,ifHideSuccessToast:i}=yV,{$t:s}=oA(),r=La(null),l=Li(()=>{if(!r.current)return;let{date:e,time:t}=r.current.values,a=r.current.values,n=jH({date:e,time:t});return n<jF()||!function(e){return e?.toString()!=="Invalid Date"}(n)?a={note:r.current.values.note,...jU(jF())}:n>jB()&&(a={note:r.current.values.note,...jU(jB())}),r.current?.setValues(a),a},[r]),o=Li(()=>{let e=l();if(!n||!e)return;let{note:t,date:s,time:r}=e;a({msg:n,note:t,time:jH({date:s,time:r}).valueOf(),ifHideToast:i})},[l,n,a,i]);return l2(()=>{r.current?.setValues({note:"",time:[9,0],date:jP()})},[]),Ln(t,()=>({submitForm:()=>{o()}}),[o]),g.jsx("div",{children:g.jsx(ix,{initialValues:{note:"",time:[9,0],date:jP()},onSubmit:ec,children:g.jsxs(iC,{translate:"yes",children:[g.jsxs("div",{className:Le.timeRow,children:[g.jsx(It,{className:Le.halfLine,label:s({id:"P7PLVj",defaultMessage:[{type:0,value:"Date"}]}),name:"date"}),g.jsx(I$,{className:Le.halfLine,label:s({id:"ug01Mk",defaultMessage:[{type:0,value:"Time"}]}),name:"time"})]}),g.jsx(Ia,{...oI.Reminders.customReminderNote,label:s({id:"qMePPG",defaultMessage:[{type:0,value:"Note"}]}),name:"note",type:"text",placeholder:s({id:"Xgb+dC",defaultMessage:[{type:0,value:"Remind me to..."}]})}),g.jsx(Iq,{}),g.jsx(Ls,{ref:r,onValuesChange:tr(l,1e3)})]})})})})),Ll=window.React.useRef,Lo=ex(function(e){let{isSubmitting:t,visible:a,onClose:n}=e,i=Ll(null),{$t:s}=oA();return g.jsx(xb,{visible:a,width:560,title:s({id:"kLlbpX",defaultMessage:[{type:0,value:"Custom Reminder"}]}),noSpacing:!1,onCancel:n,onOk:()=>{i.current?.submitForm?.()},shouldCloseOnEsc:!1,okText:s({id:"jvo0vs",defaultMessage:[{type:0,value:"Save"}]}),cancelDisable:t,loading:t,children:g.jsx(Lr,{ref:i})})}),Ld=ex(function(){let{customModalVisible:e,closeCustomReminder:t,isSubmitting:a}=yV;return g.jsx(Lo,{visible:e,onClose:t,isSubmitting:a})}),Lc=ex(function(){let{chatId:e}=yh,{$t:t}=oA();return RY(),g.jsxs(NY,{visible:rH(e),children:[g.jsx(NX,{title:t({id:"+vBFap",defaultMessage:[{type:0,value:"Reminders"}]})}),g.jsx(R9,{})]})}),Lu=window.React.useCallback,Lm=window.React.useRef,Lp=()=>{let{fetched:e}=_j,t=Lm(0);l2(()=>{t.current=fS.now()},[]);let a=Lu(()=>{fS.logMeasure(Ej.loadBookmarks,{start:t.current,tags:[fk.LOAD_BOOKMARKS]})},[]);l2(()=>{e&&a()},[e,a])},Lh=ex(function(){let{chatId:e}=yh,{$t:t}=oA();return Lp(),g.jsxs(NY,{visible:rB(e),children:[g.jsx(NX,{title:t({id:"nGBrvw",defaultMessage:[{type:0,value:"Bookmarks"}]})}),g.jsx(Ez,{})]})}),Lf=""+new URL("images/contact-empty.jpg",t.meta.url).href;function Lg(){let{$t:e}=oA();return g.jsxs("div",{className:"_contactEmpty_izgm9_1",tabIndex:0,children:[g.jsx(wu,{"aria-hidden":!0,className:"_emptyName_izgm9_8",src:Lf}),g.jsx("p",{className:"_contactTips_izgm9_11",children:e({id:"2ablGR",defaultMessage:[{type:0,value:"No contact requests right now"}]})}),g.jsx("p",{className:"_contactSubTip_izgm9_15",children:e({id:"yr7/5f",defaultMessage:[{type:0,value:"Come back to check on new requests to accept or decline"}]})})]})}let Ly={contactRequestsItem:"_contactRequestsItem_jg62h_1",avatar:"_avatar_jg62h_7",contentWrapper:"_contentWrapper_jg62h_10",userDetail:"_userDetail_jg62h_13",uerName:"_uerName_jg62h_19",external:"_external_jg62h_27",userEmail:"_userEmail_jg62h_30",requestDate:"_requestDate_jg62h_38",requestContent:"_requestContent_jg62h_47",close:"_close_jg62h_58",contentTitle:"_contentTitle_jg62h_71",contentDescription:"_contentDescription_jg62h_74"},Lv=ex(function(e){let{subscribeData:t}=e,{$t:a}=oA(),{requestMsg:n,requestStatus:i,requestType:s,requestId:r}=t,{getIsExternalContact:l}=bd,{e:o,screenname:d,ext:c,pj:u,t:m}=n,{rejectContact:p,deleteContactReq:h}=bM,f=l(u),{handleAcceptContact:y}=bI(),v=()=>{y({jid:u,requestId:r})},_=()=>{p({jid:u,name:d,requestId:r})},b=()=>{gK.startP2P({jid:u})},M=()=>{h({requestId:r})};return g.jsxs("div",{...oI.ContactRequests.contactRequestsItem(d),className:Ly.contactRequestsItem,tabIndex:0,children:[g.jsx("div",{className:Ly.avatar,children:g.jsx(M5,{userJid:u,children:g.jsx(_L,{isAlwaysColorful:!0,jid:u,name:d||o,size:"lg"})})}),g.jsxs("div",{className:Ly.contentWrapper,children:[g.jsxs("div",{className:Ly.userDetail,children:[d&&g.jsxs(g.Fragment,{children:[g.jsx("span",{className:Ly.uerName,children:d}),g.jsx(_D,{className:Ly.external})]}),g.jsx("span",{className:Ly.userEmail,children:o}),g.jsx("span",{className:Ly.requestDate,children:oK(m)})]}),(()=>{let e=g.jsx(dj,{...oI.ContactRequests.contactRequestsItemDeleteBtn,"aria-label":a({id:"BSij1a",defaultMessage:[{type:0,value:"close"}]}),icon:g.jsx(n0,{}),size:"small",type:"text",className:Ly.close,onClick:M});switch(!0){case i===bg.SUBSCRIBE_REQ_PENDING&&s===by.SUBSCRIBE_REQ_TYPE_SENT&&!c:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("sent"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"2eQvt1",defaultMessage:[{type:0,value:"You sent a contact request"}]})})]});case i===bg.SUBSCRIBE_REQ_PENDING&&s===by.SUBSCRIBE_REQ_TYPE_SENT&&!!c:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("sent"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"bDUKqk",defaultMessage:[{type:0,value:"You sent a contact request and added this user to a chat"}]})})]});case i===bg.SUBSCRIBE_REQ_DECLINED&&s===by.SUBSCRIBE_REQ_TYPE_RECEIVED:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("decline"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"y5k2mg",defaultMessage:[{type:0,value:"You declined this contact request"}]})})]});case i===bg.SUBSCRIBE_REQ_DECLINED&&s===by.SUBSCRIBE_REQ_TYPE_SENT:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("declined"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"B3Uo1I",defaultMessage:[{type:0,value:"Your invitation has been declined by this contact"}]})})]});case i===bg.SUBSCRIBE_REQ_PENDING&&s===by.SUBSCRIBE_REQ_TYPE_RECEIVED&&!c:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("received"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"+oMLz2",defaultMessage:[{type:0,value:"You received a contact request"}]})}),g.jsx(dj,{...oI.ContactRequests.contactRequestsItemAcceptBtn,type:"primary",size:"small",onClick:v,children:a({id:"sjzLbX",defaultMessage:[{type:0,value:"Accept"}]})}),g.jsx(dj,{...oI.ContactRequests.contactRequestsItemRejectBtn,size:"small",onClick:_,children:a({id:"pvtgR2",defaultMessage:[{type:0,value:"Decline"}]})})]});case i===bg.SUBSCRIBE_REQ_PENDING&&s===by.SUBSCRIBE_REQ_TYPE_RECEIVED&&!!c:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("received"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"rJdWPY",defaultMessage:[{type:1,value:"name"},{type:0,value:" wants to connect and add you to a chat"}]},{name:d})}),g.jsx(dj,{...oI.ContactRequests.contactRequestsItemAcceptBtn,type:"primary",size:"small",onClick:v,children:a({id:"c6kWRk",defaultMessage:[{type:0,value:"Accept and join"}]})}),g.jsx(dj,{...oI.ContactRequests.contactRequestsItemRejectBtn,size:"small",onClick:_,children:a({id:"pvtgR2",defaultMessage:[{type:0,value:"Decline"}]})})]});case i===bg.SUBSCRIBE_REQ_ACCEPTED&&s===by.SUBSCRIBE_REQ_TYPE_RECEIVED:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("accept"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"0LzH7h",defaultMessage:[{type:0,value:"You accepted this contact request"}]})}),f&&g.jsx("div",{className:Ly.contentDescription,children:a({id:"mKfCb8",defaultMessage:[{type:0,value:"This contact can see your status"}]})}),g.jsx(dj,{...oI.ContactRequests.contactRequestsItemChatBtn,type:"primary",size:"small",disabled:!f,onClick:b,children:a({id:"mBLNqg",defaultMessage:[{type:0,value:"Start Chat"}]})})]});case i===bg.SUBSCRIBE_REQ_ACCEPTED&&s===by.SUBSCRIBE_REQ_TYPE_SENT:return g.jsxs("div",{...oI.ContactRequests.contactRequestsItemType("accepted"),className:Ly.requestContent,children:[e,g.jsx("div",{className:Ly.contentTitle,children:a({id:"VrF+Eg",defaultMessage:[{type:0,value:"Your invitation has been accepted by this contact"}]})}),f&&g.jsx("div",{className:Ly.contentDescription,children:a({id:"mKfCb8",defaultMessage:[{type:0,value:"This contact can see your status"}]})}),g.jsx(dj,{type:"primary",size:"small",disabled:!f,onClick:b,children:a({id:"mBLNqg",defaultMessage:[{type:0,value:"Start Chat"}]})})]});default:return null}})()]})]})}),L_=ex(function(){let{sortedSubscribeDataList:e,isLoading:t,syncAllSubScribeReqAsReaded:a}=bM,n=!e.length&&!t,{chatId:i}=yh,s=sM.scrollAttrs("contactRequires");return l2(()=>{i===sn.CONTACT&&a()},[a,i]),g.jsx("div",{...s,className:"_contactRequestsList_12cil_1",children:n?g.jsx(Lg,{}):g.jsx(e4,{loading:t,children:g.jsx(g.Fragment,{children:e.map(e=>g.jsx(Lv,{subscribeData:e},e.requestId))})})})});function Lb(){return g.jsx("div",{className:"_contactPanel_1dr0q_1",children:g.jsx(L_,{})})}let LM=ex(function(){let{chatId:e}=yh,{$t:t}=oA();return g.jsxs(NY,{visible:rU(e),children:[g.jsx(NX,{title:t({id:"+oCyqh",defaultMessage:[{type:0,value:"Contact Requests"}]})}),g.jsx(Lb,{})]})}),Lx=window.React.memo,LC=Lx(function(e){let{jid:t}=e;return g.jsx(y7,{channelJid:t,children:g.jsx(vl,{channelJid:t,children:g.jsx(vy,{channelJid:t,children:g.jsx(NU,{type:NO.MainPanel,children:g.jsx(Ao,{jid:t})})})})})});function Lj(e){let t=Lx(t=>g.jsx(NU,{type:NO.MainPanel,children:g.jsx(e,{...t})}));return t.displayName=e.displayName,t}let LN=Lj(RP),Lw=Lj(RK),LI=Lj(Lh),LT=Lj(Ag),LE=Lj(LM),LS=Lj(Lc),Lk=Lj(Ah),LA=Lj(function(){let{$t:e}=oA();return g.jsx("div",{className:"_chatPanel_2a6gz_1",children:g.jsx("div",{className:"_chatContent_2a6gz_8",children:g.jsx("div",{className:"_empty_2a6gz_16",children:g.jsxs("div",{className:"_placeholder_2a6gz_22",children:[g.jsx(wu,{src:Rw}),g.jsx("div",{className:"_text_2a6gz_31",children:e({id:"Zqaale",defaultMessage:[{type:0,value:"Start chatting by clicking or creating a chat on the left panel."}]})})]})})})})}),LR=ex(function(){let{activateChatIds:e,chatId:t,recentChatsFetched:a}=yh,n=vB.userJid;return a&&!t?g.jsx(LA,{}):g.jsx(g.Fragment,{children:e.map(e=>e===g8?g.jsx(LN,{jid:e},e):e===sn.MENTION?g.jsx(Lw,{},e):e===sn.CONTACT?g.jsx(LE,{},e):e===sn.BOOKMARKS?g.jsx(LI,{},e):e===sn.FILES?g.jsx(LT,{},e):e===sn.REMINDERS?g.jsx(LS,{},e):e===n?g.jsx(Lk,{},e):g.jsx(LC,{jid:e},e))})}),LL=()=>{let{$t:e}=oA();return g.jsx("span",{className:"_newTip_q28l9_1",children:e({id:"5Jcaq4",defaultMessage:[{type:0,value:"NEW"}]})})},LO={menuAction:"_menuAction_1dbrk_1"},LD=ex(function(e){let{menuType:t,folder:a,className:n,onOpenChange:i}=e,{$t:s}=oA(),r=l3(()=>({extraData:null,dropDownOptions:[[{key:"NewChat",text:s({id:"UT7Nkj",defaultMessage:[{type:0,value:"New Chat"}]})}]],onDropDownAction:e=>{let{eventKey:t}=e;"NewChat"===t&&yh.startChat()}}),[s]),l=l3(()=>({extraData:null,dropDownOptions:[[{key:"CreateChannel",text:s({id:"tUk+KR",defaultMessage:[{type:0,value:"Create a Channel"}]})}],[{key:"JoinChannel",text:s({id:"bvchtt",defaultMessage:[{type:0,value:"Join a Channel"}]})}]],onDropDownAction:e=>{let{eventKey:t}=e;switch(t){case"CreateChannel":bf.open({type:st.CREATE_CHANNEL});break;case"JoinChannel":bf.open({type:st.JOIN_CHANNEL})}}}),[s]),o=oa(()=>({extraData:a,dropDownOptions:[[{key:"EditFolder",text:s({id:"UqTTsg",defaultMessage:[{type:0,value:"Edit Folder"}]})}],[{key:"DeleteFolder",danger:!0,text:s({id:"K3r6DQ",defaultMessage:[{type:0,value:"Delete"}]})}]],onDropDownAction:e=>{let{eventKey:t,extraData:a}=e;if(a)switch(t){case"EditFolder":bN.folderEdit(a);break;case"DeleteFolder":bN.folderDelete(a)}}}),[s,a]),d=l3(()=>({extraData:null,dropDownOptions:[[{key:"NewChat",text:s({id:"UT7Nkj",defaultMessage:[{type:0,value:"New Chat"}]})}],[{key:"CreateChannel",text:s({id:"tUk+KR",defaultMessage:[{type:0,value:"Create a Channel"}]})}],[{key:"JoinChannel",text:s({id:"bvchtt",defaultMessage:[{type:0,value:"Join a Channel"}]})}]],onDropDownAction:e=>{let{eventKey:t}=e;switch(t){case"NewChat":yh.startChat();break;case"CreateChannel":bf.open({type:st.CREATE_CHANNEL});break;case"JoinChannel":bf.open({type:st.JOIN_CHANNEL})}}}),[s]),c=l3(()=>{let e={[i0.STARRED]:null,[i0.CHATS]:r,[i0.CHANNELS]:l,[i0.FOLDERS]:o,[i0.MEETING_CHATS]:null,[i0.SPOT_CHANNELS]:null,[i0.APPS]:null,[i0.RECENTS]:d,[i0.TOP_MENU]:null};return e[t]},[r,l,o,d,t]);return c?g.jsx(NJ,{...c,onOpenChange:i,sideOffset:4,children:g.jsx(dj,{tabIndex:0,...oI.Sidebar.chatMenuMoreOptions,"aria-label":s({id:"TRgBFd",defaultMessage:[{type:0,value:"More Options"}]}),className:f(LO.menuAction,n),size:"small",type:"text",onKeyDown:lo(),icon:g.jsx(nt,{})})}):null}),LP=window.React.useState,LF=ex(function(e){let{chatIds:t,menuType:a,menuName:n,folder:i,showTotalCount:s}=e,{$t:r}=oA(),[l,o]=LP(!1),{totalUnreadCount:d,totalChannelUnreadCount:c}=function(e){let[t,a]=b9(0),[n,i]=b9(0);return oe(()=>{if(!e)return;let t=e.map(e=>({sessionId:e,isChannel:yn(yh.chatMap.get(e)?.type)})),n=uW.unreadChannel$.pipe(ah(e=>e.filter(e=>t.map(e=>e.sessionId).includes(e.sessionId)).map(e=>({...e,isChannel:t.find(t=>t.sessionId===e.sessionId)?.isChannel})).reduce((e,t)=>{let a=t.unreadCount+(t.markAsUnreadSet?.size||0);return{totalUnreadCount:e.totalUnreadCount+a,totalChannelUnreadCount:e.totalChannelUnreadCount+(t.isChannel?a:0)}},{totalUnreadCount:0,totalChannelUnreadCount:0}))).subscribe(e=>{let{totalUnreadCount:t,totalChannelUnreadCount:n}=e;a(t),i(n)});return()=>n.unsubscribe()},[e]),{totalUnreadCount:t,totalChannelUnreadCount:n}}(t),u=g4.settings.channelShowUnreadMessageCount?d:d-c,m={[i0.STARRED]:r({id:"V7cUPv",defaultMessage:[{type:0,value:"Starred"}]}),[i0.FOLDERS]:r({id:"8ILyTU",defaultMessage:[{type:0,value:"Folders"}]}),[i0.CHATS]:r({id:"ABAQyo",defaultMessage:[{type:0,value:"Chats"}]}),[i0.CHANNELS]:r({id:"LUrJwE",defaultMessage:[{type:0,value:"Channels"}]}),[i0.MEETING_CHATS]:r({id:"07r+0G",defaultMessage:[{type:0,value:"Meeting Chats"}]}),[i0.SPOT_CHANNELS]:r({id:"TlOX6G",defaultMessage:[{type:0,value:"Huddle Channels"}]}),[i0.APPS]:r({id:"gRiKLf",defaultMessage:[{type:0,value:"Apps"}]}),[i0.RECENTS]:r({id:"wA4FIM",defaultMessage:[{type:0,value:"Recents"}]}),[i0.TOP_MENU]:""},p={[i0.STARRED]:g.jsx(iE,{}),[i0.CHATS]:g.jsx(ez,{}),[i0.CHANNELS]:g.jsx(eU,{}),[i0.MEETING_CHATS]:g.jsx(is,{}),[i0.SPOT_CHANNELS]:g.jsx(ir,{}),[i0.APPS]:g.jsx(iz,{}),[i0.FOLDERS]:g.jsx(iT,{}),[i0.TOP_MENU]:null,[i0.RECENTS]:g.jsx(ez,{})},h=[i0.MEETING_CHATS,i0.SPOT_CHANNELS];return g.jsxs("p",{...n?oI.Sidebar.chatMenu(n):oI.Sidebar.chatMenu(m[a]),className:f("_chatMenuHeader_v0vpp_2",{_visible_v0vpp_2:l}),children:[g.jsxs("span",{className:"_chatMenuTitle_v0vpp_21",children:[p[a],g.jsx("span",{children:n||m[a]}),h.includes(a)&&g.jsx(LL,{})]}),g.jsx(N1,{forceShow:c>0,hideCount:!u,count:u,className:f("_totalUnreadCount_v0vpp_7",{_hideTotalCount_v0vpp_39:!s})}),g.jsx(LD,{className:"_chatMenuAction_v0vpp_1",menuType:a,folder:i,onOpenChange:o})]})}),LB=ex(function(e){let{chats:t,chatId:a,folderItem:n,isActive:i}=e,s=!!n.members.find(e=>e.objid===a),r=`id-folder-${n.name}`;return g.jsx("li",{...oI.Sidebar.chatFolders(n.name),role:"none",children:g.jsxs(ct.Item,{eventKey:n.folderID,droppableId:n.folderID,children:[g.jsxs(ct.Header,{draggableId:n.folderID,detail:{folderId:n.folderID,type:i0.FOLDERS},...lc({isFolder:!0,isActive:s,isExpanded:i,groupName:r,label:n.name}),children:[g.jsx(LF,{chatIds:t,menuName:n.name,menuType:i0.FOLDERS,folder:n,showTotalCount:!i}),g.jsx(wA,{isShown:e=>!i&&!!t.includes(e)})]}),g.jsx(ct.Body,{groupName:n.name,groupIdName:r,children:oV(n.members).map(e=>g.jsx(ct.Node,{draggableId:e.objid,index:Number(e.index),detail:{chatId:e.objid,folderId:n.folderID,type:i0.FOLDERS},children:g.jsx(w$,{chatId:e.objid,activated:e.objid===a})},e.objid))})]})})}),LU=ex(function(e){let{menu:t,chatId:a,folderItem:n,chats:i,isActive:s}=e;if(n)return g.jsx(LB,{chats:i,chatId:a,folderItem:n,isActive:s});let r=function(e,t){return[i0.CHATS,i0.CHANNELS,i0.RECENTS].includes(t)?g4.settings.unreadMessagesOnTop?F(a0(e,e=>gq.unreadSessionIds.includes(e))):F(a0(e,e=>gq.unreadSessionIdsWithMark.includes(e))):e}(i,t),l=!!r.includes(a??""),o=`id-folder-${t}`;return g.jsx("li",{...oI.Sidebar.chatFolders(t),role:"none",children:g.jsxs(ct.Item,{eventKey:t,droppableId:t,children:[g.jsxs(ct.Header,{draggableId:t,...lc({isFolder:!0,isActive:l,isExpanded:s,groupName:o,label:t}),detail:{type:t},children:[g.jsx(LF,{chatIds:i,menuType:t,showTotalCount:!s}),g.jsx(wA,{isShown:e=>!s&&!!r.includes(e)})]}),g.jsx(ct.Body,{...oI.Sidebar.chatMenuItemBody(t),groupName:t,groupIdName:o,children:r.map((e,n)=>g.jsx(ct.Node,{draggableId:e,index:n,detail:{chatId:e,type:t},children:g.jsx(w$,{chatId:e,activated:e===a})},e))})]})})}),LH=window.React.useState,Lz=window.React.useCallback,LV=ex(function(e){let{isActive:t}=e,{starredIds:a,chatId:n}=yh,{membersInFolder:i}=bN,s=oa(()=>a.filter(e=>!i.has(e)),[a,i]);return g.jsx(LU,{menu:i0.STARRED,chats:s,chatId:n,isActive:t},i0.STARRED)}),LG=ex(function(e){let{isActive:t}=e,{recentIds:a,chatId:n}=yh,{membersInFolder:i}=bN,{isChatApp:s}=bd,r=oa(()=>a.filter(e=>!i.has(e)&&!s(e)),[a,i,s]);return g.jsx(LU,{menu:i0.RECENTS,chats:r,chatId:n,isActive:t},i0.RECENTS)}),Lq=ex(function(e){let{folderItem:t,isActive:a}=e,{chatId:n}=yh,i=oa(()=>t.members.map(e=>e.objid),[t.members]);return g.jsx(LU,{menu:t.folderID,chats:i,folderItem:t,chatId:n,isActive:a},t.folderID)}),L$=ex(function(e){let{isActive:t}=e,{chatIds:a,meetingChatIds:n,chatId:i}=yh,{membersInFolder:s}=bN,{isChatApp:r}=bd,l=oa(()=>a.filter(e=>!s.has(e)&&!n.includes(e)&&!r(e)),[a,s,n,r]);return g.jsx(LU,{menu:i0.CHATS,chats:l,chatId:i,isActive:t},i0.CHATS)}),LK=ex(function(e){let{isActive:t}=e,{channelIds:a,spotChannelIds:n,chatId:i}=yh,{membersInFolder:s}=bN,r=oa(()=>a.filter(e=>!s.has(e)&&!n.includes(e)),[a,s,n]);return g.jsx(LU,{menu:i0.CHANNELS,chats:r,chatId:i,isActive:t},i0.CHANNELS)}),LJ=ex(function(e){let{isActive:t}=e,{meetingChatIds:a,chatId:n}=yh,{membersInFolder:i}=bN,s=oa(()=>a.filter(e=>!i.has(e)),[i,a]);return g.jsx(LU,{menu:i0.MEETING_CHATS,chats:s,chatId:n,isActive:t},i0.MEETING_CHATS)}),LW=ex(function(e){let{isActive:t}=e,{spotChannelIds:a,chatId:n}=yh,{membersInFolder:i}=bN,s=oa(()=>a.filter(e=>!i.has(e)),[i,a]);return g.jsx(LU,{menu:i0.SPOT_CHANNELS,chats:s,chatId:n,isActive:t},i0.SPOT_CHANNELS)}),LY=ex(function(e){let{isActive:t}=e,{starredChatIds:a,chatId:n}=yh,{membersInFolder:i}=bN,{chatAppIds:s}=bd,r=oa(()=>s.filter(e=>!i.has(e)&&!a.includes(e)),[s,i,a]);return g.jsx(LU,{menu:i0.APPS,chats:r,chatId:n,isActive:t},i0.APPS)}),LX=ex(function(){let{chatId:e}=yh,{oneSectionAllowed:t,separateChatAndChannel:a}=g4.settings,{folders:n}=bN,{handleDrop:i,allowDrop:s}=function(){let{moveToFolder:e,moveFolder:t,deleteMemberFromFolder:a,lastFolder:n,getFolder:i}=bN,{star:s,unStar:r,chatMap:l}=yh,{isPMC:o,isSpotChannel:d}=gQ;return{handleDrop:c=>{let{dropItem:u,dragPosition:m,dragItem:p}=c,[h,f]=[y(p),y(u)],g=()=>{switch(!0){case h.isFolder():{let e=h.getFolder();if(!e)return;a({folderId:e.folderID,sessionIds:[h.id]});return}case h.isStar():r({jid:h.id});return;default:return}};if(h.isParent()){if(h.isFolder())switch(!0){case f.isFolder():{let e=f.getFolder();if(!e)return;let a="up"===m?e.index:Number(e.index)+1;return t({folderID:h.id,index:String(a)})}case f.isStar()&&"down"===m:return t({folderID:h.id,index:String(0)});case(f.isChat()||f.isRecents())&&"up"===m:if(!n)return;return t({folderID:h.id,index:String(Number(n.index)+1)});default:return}}else{if(h.chatDragForbidden())return;switch(!0){case f.isFolder()&&f.isParent():e({folderID:f.id,sessionId:h.id});return;case f.isFolder()&&!f.isParent():{let t=f.getFolder();if(!t)return;let a=t.members.find(e=>e.objid===f.id);if(!a)return;e({folderID:t.folderID,sessionId:h.id,index:String("up"===m?a.index:Number(a.index)+1)});return}case f.isStar():(()=>{h.isStar()||s({jid:h.id})})();return;case f.isChannel():if(!h.canMoveToChannel())return;g();return;case f.isChat():if(!h.canMoveToChat())return;g();return;case f.isRecents():(h.canMoveToChat()||h.canMoveToChannel())&&g();return;case f.isMeetingChats():if(!h.canMoveToMeetingChats())return;g();return;case f.isSpotChannel():if(!h.canMoveToSpotChannels())return;g();return;default:return}}function y(e){let{folderId:t,chatId:a}=e.detail||{};return{...e,getFolder:()=>t?i(t):null,getChat:()=>a?l.get(a):null,isFolder:()=>e.detail?.type===i0.FOLDERS,isChat:()=>e.detail?.type===i0.CHATS,isMeetingChats:()=>e.detail?.type===i0.MEETING_CHATS,isSpotChannel:()=>e.detail?.type===i0.SPOT_CHANNELS,isChannel:()=>e.detail?.type===i0.CHANNELS,isStar:()=>e.detail?.type===i0.STARRED,isRecents:()=>e.detail?.type===i0.RECENTS,isParent:()=>"parent"===e.type,canMoveToChat(){let e=this.getChat();return!!e&&e.type!==i1.CHANNEL&&!o(a)&&!d(a)},canMoveToChannel(){let e=this.getChat();return!!e&&e.type===i1.CHANNEL&&!o(a)&&!d(a)},canMoveToMeetingChats:()=>o(a),canMoveToSpotChannels:()=>d(a),chatDragForbidden(){let e=this.getChat();return!e||rS(e.jid)||yi(e.type)}}}},allowDrop:e=>{let{dropItem:t,dragItem:a}=e,{detail:n}=t,{detail:i}=a,s=i?.chatId;function r(){return s?l.get(s):null}switch(n?.type){case i0.CHATS:{let e=r();if(!e)return!1;return e.type!==i1.CHANNEL&&!o(s)&&!d(s)}case i0.CHANNELS:{let e=r();if(!e)return!1;return e.type===i1.CHANNEL&&!o(s)&&!d(s)}case i0.MEETING_CHATS:return o(s);case i0.SPOT_CHANNELS:return d(s);default:return!0}}}}(),[r,l]=function(e){let{oneSectionAllowed:t}=g4.settings,[a,n]=LH([]),i=function(e){if(!e)return null;let{folders:t}=bN,{isPMC:a,isSpotChannel:n}=gQ,{chatMap:i,isChatStarred:s}=yh,{separateChatAndChannel:r}=g4.settings,{isChatApp:l}=bd,o=i.get(e);if(!o||o.type===i1.TOP_MENU)return null;if(s(e))return i0.STARRED;let d=t.find(t=>t.members.some(t=>t.objid===e));return d?d.folderID:l(e)?i0.APPS:r?a(e)?i0.MEETING_CHATS:n(e)?i0.SPOT_CHANNELS:yt(o.type)||ya(o.type)||yi(o.type)?i0.CHATS:i0.CHANNELS:i0.RECENTS}(e);return l2(()=>{i&&(t?n([i]):n(e=>e.includes(i)?e:[...e,i]))},[i,t]),[a,n]}(e),o=Lz(e=>r.includes(e),[r]);return g.jsx("div",{className:"_chatMenu_vyf4g_1",children:g.jsxs(ct,{handleDrop:i,allowDrop:s,isSolitary:!!t,activeKey:r,setActiveKey:l,children:[g.jsx("ul",{className:"_sidebarChatTopMenu_vyf4g_43",role:"group",children:g.jsx(wc,{})}),g.jsx(LV,{isActive:o(i0.STARRED)}),n.map(e=>g.jsx(Lq,{folderItem:e,isActive:o(e.folderID)},e.folderID)),a?(()=>g.jsxs(g.Fragment,{children:[g.jsx(L$,{isActive:o(i0.CHATS)}),g.jsx(LK,{isActive:o(i0.CHANNELS)}),g.jsx(LJ,{isActive:o(i0.MEETING_CHATS)}),g.jsx(LW,{isActive:o(i0.SPOT_CHANNELS)})]}))():g.jsx(LG,{isActive:o(i0.RECENTS)}),g.jsx(LY,{isActive:o(i0.APPS)})]})})}),LQ=window.React.useCallback,LZ=!1,L1=()=>{let{recentChatsFetched:e,starredChatsFetched:t,folderChatsFetched:a,appsListFetched:n,chatMap:i}=yh,s=i.size>0&&!e&&!t&&!a&&!n,r=LQ(e=>{if(!LZ){let t=o3()?fk.PLATFORM_WC:fk.PLATFORM_CHAT;fS.logMeasure(Ej.loadChatSidebar,[fk.LOAD_SIDEBAR_CHATS,t,e]),LZ=!0}},[]);l2(()=>{s&&r(fk.BY_LOCAL)},[s,r]),l2(()=>{e&&t&&a&&r(fk.BY_ONLINE)},[a,r,e,t])};function L0(){let{$t:e}=oA(),{openChatSetting:t}=Mu(),a=l3(()=>({extraData:null,dropDownOptions:[[{key:"CreateChannel",text:e({id:"tUk+KR",defaultMessage:[{type:0,value:"Create a Channel"}]}),testKey:"createChannel"},{key:"JoinChannel",text:e({id:"bvchtt",defaultMessage:[{type:0,value:"Join a Channel"}]}),testKey:"joinChannel"},{key:"CreateFolder",text:e({id:"yFvSRv",defaultMessage:[{type:0,value:"Create a Folder"}]}),testKey:"createFolder"}],[{key:"Settings",text:e({id:"D3idYv",defaultMessage:[{type:0,value:"Settings"}]}),testKey:"settings"}]],onDropDownAction:e=>{let{eventKey:a}=e;switch(a){case"CreateChannel":bf.open({type:st.CREATE_CHANNEL});break;case"JoinChannel":bf.open({type:st.JOIN_CHANNEL});break;case"CreateFolder":bN.folderCreate();break;case"Settings":t()}}}),[e,t]);return g.jsx(NJ,{...a,sideOffset:4,children:g.jsx("button",{...oI.Sidebar.teamChatMoreBtn,className:"_menuAction_1v3hc_1","aria-label":e({id:"ephTAX",defaultMessage:[{type:0,value:"More options for Team Chat"}]}),children:g.jsx(tC,{})})})}let L2=window.React.useCallback,L5=window.React.useRef,L3=ex(function(){let{$t:e}=oA(),{fetched:t}=gQ,{startChat:a,loading:n}=yh,i=L5(null),s=L2(()=>{i.current&&r3.set(rQ.siderWidth,+i.current.offsetWidth)},[i]);return L1(),oh(i,s),g.jsx("div",{...oI.Sidebar.sidebar,ref:i,className:f("_theme_15os1_1",`theme${g4.settings.sidebarTheme}`),children:g.jsxs("div",{className:"_sidebarChat_15os1_5",children:[g.jsxs("div",{className:"_sidebarChatHeader_15os1_12",children:[g.jsxs("span",{className:"_sidebarChatHeaderTitle_15os1_21",children:[e({id:"IvVCtb",defaultMessage:[{type:0,value:"Team Chat"}]}),g.jsx(L0,{})]}),g.jsx(dj,{...oI.Sidebar.newChatBtn,type:"primary",shape:"circle","aria-label":e({id:"UT7Nkj",defaultMessage:[{type:0,value:"New Chat"}]}),className:"_sidebarStartChat_15os1_32",onClick:a,icon:g.jsx(iV,{}),loading:n||!t})]}),g.jsx("div",{className:"_sidebarChatHeaderMenu_15os1_55",children:g.jsx(LX,{})})]})})}),L6=window.PWAToast.ToastContainer,L4=window.React.useRef,L8=(()=>{let e=r3.get(rQ.siderWidth);return!e||!iG(e)||e<240||e>320?(r3.delete(rQ.siderWidth),240):e})(),L7=function(e,t,a){return(void 0===a&&(a=()=>null),uc(t))?e:a}(function(){let e=L4(null);!function(e){let{setGlobalDisabled:t}=MI;l2(()=>{let a=e.current,n=new IntersectionObserver(e=>{e[0]?.isIntersecting?t(!1):t(!0)});return n.observe(a),()=>{n.unobserve(a),n.disconnect()}},[e])}(e),function(){let{statusToAwait:e,idleTime:t}=g4.settings,a=ng(6e4*Number(t)),n=window.pwaChatConfig.jid,{presenceType:i}=bu(n),s=bS(i),{changePresence:r}=bs;l2(()=>{if(!e)return;let t=a&&(i===nm.available||i===nm.busy),n=a&&i===nm.away;if(t){r({presenceType:nm.away,options:{manual:!1}}),s.current=i;return}n&&r({presenceType:s.current,options:{manual:!1}})},[a,r,e,i])}(),Ew();let t=o3();return g.jsxs("div",{className:"_container_k7y5f_12",ref:e,children:[g.jsx("div",{id:_G}),g.jsxs("div",{className:"_layout_k7y5f_1",children:[!t&&g.jsx(Ro,{}),g.jsxs(iq,{className:f("_contentLayout_k7y5f_5",{_hasHeader_k7y5f_8:!t}),children:[g.jsx(i$,{resizable:!0,minWidth:240,maxWidth:320,defaultWidth:L8,children:g.jsx(NU,{type:NO.Sidebar,children:g.jsx(L3,{})})}),g.jsx(iK,{className:"_content_k7y5f_5",children:g.jsx(LR,{})})]}),g.jsx(EC,{}),g.jsx(Rx,{}),g.jsx(Ld,{}),g.jsx(Eu,{}),!t&&g.jsx(L6,{TOAST_PATH:{GLOBAL:"/"},icons:{success:g.jsx(iJ,{}),info:g.jsx(iW,{}),failure:g.jsx(iY,{}),warn:g.jsx(n3,{})}})]}),g.jsx(RN,{}),g.jsx("div",{id:"screenshot"}),g.jsx("div",{className:"_srOnly_k7y5f_24",role:"alert","aria-atomic":"true","aria-live":"assertive",id:sI})]})},o4.chat,function(){let{$t:e}=oA();return g.jsxs("div",{className:"_container_u8n1t_1",role:"alert",children:[g.jsx(n3,{className:"_icon_u8n1t_10"}),g.jsx("span",{className:"_text_u8n1t_15",children:e({id:"eirec4",defaultMessage:[{type:0,value:"You have no permission."}]})})]})});function L9(){return g.jsx(oD,{children:g.jsx(L7,{})})}let Oe=window.ReactRouterDOM.BrowserRouter,Ot=window.ReactRouterDOM.Switch,Oa=window.ReactRouterDOM.Route,On=window.PWAModal.Modal,Oi=window.React,Os=window.ReactDOM;o3()||(On.setAppElement("#root"),(()=>{if(o3()||uh)return;let e=window?.pwaChatConfig?.jid||"",t=e.split("@")[0]||"";uh=window.setInterval(()=>{at.post(`/wc/pwa-ping?uid=${t}`).then(e=>{let{data:t}=e;t?.errorCode===201&&(window.location.href="/signin")}).catch(e=>{console.error(e)})},54e5)})()),Os.render(g.jsx(Oi.StrictMode,{children:g.jsx(NU,{type:NO.App,children:g.jsx(()=>g.jsx(Oe,{children:g.jsx(Ot,{children:g.jsx(Oa,{component:L9})})}),{})})}),document.getElementById("root"))}}})}();